<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns, CPP, GADTs, FlexibleContexts, ScopedTypeVariables #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module    : System.Random.MWC.Distributions</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright : (c) 2012 Bryan O'Sullivan</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License   : BSD3</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Maintainer  : bos@serpentine.com</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Portability : portable</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Pseudo-random number generation for non-uniform distributions.</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.Random.MWC.Distributions</span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Variates: non-uniformly distributed values</span></span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Continuous distributions</span></span><span>
</span><span id="line-17"></span><span>      </span><span class="annot"><a href="System.Random.MWC.Distributions.html#normal"><span class="hs-identifier">normal</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#standard"><span class="hs-identifier">standard</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#exponential"><span class="hs-identifier">exponential</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#truncatedExp"><span class="hs-identifier">truncatedExp</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#gamma"><span class="hs-identifier">gamma</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#chiSquare"><span class="hs-identifier">chiSquare</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#beta"><span class="hs-identifier">beta</span></a></span><span>
</span><span id="line-24"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Discrete distribution</span></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#categorical"><span class="hs-identifier">categorical</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#logCategorical"><span class="hs-identifier">logCategorical</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#geometric0"><span class="hs-identifier">geometric0</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#geometric1"><span class="hs-identifier">geometric1</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#bernoulli"><span class="hs-identifier">bernoulli</span></a></span><span>
</span><span id="line-30"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Multivariate</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#dirichlet"><span class="hs-identifier">dirichlet</span></a></span><span>
</span><span id="line-32"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Permutations</span></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#uniformPermutation"><span class="hs-identifier">uniformPermutation</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#uniformShuffle"><span class="hs-identifier">uniformShuffle</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#uniformShuffleM"><span class="hs-identifier">uniformShuffleM</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><span class="hs-comment">-- * References</span></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="hs-comment">-- $references</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftM</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Primitive</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PrimMonad</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PrimState</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(.&amp;.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if !MIN_VERSION_base(4,8,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Traversable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Traversable</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random.Stateful</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">StatefulGen</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">Uniform</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">UniformRange</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">uniformDoublePositive01M</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Unboxed</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">I</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Generic</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Generic.Mutable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- Unboxed 2-tuple</span><span>
</span><span id="line-56"></span><span class="hs-keyword">data</span><span> </span><span id="T"><span class="annot"><a href="System.Random.MWC.Distributions.html#T"><span class="hs-identifier hs-var">T</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="T"><span class="annot"><a href="System.Random.MWC.Distributions.html#T"><span class="hs-identifier hs-var">T</span></a></span></span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | Generate a normally distributed random variate with given mean</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- and standard deviation.</span><span>
</span><span id="line-61"></span><span id="local-6989586621679065013"><span id="local-6989586621679065014"><span class="annot"><a href="System.Random.MWC.Distributions.html#normal"><span class="hs-identifier hs-type">normal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679065014"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065013"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-62"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>                </span><span class="hs-comment">-- ^ Mean</span><span>
</span><span id="line-63"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>                </span><span class="hs-comment">-- ^ Standard deviation</span><span>
</span><span id="line-64"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065014"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-65"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065013"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span></span><span>
</span><span id="line-66"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#normal"><span class="hs-pragma hs-type">normal</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-67"></span><span id="normal"><span class="annot"><span class="annottext">normal :: forall g (m :: * -&gt; *).
StatefulGen g m =&gt;
Double -&gt; Double -&gt; g -&gt; m Double
</span><a href="System.Random.MWC.Distributions.html#normal"><span class="hs-identifier hs-var hs-var">normal</span></a></span></span><span> </span><span id="local-6989586621679064787"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064787"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679064786"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064786"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679064785"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064785"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-68"></span><span>  </span><span id="local-6989586621679064784"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064784"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m Double
</span><a href="System.Random.MWC.Distributions.html#standard"><span class="hs-identifier hs-var">standard</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064785"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064787"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064786"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064784"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | Generate a normally distributed random variate with zero mean and</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- unit variance.</span><span>
</span><span id="line-73"></span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- The implementation uses Doornik's modified ziggurat algorithm.</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- Compared to the ziggurat algorithm usually used, this is slower,</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- but generates more independent variates that pass stringent tests</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- of randomness.</span><span>
</span><span id="line-78"></span><span id="local-6989586621679065006"><span id="local-6989586621679065007"><span class="annot"><a href="System.Random.MWC.Distributions.html#standard"><span class="hs-identifier hs-type">standard</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679065007"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065006"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065007"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679065006"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span></span><span>
</span><span id="line-79"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#standard"><span class="hs-pragma hs-type">standard</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-80"></span><span id="standard"><span class="annot"><span class="annottext">standard :: forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m Double
</span><a href="System.Random.MWC.Distributions.html#standard"><span class="hs-identifier hs-var hs-var">standard</span></a></span></span><span> </span><span id="local-6989586621679064705"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064705"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Double
</span><a href="#local-6989586621679064704"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-82"></span><span>    </span><span id="local-6989586621679064704"><span class="annot"><span class="annottext">loop :: m Double
</span><a href="#local-6989586621679064704"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-83"></span><span>      </span><span id="local-6989586621679064703"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064703"><span class="hs-identifier hs-var">u</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">subtract</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-operator hs-var">`liftM`</span></span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m Double
</span><span class="hs-identifier hs-var">uniformDoublePositive01M</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064705"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-84"></span><span>      </span><span id="local-6989586621679064700"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679064700"><span class="hs-identifier hs-var">ri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a g (m :: * -&gt; *). (Uniform a, StatefulGen g m) =&gt; g -&gt; m a
</span><span class="hs-identifier hs-var">uniformM</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064705"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-85"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679064698"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679064698"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679064700"><span class="hs-identifier hs-var">ri</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">127</span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>          </span><span id="local-6989586621679064697"><span class="annot"><span class="annottext">bi :: Double
</span><a href="#local-6989586621679064697"><span class="hs-identifier hs-var hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Unbox a =&gt; Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">I.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><a href="System.Random.MWC.Distributions.html#blocks"><span class="hs-identifier hs-var">blocks</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064698"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-87"></span><span>          </span><span id="local-6989586621679064694"><span class="annot"><span class="annottext">bj :: Double
</span><a href="#local-6989586621679064694"><span class="hs-identifier hs-var hs-var">bj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Unbox a =&gt; Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">I.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><a href="System.Random.MWC.Distributions.html#blocks"><span class="hs-identifier hs-var">blocks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064698"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-89"></span><span>        </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064703"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Unbox a =&gt; Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">I.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><a href="System.Random.MWC.Distributions.html#ratios"><span class="hs-identifier hs-var">ratios</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064698"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064703"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064697"><span class="hs-identifier hs-var">bi</span></a></span><span>
</span><span id="line-90"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064698"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Double
</span><a href="#local-6989586621679064690"><span class="hs-identifier hs-var">normalTail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064703"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-92"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679064689"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679064689"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064703"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064697"><span class="hs-identifier hs-var">bi</span></a></span><span>
</span><span id="line-93"></span><span>                 </span><span id="local-6989586621679064688"><span class="annot"><span class="annottext">xx :: Double
</span><a href="#local-6989586621679064688"><span class="hs-identifier hs-var hs-var">xx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064689"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064689"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-94"></span><span>                 </span><span id="local-6989586621679064687"><span class="annot"><span class="annottext">d :: Double
</span><a href="#local-6989586621679064687"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">exp</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064697"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064697"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064688"><span class="hs-identifier hs-var">xx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>                 </span><span id="local-6989586621679064685"><span class="annot"><span class="annottext">e :: Double
</span><a href="#local-6989586621679064685"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">exp</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064694"><span class="hs-identifier hs-var">bj</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064694"><span class="hs-identifier hs-var">bj</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064688"><span class="hs-identifier hs-var">xx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>             </span><span id="local-6989586621679064684"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064684"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m Double
</span><span class="hs-identifier hs-var">uniformDoublePositive01M</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064705"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-97"></span><span>             </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064685"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064684"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064687"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064685"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-98"></span><span>               </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064689"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-99"></span><span>               </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">m Double
</span><a href="#local-6989586621679064704"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621679064690"><span class="annot"><span class="annottext">normalTail :: Bool -&gt; m Double
</span><a href="#local-6989586621679064690"><span class="hs-identifier hs-var hs-var">normalTail</span></a></span></span><span> </span><span id="local-6989586621679064683"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679064683"><span class="hs-identifier hs-var">neg</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Double
</span><a href="#local-6989586621679064682"><span class="hs-identifier hs-var">tailing</span></a></span><span>
</span><span id="line-101"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679064682"><span class="annot"><span class="annottext">tailing :: m Double
</span><a href="#local-6989586621679064682"><span class="hs-identifier hs-var hs-var">tailing</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-102"></span><span>              </span><span id="local-6989586621679064681"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064681"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="System.Random.MWC.Distributions.html#rNorm"><span class="hs-identifier hs-var">rNorm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-operator hs-var">`liftM`</span></span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m Double
</span><span class="hs-identifier hs-var">uniformDoublePositive01M</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064705"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-103"></span><span>              </span><span id="local-6989586621679064677"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064677"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span>              </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-operator hs-var">`liftM`</span></span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m Double
</span><span class="hs-identifier hs-var">uniformDoublePositive01M</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064705"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-104"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064677"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064681"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064681"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-105"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">m Double
</span><a href="#local-6989586621679064682"><span class="hs-identifier hs-var">tailing</span></a></span><span>
</span><span id="line-106"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679064683"><span class="hs-identifier hs-var">neg</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064681"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="System.Random.MWC.Distributions.html#rNorm"><span class="hs-identifier hs-var">rNorm</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="System.Random.MWC.Distributions.html#rNorm"><span class="hs-identifier hs-var">rNorm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064681"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- Constants used by standard/normal. They are floated to the top</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- level to avoid performance regression (Bug #16) when blocks/ratios</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- are recalculated on each call to standard/normal. It's also</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- somewhat difficult to trigger reliably.</span><span>
</span><span id="line-112"></span><span class="annot"><a href="System.Random.MWC.Distributions.html#blocks"><span class="hs-identifier hs-type">blocks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">I.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-113"></span><span id="blocks"><span class="annot"><span class="annottext">blocks :: Vector Double
</span><a href="System.Random.MWC.Distributions.html#blocks"><span class="hs-identifier hs-var hs-var">blocks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Unbox a =&gt; Vector a -&gt; a -&gt; Vector a
</span><span class="hs-operator hs-var">`I.snoc`</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Unbox a =&gt; a -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">I.cons</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064674"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064673"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Unbox a =&gt; a -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">I.cons</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="System.Random.MWC.Distributions.html#rNorm"><span class="hs-identifier hs-var">rNorm</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. Unbox a =&gt; Int -&gt; (b -&gt; Maybe (a, b)) -&gt; b -&gt; Vector a
</span><span class="hs-identifier hs-var">I.unfoldrN</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">126</span></span><span> </span><span class="annot"><span class="annottext">T -&gt; Maybe (Double, T)
</span><a href="#local-6989586621679064671"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; T
</span><a href="System.Random.MWC.Distributions.html#T"><span class="hs-identifier hs-var">T</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="System.Random.MWC.Distributions.html#rNorm"><span class="hs-identifier hs-var">rNorm</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064673"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621679064671"><span class="annot"><span class="annottext">go :: T -&gt; Maybe (Double, T)
</span><a href="#local-6989586621679064671"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Random.MWC.Distributions.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span id="local-6989586621679064670"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064670"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679064669"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064669"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679064668"><span class="annot"><span class="annottext">u :: T
</span><a href="#local-6989586621679064668"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; T
</span><a href="System.Random.MWC.Distributions.html#T"><span class="hs-identifier hs-var">T</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064667"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">exp</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064667"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064667"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>                     </span><span id="local-6989586621679064667"><span class="annot"><span class="annottext">h :: Double
</span><a href="#local-6989586621679064667"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064674"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064670"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064669"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064667"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">T
</span><a href="#local-6989586621679064668"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621679064674"><span class="annot"><span class="annottext">v :: Double
</span><a href="#local-6989586621679064674"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">9.91256303526217e-3</span></span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679064673"><span class="annot"><span class="annottext">f :: Double
</span><a href="#local-6989586621679064673"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">exp</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="System.Random.MWC.Distributions.html#rNorm"><span class="hs-identifier hs-var">rNorm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="System.Random.MWC.Distributions.html#rNorm"><span class="hs-identifier hs-var">rNorm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#blocks"><span class="hs-pragma hs-type">blocks</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><a href="System.Random.MWC.Distributions.html#rNorm"><span class="hs-identifier hs-type">rNorm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-123"></span><span id="rNorm"><span class="annot"><span class="annottext">rNorm :: Double
</span><a href="System.Random.MWC.Distributions.html#rNorm"><span class="hs-identifier hs-var hs-var">rNorm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3.442619855899</span></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="annot"><a href="System.Random.MWC.Distributions.html#ratios"><span class="hs-identifier hs-type">ratios</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">I.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-126"></span><span id="ratios"><span class="annot"><span class="annottext">ratios :: Vector Double
</span><a href="System.Random.MWC.Distributions.html#ratios"><span class="hs-identifier hs-var hs-var">ratios</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c.
(Unbox a, Unbox b, Unbox c) =&gt;
(a -&gt; b -&gt; c) -&gt; Vector a -&gt; Vector b -&gt; Vector c
</span><span class="hs-identifier hs-var">I.zipWith</span></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(/)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Unbox a =&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">I.tail</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><a href="System.Random.MWC.Distributions.html#blocks"><span class="hs-identifier hs-var">blocks</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><a href="System.Random.MWC.Distributions.html#blocks"><span class="hs-identifier hs-var">blocks</span></a></span><span>
</span><span id="line-127"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#ratios"><span class="hs-pragma hs-type">ratios</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">-- | Generate an exponentially distributed random variate.</span><span>
</span><span id="line-132"></span><span id="local-6989586621679064966"><span id="local-6989586621679064967"><span class="annot"><a href="System.Random.MWC.Distributions.html#exponential"><span class="hs-identifier hs-type">exponential</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679064967"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064966"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-133"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>            </span><span class="hs-comment">-- ^ Scale parameter</span><span>
</span><span id="line-134"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064967"><span class="hs-identifier hs-type">g</span></a></span><span>                 </span><span class="hs-comment">-- ^ Generator</span><span>
</span><span id="line-135"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064966"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span></span><span>
</span><span id="line-136"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#exponential"><span class="hs-pragma hs-type">exponential</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-137"></span><span id="exponential"><span class="annot"><span class="annottext">exponential :: forall g (m :: * -&gt; *). StatefulGen g m =&gt; Double -&gt; g -&gt; m Double
</span><a href="System.Random.MWC.Distributions.html#exponential"><span class="hs-identifier hs-var hs-var">exponential</span></a></span></span><span> </span><span id="local-6989586621679064649"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064649"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679064648"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064648"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621679064647"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064647"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m Double
</span><span class="hs-identifier hs-var">uniformDoublePositive01M</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064648"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="hs-glyph">-</span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064647"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064649"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- | Generate truncated exponentially distributed random variate.</span><span>
</span><span id="line-143"></span><span id="local-6989586621679064962"><span id="local-6989586621679064963"><span class="annot"><a href="System.Random.MWC.Distributions.html#truncatedExp"><span class="hs-identifier hs-type">truncatedExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679064963"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064962"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-144"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>            </span><span class="hs-comment">-- ^ Scale parameter</span><span>
</span><span id="line-145"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- ^ Range to which distribution is</span><span>
</span><span id="line-146"></span><span>                                  </span><span class="hs-comment">--   truncated. Values may be negative.</span><span>
</span><span id="line-147"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064963"><span class="hs-identifier hs-type">g</span></a></span><span>                 </span><span class="hs-comment">-- ^ Generator.</span><span>
</span><span id="line-148"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064962"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span></span><span>
</span><span id="line-149"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#truncatedExp"><span class="hs-pragma hs-type">truncatedExp</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-150"></span><span id="truncatedExp"><span class="annot"><span class="annottext">truncatedExp :: forall g (m :: * -&gt; *).
StatefulGen g m =&gt;
Double -&gt; (Double, Double) -&gt; g -&gt; m Double
</span><a href="System.Random.MWC.Distributions.html#truncatedExp"><span class="hs-identifier hs-var hs-var">truncatedExp</span></a></span></span><span> </span><span id="local-6989586621679064630"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064630"><span class="hs-identifier hs-var">scale</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064629"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064629"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679064628"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064628"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679064627"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064627"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-comment">-- We shift a to 0 and then generate distribution truncated to [0,b-a]</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-comment">-- It's easier</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679064626"><span class="annot"><span class="annottext">delta :: Double
</span><a href="#local-6989586621679064626"><span class="hs-identifier hs-var hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064628"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064629"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621679064625"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064625"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m Double
</span><span class="hs-identifier hs-var">uniformDoublePositive01M</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064627"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064629"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064625"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064625"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">exp</span></span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064630"><span class="hs-identifier hs-var">scale</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064626"><span class="hs-identifier hs-var">delta</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064630"><span class="hs-identifier hs-var">scale</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Random variate generator for gamma distribution.</span><span>
</span><span id="line-158"></span><span id="local-6989586621679064623"><span id="local-6989586621679064624"><span class="annot"><a href="System.Random.MWC.Distributions.html#gamma"><span class="hs-identifier hs-type">gamma</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679064624"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064623"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>                 </span><span class="hs-comment">-- ^ Shape parameter</span><span>
</span><span id="line-160"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>                 </span><span class="hs-comment">-- ^ Scale parameter</span><span>
</span><span id="line-161"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064624"><span class="hs-identifier hs-type">g</span></a></span><span>                      </span><span class="hs-comment">-- ^ Generator</span><span>
</span><span id="line-162"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064623"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span></span><span>
</span><span id="line-163"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#gamma"><span class="hs-pragma hs-type">gamma</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-164"></span><span id="gamma"><span class="annot"><span class="annottext">gamma :: forall g (m :: * -&gt; *).
StatefulGen g m =&gt;
Double -&gt; Double -&gt; g -&gt; m Double
</span><a href="System.Random.MWC.Distributions.html#gamma"><span class="hs-identifier hs-var hs-var">gamma</span></a></span></span><span> </span><span id="local-6989586621679064563"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064563"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679064562"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064562"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679064561"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064561"><span class="hs-identifier hs-var">gen</span></a></span></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064563"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; String -&gt; a
</span><a href="System.Random.MWC.Distributions.html#pkgError"><span class="hs-identifier hs-var">pkgError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;gamma&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;negative alpha parameter&quot;</span></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Double
</span><a href="#local-6989586621679064558"><span class="hs-identifier hs-var">mainloop</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>      </span><span id="local-6989586621679064558"><span class="annot"><span class="annottext">mainloop :: m Double
</span><a href="#local-6989586621679064558"><span class="hs-identifier hs-var hs-var">mainloop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><a href="System.Random.MWC.Distributions.html#T"><span class="hs-identifier hs-type">T</span></a></span><span> </span><span id="local-6989586621679064557"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064557"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064556"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064556"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m T
</span><a href="#local-6989586621679064555"><span class="hs-identifier hs-var">innerloop</span></a></span><span>
</span><span id="line-170"></span><span>        </span><span id="local-6989586621679064554"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064554"><span class="hs-identifier hs-var">u</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m Double
</span><span class="hs-identifier hs-var">uniformDoublePositive01M</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064561"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-171"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679064553"><span class="annot"><span class="annottext">cont :: Bool
</span><a href="#local-6989586621679064553"><span class="hs-identifier hs-var hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064554"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.331</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="System.Random.MWC.Distributions.html#sqr"><span class="hs-identifier hs-var">sqr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="System.Random.MWC.Distributions.html#sqr"><span class="hs-identifier hs-var">sqr</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064557"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>                 </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064554"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="System.Random.MWC.Distributions.html#sqr"><span class="hs-identifier hs-var">sqr</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064557"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064549"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064556"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064556"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Rarely evaluated</span><span>
</span><span id="line-173"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-174"></span><span>          </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679064553"><span class="hs-identifier hs-var">cont</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m Double
</span><a href="#local-6989586621679064558"><span class="hs-identifier hs-var">mainloop</span></a></span><span>
</span><span id="line-175"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064563"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064549"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064556"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064562"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-176"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679064548"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064548"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m Double
</span><span class="hs-identifier hs-var">uniformDoublePositive01M</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064561"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-177"></span><span>                             </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064548"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064563"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064549"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064556"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064562"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-178"></span><span>      </span><span class="hs-comment">-- inner loop</span><span>
</span><span id="line-179"></span><span>      </span><span id="local-6989586621679064555"><span class="annot"><span class="annottext">innerloop :: m T
</span><a href="#local-6989586621679064555"><span class="hs-identifier hs-var hs-var">innerloop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-180"></span><span>        </span><span id="local-6989586621679064546"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064546"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m Double
</span><a href="System.Random.MWC.Distributions.html#standard"><span class="hs-identifier hs-var">standard</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064561"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-181"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064545"><span class="hs-identifier hs-var">a2</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064546"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-182"></span><span>          </span><span id="local-6989586621679064544"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064544"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064544"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m T
</span><a href="#local-6989586621679064555"><span class="hs-identifier hs-var">innerloop</span></a></span><span>
</span><span id="line-183"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; T
</span><a href="System.Random.MWC.Distributions.html#T"><span class="hs-identifier hs-var">T</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064546"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064544"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064544"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064544"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>      </span><span class="hs-comment">-- constants</span><span>
</span><span id="line-185"></span><span>      </span><span id="local-6989586621679064543"><span class="annot"><span class="annottext">a' :: Double
</span><a href="#local-6989586621679064543"><span class="hs-identifier hs-var hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064563"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064563"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064563"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-186"></span><span>      </span><span id="local-6989586621679064549"><span class="annot"><span class="annottext">a1 :: Double
</span><a href="#local-6989586621679064549"><span class="hs-identifier hs-var hs-var">a1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064543"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span>
</span><span id="line-187"></span><span>      </span><span id="local-6989586621679064545"><span class="annot"><span class="annottext">a2 :: Double
</span><a href="#local-6989586621679064545"><span class="hs-identifier hs-var hs-var">a2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064549"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- | Random variate generator for the chi square distribution.</span><span>
</span><span id="line-191"></span><span id="local-6989586621679064955"><span id="local-6989586621679064956"><span class="annot"><a href="System.Random.MWC.Distributions.html#chiSquare"><span class="hs-identifier hs-type">chiSquare</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679064956"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064955"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-192"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                </span><span class="hs-comment">-- ^ Number of degrees of freedom</span><span>
</span><span id="line-193"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064956"><span class="hs-identifier hs-type">g</span></a></span><span>                  </span><span class="hs-comment">-- ^ Generator</span><span>
</span><span id="line-194"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064955"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span></span><span>
</span><span id="line-195"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#chiSquare"><span class="hs-pragma hs-type">chiSquare</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-196"></span><span id="chiSquare"><span class="annot"><span class="annottext">chiSquare :: forall g (m :: * -&gt; *). StatefulGen g m =&gt; Int -&gt; g -&gt; m Double
</span><a href="System.Random.MWC.Distributions.html#chiSquare"><span class="hs-identifier hs-var hs-var">chiSquare</span></a></span></span><span> </span><span id="local-6989586621679064527"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064527"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679064526"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064526"><span class="hs-identifier hs-var">gen</span></a></span></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064527"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; String -&gt; a
</span><a href="System.Random.MWC.Distributions.html#pkgError"><span class="hs-identifier hs-var">pkgError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;chiSquare&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;number of degrees of freedom must be positive&quot;</span></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679064525"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064525"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *).
StatefulGen g m =&gt;
Double -&gt; Double -&gt; g -&gt; m Double
</span><a href="System.Random.MWC.Distributions.html#gamma"><span class="hs-identifier hs-var">gamma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064527"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064526"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-199"></span><span>                   </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064525"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | Random variate generator for the geometric distribution,</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- computing the number of failures before success. Distribution's</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- support is [0..].</span><span>
</span><span id="line-204"></span><span id="local-6989586621679064951"><span id="local-6989586621679064952"><span class="annot"><a href="System.Random.MWC.Distributions.html#geometric0"><span class="hs-identifier hs-type">geometric0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679064952"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064951"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-205"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>            </span><span class="hs-comment">-- ^ /p/ success probability lies in (0,1]</span><span>
</span><span id="line-206"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064952"><span class="hs-identifier hs-type">g</span></a></span><span>                 </span><span class="hs-comment">-- ^ Generator</span><span>
</span><span id="line-207"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064951"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span><span>
</span><span id="line-208"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#geometric0"><span class="hs-pragma hs-type">geometric0</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-209"></span><span id="geometric0"><span class="annot"><span class="annottext">geometric0 :: forall g (m :: * -&gt; *). StatefulGen g m =&gt; Double -&gt; g -&gt; m Int
</span><a href="System.Random.MWC.Distributions.html#geometric0"><span class="hs-identifier hs-var hs-var">geometric0</span></a></span></span><span> </span><span id="local-6989586621679064502"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064502"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679064501"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064501"><span class="hs-identifier hs-var">gen</span></a></span></span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064502"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064502"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span>  </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064502"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679064500"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064500"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m Double
</span><span class="hs-identifier hs-var">uniformDoublePositive01M</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064501"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-212"></span><span>                         </span><span class="hs-comment">-- FIXME: We want to use log1p here but it will</span><span>
</span><span id="line-213"></span><span>                         </span><span class="hs-comment">--        introduce dependency on math-functions.</span><span>
</span><span id="line-214"></span><span>                         </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064500"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064502"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; String -&gt; a
</span><a href="System.Random.MWC.Distributions.html#pkgError"><span class="hs-identifier hs-var">pkgError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;geometric0&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;probability out of [0,1] range&quot;</span></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- | Random variate generator for geometric distribution for number of</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- trials. Distribution's support is [1..] (i.e. just 'geometric0'</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- shifted by 1).</span><span>
</span><span id="line-220"></span><span id="local-6989586621679064497"><span id="local-6989586621679064498"><span class="annot"><a href="System.Random.MWC.Distributions.html#geometric1"><span class="hs-identifier hs-type">geometric1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679064498"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064497"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-221"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>            </span><span class="hs-comment">-- ^ /p/ success probability lies in (0,1]</span><span>
</span><span id="line-222"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064498"><span class="hs-identifier hs-type">g</span></a></span><span>                 </span><span class="hs-comment">-- ^ Generator</span><span>
</span><span id="line-223"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064497"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span><span>
</span><span id="line-224"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#geometric1"><span class="hs-pragma hs-type">geometric1</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-225"></span><span id="geometric1"><span class="annot"><span class="annottext">geometric1 :: forall g (m :: * -&gt; *). StatefulGen g m =&gt; Double -&gt; g -&gt; m Int
</span><a href="System.Random.MWC.Distributions.html#geometric1"><span class="hs-identifier hs-var hs-var">geometric1</span></a></span></span><span> </span><span id="local-6989586621679064489"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064489"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679064488"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064488"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679064487"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064487"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *). StatefulGen g m =&gt; Double -&gt; g -&gt; m Int
</span><a href="System.Random.MWC.Distributions.html#geometric0"><span class="hs-identifier hs-var">geometric0</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064489"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064488"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-226"></span><span>                      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064487"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Random variate generator for Beta distribution</span><span>
</span><span id="line-229"></span><span id="local-6989586621679064485"><span id="local-6989586621679064486"><span class="annot"><a href="System.Random.MWC.Distributions.html#beta"><span class="hs-identifier hs-type">beta</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679064486"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064485"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-230"></span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>            </span><span class="hs-comment">-- ^ alpha (&gt;0)</span><span>
</span><span id="line-231"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>            </span><span class="hs-comment">-- ^ beta  (&gt;0)</span><span>
</span><span id="line-232"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064486"><span class="hs-identifier hs-type">g</span></a></span><span>                 </span><span class="hs-comment">-- ^ Generator</span><span>
</span><span id="line-233"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064485"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span></span><span>
</span><span id="line-234"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#beta"><span class="hs-pragma hs-type">beta</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-235"></span><span id="beta"><span class="annot"><span class="annottext">beta :: forall g (m :: * -&gt; *).
StatefulGen g m =&gt;
Double -&gt; Double -&gt; g -&gt; m Double
</span><a href="System.Random.MWC.Distributions.html#beta"><span class="hs-identifier hs-var hs-var">beta</span></a></span></span><span> </span><span id="local-6989586621679064475"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064475"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679064474"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064474"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679064473"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064473"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-236"></span><span>  </span><span id="local-6989586621679064472"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064472"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *).
StatefulGen g m =&gt;
Double -&gt; Double -&gt; g -&gt; m Double
</span><a href="System.Random.MWC.Distributions.html#gamma"><span class="hs-identifier hs-var">gamma</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064475"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064473"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span id="local-6989586621679064471"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064471"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *).
StatefulGen g m =&gt;
Double -&gt; Double -&gt; g -&gt; m Double
</span><a href="System.Random.MWC.Distributions.html#gamma"><span class="hs-identifier hs-var">gamma</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064474"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064473"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064472"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064472"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064471"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- | Random variate generator for Dirichlet distribution</span><span>
</span><span id="line-241"></span><span id="local-6989586621679064940"><span id="local-6989586621679064941"><span id="local-6989586621679064942"><span class="annot"><a href="System.Random.MWC.Distributions.html#dirichlet"><span class="hs-identifier hs-type">dirichlet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679064942"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064941"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679064940"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064940"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>          </span><span class="hs-comment">-- ^ container of parameters</span><span>
</span><span id="line-243"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064942"><span class="hs-identifier hs-type">g</span></a></span><span>                 </span><span class="hs-comment">-- ^ Generator</span><span>
</span><span id="line-244"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064941"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064940"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-245"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#dirichlet"><span class="hs-pragma hs-type">dirichlet</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-246"></span><span id="dirichlet"><span class="annot"><span class="annottext">dirichlet :: forall g (m :: * -&gt; *) (t :: * -&gt; *).
(StatefulGen g m, Traversable t) =&gt;
t Double -&gt; g -&gt; m (t Double)
</span><a href="System.Random.MWC.Distributions.html#dirichlet"><span class="hs-identifier hs-var hs-var">dirichlet</span></a></span></span><span> </span><span id="local-6989586621679064453"><span class="annot"><span class="annottext">t Double
</span><a href="#local-6989586621679064453"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679064452"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064452"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621679064451"><span class="annot"><span class="annottext">t Double
</span><a href="#local-6989586621679064451"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679064450"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064450"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *).
StatefulGen g m =&gt;
Double -&gt; Double -&gt; g -&gt; m Double
</span><a href="System.Random.MWC.Distributions.html#gamma"><span class="hs-identifier hs-var">gamma</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064450"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064452"><span class="hs-identifier hs-var">gen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t Double
</span><a href="#local-6989586621679064453"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679064449"><span class="annot"><span class="annottext">total :: Double
</span><a href="#local-6989586621679064449"><span class="hs-identifier hs-var hs-var">total</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">t Double
</span><a href="#local-6989586621679064451"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064449"><span class="hs-identifier hs-var">total</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t Double
</span><a href="#local-6989586621679064451"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | Random variate generator for Bernoulli distribution</span><span>
</span><span id="line-252"></span><span id="local-6989586621679064925"><span id="local-6989586621679064926"><span class="annot"><a href="System.Random.MWC.Distributions.html#bernoulli"><span class="hs-identifier hs-type">bernoulli</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679064926"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064925"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-253"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>            </span><span class="hs-comment">-- ^ Probability of success (returning True)</span><span>
</span><span id="line-254"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064926"><span class="hs-identifier hs-type">g</span></a></span><span>                 </span><span class="hs-comment">-- ^ Generator</span><span>
</span><span id="line-255"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064925"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-256"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#bernoulli"><span class="hs-pragma hs-type">bernoulli</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-257"></span><span id="bernoulli"><span class="annot"><span class="annottext">bernoulli :: forall g (m :: * -&gt; *). StatefulGen g m =&gt; Double -&gt; g -&gt; m Bool
</span><a href="System.Random.MWC.Distributions.html#bernoulli"><span class="hs-identifier hs-var hs-var">bernoulli</span></a></span></span><span> </span><span id="local-6989586621679064443"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064443"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679064442"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064442"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064443"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-operator hs-var">`liftM`</span></span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m Double
</span><span class="hs-identifier hs-var">uniformDoublePositive01M</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064442"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-comment">-- | Random variate generator for categorical distribution.</span><span>
</span><span id="line-260"></span><span class="hs-comment">--</span><span>
</span><span id="line-261"></span><span class="hs-comment">--   Note that if you need to generate a lot of variates functions</span><span>
</span><span id="line-262"></span><span class="hs-comment">--   &quot;System.Random.MWC.CondensedTable&quot; will offer better</span><span>
</span><span id="line-263"></span><span class="hs-comment">--   performance.  If only few is needed this function will faster</span><span>
</span><span id="line-264"></span><span class="hs-comment">--   since it avoids costs of setting up table.</span><span>
</span><span id="line-265"></span><span id="local-6989586621679064920"><span id="local-6989586621679064921"><span id="local-6989586621679064922"><span class="annot"><a href="System.Random.MWC.Distributions.html#categorical"><span class="hs-identifier hs-type">categorical</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679064922"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064921"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679064920"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064920"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>          </span><span class="hs-comment">-- ^ List of weights [&gt;0]</span><span>
</span><span id="line-267"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064922"><span class="hs-identifier hs-type">g</span></a></span><span>                 </span><span class="hs-comment">-- ^ Generator</span><span>
</span><span id="line-268"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064921"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span></span><span>
</span><span id="line-269"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#categorical"><span class="hs-pragma hs-type">categorical</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-270"></span><span id="categorical"><span class="annot"><span class="annottext">categorical :: forall g (m :: * -&gt; *) (v :: * -&gt; *).
(StatefulGen g m, Vector v Double) =&gt;
v Double -&gt; g -&gt; m Int
</span><a href="System.Random.MWC.Distributions.html#categorical"><span class="hs-identifier hs-var hs-var">categorical</span></a></span></span><span> </span><span id="local-6989586621679064427"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679064427"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679064426"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064426"><span class="hs-identifier hs-var">gen</span></a></span></span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; Bool
</span><span class="hs-identifier hs-var">G.null</span></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679064427"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; String -&gt; a
</span><a href="System.Random.MWC.Distributions.html#pkgError"><span class="hs-identifier hs-var">pkgError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;categorical&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;empty weights!&quot;</span></span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-273"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679064424"><span class="annot"><span class="annottext">cv :: v Double
</span><a href="#local-6989586621679064424"><span class="hs-identifier hs-var hs-var">cv</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (v :: * -&gt; *) a. Vector v a =&gt; (a -&gt; a -&gt; a) -&gt; v a -&gt; v a
</span><span class="hs-identifier hs-var">G.scanl1'</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679064427"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-274"></span><span>        </span><span id="local-6989586621679064422"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064422"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; a
</span><span class="hs-identifier hs-var">G.last</span></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679064424"><span class="hs-identifier hs-var">cv</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-operator hs-var">`liftM`</span></span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *). StatefulGen g m =&gt; g -&gt; m Double
</span><span class="hs-identifier hs-var">uniformDoublePositive01M</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064426"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-275"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (v :: * -&gt; *) a.
Vector v a =&gt;
(a -&gt; Bool) -&gt; v a -&gt; Maybe Int
</span><span class="hs-identifier hs-var">G.findIndex</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064422"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679064424"><span class="hs-identifier hs-var">cv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-276"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679064419"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064419"><span class="hs-identifier hs-var">i</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064419"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-277"></span><span>                    </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; String -&gt; a
</span><a href="System.Random.MWC.Distributions.html#pkgError"><span class="hs-identifier hs-var">pkgError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;categorical&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bad weights!&quot;</span></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- | Random variate generator for categorical distribution where the</span><span>
</span><span id="line-280"></span><span class="hs-comment">--   weights are in the log domain. It's implemented in terms of</span><span>
</span><span id="line-281"></span><span class="hs-comment">--   'categorical'.</span><span>
</span><span id="line-282"></span><span id="local-6989586621679064416"><span id="local-6989586621679064417"><span id="local-6989586621679064418"><span class="annot"><a href="System.Random.MWC.Distributions.html#logCategorical"><span class="hs-identifier hs-type">logCategorical</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679064418"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064417"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679064416"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064416"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>          </span><span class="hs-comment">-- ^ List of logarithms of weights</span><span>
</span><span id="line-284"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064418"><span class="hs-identifier hs-type">g</span></a></span><span>                 </span><span class="hs-comment">-- ^ Generator</span><span>
</span><span id="line-285"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064417"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span></span><span>
</span><span id="line-286"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#logCategorical"><span class="hs-pragma hs-type">logCategorical</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-287"></span><span id="logCategorical"><span class="annot"><span class="annottext">logCategorical :: forall g (m :: * -&gt; *) (v :: * -&gt; *).
(StatefulGen g m, Vector v Double) =&gt;
v Double -&gt; g -&gt; m Int
</span><a href="System.Random.MWC.Distributions.html#logCategorical"><span class="hs-identifier hs-var hs-var">logCategorical</span></a></span></span><span> </span><span id="local-6989586621679064404"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679064404"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679064403"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064403"><span class="hs-identifier hs-var">gen</span></a></span></span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; Bool
</span><span class="hs-identifier hs-var">G.null</span></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679064404"><span class="hs-identifier hs-var">v</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; String -&gt; a
</span><a href="System.Random.MWC.Distributions.html#pkgError"><span class="hs-identifier hs-var">pkgError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;logCategorical&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;empty weights!&quot;</span></span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *) (v :: * -&gt; *).
(StatefulGen g m, Vector v Double) =&gt;
v Double -&gt; g -&gt; m Int
</span><a href="System.Random.MWC.Distributions.html#categorical"><span class="hs-identifier hs-var">categorical</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (v :: * -&gt; *) a b.
(Vector v a, Vector v b) =&gt;
(a -&gt; b) -&gt; v a -&gt; v b
</span><span class="hs-identifier hs-var">G.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">exp</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">subtract</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064401"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679064404"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064403"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621679064401"><span class="annot"><span class="annottext">m :: Double
</span><a href="#local-6989586621679064401"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (v :: * -&gt; *) a. (Vector v a, Ord a) =&gt; v a -&gt; a
</span><span class="hs-identifier hs-var">G.maximum</span></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679064404"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- | Random variate generator for uniformly distributed permutations.</span><span>
</span><span id="line-294"></span><span class="hs-comment">--   It returns random permutation of vector /[0 .. n-1]/.</span><span>
</span><span id="line-295"></span><span class="hs-comment">--</span><span>
</span><span id="line-296"></span><span class="hs-comment">--   This is the Fisher-Yates shuffle</span><span>
</span><span id="line-297"></span><span class="annot"><a href="System.Random.MWC.Distributions.html#uniformPermutation"><span class="hs-identifier hs-type">uniformPermutation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679064899"><span class="annot"><a href="#local-6989586621679064899"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679064898"><span class="annot"><a href="#local-6989586621679064898"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679064896"><span class="annot"><a href="#local-6989586621679064896"><span class="hs-identifier hs-type">v</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679064899"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064898"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrimMonad</span></span><span> </span><span class="annot"><a href="#local-6989586621679064898"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679064896"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-299"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064899"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-300"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064898"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064896"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#uniformPermutation"><span class="hs-pragma hs-type">uniformPermutation</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-302"></span><span id="uniformPermutation"><span class="annot"><span class="annottext">uniformPermutation :: forall g (m :: * -&gt; *) (v :: * -&gt; *).
(StatefulGen g m, PrimMonad m, Vector v Int) =&gt;
Int -&gt; g -&gt; m (v Int)
</span><a href="System.Random.MWC.Distributions.html#uniformPermutation"><span class="hs-identifier hs-var hs-var">uniformPermutation</span></a></span></span><span> </span><span id="local-6989586621679064390"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064390"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679064389"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064389"><span class="hs-identifier hs-var">gen</span></a></span></span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064390"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; String -&gt; a
</span><a href="System.Random.MWC.Distributions.html#pkgError"><span class="hs-identifier hs-var">pkgError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;uniformPermutation&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;size must be &gt;=0&quot;</span></span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *) (v :: * -&gt; *) a.
(StatefulGen g m, PrimMonad m, Vector v a) =&gt;
v a -&gt; g -&gt; m (v a)
</span><a href="System.Random.MWC.Distributions.html#uniformShuffle"><span class="hs-identifier hs-var">uniformShuffle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (v :: * -&gt; *) a. Vector v a =&gt; Int -&gt; (Int -&gt; a) -&gt; v a
</span><span class="hs-identifier hs-var">G.generate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064390"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679064896"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064389"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-comment">-- | Random variate generator for a uniformly distributed shuffle (all</span><span>
</span><span id="line-307"></span><span class="hs-comment">--   shuffles are equiprobable) of a vector. It uses Fisher-Yates</span><span>
</span><span id="line-308"></span><span class="hs-comment">--   shuffle algorithm.</span><span>
</span><span id="line-309"></span><span id="local-6989586621679064889"><span id="local-6989586621679064890"><span id="local-6989586621679064891"><span id="local-6989586621679064892"><span class="annot"><a href="System.Random.MWC.Distributions.html#uniformShuffle"><span class="hs-identifier hs-type">uniformShuffle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679064892"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064891"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrimMonad</span></span><span> </span><span class="annot"><a href="#local-6989586621679064891"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679064890"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064889"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064890"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064889"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-311"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064892"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-312"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064891"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064890"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064889"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-313"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#uniformShuffle"><span class="hs-pragma hs-type">uniformShuffle</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-314"></span><span id="uniformShuffle"><span class="annot"><span class="annottext">uniformShuffle :: forall g (m :: * -&gt; *) (v :: * -&gt; *) a.
(StatefulGen g m, PrimMonad m, Vector v a) =&gt;
v a -&gt; g -&gt; m (v a)
</span><a href="System.Random.MWC.Distributions.html#uniformShuffle"><span class="hs-identifier hs-var hs-var">uniformShuffle</span></a></span></span><span> </span><span id="local-6989586621679064367"><span class="annot"><span class="annottext">v a
</span><a href="#local-6989586621679064367"><span class="hs-identifier hs-var">vec</span></a></span></span><span> </span><span id="local-6989586621679064366"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064366"><span class="hs-identifier hs-var">gen</span></a></span></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; Int
</span><span class="hs-identifier hs-var">G.length</span></span><span> </span><span class="annot"><span class="annottext">v a
</span><a href="#local-6989586621679064367"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">v a
</span><a href="#local-6989586621679064367"><span class="hs-identifier hs-var">vec</span></a></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-317"></span><span>      </span><span id="local-6989586621679064364"><span class="annot"><span class="annottext">Mutable v (PrimState m) a
</span><a href="#local-6989586621679064364"><span class="hs-identifier hs-var">mvec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (v :: * -&gt; *) a.
(PrimMonad m, Vector v a) =&gt;
v a -&gt; m (Mutable v (PrimState m) a)
</span><span class="hs-identifier hs-var">G.thaw</span></span><span> </span><span class="annot"><span class="annottext">v a
</span><a href="#local-6989586621679064367"><span class="hs-identifier hs-var">vec</span></a></span><span>
</span><span id="line-318"></span><span>      </span><span class="annot"><span class="annottext">forall g (m :: * -&gt; *) (v :: * -&gt; * -&gt; *) a.
(StatefulGen g m, PrimMonad m, MVector v a) =&gt;
v (PrimState m) a -&gt; g -&gt; m ()
</span><a href="System.Random.MWC.Distributions.html#uniformShuffleM"><span class="hs-identifier hs-var">uniformShuffleM</span></a></span><span> </span><span class="annot"><span class="annottext">Mutable v (PrimState m) a
</span><a href="#local-6989586621679064364"><span class="hs-identifier hs-var">mvec</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064366"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-319"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (v :: * -&gt; *) a.
(PrimMonad m, Vector v a) =&gt;
Mutable v (PrimState m) a -&gt; m (v a)
</span><span class="hs-identifier hs-var">G.unsafeFreeze</span></span><span> </span><span class="annot"><span class="annottext">Mutable v (PrimState m) a
</span><a href="#local-6989586621679064364"><span class="hs-identifier hs-var">mvec</span></a></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="hs-comment">-- | In-place uniformly distributed shuffle (all shuffles are</span><span>
</span><span id="line-322"></span><span class="hs-comment">--   equiprobable)of a vector.</span><span>
</span><span id="line-323"></span><span id="local-6989586621679064868"><span id="local-6989586621679064869"><span id="local-6989586621679064870"><span id="local-6989586621679064871"><span class="annot"><a href="System.Random.MWC.Distributions.html#uniformShuffleM"><span class="hs-identifier hs-type">uniformShuffleM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679064871"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064870"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrimMonad</span></span><span> </span><span class="annot"><a href="#local-6989586621679064870"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.MVector</span></span><span> </span><span class="annot"><a href="#local-6989586621679064869"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064868"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064869"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrimState</span></span><span> </span><span class="annot"><a href="#local-6989586621679064870"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679064868"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-325"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064871"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-326"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064870"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-327"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#uniformShuffleM"><span class="hs-pragma hs-type">uniformShuffleM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-328"></span><span id="uniformShuffleM"><span class="annot"><span class="annottext">uniformShuffleM :: forall g (m :: * -&gt; *) (v :: * -&gt; * -&gt; *) a.
(StatefulGen g m, PrimMonad m, MVector v a) =&gt;
v (PrimState m) a -&gt; g -&gt; m ()
</span><a href="System.Random.MWC.Distributions.html#uniformShuffleM"><span class="hs-identifier hs-var hs-var">uniformShuffleM</span></a></span></span><span> </span><span id="local-6989586621679064338"><span class="annot"><span class="annottext">v (PrimState m) a
</span><a href="#local-6989586621679064338"><span class="hs-identifier hs-var">vec</span></a></span></span><span> </span><span id="local-6989586621679064337"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064337"><span class="hs-identifier hs-var">gen</span></a></span></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (v :: * -&gt; * -&gt; *) a s. MVector v a =&gt; v s a -&gt; Int
</span><span class="hs-identifier hs-var">M.length</span></span><span> </span><span class="annot"><span class="annottext">v (PrimState m) a
</span><a href="#local-6989586621679064338"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; m ()
</span><a href="#local-6989586621679064335"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621679064334"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679064334"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (v :: * -&gt; * -&gt; *) a s. MVector v a =&gt; v s a -&gt; Int
</span><span class="hs-identifier hs-var">M.length</span></span><span> </span><span class="annot"><span class="annottext">v (PrimState m) a
</span><a href="#local-6989586621679064338"><span class="hs-identifier hs-var">vec</span></a></span><span>
</span><span id="line-333"></span><span>    </span><span id="local-6989586621679064333"><span class="annot"><span class="annottext">lst :: Int
</span><a href="#local-6989586621679064333"><span class="hs-identifier hs-var hs-var">lst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064334"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-334"></span><span>    </span><span id="local-6989586621679064335"><span class="annot"><span class="annottext">loop :: Int -&gt; m ()
</span><a href="#local-6989586621679064335"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679064332"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064332"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064332"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064333"><span class="hs-identifier hs-var">lst</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679064331"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064331"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a g (m :: * -&gt; *).
(UniformRange a, StatefulGen g m) =&gt;
(a, a) -&gt; g -&gt; m a
</span><span class="hs-identifier hs-var">uniformRM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064332"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064333"><span class="hs-identifier hs-var">lst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679064337"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-336"></span><span>                            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (v :: * -&gt; * -&gt; *) a.
(PrimMonad m, MVector v a) =&gt;
v (PrimState m) a -&gt; Int -&gt; Int -&gt; m ()
</span><span class="hs-identifier hs-var">M.unsafeSwap</span></span><span> </span><span class="annot"><span class="annottext">v (PrimState m) a
</span><a href="#local-6989586621679064338"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064332"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064331"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-337"></span><span>                            </span><span class="annot"><span class="annottext">Int -&gt; m ()
</span><a href="#local-6989586621679064335"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064332"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="annot"><a href="System.Random.MWC.Distributions.html#sqr"><span class="hs-identifier hs-type">sqr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-341"></span><span id="sqr"><span class="annot"><span class="annottext">sqr :: Double -&gt; Double
</span><a href="System.Random.MWC.Distributions.html#sqr"><span class="hs-identifier hs-var hs-var">sqr</span></a></span></span><span> </span><span id="local-6989586621679064328"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064328"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064328"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679064328"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-342"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.MWC.Distributions.html#sqr"><span class="hs-pragma hs-type">sqr</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span id="local-6989586621679064957"><span class="annot"><a href="System.Random.MWC.Distributions.html#pkgError"><span class="hs-identifier hs-type">pkgError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064957"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-345"></span><span id="pkgError"><span class="annot"><span class="annottext">pkgError :: forall a. String -&gt; String -&gt; a
</span><a href="System.Random.MWC.Distributions.html#pkgError"><span class="hs-identifier hs-var hs-var">pkgError</span></a></span></span><span> </span><span id="local-6989586621679064325"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679064325"><span class="hs-identifier hs-var">func</span></a></span></span><span> </span><span id="local-6989586621679064324"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679064324"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;System.Random.MWC.Distributions.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679064325"><span class="hs-identifier hs-var">func</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-346"></span><span>                            </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679064324"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-comment">-- $references</span><span>
</span><span id="line-349"></span><span class="hs-comment">--</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- * Doornik, J.A. (2005) An improved ziggurat method to generate</span><span>
</span><span id="line-351"></span><span class="hs-comment">--   normal random samples. Mimeo, Nuffield College, University of</span><span>
</span><span id="line-352"></span><span class="hs-comment">--   Oxford.  &lt;http://www.doornik.com/research/ziggurat.pdf&gt;</span><span>
</span><span id="line-353"></span><span class="hs-comment">--</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- * Thomas, D.B.; Leong, P.G.W.; Luk, W.; Villasenor, J.D.</span><span>
</span><span id="line-355"></span><span class="hs-comment">--   (2007). Gaussian random number generators.</span><span>
</span><span id="line-356"></span><span class="hs-comment">--   /ACM Computing Surveys/ 39(4).</span><span>
</span><span id="line-357"></span><span class="hs-comment">--   &lt;http://www.cse.cuhk.edu.hk/~phwl/mt/public/archives/papers/grng_acmcs07.pdf&gt;</span><span>
</span><span id="line-358"></span></pre></body></html>