<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621679078016"><span id="local-6989586621679078017"><span id="local-6989586621679078018"><span id="local-6989586621679078019"></span></span></span></span><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Data.X509.Ext</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Portability : unknown</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- extension processing module.</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.X509.Ext</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#Extension"><span class="hs-identifier">Extension</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Common extension usually found in x509v3</span></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtBasicConstraints"><span class="hs-identifier">ExtBasicConstraints</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtKeyUsage"><span class="hs-identifier">ExtKeyUsage</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtKeyUsageFlag"><span class="hs-identifier">ExtKeyUsageFlag</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtExtendedKeyUsage"><span class="hs-identifier">ExtExtendedKeyUsage</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtKeyUsagePurpose"><span class="hs-identifier">ExtKeyUsagePurpose</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtSubjectKeyId"><span class="hs-identifier">ExtSubjectKeyId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtSubjectAltName"><span class="hs-identifier">ExtSubjectAltName</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtAuthorityKeyId"><span class="hs-identifier">ExtAuthorityKeyId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtCrlDistributionPoints"><span class="hs-identifier">ExtCrlDistributionPoints</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtNetscapeComment"><span class="hs-identifier">ExtNetscapeComment</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#AltName"><span class="hs-identifier">AltName</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#DistributionPoint"><span class="hs-identifier">DistributionPoint</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ReasonFlag"><span class="hs-identifier">ReasonFlag</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Accessor turning extension into a specific one</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#extensionGet"><span class="hs-identifier">extensionGet</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#extensionGetE"><span class="hs-identifier">extensionGetE</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#extensionDecode"><span class="hs-identifier">extensionDecode</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#extensionEncode"><span class="hs-identifier">extensionEncode</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BC</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.Types</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.Parse</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.Encoding</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.BinaryEncoding</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.BitArray</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X509.ExtensionRaw.html"><span class="hs-identifier">Data.X509.ExtensionRaw</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X509.DistinguishedName.html"><span class="hs-identifier">Data.X509.DistinguishedName</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- | key usage flag that is found in the key usage extension field.</span><span>
</span><span id="line-50"></span><span class="hs-keyword">data</span><span> </span><span id="ExtKeyUsageFlag"><span class="annot"><a href="Data.X509.Ext.html#ExtKeyUsageFlag"><span class="hs-identifier hs-var">ExtKeyUsageFlag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-51"></span><span>      </span><span id="KeyUsage_digitalSignature"><span class="annot"><a href="Data.X509.Ext.html#KeyUsage_digitalSignature"><span class="hs-identifier hs-var">KeyUsage_digitalSignature</span></a></span></span><span> </span><span class="hs-comment">-- (0)</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KeyUsage_nonRepudiation"><span class="annot"><a href="Data.X509.Ext.html#KeyUsage_nonRepudiation"><span class="hs-identifier hs-var">KeyUsage_nonRepudiation</span></a></span></span><span>   </span><span class="hs-comment">-- (1) recent X.509 ver have renamed this bit to contentCommitment</span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KeyUsage_keyEncipherment"><span class="annot"><a href="Data.X509.Ext.html#KeyUsage_keyEncipherment"><span class="hs-identifier hs-var">KeyUsage_keyEncipherment</span></a></span></span><span>  </span><span class="hs-comment">-- (2)</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KeyUsage_dataEncipherment"><span class="annot"><a href="Data.X509.Ext.html#KeyUsage_dataEncipherment"><span class="hs-identifier hs-var">KeyUsage_dataEncipherment</span></a></span></span><span> </span><span class="hs-comment">-- (3)</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KeyUsage_keyAgreement"><span class="annot"><a href="Data.X509.Ext.html#KeyUsage_keyAgreement"><span class="hs-identifier hs-var">KeyUsage_keyAgreement</span></a></span></span><span>     </span><span class="hs-comment">-- (4)</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KeyUsage_keyCertSign"><span class="annot"><a href="Data.X509.Ext.html#KeyUsage_keyCertSign"><span class="hs-identifier hs-var">KeyUsage_keyCertSign</span></a></span></span><span>      </span><span class="hs-comment">-- (5)</span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KeyUsage_cRLSign"><span class="annot"><a href="Data.X509.Ext.html#KeyUsage_cRLSign"><span class="hs-identifier hs-var">KeyUsage_cRLSign</span></a></span></span><span>          </span><span class="hs-comment">-- (6)</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KeyUsage_encipherOnly"><span class="annot"><a href="Data.X509.Ext.html#KeyUsage_encipherOnly"><span class="hs-identifier hs-var">KeyUsage_encipherOnly</span></a></span></span><span>     </span><span class="hs-comment">-- (7)</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KeyUsage_decipherOnly"><span class="annot"><a href="Data.X509.Ext.html#KeyUsage_decipherOnly"><span class="hs-identifier hs-var">KeyUsage_decipherOnly</span></a></span></span><span>     </span><span class="hs-comment">-- (8)</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077981"><span id="local-6989586621679077983"><span id="local-6989586621679077985"><span class="annot"><span class="annottext">Int -&gt; ExtKeyUsageFlag -&gt; ShowS
[ExtKeyUsageFlag] -&gt; ShowS
ExtKeyUsageFlag -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ExtKeyUsageFlag] -&gt; ShowS
$cshowList :: [ExtKeyUsageFlag] -&gt; ShowS
show :: ExtKeyUsageFlag -&gt; String
$cshow :: ExtKeyUsageFlag -&gt; String
showsPrec :: Int -&gt; ExtKeyUsageFlag -&gt; ShowS
$cshowsPrec :: Int -&gt; ExtKeyUsageFlag -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077976"><span id="local-6989586621679077978"><span class="annot"><span class="annottext">ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Bool
$c/= :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Bool
== :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Bool
$c== :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077956"><span id="local-6989586621679077958"><span id="local-6989586621679077961"><span id="local-6989586621679077964"><span id="local-6989586621679077967"><span id="local-6989586621679077969"><span id="local-6989586621679077971"><span class="annot"><span class="annottext">Eq ExtKeyUsageFlag
ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Bool
ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Ordering
ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; ExtKeyUsageFlag
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; ExtKeyUsageFlag
$cmin :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; ExtKeyUsageFlag
max :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; ExtKeyUsageFlag
$cmax :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; ExtKeyUsageFlag
&gt;= :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Bool
$c&gt;= :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Bool
&gt; :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Bool
$c&gt; :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Bool
&lt;= :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Bool
$c&lt;= :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Bool
&lt; :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Bool
$c&lt; :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Bool
compare :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Ordering
$ccompare :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077917"><span id="local-6989586621679077919"><span id="local-6989586621679077923"><span id="local-6989586621679077927"><span id="local-6989586621679077929"><span id="local-6989586621679077939"><span id="local-6989586621679077945"><span id="local-6989586621679077953"><span class="annot"><span class="annottext">Int -&gt; ExtKeyUsageFlag
ExtKeyUsageFlag -&gt; Int
ExtKeyUsageFlag -&gt; [ExtKeyUsageFlag]
ExtKeyUsageFlag -&gt; ExtKeyUsageFlag
ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; [ExtKeyUsageFlag]
ExtKeyUsageFlag
-&gt; ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; [ExtKeyUsageFlag]
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: ExtKeyUsageFlag
-&gt; ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; [ExtKeyUsageFlag]
$cenumFromThenTo :: ExtKeyUsageFlag
-&gt; ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; [ExtKeyUsageFlag]
enumFromTo :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; [ExtKeyUsageFlag]
$cenumFromTo :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; [ExtKeyUsageFlag]
enumFromThen :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; [ExtKeyUsageFlag]
$cenumFromThen :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag -&gt; [ExtKeyUsageFlag]
enumFrom :: ExtKeyUsageFlag -&gt; [ExtKeyUsageFlag]
$cenumFrom :: ExtKeyUsageFlag -&gt; [ExtKeyUsageFlag]
fromEnum :: ExtKeyUsageFlag -&gt; Int
$cfromEnum :: ExtKeyUsageFlag -&gt; Int
toEnum :: Int -&gt; ExtKeyUsageFlag
$ctoEnum :: Int -&gt; ExtKeyUsageFlag
pred :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag
$cpred :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag
succ :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag
$csucc :: ExtKeyUsageFlag -&gt; ExtKeyUsageFlag
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">{-
-- RFC 5280
oidDistributionPoints, oidPolicies, oidPoliciesMapping :: OID
oidPolicies           = [2,5,29,32]
oidPoliciesMapping    = [2,5,29,33]
-}</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | Extension class.</span><span>
</span><span id="line-70"></span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- each extension have a unique OID associated, and a way</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- to encode and decode an ASN1 stream.</span><span>
</span><span id="line-73"></span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- Errata: turns out, the content is not necessarily ASN1,</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- it could be data that is only parsable by the extension</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- e.g. raw ascii string. Add method to parse and encode with</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- ByteString</span><span>
</span><span id="line-78"></span><span class="hs-keyword">class</span><span> </span><span id="Extension"><span class="annot"><a href="Data.X509.Ext.html#Extension"><span class="hs-identifier hs-var">Extension</span></a></span></span><span> </span><span id="local-6989586621679078243"><span class="annot"><a href="#local-6989586621679078243"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>    </span><span id="extOID"><span class="annot"><a href="Data.X509.Ext.html#extOID"><span class="hs-identifier hs-type">extOID</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679078243"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span>
</span><span id="line-80"></span><span>    </span><span id="extHasNestedASN1"><span class="annot"><a href="Data.X509.Ext.html#extHasNestedASN1"><span class="hs-identifier hs-type">extHasNestedASN1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679078243"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-81"></span><span>    </span><span id="extEncode"><span class="annot"><a href="Data.X509.Ext.html#extEncode"><span class="hs-identifier hs-type">extEncode</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679078243"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASN1</span></span><span class="hs-special">]</span><span>
</span><span id="line-82"></span><span>    </span><span id="extDecode"><span class="annot"><a href="Data.X509.Ext.html#extDecode"><span class="hs-identifier hs-type">extDecode</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASN1</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679078243"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>    </span><span id="extDecodeBs"><span class="annot"><a href="Data.X509.Ext.html#extDecodeBs"><span class="hs-identifier hs-type">extDecodeBs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679078243"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621679077909"><span class="annot"><a href="Data.X509.Ext.html#extDecodeBs"><span class="hs-identifier hs-var hs-var">extDecodeBs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a.
ASN1Decoding a =&gt;
a -&gt; ByteString -&gt; Either ASN1Error [ASN1]
</span><span class="hs-identifier hs-var">decodeASN1'</span></span><span> </span><span class="annot"><span class="annottext">BER
</span><span class="hs-identifier hs-var">BER</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Extension a =&gt; [ASN1] -&gt; Either String a
</span><a href="Data.X509.Ext.html#extDecode"><span class="hs-identifier hs-var">extDecode</span></a></span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span>    </span><span id="extEncodeBs"><span class="annot"><a href="Data.X509.Ext.html#extEncodeBs"><span class="hs-identifier hs-type">extEncodeBs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679078243"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621679077894"><span class="annot"><a href="Data.X509.Ext.html#extEncodeBs"><span class="hs-identifier hs-var hs-var">extEncodeBs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ASN1Encoding a =&gt; a -&gt; [ASN1] -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeASN1'</span></span><span> </span><span class="annot"><span class="annottext">DER
</span><span class="hs-identifier hs-var">DER</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Extension a =&gt; a -&gt; [ASN1]
</span><a href="Data.X509.Ext.html#extEncode"><span class="hs-identifier hs-var">extEncode</span></a></span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Get a specific extension from a lists of raw extensions</span><span>
</span><span id="line-92"></span><span id="local-6989586621679078221"><span class="annot"><a href="Data.X509.Ext.html#extensionGet"><span class="hs-identifier hs-type">extensionGet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#Extension"><span class="hs-identifier hs-type">Extension</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078221"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.X509.ExtensionRaw.html#Extensions"><span class="hs-identifier hs-type">Extensions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679078221"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-93"></span><span id="extensionGet"><span class="annot"><span class="annottext">extensionGet :: forall a. Extension a =&gt; Extensions -&gt; Maybe a
</span><a href="Data.X509.Ext.html#extensionGet"><span class="hs-identifier hs-var hs-var">extensionGet</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.ExtensionRaw.html#Extensions"><span class="hs-identifier hs-type">Extensions</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [ExtensionRaw]
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-94"></span><span class="annot"><a href="Data.X509.Ext.html#extensionGet"><span class="hs-identifier hs-var">extensionGet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.ExtensionRaw.html#Extensions"><span class="hs-identifier hs-type">Extensions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679077885"><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679077885"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a}. Extension a =&gt; [ExtensionRaw] -&gt; Maybe a
</span><a href="#local-6989586621679077884"><span class="hs-identifier hs-var">findExt</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679077885"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679077884"><span class="annot"><span class="annottext">findExt :: [ExtensionRaw] -&gt; Maybe a
</span><a href="#local-6989586621679077884"><span class="hs-identifier hs-var hs-var">findExt</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-96"></span><span>        </span><span class="annot"><a href="#local-6989586621679077884"><span class="hs-identifier hs-var">findExt</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077881"><span class="annot"><span class="annottext">ExtensionRaw
</span><a href="#local-6989586621679077881"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077880"><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679077880"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. Extension a =&gt; ExtensionRaw -&gt; Maybe (Either String a)
</span><a href="Data.X509.Ext.html#extensionDecode"><span class="hs-identifier hs-var">extensionDecode</span></a></span><span> </span><span class="annot"><span class="annottext">ExtensionRaw
</span><a href="#local-6989586621679077881"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-97"></span><span>                            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679077879"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077879"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077879"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-98"></span><span>                            </span><span class="annot"><span class="annottext">Maybe (Either String a)
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw] -&gt; Maybe a
</span><a href="#local-6989586621679077884"><span class="hs-identifier hs-var">findExt</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679077880"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- | Get a specific extension from a lists of raw extensions</span><span>
</span><span id="line-101"></span><span id="local-6989586621679078214"><span class="annot"><a href="Data.X509.Ext.html#extensionGetE"><span class="hs-identifier hs-type">extensionGetE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#Extension"><span class="hs-identifier hs-type">Extension</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078214"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.X509.ExtensionRaw.html#Extensions"><span class="hs-identifier hs-type">Extensions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679078214"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-102"></span><span id="extensionGetE"><span class="annot"><span class="annottext">extensionGetE :: forall a. Extension a =&gt; Extensions -&gt; Maybe (Either String a)
</span><a href="Data.X509.Ext.html#extensionGetE"><span class="hs-identifier hs-var hs-var">extensionGetE</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.ExtensionRaw.html#Extensions"><span class="hs-identifier hs-type">Extensions</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [ExtensionRaw]
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-103"></span><span class="annot"><a href="Data.X509.Ext.html#extensionGetE"><span class="hs-identifier hs-var">extensionGetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.ExtensionRaw.html#Extensions"><span class="hs-identifier hs-type">Extensions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679077876"><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679077876"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a}.
Extension a =&gt;
[ExtensionRaw] -&gt; Maybe (Either String a)
</span><a href="#local-6989586621679077875"><span class="hs-identifier hs-var">findExt</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679077876"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679077875"><span class="annot"><span class="annottext">findExt :: [ExtensionRaw] -&gt; Maybe (Either String a)
</span><a href="#local-6989586621679077875"><span class="hs-identifier hs-var hs-var">findExt</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-105"></span><span>        </span><span class="annot"><a href="#local-6989586621679077875"><span class="hs-identifier hs-var">findExt</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077872"><span class="annot"><span class="annottext">ExtensionRaw
</span><a href="#local-6989586621679077872"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077871"><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679077871"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. Extension a =&gt; ExtensionRaw -&gt; Maybe (Either String a)
</span><a href="Data.X509.Ext.html#extensionDecode"><span class="hs-identifier hs-var">extensionDecode</span></a></span><span> </span><span class="annot"><span class="annottext">ExtensionRaw
</span><a href="#local-6989586621679077872"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-106"></span><span>                            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679077870"><span class="annot"><span class="annottext">Either String a
</span><a href="#local-6989586621679077870"><span class="hs-identifier hs-var">r</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Either String a
</span><a href="#local-6989586621679077870"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-107"></span><span>                            </span><span class="annot"><span class="annottext">Maybe (Either String a)
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw] -&gt; Maybe (Either String a)
</span><a href="#local-6989586621679077875"><span class="hs-identifier hs-var">findExt</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679077871"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Try to decode an ExtensionRaw.</span><span>
</span><span id="line-110"></span><span class="hs-comment">--</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- If this function return:</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- * Nothing, the OID doesn't match</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- * Just Left, the OID matched, but the extension couldn't be decoded</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- * Just Right, the OID matched, and the extension has been succesfully decoded</span><span>
</span><span id="line-115"></span><span class="annot"><a href="Data.X509.Ext.html#extensionDecode"><span class="hs-identifier hs-type">extensionDecode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679078215"><span class="annot"><a href="#local-6989586621679078215"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#Extension"><span class="hs-identifier hs-type">Extension</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078215"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.X509.ExtensionRaw.html#ExtensionRaw"><span class="hs-identifier hs-type">ExtensionRaw</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679078215"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span id="extensionDecode"><span class="annot"><span class="annottext">extensionDecode :: forall a. Extension a =&gt; ExtensionRaw -&gt; Maybe (Either String a)
</span><a href="Data.X509.Ext.html#extensionDecode"><span class="hs-identifier hs-var hs-var">extensionDecode</span></a></span></span><span> </span><span id="local-6989586621679077857"><span class="annot"><span class="annottext">er :: ExtensionRaw
</span><a href="#local-6989586621679077857"><span class="hs-identifier hs-var">er</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.ExtensionRaw.html#ExtensionRaw"><span class="hs-identifier hs-type">ExtensionRaw</span></a></span><span> </span><span id="local-6989586621679077855"><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679077855"><span class="hs-identifier hs-var">oid</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679077854"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077854"><span class="hs-identifier hs-var">content</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. Extension a =&gt; a -&gt; OID
</span><a href="Data.X509.Ext.html#extOID"><span class="hs-identifier hs-var">extOID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679078215"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679077855"><span class="hs-identifier hs-var">oid</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. Extension a =&gt; Proxy a -&gt; Bool
</span><a href="Data.X509.Ext.html#extHasNestedASN1"><span class="hs-identifier hs-var">extHasNestedASN1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679078215"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExtensionRaw -&gt; Either String [ASN1]
</span><a href="Data.X509.ExtensionRaw.html#tryExtRawASN1"><span class="hs-identifier hs-var">tryExtRawASN1</span></a></span><span> </span><span class="annot"><span class="annottext">ExtensionRaw
</span><a href="#local-6989586621679077857"><span class="hs-identifier hs-var">er</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall a. Extension a =&gt; [ASN1] -&gt; Either String a
</span><a href="Data.X509.Ext.html#extDecode"><span class="hs-identifier hs-var">extDecode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Extension a =&gt; ByteString -&gt; Either String a
</span><a href="Data.X509.Ext.html#extDecodeBs"><span class="hs-identifier hs-var">extDecodeBs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077854"><span class="hs-identifier hs-var">content</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | Encode an Extension to extensionRaw</span><span>
</span><span id="line-122"></span><span class="annot"><a href="Data.X509.Ext.html#extensionEncode"><span class="hs-identifier hs-type">extensionEncode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679078200"><span class="annot"><a href="#local-6989586621679078200"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#Extension"><span class="hs-identifier hs-type">Extension</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078200"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078200"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X509.ExtensionRaw.html#ExtensionRaw"><span class="hs-identifier hs-type">ExtensionRaw</span></a></span><span>
</span><span id="line-123"></span><span id="extensionEncode"><span class="annot"><span class="annottext">extensionEncode :: forall a. Extension a =&gt; Bool -&gt; a -&gt; ExtensionRaw
</span><a href="Data.X509.Ext.html#extensionEncode"><span class="hs-identifier hs-var hs-var">extensionEncode</span></a></span></span><span> </span><span id="local-6989586621679077842"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077842"><span class="hs-identifier hs-var">critical</span></a></span></span><span> </span><span id="local-6989586621679077841"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077841"><span class="hs-identifier hs-var">ext</span></a></span></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. Extension a =&gt; Proxy a -&gt; Bool
</span><a href="Data.X509.Ext.html#extHasNestedASN1"><span class="hs-identifier hs-var">extHasNestedASN1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679078200"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OID -&gt; Bool -&gt; ByteString -&gt; ExtensionRaw
</span><a href="Data.X509.ExtensionRaw.html#ExtensionRaw"><span class="hs-identifier hs-var">ExtensionRaw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Extension a =&gt; a -&gt; OID
</span><a href="Data.X509.Ext.html#extOID"><span class="hs-identifier hs-var">extOID</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077841"><span class="hs-identifier hs-var">ext</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077842"><span class="hs-identifier hs-var">critical</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. ASN1Encoding a =&gt; a -&gt; [ASN1] -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeASN1'</span></span><span> </span><span class="annot"><span class="annottext">DER
</span><span class="hs-identifier hs-var">DER</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Extension a =&gt; a -&gt; [ASN1]
</span><a href="Data.X509.Ext.html#extEncode"><span class="hs-identifier hs-var">extEncode</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077841"><span class="hs-identifier hs-var">ext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OID -&gt; Bool -&gt; ByteString -&gt; ExtensionRaw
</span><a href="Data.X509.ExtensionRaw.html#ExtensionRaw"><span class="hs-identifier hs-var">ExtensionRaw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Extension a =&gt; a -&gt; OID
</span><a href="Data.X509.Ext.html#extOID"><span class="hs-identifier hs-var">extOID</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077841"><span class="hs-identifier hs-var">ext</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077842"><span class="hs-identifier hs-var">critical</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Extension a =&gt; a -&gt; ByteString
</span><a href="Data.X509.Ext.html#extEncodeBs"><span class="hs-identifier hs-var">extEncodeBs</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077841"><span class="hs-identifier hs-var">ext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | Basic Constraints</span><span>
</span><span id="line-128"></span><span class="hs-keyword">data</span><span> </span><span id="ExtBasicConstraints"><span class="annot"><a href="Data.X509.Ext.html#ExtBasicConstraints"><span class="hs-identifier hs-var">ExtBasicConstraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ExtBasicConstraints"><span class="annot"><a href="Data.X509.Ext.html#ExtBasicConstraints"><span class="hs-identifier hs-var">ExtBasicConstraints</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077828"><span id="local-6989586621679077830"><span id="local-6989586621679077838"><span class="annot"><span class="annottext">Int -&gt; ExtBasicConstraints -&gt; ShowS
[ExtBasicConstraints] -&gt; ShowS
ExtBasicConstraints -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ExtBasicConstraints] -&gt; ShowS
$cshowList :: [ExtBasicConstraints] -&gt; ShowS
show :: ExtBasicConstraints -&gt; String
$cshow :: ExtBasicConstraints -&gt; String
showsPrec :: Int -&gt; ExtBasicConstraints -&gt; ShowS
$cshowsPrec :: Int -&gt; ExtBasicConstraints -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077818"><span id="local-6989586621679077825"><span class="annot"><span class="annottext">ExtBasicConstraints -&gt; ExtBasicConstraints -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ExtBasicConstraints -&gt; ExtBasicConstraints -&gt; Bool
$c/= :: ExtBasicConstraints -&gt; ExtBasicConstraints -&gt; Bool
== :: ExtBasicConstraints -&gt; ExtBasicConstraints -&gt; Bool
$c== :: ExtBasicConstraints -&gt; ExtBasicConstraints -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679077810"><span id="local-6989586621679077812"><span class="annot"><a href="Data.X509.Ext.html#Extension"><span class="hs-identifier hs-type">Extension</span></a></span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtBasicConstraints"><span class="hs-identifier hs-type">ExtBasicConstraints</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-132"></span><span>    </span><span id="local-6989586621679077808"><span class="annot"><span class="annottext">extOID :: ExtBasicConstraints -&gt; OID
</span><a href="#local-6989586621679077808"><span class="hs-identifier hs-var hs-var hs-var hs-var">extOID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">29</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">19</span></span><span class="hs-special">]</span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679077806"><span class="annot"><span class="annottext">extHasNestedASN1 :: Proxy ExtBasicConstraints -&gt; Bool
</span><a href="#local-6989586621679077806"><span class="hs-identifier hs-var hs-var hs-var hs-var">extHasNestedASN1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621679077805"><span class="annot"><span class="annottext">extEncode :: ExtBasicConstraints -&gt; [ASN1]
</span><a href="#local-6989586621679077805"><span class="hs-identifier hs-var hs-var hs-var hs-var">extEncode</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.Ext.html#ExtBasicConstraints"><span class="hs-identifier hs-type">ExtBasicConstraints</span></a></span><span> </span><span id="local-6989586621679077804"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077804"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">Start</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool -&gt; ASN1
</span><span class="hs-identifier hs-var">Boolean</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077804"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">End</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">]</span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><a href="Data.X509.Ext.html#extEncode"><span class="hs-identifier hs-var">extEncode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.Ext.html#ExtBasicConstraints"><span class="hs-identifier hs-type">ExtBasicConstraints</span></a></span><span> </span><span id="local-6989586621679077799"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077799"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679077798"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679077798"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">Start</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool -&gt; ASN1
</span><span class="hs-identifier hs-var">Boolean</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077799"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer -&gt; ASN1
</span><span class="hs-identifier hs-var">IntVal</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679077798"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">End</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">]</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621679077793"><span class="annot"><span class="annottext">extDecode :: [ASN1] -&gt; Either String ExtBasicConstraints
</span><a href="#local-6989586621679077793"><span class="hs-identifier hs-var hs-var hs-var hs-var">extDecode</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Start</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Boolean</span></span><span> </span><span id="local-6989586621679077792"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077792"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679077791"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679077791"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">End</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">]</span><span>
</span><span id="line-138"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679077791"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Integer -&gt; ExtBasicConstraints
</span><a href="Data.X509.Ext.html#ExtBasicConstraints"><span class="hs-identifier hs-var">ExtBasicConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077792"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679077791"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;invalid pathlen&quot;</span></span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><a href="Data.X509.Ext.html#extDecode"><span class="hs-identifier hs-var">extDecode</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Start</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Boolean</span></span><span> </span><span id="local-6989586621679077790"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077790"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">End</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Integer -&gt; ExtBasicConstraints
</span><a href="Data.X509.Ext.html#ExtBasicConstraints"><span class="hs-identifier hs-var">ExtBasicConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077790"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><a href="Data.X509.Ext.html#extDecode"><span class="hs-identifier hs-var">extDecode</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Start</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">End</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Integer -&gt; ExtBasicConstraints
</span><a href="Data.X509.Ext.html#ExtBasicConstraints"><span class="hs-identifier hs-var">ExtBasicConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><a href="Data.X509.Ext.html#extDecode"><span class="hs-identifier hs-var">extDecode</span></a></span><span> </span><span class="annot"><span class="annottext">[ASN1]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unknown sequence&quot;</span></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | Describe key usage</span><span>
</span><span id="line-145"></span><span class="hs-keyword">data</span><span> </span><span id="ExtKeyUsage"><span class="annot"><a href="Data.X509.Ext.html#ExtKeyUsage"><span class="hs-identifier hs-var">ExtKeyUsage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ExtKeyUsage"><span class="annot"><a href="Data.X509.Ext.html#ExtKeyUsage"><span class="hs-identifier hs-var">ExtKeyUsage</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.X509.Ext.html#ExtKeyUsageFlag"><span class="hs-identifier hs-type">ExtKeyUsageFlag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077779"><span id="local-6989586621679077781"><span id="local-6989586621679077787"><span class="annot"><span class="annottext">Int -&gt; ExtKeyUsage -&gt; ShowS
[ExtKeyUsage] -&gt; ShowS
ExtKeyUsage -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ExtKeyUsage] -&gt; ShowS
$cshowList :: [ExtKeyUsage] -&gt; ShowS
show :: ExtKeyUsage -&gt; String
$cshow :: ExtKeyUsage -&gt; String
showsPrec :: Int -&gt; ExtKeyUsage -&gt; ShowS
$cshowsPrec :: Int -&gt; ExtKeyUsage -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077773"><span id="local-6989586621679077777"><span class="annot"><span class="annottext">ExtKeyUsage -&gt; ExtKeyUsage -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ExtKeyUsage -&gt; ExtKeyUsage -&gt; Bool
$c/= :: ExtKeyUsage -&gt; ExtKeyUsage -&gt; Bool
== :: ExtKeyUsage -&gt; ExtKeyUsage -&gt; Bool
$c== :: ExtKeyUsage -&gt; ExtKeyUsage -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679077765"><span id="local-6989586621679077767"><span class="annot"><a href="Data.X509.Ext.html#Extension"><span class="hs-identifier hs-type">Extension</span></a></span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtKeyUsage"><span class="hs-identifier hs-type">ExtKeyUsage</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621679077764"><span class="annot"><span class="annottext">extOID :: ExtKeyUsage -&gt; OID
</span><a href="#local-6989586621679077764"><span class="hs-identifier hs-var hs-var hs-var hs-var">extOID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">29</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">15</span></span><span class="hs-special">]</span><span>
</span><span id="line-150"></span><span>    </span><span id="local-6989586621679077763"><span class="annot"><span class="annottext">extHasNestedASN1 :: Proxy ExtKeyUsage -&gt; Bool
</span><a href="#local-6989586621679077763"><span class="hs-identifier hs-var hs-var hs-var hs-var">extHasNestedASN1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679077761"><span class="annot"><span class="annottext">extEncode :: ExtKeyUsage -&gt; [ASN1]
</span><a href="#local-6989586621679077761"><span class="hs-identifier hs-var hs-var hs-var hs-var">extEncode</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.Ext.html#ExtKeyUsage"><span class="hs-identifier hs-type">ExtKeyUsage</span></a></span><span> </span><span id="local-6989586621679077760"><span class="annot"><span class="annottext">[ExtKeyUsageFlag]
</span><a href="#local-6989586621679077760"><span class="hs-identifier hs-var">flags</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BitArray -&gt; ASN1
</span><span class="hs-identifier hs-var">BitString</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Enum a =&gt; [a] -&gt; BitArray
</span><a href="Data.X509.Ext.html#flagsToBits"><span class="hs-identifier hs-var">flagsToBits</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtKeyUsageFlag]
</span><a href="#local-6989586621679077760"><span class="hs-identifier hs-var">flags</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-152"></span><span>    </span><span id="local-6989586621679077756"><span class="annot"><span class="annottext">extDecode :: [ASN1] -&gt; Either String ExtKeyUsage
</span><a href="#local-6989586621679077756"><span class="hs-identifier hs-var hs-var hs-var hs-var">extDecode</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">BitString</span></span><span> </span><span id="local-6989586621679077755"><span class="annot"><span class="annottext">BitArray
</span><a href="#local-6989586621679077755"><span class="hs-identifier hs-var">bits</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ExtKeyUsageFlag] -&gt; ExtKeyUsage
</span><a href="Data.X509.Ext.html#ExtKeyUsage"><span class="hs-identifier hs-var">ExtKeyUsage</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Enum a =&gt; BitArray -&gt; [a]
</span><a href="Data.X509.Ext.html#bitsToFlags"><span class="hs-identifier hs-var">bitsToFlags</span></a></span><span> </span><span class="annot"><span class="annottext">BitArray
</span><a href="#local-6989586621679077755"><span class="hs-identifier hs-var">bits</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="Data.X509.Ext.html#extDecode"><span class="hs-identifier hs-var">extDecode</span></a></span><span> </span><span class="annot"><span class="annottext">[ASN1]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unknown sequence&quot;</span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | Key usage purposes for the ExtendedKeyUsage extension</span><span>
</span><span id="line-156"></span><span class="hs-keyword">data</span><span> </span><span id="ExtKeyUsagePurpose"><span class="annot"><a href="Data.X509.Ext.html#ExtKeyUsagePurpose"><span class="hs-identifier hs-var">ExtKeyUsagePurpose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-157"></span><span>      </span><span id="KeyUsagePurpose_ServerAuth"><span class="annot"><a href="Data.X509.Ext.html#KeyUsagePurpose_ServerAuth"><span class="hs-identifier hs-var">KeyUsagePurpose_ServerAuth</span></a></span></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KeyUsagePurpose_ClientAuth"><span class="annot"><a href="Data.X509.Ext.html#KeyUsagePurpose_ClientAuth"><span class="hs-identifier hs-var">KeyUsagePurpose_ClientAuth</span></a></span></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KeyUsagePurpose_CodeSigning"><span class="annot"><a href="Data.X509.Ext.html#KeyUsagePurpose_CodeSigning"><span class="hs-identifier hs-var">KeyUsagePurpose_CodeSigning</span></a></span></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KeyUsagePurpose_EmailProtection"><span class="annot"><a href="Data.X509.Ext.html#KeyUsagePurpose_EmailProtection"><span class="hs-identifier hs-var">KeyUsagePurpose_EmailProtection</span></a></span></span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KeyUsagePurpose_TimeStamping"><span class="annot"><a href="Data.X509.Ext.html#KeyUsagePurpose_TimeStamping"><span class="hs-identifier hs-var">KeyUsagePurpose_TimeStamping</span></a></span></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KeyUsagePurpose_OCSPSigning"><span class="annot"><a href="Data.X509.Ext.html#KeyUsagePurpose_OCSPSigning"><span class="hs-identifier hs-var">KeyUsagePurpose_OCSPSigning</span></a></span></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KeyUsagePurpose_Unknown"><span class="annot"><a href="Data.X509.Ext.html#KeyUsagePurpose_Unknown"><span class="hs-identifier hs-var">KeyUsagePurpose_Unknown</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077738"><span id="local-6989586621679077740"><span id="local-6989586621679077745"><span class="annot"><span class="annottext">Int -&gt; ExtKeyUsagePurpose -&gt; ShowS
[ExtKeyUsagePurpose] -&gt; ShowS
ExtKeyUsagePurpose -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ExtKeyUsagePurpose] -&gt; ShowS
$cshowList :: [ExtKeyUsagePurpose] -&gt; ShowS
show :: ExtKeyUsagePurpose -&gt; String
$cshow :: ExtKeyUsagePurpose -&gt; String
showsPrec :: Int -&gt; ExtKeyUsagePurpose -&gt; ShowS
$cshowsPrec :: Int -&gt; ExtKeyUsagePurpose -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077732"><span id="local-6989586621679077736"><span class="annot"><span class="annottext">ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Bool
$c/= :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Bool
== :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Bool
$c== :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077713"><span id="local-6989586621679077715"><span id="local-6989586621679077717"><span id="local-6989586621679077719"><span id="local-6989586621679077721"><span id="local-6989586621679077723"><span id="local-6989586621679077728"><span class="annot"><span class="annottext">Eq ExtKeyUsagePurpose
ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Bool
ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Ordering
ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose
$cmin :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose
max :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose
$cmax :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose
&gt;= :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Bool
$c&gt;= :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Bool
&gt; :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Bool
$c&gt; :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Bool
&lt;= :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Bool
$c&lt;= :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Bool
&lt; :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Bool
$c&lt; :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Bool
compare :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Ordering
$ccompare :: ExtKeyUsagePurpose -&gt; ExtKeyUsagePurpose -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="annot"><a href="Data.X509.Ext.html#extKeyUsagePurposedOID"><span class="hs-identifier hs-type">extKeyUsagePurposedOID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtKeyUsagePurpose"><span class="hs-identifier hs-type">ExtKeyUsagePurpose</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-167"></span><span id="extKeyUsagePurposedOID"><span class="annot"><span class="annottext">extKeyUsagePurposedOID :: [(OID, ExtKeyUsagePurpose)]
</span><a href="Data.X509.Ext.html#extKeyUsagePurposedOID"><span class="hs-identifier hs-var hs-var">extKeyUsagePurposedOID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. Num a =&gt; a -&gt; [a]
</span><a href="#local-6989586621679077711"><span class="hs-identifier hs-var">keyUsagePurposePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExtKeyUsagePurpose
</span><a href="Data.X509.Ext.html#KeyUsagePurpose_ServerAuth"><span class="hs-identifier hs-var">KeyUsagePurpose_ServerAuth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. Num a =&gt; a -&gt; [a]
</span><a href="#local-6989586621679077711"><span class="hs-identifier hs-var">keyUsagePurposePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExtKeyUsagePurpose
</span><a href="Data.X509.Ext.html#KeyUsagePurpose_ClientAuth"><span class="hs-identifier hs-var">KeyUsagePurpose_ClientAuth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. Num a =&gt; a -&gt; [a]
</span><a href="#local-6989586621679077711"><span class="hs-identifier hs-var">keyUsagePurposePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExtKeyUsagePurpose
</span><a href="Data.X509.Ext.html#KeyUsagePurpose_CodeSigning"><span class="hs-identifier hs-var">KeyUsagePurpose_CodeSigning</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. Num a =&gt; a -&gt; [a]
</span><a href="#local-6989586621679077711"><span class="hs-identifier hs-var">keyUsagePurposePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExtKeyUsagePurpose
</span><a href="Data.X509.Ext.html#KeyUsagePurpose_EmailProtection"><span class="hs-identifier hs-var">KeyUsagePurpose_EmailProtection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. Num a =&gt; a -&gt; [a]
</span><a href="#local-6989586621679077711"><span class="hs-identifier hs-var">keyUsagePurposePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExtKeyUsagePurpose
</span><a href="Data.X509.Ext.html#KeyUsagePurpose_TimeStamping"><span class="hs-identifier hs-var">KeyUsagePurpose_TimeStamping</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. Num a =&gt; a -&gt; [a]
</span><a href="#local-6989586621679077711"><span class="hs-identifier hs-var">keyUsagePurposePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">9</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExtKeyUsagePurpose
</span><a href="Data.X509.Ext.html#KeyUsagePurpose_OCSPSigning"><span class="hs-identifier hs-var">KeyUsagePurpose_OCSPSigning</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679077711"><span class="annot"><span class="annottext">keyUsagePurposePrefix :: a -&gt; [a]
</span><a href="#local-6989586621679077711"><span class="hs-identifier hs-var hs-var">keyUsagePurposePrefix</span></a></span></span><span> </span><span id="local-6989586621679077701"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077701"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">6</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">7</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077701"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- | Extended key usage extension</span><span>
</span><span id="line-177"></span><span class="hs-keyword">data</span><span> </span><span id="ExtExtendedKeyUsage"><span class="annot"><a href="Data.X509.Ext.html#ExtExtendedKeyUsage"><span class="hs-identifier hs-var">ExtExtendedKeyUsage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ExtExtendedKeyUsage"><span class="annot"><a href="Data.X509.Ext.html#ExtExtendedKeyUsage"><span class="hs-identifier hs-var">ExtExtendedKeyUsage</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.X509.Ext.html#ExtKeyUsagePurpose"><span class="hs-identifier hs-type">ExtKeyUsagePurpose</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077691"><span id="local-6989586621679077693"><span id="local-6989586621679077698"><span class="annot"><span class="annottext">Int -&gt; ExtExtendedKeyUsage -&gt; ShowS
[ExtExtendedKeyUsage] -&gt; ShowS
ExtExtendedKeyUsage -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ExtExtendedKeyUsage] -&gt; ShowS
$cshowList :: [ExtExtendedKeyUsage] -&gt; ShowS
show :: ExtExtendedKeyUsage -&gt; String
$cshow :: ExtExtendedKeyUsage -&gt; String
showsPrec :: Int -&gt; ExtExtendedKeyUsage -&gt; ShowS
$cshowsPrec :: Int -&gt; ExtExtendedKeyUsage -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077685"><span id="local-6989586621679077689"><span class="annot"><span class="annottext">ExtExtendedKeyUsage -&gt; ExtExtendedKeyUsage -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ExtExtendedKeyUsage -&gt; ExtExtendedKeyUsage -&gt; Bool
$c/= :: ExtExtendedKeyUsage -&gt; ExtExtendedKeyUsage -&gt; Bool
== :: ExtExtendedKeyUsage -&gt; ExtExtendedKeyUsage -&gt; Bool
$c== :: ExtExtendedKeyUsage -&gt; ExtExtendedKeyUsage -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679077677"><span id="local-6989586621679077679"><span class="annot"><a href="Data.X509.Ext.html#Extension"><span class="hs-identifier hs-type">Extension</span></a></span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtExtendedKeyUsage"><span class="hs-identifier hs-type">ExtExtendedKeyUsage</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621679077676"><span class="annot"><span class="annottext">extOID :: ExtExtendedKeyUsage -&gt; OID
</span><a href="#local-6989586621679077676"><span class="hs-identifier hs-var hs-var hs-var hs-var">extOID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">29</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">37</span></span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679077675"><span class="annot"><span class="annottext">extHasNestedASN1 :: Proxy ExtExtendedKeyUsage -&gt; Bool
</span><a href="#local-6989586621679077675"><span class="hs-identifier hs-var hs-var hs-var hs-var">extHasNestedASN1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679077674"><span class="annot"><span class="annottext">extEncode :: ExtExtendedKeyUsage -&gt; [ASN1]
</span><a href="#local-6989586621679077674"><span class="hs-identifier hs-var hs-var hs-var hs-var">extEncode</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.Ext.html#ExtExtendedKeyUsage"><span class="hs-identifier hs-type">ExtExtendedKeyUsage</span></a></span><span> </span><span id="local-6989586621679077673"><span class="annot"><span class="annottext">[ExtKeyUsagePurpose]
</span><a href="#local-6989586621679077673"><span class="hs-identifier hs-var">purposes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-184"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">Start</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OID -&gt; ASN1
</span><span class="hs-identifier hs-var">OID</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ExtKeyUsagePurpose -&gt; OID
</span><a href="#local-6989586621679077671"><span class="hs-identifier hs-var">lookupRev</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ExtKeyUsagePurpose]
</span><a href="#local-6989586621679077673"><span class="hs-identifier hs-var">purposes</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">End</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679077671"><span class="annot"><span class="annottext">lookupRev :: ExtKeyUsagePurpose -&gt; OID
</span><a href="#local-6989586621679077671"><span class="hs-identifier hs-var hs-var">lookupRev</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.Ext.html#KeyUsagePurpose_Unknown"><span class="hs-identifier hs-type">KeyUsagePurpose_Unknown</span></a></span><span> </span><span id="local-6989586621679077666"><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679077666"><span class="hs-identifier hs-var">oid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679077666"><span class="hs-identifier hs-var">oid</span></a></span><span>
</span><span id="line-186"></span><span>            </span><span class="annot"><a href="#local-6989586621679077671"><span class="hs-identifier hs-var">lookupRev</span></a></span><span> </span><span id="local-6989586621679077665"><span class="annot"><span class="annottext">ExtKeyUsagePurpose
</span><a href="#local-6989586621679077665"><span class="hs-identifier hs-var">kup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unknown key usage purpose&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">ExtKeyUsagePurpose
</span><a href="#local-6989586621679077665"><span class="hs-identifier hs-var">kup</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(OID, ExtKeyUsagePurpose)]
</span><a href="Data.X509.Ext.html#extKeyUsagePurposedOID"><span class="hs-identifier hs-var">extKeyUsagePurposedOID</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621679077653"><span class="annot"><span class="annottext">extDecode :: [ASN1] -&gt; Either String ExtExtendedKeyUsage
</span><a href="#local-6989586621679077653"><span class="hs-identifier hs-var hs-var hs-var hs-var">extDecode</span></a></span></span><span> </span><span id="local-6989586621679077652"><span class="annot"><span class="annottext">[ASN1]
</span><a href="#local-6989586621679077652"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ExtKeyUsagePurpose] -&gt; ExtExtendedKeyUsage
</span><a href="Data.X509.Ext.html#ExtExtendedKeyUsage"><span class="hs-identifier hs-var">ExtExtendedKeyUsage</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a. ParseASN1 a -&gt; [ASN1] -&gt; Either String a
</span><span class="hs-identifier hs-var">runParseASN1</span></span><span> </span><span class="annot"><span class="annottext">[ASN1]
</span><a href="#local-6989586621679077652"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. ASN1ConstructionType -&gt; ParseASN1 a -&gt; ParseASN1 a
</span><span class="hs-identifier hs-var">onNextContainer</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. ParseASN1 a -&gt; ParseASN1 [a]
</span><span class="hs-identifier hs-var">getMany</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-188"></span><span>        </span><span id="local-6989586621679077647"><span class="annot"><span class="annottext">ASN1
</span><a href="#local-6989586621679077647"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 ASN1
</span><span class="hs-identifier hs-var">getNext</span></span><span>
</span><span id="line-189"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ASN1
</span><a href="#local-6989586621679077647"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-190"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span> </span><span id="local-6989586621679077645"><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679077645"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OID -&gt; ExtKeyUsagePurpose
</span><a href="Data.X509.Ext.html#KeyUsagePurpose_Unknown"><span class="hs-identifier hs-var">KeyUsagePurpose_Unknown</span></a></span><span> </span><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679077645"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679077645"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">[(OID, ExtKeyUsagePurpose)]
</span><a href="Data.X509.Ext.html#extKeyUsagePurposedOID"><span class="hs-identifier hs-var">extKeyUsagePurposedOID</span></a></span><span>
</span><span id="line-191"></span><span>            </span><span class="annot"><span class="annottext">ASN1
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;invalid content in extended key usage&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | Provide a way to identify a public key by a short hash.</span><span>
</span><span id="line-194"></span><span class="hs-keyword">data</span><span> </span><span id="ExtSubjectKeyId"><span class="annot"><a href="Data.X509.Ext.html#ExtSubjectKeyId"><span class="hs-identifier hs-var">ExtSubjectKeyId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ExtSubjectKeyId"><span class="annot"><a href="Data.X509.Ext.html#ExtSubjectKeyId"><span class="hs-identifier hs-var">ExtSubjectKeyId</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077633"><span id="local-6989586621679077635"><span id="local-6989586621679077640"><span class="annot"><span class="annottext">Int -&gt; ExtSubjectKeyId -&gt; ShowS
[ExtSubjectKeyId] -&gt; ShowS
ExtSubjectKeyId -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ExtSubjectKeyId] -&gt; ShowS
$cshowList :: [ExtSubjectKeyId] -&gt; ShowS
show :: ExtSubjectKeyId -&gt; String
$cshow :: ExtSubjectKeyId -&gt; String
showsPrec :: Int -&gt; ExtSubjectKeyId -&gt; ShowS
$cshowsPrec :: Int -&gt; ExtSubjectKeyId -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077627"><span id="local-6989586621679077631"><span class="annot"><span class="annottext">ExtSubjectKeyId -&gt; ExtSubjectKeyId -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ExtSubjectKeyId -&gt; ExtSubjectKeyId -&gt; Bool
$c/= :: ExtSubjectKeyId -&gt; ExtSubjectKeyId -&gt; Bool
== :: ExtSubjectKeyId -&gt; ExtSubjectKeyId -&gt; Bool
$c== :: ExtSubjectKeyId -&gt; ExtSubjectKeyId -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679077619"><span id="local-6989586621679077621"><span class="annot"><a href="Data.X509.Ext.html#Extension"><span class="hs-identifier hs-type">Extension</span></a></span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtSubjectKeyId"><span class="hs-identifier hs-type">ExtSubjectKeyId</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span>    </span><span id="local-6989586621679077618"><span class="annot"><span class="annottext">extOID :: ExtSubjectKeyId -&gt; OID
</span><a href="#local-6989586621679077618"><span class="hs-identifier hs-var hs-var hs-var hs-var">extOID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">29</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">14</span></span><span class="hs-special">]</span><span>
</span><span id="line-199"></span><span>    </span><span id="local-6989586621679077617"><span class="annot"><span class="annottext">extHasNestedASN1 :: Proxy ExtSubjectKeyId -&gt; Bool
</span><a href="#local-6989586621679077617"><span class="hs-identifier hs-var hs-var hs-var hs-var">extHasNestedASN1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621679077616"><span class="annot"><span class="annottext">extEncode :: ExtSubjectKeyId -&gt; [ASN1]
</span><a href="#local-6989586621679077616"><span class="hs-identifier hs-var hs-var hs-var hs-var">extEncode</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.Ext.html#ExtSubjectKeyId"><span class="hs-identifier hs-type">ExtSubjectKeyId</span></a></span><span> </span><span id="local-6989586621679077615"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077615"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString -&gt; ASN1
</span><span class="hs-identifier hs-var">OctetString</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077615"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621679077613"><span class="annot"><span class="annottext">extDecode :: [ASN1] -&gt; Either String ExtSubjectKeyId
</span><a href="#local-6989586621679077613"><span class="hs-identifier hs-var hs-var hs-var hs-var">extDecode</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">OctetString</span></span><span> </span><span id="local-6989586621679077612"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077612"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ExtSubjectKeyId
</span><a href="Data.X509.Ext.html#ExtSubjectKeyId"><span class="hs-identifier hs-var">ExtSubjectKeyId</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077612"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><a href="Data.X509.Ext.html#extDecode"><span class="hs-identifier hs-var">extDecode</span></a></span><span> </span><span class="annot"><span class="annottext">[ASN1]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unknown sequence&quot;</span></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | Different naming scheme use by the extension.</span><span>
</span><span id="line-205"></span><span class="hs-comment">--</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- Not all name types are available, missing:</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- otherName</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- x400Address</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- directoryName</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- ediPartyName</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- registeredID</span><span>
</span><span id="line-212"></span><span class="hs-comment">--</span><span>
</span><span id="line-213"></span><span class="hs-keyword">data</span><span> </span><span id="AltName"><span class="annot"><a href="Data.X509.Ext.html#AltName"><span class="hs-identifier hs-var">AltName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-214"></span><span>      </span><span id="AltNameRFC822"><span class="annot"><a href="Data.X509.Ext.html#AltNameRFC822"><span class="hs-identifier hs-var">AltNameRFC822</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="AltNameDNS"><span class="annot"><a href="Data.X509.Ext.html#AltNameDNS"><span class="hs-identifier hs-var">AltNameDNS</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="AltNameURI"><span class="annot"><a href="Data.X509.Ext.html#AltNameURI"><span class="hs-identifier hs-var">AltNameURI</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="AltNameIP"><span class="annot"><a href="Data.X509.Ext.html#AltNameIP"><span class="hs-identifier hs-var">AltNameIP</span></a></span></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="AltNameXMPP"><span class="annot"><a href="Data.X509.Ext.html#AltNameXMPP"><span class="hs-identifier hs-var">AltNameXMPP</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="AltNameDNSSRV"><span class="annot"><a href="Data.X509.Ext.html#AltNameDNSSRV"><span class="hs-identifier hs-var">AltNameDNSSRV</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077587"><span id="local-6989586621679077589"><span id="local-6989586621679077604"><span class="annot"><span class="annottext">Int -&gt; AltName -&gt; ShowS
[AltName] -&gt; ShowS
AltName -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [AltName] -&gt; ShowS
$cshowList :: [AltName] -&gt; ShowS
show :: AltName -&gt; String
$cshow :: AltName -&gt; String
showsPrec :: Int -&gt; AltName -&gt; ShowS
$cshowsPrec :: Int -&gt; AltName -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077575"><span id="local-6989586621679077584"><span class="annot"><span class="annottext">AltName -&gt; AltName -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: AltName -&gt; AltName -&gt; Bool
$c/= :: AltName -&gt; AltName -&gt; Bool
== :: AltName -&gt; AltName -&gt; Bool
$c== :: AltName -&gt; AltName -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077550"><span id="local-6989586621679077552"><span id="local-6989586621679077554"><span id="local-6989586621679077556"><span id="local-6989586621679077558"><span id="local-6989586621679077560"><span id="local-6989586621679077570"><span class="annot"><span class="annottext">Eq AltName
AltName -&gt; AltName -&gt; Bool
AltName -&gt; AltName -&gt; Ordering
AltName -&gt; AltName -&gt; AltName
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: AltName -&gt; AltName -&gt; AltName
$cmin :: AltName -&gt; AltName -&gt; AltName
max :: AltName -&gt; AltName -&gt; AltName
$cmax :: AltName -&gt; AltName -&gt; AltName
&gt;= :: AltName -&gt; AltName -&gt; Bool
$c&gt;= :: AltName -&gt; AltName -&gt; Bool
&gt; :: AltName -&gt; AltName -&gt; Bool
$c&gt; :: AltName -&gt; AltName -&gt; Bool
&lt;= :: AltName -&gt; AltName -&gt; Bool
$c&lt;= :: AltName -&gt; AltName -&gt; Bool
&lt; :: AltName -&gt; AltName -&gt; Bool
$c&lt; :: AltName -&gt; AltName -&gt; Bool
compare :: AltName -&gt; AltName -&gt; Ordering
$ccompare :: AltName -&gt; AltName -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-comment">-- | Provide a way to supply alternate name that can be</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- used for matching host name.</span><span>
</span><span id="line-224"></span><span class="hs-keyword">data</span><span> </span><span id="ExtSubjectAltName"><span class="annot"><a href="Data.X509.Ext.html#ExtSubjectAltName"><span class="hs-identifier hs-var">ExtSubjectAltName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ExtSubjectAltName"><span class="annot"><a href="Data.X509.Ext.html#ExtSubjectAltName"><span class="hs-identifier hs-var">ExtSubjectAltName</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.X509.Ext.html#AltName"><span class="hs-identifier hs-type">AltName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077539"><span id="local-6989586621679077541"><span id="local-6989586621679077546"><span class="annot"><span class="annottext">Int -&gt; ExtSubjectAltName -&gt; ShowS
[ExtSubjectAltName] -&gt; ShowS
ExtSubjectAltName -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ExtSubjectAltName] -&gt; ShowS
$cshowList :: [ExtSubjectAltName] -&gt; ShowS
show :: ExtSubjectAltName -&gt; String
$cshow :: ExtSubjectAltName -&gt; String
showsPrec :: Int -&gt; ExtSubjectAltName -&gt; ShowS
$cshowsPrec :: Int -&gt; ExtSubjectAltName -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077533"><span id="local-6989586621679077537"><span class="annot"><span class="annottext">ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Bool
$c/= :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Bool
== :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Bool
$c== :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077510"><span id="local-6989586621679077512"><span id="local-6989586621679077515"><span id="local-6989586621679077518"><span id="local-6989586621679077521"><span id="local-6989586621679077525"><span id="local-6989586621679077529"><span class="annot"><span class="annottext">Eq ExtSubjectAltName
ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Bool
ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Ordering
ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; ExtSubjectAltName
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; ExtSubjectAltName
$cmin :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; ExtSubjectAltName
max :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; ExtSubjectAltName
$cmax :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; ExtSubjectAltName
&gt;= :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Bool
$c&gt;= :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Bool
&gt; :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Bool
$c&gt; :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Bool
&lt;= :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Bool
$c&lt;= :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Bool
&lt; :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Bool
$c&lt; :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Bool
compare :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Ordering
$ccompare :: ExtSubjectAltName -&gt; ExtSubjectAltName -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679077502"><span id="local-6989586621679077504"><span class="annot"><a href="Data.X509.Ext.html#Extension"><span class="hs-identifier hs-type">Extension</span></a></span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtSubjectAltName"><span class="hs-identifier hs-type">ExtSubjectAltName</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621679077501"><span class="annot"><span class="annottext">extOID :: ExtSubjectAltName -&gt; OID
</span><a href="#local-6989586621679077501"><span class="hs-identifier hs-var hs-var hs-var hs-var">extOID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">29</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">17</span></span><span class="hs-special">]</span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621679077500"><span class="annot"><span class="annottext">extHasNestedASN1 :: Proxy ExtSubjectAltName -&gt; Bool
</span><a href="#local-6989586621679077500"><span class="hs-identifier hs-var hs-var hs-var hs-var">extHasNestedASN1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-230"></span><span>    </span><span id="local-6989586621679077499"><span class="annot"><span class="annottext">extEncode :: ExtSubjectAltName -&gt; [ASN1]
</span><a href="#local-6989586621679077499"><span class="hs-identifier hs-var hs-var hs-var hs-var">extEncode</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.Ext.html#ExtSubjectAltName"><span class="hs-identifier hs-type">ExtSubjectAltName</span></a></span><span> </span><span id="local-6989586621679077498"><span class="annot"><span class="annottext">[AltName]
</span><a href="#local-6989586621679077498"><span class="hs-identifier hs-var">names</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[AltName] -&gt; [ASN1]
</span><a href="Data.X509.Ext.html#encodeGeneralNames"><span class="hs-identifier hs-var">encodeGeneralNames</span></a></span><span> </span><span class="annot"><span class="annottext">[AltName]
</span><a href="#local-6989586621679077498"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621679077494"><span class="annot"><span class="annottext">extDecode :: [ASN1] -&gt; Either String ExtSubjectAltName
</span><a href="#local-6989586621679077494"><span class="hs-identifier hs-var hs-var hs-var hs-var">extDecode</span></a></span></span><span> </span><span id="local-6989586621679077493"><span class="annot"><span class="annottext">[ASN1]
</span><a href="#local-6989586621679077493"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ParseASN1 a -&gt; [ASN1] -&gt; Either String a
</span><span class="hs-identifier hs-var">runParseASN1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[AltName] -&gt; ExtSubjectAltName
</span><a href="Data.X509.Ext.html#ExtSubjectAltName"><span class="hs-identifier hs-var">ExtSubjectAltName</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 [AltName]
</span><a href="Data.X509.Ext.html#parseGeneralNames"><span class="hs-identifier hs-var">parseGeneralNames</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ASN1]
</span><a href="#local-6989586621679077493"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-comment">-- | Provide a mean to identify the public key corresponding to the private key</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- used to signed a certificate.</span><span>
</span><span id="line-235"></span><span class="hs-keyword">data</span><span> </span><span id="ExtAuthorityKeyId"><span class="annot"><a href="Data.X509.Ext.html#ExtAuthorityKeyId"><span class="hs-identifier hs-var">ExtAuthorityKeyId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ExtAuthorityKeyId"><span class="annot"><a href="Data.X509.Ext.html#ExtAuthorityKeyId"><span class="hs-identifier hs-var">ExtAuthorityKeyId</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077482"><span id="local-6989586621679077484"><span id="local-6989586621679077488"><span class="annot"><span class="annottext">Int -&gt; ExtAuthorityKeyId -&gt; ShowS
[ExtAuthorityKeyId] -&gt; ShowS
ExtAuthorityKeyId -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ExtAuthorityKeyId] -&gt; ShowS
$cshowList :: [ExtAuthorityKeyId] -&gt; ShowS
show :: ExtAuthorityKeyId -&gt; String
$cshow :: ExtAuthorityKeyId -&gt; String
showsPrec :: Int -&gt; ExtAuthorityKeyId -&gt; ShowS
$cshowsPrec :: Int -&gt; ExtAuthorityKeyId -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077477"><span id="local-6989586621679077480"><span class="annot"><span class="annottext">ExtAuthorityKeyId -&gt; ExtAuthorityKeyId -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ExtAuthorityKeyId -&gt; ExtAuthorityKeyId -&gt; Bool
$c/= :: ExtAuthorityKeyId -&gt; ExtAuthorityKeyId -&gt; Bool
== :: ExtAuthorityKeyId -&gt; ExtAuthorityKeyId -&gt; Bool
$c== :: ExtAuthorityKeyId -&gt; ExtAuthorityKeyId -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679077469"><span id="local-6989586621679077471"><span class="annot"><a href="Data.X509.Ext.html#Extension"><span class="hs-identifier hs-type">Extension</span></a></span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtAuthorityKeyId"><span class="hs-identifier hs-type">ExtAuthorityKeyId</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-239"></span><span>    </span><span id="local-6989586621679077468"><span class="annot"><span class="annottext">extOID :: ExtAuthorityKeyId -&gt; OID
</span><a href="#local-6989586621679077468"><span class="hs-identifier hs-var hs-var hs-var hs-var">extOID</span></a></span></span><span> </span><span class="annot"><span class="annottext">ExtAuthorityKeyId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">29</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">35</span></span><span class="hs-special">]</span><span>
</span><span id="line-240"></span><span>    </span><span id="local-6989586621679077467"><span class="annot"><span class="annottext">extHasNestedASN1 :: Proxy ExtAuthorityKeyId -&gt; Bool
</span><a href="#local-6989586621679077467"><span class="hs-identifier hs-var hs-var hs-var hs-var">extHasNestedASN1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621679077466"><span class="annot"><span class="annottext">extEncode :: ExtAuthorityKeyId -&gt; [ASN1]
</span><a href="#local-6989586621679077466"><span class="hs-identifier hs-var hs-var hs-var hs-var">extEncode</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.Ext.html#ExtAuthorityKeyId"><span class="hs-identifier hs-type">ExtAuthorityKeyId</span></a></span><span> </span><span id="local-6989586621679077465"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077465"><span class="hs-identifier hs-var">keyid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-242"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">Start</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ByteString -&gt; ASN1
</span><span class="hs-identifier hs-var">Other</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077465"><span class="hs-identifier hs-var">keyid</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">End</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">]</span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621679077460"><span class="annot"><span class="annottext">extDecode :: [ASN1] -&gt; Either String ExtAuthorityKeyId
</span><a href="#local-6989586621679077460"><span class="hs-identifier hs-var hs-var hs-var hs-var">extDecode</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Start</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Other</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621679077459"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077459"><span class="hs-identifier hs-var">keyid</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">End</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-244"></span><span>        </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ExtAuthorityKeyId
</span><a href="Data.X509.Ext.html#ExtAuthorityKeyId"><span class="hs-identifier hs-var">ExtAuthorityKeyId</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077459"><span class="hs-identifier hs-var">keyid</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><a href="Data.X509.Ext.html#extDecode"><span class="hs-identifier hs-var">extDecode</span></a></span><span> </span><span class="annot"><span class="annottext">[ASN1]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unknown sequence&quot;</span></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-comment">-- | Identify how CRL information is obtained</span><span>
</span><span id="line-248"></span><span class="hs-keyword">data</span><span> </span><span id="ExtCrlDistributionPoints"><span class="annot"><a href="Data.X509.Ext.html#ExtCrlDistributionPoints"><span class="hs-identifier hs-var">ExtCrlDistributionPoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ExtCrlDistributionPoints"><span class="annot"><a href="Data.X509.Ext.html#ExtCrlDistributionPoints"><span class="hs-identifier hs-var">ExtCrlDistributionPoints</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.X509.Ext.html#DistributionPoint"><span class="hs-identifier hs-type">DistributionPoint</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077449"><span id="local-6989586621679077451"><span id="local-6989586621679077456"><span class="annot"><span class="annottext">Int -&gt; ExtCrlDistributionPoints -&gt; ShowS
[ExtCrlDistributionPoints] -&gt; ShowS
ExtCrlDistributionPoints -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ExtCrlDistributionPoints] -&gt; ShowS
$cshowList :: [ExtCrlDistributionPoints] -&gt; ShowS
show :: ExtCrlDistributionPoints -&gt; String
$cshow :: ExtCrlDistributionPoints -&gt; String
showsPrec :: Int -&gt; ExtCrlDistributionPoints -&gt; ShowS
$cshowsPrec :: Int -&gt; ExtCrlDistributionPoints -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077443"><span id="local-6989586621679077447"><span class="annot"><span class="annottext">ExtCrlDistributionPoints -&gt; ExtCrlDistributionPoints -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ExtCrlDistributionPoints -&gt; ExtCrlDistributionPoints -&gt; Bool
$c/= :: ExtCrlDistributionPoints -&gt; ExtCrlDistributionPoints -&gt; Bool
== :: ExtCrlDistributionPoints -&gt; ExtCrlDistributionPoints -&gt; Bool
$c== :: ExtCrlDistributionPoints -&gt; ExtCrlDistributionPoints -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | Reason flag for the CRL</span><span>
</span><span id="line-252"></span><span class="hs-keyword">data</span><span> </span><span id="ReasonFlag"><span class="annot"><a href="Data.X509.Ext.html#ReasonFlag"><span class="hs-identifier hs-var">ReasonFlag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-253"></span><span>      </span><span id="Reason_Unused"><span class="annot"><a href="Data.X509.Ext.html#Reason_Unused"><span class="hs-identifier hs-var">Reason_Unused</span></a></span></span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Reason_KeyCompromise"><span class="annot"><a href="Data.X509.Ext.html#Reason_KeyCompromise"><span class="hs-identifier hs-var">Reason_KeyCompromise</span></a></span></span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Reason_CACompromise"><span class="annot"><a href="Data.X509.Ext.html#Reason_CACompromise"><span class="hs-identifier hs-var">Reason_CACompromise</span></a></span></span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Reason_AffiliationChanged"><span class="annot"><a href="Data.X509.Ext.html#Reason_AffiliationChanged"><span class="hs-identifier hs-var">Reason_AffiliationChanged</span></a></span></span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Reason_Superseded"><span class="annot"><a href="Data.X509.Ext.html#Reason_Superseded"><span class="hs-identifier hs-var">Reason_Superseded</span></a></span></span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Reason_CessationOfOperation"><span class="annot"><a href="Data.X509.Ext.html#Reason_CessationOfOperation"><span class="hs-identifier hs-var">Reason_CessationOfOperation</span></a></span></span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Reason_CertificateHold"><span class="annot"><a href="Data.X509.Ext.html#Reason_CertificateHold"><span class="hs-identifier hs-var">Reason_CertificateHold</span></a></span></span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Reason_PrivilegeWithdrawn"><span class="annot"><a href="Data.X509.Ext.html#Reason_PrivilegeWithdrawn"><span class="hs-identifier hs-var">Reason_PrivilegeWithdrawn</span></a></span></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Reason_AACompromise"><span class="annot"><a href="Data.X509.Ext.html#Reason_AACompromise"><span class="hs-identifier hs-var">Reason_AACompromise</span></a></span></span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077428"><span id="local-6989586621679077430"><span id="local-6989586621679077432"><span class="annot"><span class="annottext">Int -&gt; ReasonFlag -&gt; ShowS
[ReasonFlag] -&gt; ShowS
ReasonFlag -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ReasonFlag] -&gt; ShowS
$cshowList :: [ReasonFlag] -&gt; ShowS
show :: ReasonFlag -&gt; String
$cshow :: ReasonFlag -&gt; String
showsPrec :: Int -&gt; ReasonFlag -&gt; ShowS
$cshowsPrec :: Int -&gt; ReasonFlag -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077424"><span id="local-6989586621679077426"><span class="annot"><span class="annottext">ReasonFlag -&gt; ReasonFlag -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ReasonFlag -&gt; ReasonFlag -&gt; Bool
$c/= :: ReasonFlag -&gt; ReasonFlag -&gt; Bool
== :: ReasonFlag -&gt; ReasonFlag -&gt; Bool
$c== :: ReasonFlag -&gt; ReasonFlag -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077405"><span id="local-6989586621679077407"><span id="local-6989586621679077410"><span id="local-6989586621679077413"><span id="local-6989586621679077416"><span id="local-6989586621679077418"><span id="local-6989586621679077420"><span class="annot"><span class="annottext">Eq ReasonFlag
ReasonFlag -&gt; ReasonFlag -&gt; Bool
ReasonFlag -&gt; ReasonFlag -&gt; Ordering
ReasonFlag -&gt; ReasonFlag -&gt; ReasonFlag
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: ReasonFlag -&gt; ReasonFlag -&gt; ReasonFlag
$cmin :: ReasonFlag -&gt; ReasonFlag -&gt; ReasonFlag
max :: ReasonFlag -&gt; ReasonFlag -&gt; ReasonFlag
$cmax :: ReasonFlag -&gt; ReasonFlag -&gt; ReasonFlag
&gt;= :: ReasonFlag -&gt; ReasonFlag -&gt; Bool
$c&gt;= :: ReasonFlag -&gt; ReasonFlag -&gt; Bool
&gt; :: ReasonFlag -&gt; ReasonFlag -&gt; Bool
$c&gt; :: ReasonFlag -&gt; ReasonFlag -&gt; Bool
&lt;= :: ReasonFlag -&gt; ReasonFlag -&gt; Bool
$c&lt;= :: ReasonFlag -&gt; ReasonFlag -&gt; Bool
&lt; :: ReasonFlag -&gt; ReasonFlag -&gt; Bool
$c&lt; :: ReasonFlag -&gt; ReasonFlag -&gt; Bool
compare :: ReasonFlag -&gt; ReasonFlag -&gt; Ordering
$ccompare :: ReasonFlag -&gt; ReasonFlag -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077372"><span id="local-6989586621679077374"><span id="local-6989586621679077378"><span id="local-6989586621679077381"><span id="local-6989586621679077383"><span id="local-6989586621679077391"><span id="local-6989586621679077397"><span id="local-6989586621679077403"><span class="annot"><span class="annottext">Int -&gt; ReasonFlag
ReasonFlag -&gt; Int
ReasonFlag -&gt; [ReasonFlag]
ReasonFlag -&gt; ReasonFlag
ReasonFlag -&gt; ReasonFlag -&gt; [ReasonFlag]
ReasonFlag -&gt; ReasonFlag -&gt; ReasonFlag -&gt; [ReasonFlag]
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: ReasonFlag -&gt; ReasonFlag -&gt; ReasonFlag -&gt; [ReasonFlag]
$cenumFromThenTo :: ReasonFlag -&gt; ReasonFlag -&gt; ReasonFlag -&gt; [ReasonFlag]
enumFromTo :: ReasonFlag -&gt; ReasonFlag -&gt; [ReasonFlag]
$cenumFromTo :: ReasonFlag -&gt; ReasonFlag -&gt; [ReasonFlag]
enumFromThen :: ReasonFlag -&gt; ReasonFlag -&gt; [ReasonFlag]
$cenumFromThen :: ReasonFlag -&gt; ReasonFlag -&gt; [ReasonFlag]
enumFrom :: ReasonFlag -&gt; [ReasonFlag]
$cenumFrom :: ReasonFlag -&gt; [ReasonFlag]
fromEnum :: ReasonFlag -&gt; Int
$cfromEnum :: ReasonFlag -&gt; Int
toEnum :: Int -&gt; ReasonFlag
$ctoEnum :: Int -&gt; ReasonFlag
pred :: ReasonFlag -&gt; ReasonFlag
$cpred :: ReasonFlag -&gt; ReasonFlag
succ :: ReasonFlag -&gt; ReasonFlag
$csucc :: ReasonFlag -&gt; ReasonFlag
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- | Distribution point as either some GeneralNames or a DN</span><span>
</span><span id="line-265"></span><span class="hs-keyword">data</span><span> </span><span id="DistributionPoint"><span class="annot"><a href="Data.X509.Ext.html#DistributionPoint"><span class="hs-identifier hs-var">DistributionPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-266"></span><span>      </span><span id="DistributionPointFullName"><span class="annot"><a href="Data.X509.Ext.html#DistributionPointFullName"><span class="hs-identifier hs-var">DistributionPointFullName</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.X509.Ext.html#AltName"><span class="hs-identifier hs-type">AltName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="DistributionNameRelative"><span class="annot"><a href="Data.X509.Ext.html#DistributionNameRelative"><span class="hs-identifier hs-var">DistributionNameRelative</span></a></span></span><span> </span><span class="annot"><a href="Data.X509.DistinguishedName.html#DistinguishedName"><span class="hs-identifier hs-type">DistinguishedName</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077358"><span id="local-6989586621679077360"><span id="local-6989586621679077368"><span class="annot"><span class="annottext">Int -&gt; DistributionPoint -&gt; ShowS
[DistributionPoint] -&gt; ShowS
DistributionPoint -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [DistributionPoint] -&gt; ShowS
$cshowList :: [DistributionPoint] -&gt; ShowS
show :: DistributionPoint -&gt; String
$cshow :: DistributionPoint -&gt; String
showsPrec :: Int -&gt; DistributionPoint -&gt; ShowS
$cshowsPrec :: Int -&gt; DistributionPoint -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077350"><span id="local-6989586621679077356"><span class="annot"><span class="annottext">DistributionPoint -&gt; DistributionPoint -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DistributionPoint -&gt; DistributionPoint -&gt; Bool
$c/= :: DistributionPoint -&gt; DistributionPoint -&gt; Bool
== :: DistributionPoint -&gt; DistributionPoint -&gt; Bool
$c== :: DistributionPoint -&gt; DistributionPoint -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679077342"><span id="local-6989586621679077344"><span class="annot"><a href="Data.X509.Ext.html#Extension"><span class="hs-identifier hs-type">Extension</span></a></span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtCrlDistributionPoints"><span class="hs-identifier hs-type">ExtCrlDistributionPoints</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621679077341"><span class="annot"><span class="annottext">extOID :: ExtCrlDistributionPoints -&gt; OID
</span><a href="#local-6989586621679077341"><span class="hs-identifier hs-var hs-var hs-var hs-var">extOID</span></a></span></span><span> </span><span class="annot"><span class="annottext">ExtCrlDistributionPoints
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">29</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">31</span></span><span class="hs-special">]</span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621679077340"><span class="annot"><span class="annottext">extHasNestedASN1 :: Proxy ExtCrlDistributionPoints -&gt; Bool
</span><a href="#local-6989586621679077340"><span class="hs-identifier hs-var hs-var hs-var hs-var">extHasNestedASN1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621679077337"><span class="annot"><span class="annottext">extEncode :: ExtCrlDistributionPoints -&gt; [ASN1]
</span><a href="#local-6989586621679077337"><span class="hs-identifier hs-var hs-var hs-var hs-var">extEncode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;extEncode ExtCrlDistributionPoints unimplemented&quot;</span></span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621679077334"><span class="annot"><span class="annottext">extDecode :: [ASN1] -&gt; Either String ExtCrlDistributionPoints
</span><a href="#local-6989586621679077334"><span class="hs-identifier hs-var hs-var hs-var hs-var">extDecode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;extDecode ExtCrlDistributionPoints unimplemented&quot;</span></span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-comment">--extEncode (ExtCrlDistributionPoints )</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="annot"><a href="Data.X509.Ext.html#parseGeneralNames"><span class="hs-identifier hs-type">parseGeneralNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ParseASN1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.X509.Ext.html#AltName"><span class="hs-identifier hs-type">AltName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span id="parseGeneralNames"><span class="annot"><span class="annottext">parseGeneralNames :: ParseASN1 [AltName]
</span><a href="Data.X509.Ext.html#parseGeneralNames"><span class="hs-identifier hs-var hs-var">parseGeneralNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ASN1ConstructionType -&gt; ParseASN1 a -&gt; ParseASN1 a
</span><span class="hs-identifier hs-var">onNextContainer</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. ParseASN1 a -&gt; ParseASN1 [a]
</span><span class="hs-identifier hs-var">getMany</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 AltName
</span><a href="#local-6989586621679077333"><span class="hs-identifier hs-var">getAddr</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-280"></span><span>        </span><span id="local-6989586621679077333"><span class="annot"><span class="annottext">getAddr :: ParseASN1 AltName
</span><a href="#local-6989586621679077333"><span class="hs-identifier hs-var hs-var">getAddr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-281"></span><span>            </span><span id="local-6989586621679077330"><span class="annot"><span class="annottext">Maybe AltName
</span><a href="#local-6989586621679077330"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a.
ASN1ConstructionType -&gt; ParseASN1 a -&gt; ParseASN1 (Maybe a)
</span><span class="hs-identifier hs-var">onNextContainerMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParseASN1 AltName
</span><a href="#local-6989586621679077327"><span class="hs-identifier hs-var">getComposedAddr</span></a></span><span>
</span><span id="line-282"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe AltName
</span><a href="#local-6989586621679077330"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-283"></span><span>                </span><span class="annot"><span class="annottext">Maybe AltName
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ParseASN1 AltName
</span><a href="#local-6989586621679077326"><span class="hs-identifier hs-var">getSimpleAddr</span></a></span><span>
</span><span id="line-284"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679077325"><span class="annot"><span class="annottext">AltName
</span><a href="#local-6989586621679077325"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">AltName
</span><a href="#local-6989586621679077325"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-285"></span><span>        </span><span id="local-6989586621679077327"><span class="annot"><span class="annottext">getComposedAddr :: ParseASN1 AltName
</span><a href="#local-6989586621679077327"><span class="hs-identifier hs-var hs-var">getComposedAddr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-286"></span><span>            </span><span id="local-6989586621679077275"><span class="annot"><span class="annottext">ASN1
</span><a href="#local-6989586621679077275"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 ASN1
</span><span class="hs-identifier hs-var">getNext</span></span><span>
</span><span id="line-287"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ASN1
</span><a href="#local-6989586621679077275"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-288"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">6</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">7</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- xmpp addr</span><span>
</span><span id="line-289"></span><span>                    </span><span id="local-6989586621679077274"><span class="annot"><span class="annottext">Maybe [ASN1]
</span><a href="#local-6989586621679077274"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 (Maybe [ASN1])
</span><span class="hs-identifier hs-var">getNextContainerMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe [ASN1]
</span><a href="#local-6989586621679077274"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-291"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASN1String</span></span><span> </span><span id="local-6989586621679077271"><span class="annot"><span class="annottext">ASN1CharacterString
</span><a href="#local-6989586621679077271"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-292"></span><span>                            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ASN1CharacterString -&gt; Maybe String
</span><span class="hs-identifier hs-var">asn1CharacterToString</span></span><span> </span><span class="annot"><span class="annottext">ASN1CharacterString
</span><a href="#local-6989586621679077271"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-293"></span><span>                                </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; ParseASN1 a
</span><span class="hs-identifier hs-var">throwParseError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GeneralNames: invalid string for XMPP Addr&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>                                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679077268"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077268"><span class="hs-identifier hs-var">s</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; AltName
</span><a href="Data.X509.Ext.html#AltNameXMPP"><span class="hs-identifier hs-var">AltNameXMPP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077268"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-295"></span><span>                        </span><span class="annot"><span class="annottext">Maybe [ASN1]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; ParseASN1 a
</span><span class="hs-identifier hs-var">throwParseError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GeneralNames: expecting string for XMPP Addr got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Maybe [ASN1]
</span><a href="#local-6989586621679077274"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">6</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">7</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">7</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- DNSSRV addr</span><span>
</span><span id="line-297"></span><span>                    </span><span id="local-6989586621679077267"><span class="annot"><span class="annottext">Maybe [ASN1]
</span><a href="#local-6989586621679077267"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 (Maybe [ASN1])
</span><span class="hs-identifier hs-var">getNextContainerMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe [ASN1]
</span><a href="#local-6989586621679077267"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-299"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASN1String</span></span><span> </span><span id="local-6989586621679077266"><span class="annot"><span class="annottext">ASN1CharacterString
</span><a href="#local-6989586621679077266"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-300"></span><span>                            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ASN1CharacterString -&gt; Maybe String
</span><span class="hs-identifier hs-var">asn1CharacterToString</span></span><span> </span><span class="annot"><span class="annottext">ASN1CharacterString
</span><a href="#local-6989586621679077266"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-301"></span><span>                                </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; ParseASN1 a
</span><span class="hs-identifier hs-var">throwParseError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GeneralNames: invalid string for DNSSrv Addr&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>                                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679077265"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077265"><span class="hs-identifier hs-var">s</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; AltName
</span><a href="Data.X509.Ext.html#AltNameDNSSRV"><span class="hs-identifier hs-var">AltNameDNSSRV</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077265"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-303"></span><span>                        </span><span class="annot"><span class="annottext">Maybe [ASN1]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; ParseASN1 a
</span><span class="hs-identifier hs-var">throwParseError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GeneralNames: expecting string for DNSSRV Addr got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Maybe [ASN1]
</span><a href="#local-6989586621679077267"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span> </span><span id="local-6989586621679077264"><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679077264"><span class="hs-identifier hs-var">unknown</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; ParseASN1 a
</span><span class="hs-identifier hs-var">throwParseError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GeneralNames: unknown OID &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679077264"><span class="hs-identifier hs-var">unknown</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>                </span><span class="annot"><span class="annottext">ASN1
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; ParseASN1 a
</span><span class="hs-identifier hs-var">throwParseError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GeneralNames: expecting OID but got &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ASN1
</span><a href="#local-6989586621679077275"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>        </span><span id="local-6989586621679077326"><span class="annot"><span class="annottext">getSimpleAddr :: ParseASN1 AltName
</span><a href="#local-6989586621679077326"><span class="hs-identifier hs-var hs-var">getSimpleAddr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>            </span><span id="local-6989586621679077249"><span class="annot"><span class="annottext">ASN1
</span><a href="#local-6989586621679077249"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 ASN1
</span><span class="hs-identifier hs-var">getNext</span></span><span>
</span><span id="line-309"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ASN1
</span><a href="#local-6989586621679077249"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-310"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Other</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span id="local-6989586621679077248"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077248"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; AltName
</span><a href="Data.X509.Ext.html#AltNameRFC822"><span class="hs-identifier hs-var">AltNameRFC822</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">BC.unpack</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077248"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-311"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Other</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span id="local-6989586621679077246"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077246"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; AltName
</span><a href="Data.X509.Ext.html#AltNameDNS"><span class="hs-identifier hs-var">AltNameDNS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">BC.unpack</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077246"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-312"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Other</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span> </span><span id="local-6989586621679077245"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077245"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; AltName
</span><a href="Data.X509.Ext.html#AltNameURI"><span class="hs-identifier hs-var">AltNameURI</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">BC.unpack</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077245"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-313"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Other</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span id="local-6989586621679077244"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077244"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; AltName
</span><a href="Data.X509.Ext.html#AltNameIP"><span class="hs-identifier hs-var">AltNameIP</span></a></span><span>  </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077244"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-314"></span><span>                </span><span class="annot"><span class="annottext">ASN1
</span><span class="hs-identifier">_</span></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; ParseASN1 a
</span><span class="hs-identifier hs-var">throwParseError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GeneralNames: not coping with unknown stream &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ASN1
</span><a href="#local-6989586621679077249"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="annot"><a href="Data.X509.Ext.html#encodeGeneralNames"><span class="hs-identifier hs-type">encodeGeneralNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.X509.Ext.html#AltName"><span class="hs-identifier hs-type">AltName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASN1</span></span><span class="hs-special">]</span><span>
</span><span id="line-317"></span><span id="encodeGeneralNames"><span class="annot"><span class="annottext">encodeGeneralNames :: [AltName] -&gt; [ASN1]
</span><a href="Data.X509.Ext.html#encodeGeneralNames"><span class="hs-identifier hs-var hs-var">encodeGeneralNames</span></a></span></span><span> </span><span id="local-6989586621679077243"><span class="annot"><span class="annottext">[AltName]
</span><a href="#local-6989586621679077243"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">Start</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">]</span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">AltName -&gt; [ASN1]
</span><a href="#local-6989586621679077241"><span class="hs-identifier hs-var">encodeAltName</span></a></span><span> </span><span class="annot"><span class="annottext">[AltName]
</span><a href="#local-6989586621679077243"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">End</span></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span class="hs-special">]</span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679077241"><span class="annot"><span class="annottext">encodeAltName :: AltName -&gt; [ASN1]
</span><a href="#local-6989586621679077241"><span class="hs-identifier hs-var hs-var">encodeAltName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.Ext.html#AltNameRFC822"><span class="hs-identifier hs-type">AltNameRFC822</span></a></span><span> </span><span id="local-6989586621679077240"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077240"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ByteString -&gt; ASN1
</span><span class="hs-identifier hs-var">Other</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">BC.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077240"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-322"></span><span>        </span><span class="annot"><a href="#local-6989586621679077241"><span class="hs-identifier hs-var">encodeAltName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.Ext.html#AltNameDNS"><span class="hs-identifier hs-type">AltNameDNS</span></a></span><span> </span><span id="local-6989586621679077238"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077238"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ByteString -&gt; ASN1
</span><span class="hs-identifier hs-var">Other</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">BC.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077238"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-323"></span><span>        </span><span class="annot"><a href="#local-6989586621679077241"><span class="hs-identifier hs-var">encodeAltName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.Ext.html#AltNameURI"><span class="hs-identifier hs-type">AltNameURI</span></a></span><span> </span><span id="local-6989586621679077237"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077237"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ByteString -&gt; ASN1
</span><span class="hs-identifier hs-var">Other</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">BC.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077237"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-324"></span><span>        </span><span class="annot"><a href="#local-6989586621679077241"><span class="hs-identifier hs-var">encodeAltName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.Ext.html#AltNameIP"><span class="hs-identifier hs-type">AltNameIP</span></a></span><span> </span><span id="local-6989586621679077236"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077236"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ByteString -&gt; ASN1
</span><span class="hs-identifier hs-var">Other</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077236"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-325"></span><span>        </span><span class="annot"><a href="#local-6989586621679077241"><span class="hs-identifier hs-var">encodeAltName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.Ext.html#AltNameXMPP"><span class="hs-identifier hs-type">AltNameXMPP</span></a></span><span> </span><span id="local-6989586621679077235"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077235"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">Start</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">OID -&gt; ASN1
</span><span class="hs-identifier hs-var">OID</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">6</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">7</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">]</span><span>
</span><span id="line-326"></span><span>                                          </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">Start</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ASN1CharacterString -&gt; ASN1
</span><span class="hs-identifier hs-var">ASN1String</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ASN1StringEncoding -&gt; String -&gt; ASN1CharacterString
</span><span class="hs-identifier hs-var">asn1CharacterString</span></span><span> </span><span class="annot"><span class="annottext">ASN1StringEncoding
</span><span class="hs-identifier hs-var">UTF8</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077235"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">End</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>                                          </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">End</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-328"></span><span>        </span><span class="annot"><a href="#local-6989586621679077241"><span class="hs-identifier hs-var">encodeAltName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.Ext.html#AltNameDNSSRV"><span class="hs-identifier hs-type">AltNameDNSSRV</span></a></span><span> </span><span id="local-6989586621679077232"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077232"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">Start</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">OID -&gt; ASN1
</span><span class="hs-identifier hs-var">OID</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">6</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">7</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5</span></span><span class="hs-special">]</span><span>
</span><span id="line-329"></span><span>                                          </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">Start</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ASN1CharacterString -&gt; ASN1
</span><span class="hs-identifier hs-var">ASN1String</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ASN1StringEncoding -&gt; String -&gt; ASN1CharacterString
</span><span class="hs-identifier hs-var">asn1CharacterString</span></span><span> </span><span class="annot"><span class="annottext">ASN1StringEncoding
</span><span class="hs-identifier hs-var">UTF8</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077232"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">End</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>                                          </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1
</span><span class="hs-identifier hs-var">End</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span id="local-6989586621679078187"><span class="annot"><a href="Data.X509.Ext.html#bitsToFlags"><span class="hs-identifier hs-type">bitsToFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="#local-6989586621679078187"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BitArray</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679078187"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-333"></span><span id="bitsToFlags"><span class="annot"><span class="annottext">bitsToFlags :: forall a. Enum a =&gt; BitArray -&gt; [a]
</span><a href="Data.X509.Ext.html#bitsToFlags"><span class="hs-identifier hs-var hs-var">bitsToFlags</span></a></span></span><span> </span><span id="local-6989586621679077219"><span class="annot"><span class="annottext">BitArray
</span><a href="#local-6989586621679077219"><span class="hs-identifier hs-var">bits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BitArray -&gt; Word64
</span><span class="hs-identifier hs-var">bitArrayLength</span></span><span> </span><span class="annot"><span class="annottext">BitArray
</span><a href="#local-6989586621679077219"><span class="hs-identifier hs-var">bits</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679077216"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679077216"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-334"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077215"><span class="annot"><span class="annottext">isSet :: Bool
</span><a href="#local-6989586621679077215"><span class="hs-identifier hs-var hs-var">isSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BitArray -&gt; Word64 -&gt; Bool
</span><span class="hs-identifier hs-var">bitArrayGetBit</span></span><span> </span><span class="annot"><span class="annottext">BitArray
</span><a href="#local-6989586621679077219"><span class="hs-identifier hs-var">bits</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679077216"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-335"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077215"><span class="hs-identifier hs-var">isSet</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679077216"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span id="local-6989586621679078188"><span class="annot"><a href="Data.X509.Ext.html#flagsToBits"><span class="hs-identifier hs-type">flagsToBits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="#local-6989586621679078188"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679078188"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BitArray</span></span></span><span>
</span><span id="line-338"></span><span id="flagsToBits"><span class="annot"><span class="annottext">flagsToBits :: forall a. Enum a =&gt; [a] -&gt; BitArray
</span><a href="Data.X509.Ext.html#flagsToBits"><span class="hs-identifier hs-var hs-var">flagsToBits</span></a></span></span><span> </span><span id="local-6989586621679077206"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679077206"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">BitArray -&gt; Word64 -&gt; BitArray
</span><span class="hs-identifier hs-var">bitArraySetBit</span></span><span> </span><span class="annot"><span class="annottext">BitArray
</span><a href="#local-6989586621679077203"><span class="hs-identifier hs-var">bitArrayEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679077206"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679077203"><span class="annot"><span class="annottext">bitArrayEmpty :: BitArray
</span><a href="#local-6989586621679077203"><span class="hs-identifier hs-var hs-var">bitArrayEmpty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; BitArray
</span><span class="hs-identifier hs-var">toBitArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.pack</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-keyword">data</span><span> </span><span id="ExtNetscapeComment"><span class="annot"><a href="Data.X509.Ext.html#ExtNetscapeComment"><span class="hs-identifier hs-var">ExtNetscapeComment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ExtNetscapeComment"><span class="annot"><a href="Data.X509.Ext.html#ExtNetscapeComment"><span class="hs-identifier hs-var">ExtNetscapeComment</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077188"><span id="local-6989586621679077190"><span id="local-6989586621679077194"><span class="annot"><span class="annottext">Int -&gt; ExtNetscapeComment -&gt; ShowS
[ExtNetscapeComment] -&gt; ShowS
ExtNetscapeComment -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ExtNetscapeComment] -&gt; ShowS
$cshowList :: [ExtNetscapeComment] -&gt; ShowS
show :: ExtNetscapeComment -&gt; String
$cshow :: ExtNetscapeComment -&gt; String
showsPrec :: Int -&gt; ExtNetscapeComment -&gt; ShowS
$cshowsPrec :: Int -&gt; ExtNetscapeComment -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679077183"><span id="local-6989586621679077186"><span class="annot"><span class="annottext">ExtNetscapeComment -&gt; ExtNetscapeComment -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ExtNetscapeComment -&gt; ExtNetscapeComment -&gt; Bool
$c/= :: ExtNetscapeComment -&gt; ExtNetscapeComment -&gt; Bool
== :: ExtNetscapeComment -&gt; ExtNetscapeComment -&gt; Bool
$c== :: ExtNetscapeComment -&gt; ExtNetscapeComment -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.X509.Ext.html#Extension"><span class="hs-identifier hs-type">Extension</span></a></span><span> </span><span class="annot"><a href="Data.X509.Ext.html#ExtNetscapeComment"><span class="hs-identifier hs-type">ExtNetscapeComment</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-345"></span><span>    </span><span id="local-6989586621679077175"><span class="annot"><span class="annottext">extOID :: ExtNetscapeComment -&gt; OID
</span><a href="#local-6989586621679077175"><span class="hs-identifier hs-var hs-var hs-var hs-var">extOID</span></a></span></span><span> </span><span class="annot"><span class="annottext">ExtNetscapeComment
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">16</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">840</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">113730</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">13</span></span><span class="hs-special">]</span><span>
</span><span id="line-346"></span><span>    </span><span id="local-6989586621679077174"><span class="annot"><span class="annottext">extHasNestedASN1 :: Proxy ExtNetscapeComment -&gt; Bool
</span><a href="#local-6989586621679077174"><span class="hs-identifier hs-var hs-var hs-var hs-var">extHasNestedASN1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-347"></span><span>    </span><span id="local-6989586621679077171"><span class="annot"><span class="annottext">extEncode :: ExtNetscapeComment -&gt; [ASN1]
</span><a href="#local-6989586621679077171"><span class="hs-identifier hs-var hs-var hs-var hs-var">extEncode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Extension: Netscape Comment do not contain nested ASN1&quot;</span></span><span>
</span><span id="line-348"></span><span>    </span><span id="local-6989586621679077168"><span class="annot"><span class="annottext">extDecode :: [ASN1] -&gt; Either String ExtNetscapeComment
</span><a href="#local-6989586621679077168"><span class="hs-identifier hs-var hs-var hs-var hs-var">extDecode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Extension: Netscape Comment do not contain nested ASN1&quot;</span></span><span>
</span><span id="line-349"></span><span>    </span><span id="local-6989586621679077167"><span class="annot"><span class="annottext">extEncodeBs :: ExtNetscapeComment -&gt; ByteString
</span><a href="#local-6989586621679077167"><span class="hs-identifier hs-var hs-var hs-var hs-var">extEncodeBs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.Ext.html#ExtNetscapeComment"><span class="hs-identifier hs-type">ExtNetscapeComment</span></a></span><span> </span><span id="local-6989586621679077166"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077166"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679077166"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span id="local-6989586621679077165"><span class="annot"><span class="annottext">extDecodeBs :: ByteString -&gt; Either String ExtNetscapeComment
</span><a href="#local-6989586621679077165"><span class="hs-identifier hs-var hs-var hs-var hs-var">extDecodeBs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ExtNetscapeComment
</span><a href="Data.X509.Ext.html#ExtNetscapeComment"><span class="hs-identifier hs-var">ExtNetscapeComment</span></a></span><span>
</span><span id="line-351"></span></pre></body></html>