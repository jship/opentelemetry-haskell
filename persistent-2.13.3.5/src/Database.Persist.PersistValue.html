<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">-- | This module contains an intermediate representation of values before the</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- backends serialize them into explicit database types.</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- @since 2.13.0.0</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database.Persist.PersistValue</span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistValue"><span class="hs-identifier">PersistValue</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistLiteral"><span class="hs-identifier">PersistLiteral</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistLiteralEscaped"><span class="hs-identifier">PersistLiteralEscaped</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistDbSpecific"><span class="hs-identifier">PersistDbSpecific</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier">fromPersistValueText</span></a></span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#LiteralType"><span class="hs-identifier">LiteralType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Base64</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B64</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TE</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS8</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Scientific</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding.Error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lenientDecode</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">shiftL</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">shiftR</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readHex</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">showHex</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Day</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TimeOfDay</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UTCTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Web.PathPieces</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PathPiece</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span class="hs-cpp">

#if MIN_VERSION_aeson(2,0,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Key</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">K</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.KeyMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AM</span></span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.HashMap.Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">AM</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Web.HttpApiData</span></span><span>
</span><span id="line-39"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">FromHttpApiData</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToHttpApiData</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parseUrlPieceMaybe</span></span><span>
</span><span id="line-42"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">readTextData</span></span><span>
</span><span id="line-43"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">-- | A raw value which can be stored in any backend and can be marshalled to</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- and from a 'PersistField'.</span><span>
</span><span id="line-47"></span><span class="hs-keyword">data</span><span> </span><span id="PersistValue"><span class="annot"><a href="Database.Persist.PersistValue.html#PersistValue"><span class="hs-identifier hs-var">PersistValue</span></a></span></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="PersistText"><span class="annot"><a href="Database.Persist.PersistValue.html#PersistText"><span class="hs-identifier hs-var">PersistText</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PersistByteString"><span class="annot"><a href="Database.Persist.PersistValue.html#PersistByteString"><span class="hs-identifier hs-var">PersistByteString</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PersistInt64"><span class="annot"><a href="Database.Persist.PersistValue.html#PersistInt64"><span class="hs-identifier hs-var">PersistInt64</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PersistDouble"><span class="annot"><a href="Database.Persist.PersistValue.html#PersistDouble"><span class="hs-identifier hs-var">PersistDouble</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PersistRational"><span class="annot"><a href="Database.Persist.PersistValue.html#PersistRational"><span class="hs-identifier hs-var">PersistRational</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PersistBool"><span class="annot"><a href="Database.Persist.PersistValue.html#PersistBool"><span class="hs-identifier hs-var">PersistBool</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PersistDay"><span class="annot"><a href="Database.Persist.PersistValue.html#PersistDay"><span class="hs-identifier hs-var">PersistDay</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PersistTimeOfDay"><span class="annot"><a href="Database.Persist.PersistValue.html#PersistTimeOfDay"><span class="hs-identifier hs-var">PersistTimeOfDay</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TimeOfDay</span></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PersistUTCTime"><span class="annot"><a href="Database.Persist.PersistValue.html#PersistUTCTime"><span class="hs-identifier hs-var">PersistUTCTime</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PersistNull"><span class="annot"><a href="Database.Persist.PersistValue.html#PersistNull"><span class="hs-identifier hs-var">PersistNull</span></a></span></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PersistList"><span class="annot"><a href="Database.Persist.PersistValue.html#PersistList"><span class="hs-identifier hs-var">PersistList</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistValue"><span class="hs-identifier hs-type">PersistValue</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PersistMap"><span class="annot"><a href="Database.Persist.PersistValue.html#PersistMap"><span class="hs-identifier hs-var">PersistMap</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistValue"><span class="hs-identifier hs-type">PersistValue</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PersistObjectId"><span class="annot"><a href="Database.Persist.PersistValue.html#PersistObjectId"><span class="hs-identifier hs-var">PersistObjectId</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-comment">-- ^ Intended especially for MongoDB backend</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PersistArray"><span class="annot"><a href="Database.Persist.PersistValue.html#PersistArray"><span class="hs-identifier hs-var">PersistArray</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistValue"><span class="hs-identifier hs-type">PersistValue</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-comment">-- ^ Intended especially for PostgreSQL backend for text arrays</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PersistLiteral_"><span class="annot"><a href="Database.Persist.PersistValue.html#PersistLiteral_"><span class="hs-identifier hs-var">PersistLiteral_</span></a></span></span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#LiteralType"><span class="hs-identifier hs-type">LiteralType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-comment">-- ^ This constructor is used to specify some raw literal value for the</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-comment">-- backend. The 'LiteralType' value specifies how the value should be</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-comment">-- escaped. This can be used to make special, custom types avaialable</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-comment">-- in the back end.</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-comment">-- @since 2.12.0.0</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679923457"><span id="local-6989586621679923459"><span id="local-6989586621679923496"><span class="annot"><span class="annottext">Int -&gt; PersistValue -&gt; ShowS
[PersistValue] -&gt; ShowS
PersistValue -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PersistValue] -&gt; ShowS
$cshowList :: [PersistValue] -&gt; ShowS
show :: PersistValue -&gt; String
$cshow :: PersistValue -&gt; String
showsPrec :: Int -&gt; PersistValue -&gt; ShowS
$cshowsPrec :: Int -&gt; PersistValue -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679923371"><span id="local-6989586621679923448"><span id="local-6989586621679923451"><span id="local-6989586621679923453"><span class="annot"><span class="annottext">ReadPrec [PersistValue]
ReadPrec PersistValue
Int -&gt; ReadS PersistValue
ReadS [PersistValue]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [PersistValue]
$creadListPrec :: ReadPrec [PersistValue]
readPrec :: ReadPrec PersistValue
$creadPrec :: ReadPrec PersistValue
readList :: ReadS [PersistValue]
$creadList :: ReadS [PersistValue]
readsPrec :: Int -&gt; ReadS PersistValue
$creadsPrec :: Int -&gt; ReadS PersistValue
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679923334"><span id="local-6989586621679923364"><span class="annot"><span class="annottext">PersistValue -&gt; PersistValue -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PersistValue -&gt; PersistValue -&gt; Bool
$c/= :: PersistValue -&gt; PersistValue -&gt; Bool
== :: PersistValue -&gt; PersistValue -&gt; Bool
$c== :: PersistValue -&gt; PersistValue -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679923287"><span id="local-6989586621679923289"><span id="local-6989586621679923291"><span id="local-6989586621679923293"><span id="local-6989586621679923295"><span id="local-6989586621679923297"><span id="local-6989586621679923327"><span class="annot"><span class="annottext">Eq PersistValue
PersistValue -&gt; PersistValue -&gt; Bool
PersistValue -&gt; PersistValue -&gt; Ordering
PersistValue -&gt; PersistValue -&gt; PersistValue
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: PersistValue -&gt; PersistValue -&gt; PersistValue
$cmin :: PersistValue -&gt; PersistValue -&gt; PersistValue
max :: PersistValue -&gt; PersistValue -&gt; PersistValue
$cmax :: PersistValue -&gt; PersistValue -&gt; PersistValue
&gt;= :: PersistValue -&gt; PersistValue -&gt; Bool
$c&gt;= :: PersistValue -&gt; PersistValue -&gt; Bool
&gt; :: PersistValue -&gt; PersistValue -&gt; Bool
$c&gt; :: PersistValue -&gt; PersistValue -&gt; Bool
&lt;= :: PersistValue -&gt; PersistValue -&gt; Bool
$c&lt;= :: PersistValue -&gt; PersistValue -&gt; Bool
&lt; :: PersistValue -&gt; PersistValue -&gt; Bool
$c&lt; :: PersistValue -&gt; PersistValue -&gt; Bool
compare :: PersistValue -&gt; PersistValue -&gt; Ordering
$ccompare :: PersistValue -&gt; PersistValue -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- | A type that determines how a backend should handle the literal.</span><span>
</span><span id="line-74"></span><span class="hs-comment">--</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- @since 2.12.0.0</span><span>
</span><span id="line-76"></span><span class="hs-keyword">data</span><span> </span><span id="LiteralType"><span class="annot"><a href="Database.Persist.PersistValue.html#LiteralType"><span class="hs-identifier hs-var">LiteralType</span></a></span></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="Escaped"><span class="annot"><a href="Database.Persist.PersistValue.html#Escaped"><span class="hs-identifier hs-var">Escaped</span></a></span></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-comment">-- ^ The accompanying value will be escaped before inserting into the</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-comment">-- database. This is the correct default choice to use.</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-comment">-- @since 2.12.0.0</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Unescaped"><span class="annot"><a href="Database.Persist.PersistValue.html#Unescaped"><span class="hs-identifier hs-var">Unescaped</span></a></span></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-comment">-- ^ The accompanying value will not be escaped when inserting into the</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-comment">-- database. This is potentially dangerous - use this with care.</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-comment">-- @since 2.12.0.0</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="DbSpecific"><span class="annot"><a href="Database.Persist.PersistValue.html#DbSpecific"><span class="hs-identifier hs-var">DbSpecific</span></a></span></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-comment">-- ^ The 'DbSpecific' constructor corresponds to the legacy</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-comment">-- 'PersistDbSpecific' constructor. We need to keep this around because</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-comment">-- old databases may have serialized JSON representations that</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-comment">-- reference this. We don't want to break the ability of a database to</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-comment">-- load rows.</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-comment">-- @since 2.12.0.0</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679923276"><span id="local-6989586621679923278"><span id="local-6989586621679923280"><span class="annot"><span class="annottext">Int -&gt; LiteralType -&gt; ShowS
[LiteralType] -&gt; ShowS
LiteralType -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [LiteralType] -&gt; ShowS
$cshowList :: [LiteralType] -&gt; ShowS
show :: LiteralType -&gt; String
$cshow :: LiteralType -&gt; String
showsPrec :: Int -&gt; LiteralType -&gt; ShowS
$cshowsPrec :: Int -&gt; LiteralType -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679923264"><span id="local-6989586621679923269"><span id="local-6989586621679923272"><span id="local-6989586621679923274"><span class="annot"><span class="annottext">ReadPrec [LiteralType]
ReadPrec LiteralType
Int -&gt; ReadS LiteralType
ReadS [LiteralType]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [LiteralType]
$creadListPrec :: ReadPrec [LiteralType]
readPrec :: ReadPrec LiteralType
$creadPrec :: ReadPrec LiteralType
readList :: ReadS [LiteralType]
$creadList :: ReadS [LiteralType]
readsPrec :: Int -&gt; ReadS LiteralType
$creadsPrec :: Int -&gt; ReadS LiteralType
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679923259"><span id="local-6989586621679923261"><span class="annot"><span class="annottext">LiteralType -&gt; LiteralType -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: LiteralType -&gt; LiteralType -&gt; Bool
$c/= :: LiteralType -&gt; LiteralType -&gt; Bool
== :: LiteralType -&gt; LiteralType -&gt; Bool
$c== :: LiteralType -&gt; LiteralType -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679923240"><span id="local-6989586621679923242"><span id="local-6989586621679923245"><span id="local-6989586621679923248"><span id="local-6989586621679923251"><span id="local-6989586621679923253"><span id="local-6989586621679923255"><span class="annot"><span class="annottext">Eq LiteralType
LiteralType -&gt; LiteralType -&gt; Bool
LiteralType -&gt; LiteralType -&gt; Ordering
LiteralType -&gt; LiteralType -&gt; LiteralType
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: LiteralType -&gt; LiteralType -&gt; LiteralType
$cmin :: LiteralType -&gt; LiteralType -&gt; LiteralType
max :: LiteralType -&gt; LiteralType -&gt; LiteralType
$cmax :: LiteralType -&gt; LiteralType -&gt; LiteralType
&gt;= :: LiteralType -&gt; LiteralType -&gt; Bool
$c&gt;= :: LiteralType -&gt; LiteralType -&gt; Bool
&gt; :: LiteralType -&gt; LiteralType -&gt; Bool
$c&gt; :: LiteralType -&gt; LiteralType -&gt; Bool
&lt;= :: LiteralType -&gt; LiteralType -&gt; Bool
$c&lt;= :: LiteralType -&gt; LiteralType -&gt; Bool
&lt; :: LiteralType -&gt; LiteralType -&gt; Bool
$c&lt; :: LiteralType -&gt; LiteralType -&gt; Bool
compare :: LiteralType -&gt; LiteralType -&gt; Ordering
$ccompare :: LiteralType -&gt; LiteralType -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">-- | This pattern synonym used to be a data constructor for the</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- 'PersistValue' type. It was changed to be a pattern so that JSON-encoded</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- database values could be parsed into their corresponding values. You</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- should not use this, and instead prefer to pattern match on</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- `PersistLiteral_` directly.</span><span>
</span><span id="line-102"></span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- If you use this, it will overlap a patern match on the 'PersistLiteral_,</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- 'PersistLiteral', and 'PersistLiteralEscaped' patterns. If you need to</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- disambiguate between these constructors, pattern match on</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- 'PersistLiteral_' directly.</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- @since 2.12.0.0</span><span>
</span><span id="line-109"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistDbSpecific"><span class="hs-identifier hs-type">PersistDbSpecific</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistValue"><span class="hs-identifier hs-type">PersistValue</span></a></span><span>
</span><span id="line-110"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bPersistDbSpecific"><span id="%24mPersistDbSpecific"><span id="PersistDbSpecific"><span class="annot"><span class="annottext">$bPersistDbSpecific :: ByteString -&gt; PersistValue
$mPersistDbSpecific :: forall {r}. PersistValue -&gt; (ByteString -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="Database.Persist.PersistValue.html#%24bPersistDbSpecific"><span class="hs-identifier hs-var hs-var hs-var hs-var">PersistDbSpecific</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679923237"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistLiteral_"><span class="hs-identifier hs-type">PersistLiteral_</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679923237"><span class="annot"><a href="#local-6989586621679923237"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistDbSpecific"><span class="hs-identifier hs-var">PersistDbSpecific</span></a></span><span> </span><span id="local-6989586621679923236"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923236"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LiteralType -&gt; ByteString -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistLiteral_"><span class="hs-identifier hs-var">PersistLiteral_</span></a></span><span> </span><span class="annot"><span class="annottext">LiteralType
</span><a href="Database.Persist.PersistValue.html#DbSpecific"><span class="hs-identifier hs-var">DbSpecific</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923236"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | This pattern synonym used to be a data constructor on 'PersistValue',</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- but was changed into a catch-all pattern synonym to allow backwards</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- compatiblity with database types. See the documentation on</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- 'PersistDbSpecific' for more details.</span><span>
</span><span id="line-117"></span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- @since 2.12.0.0</span><span>
</span><span id="line-119"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistLiteralEscaped"><span class="hs-identifier hs-type">PersistLiteralEscaped</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistValue"><span class="hs-identifier hs-type">PersistValue</span></a></span><span>
</span><span id="line-120"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bPersistLiteralEscaped"><span id="%24mPersistLiteralEscaped"><span id="PersistLiteralEscaped"><span class="annot"><span class="annottext">$bPersistLiteralEscaped :: ByteString -&gt; PersistValue
$mPersistLiteralEscaped :: forall {r}. PersistValue -&gt; (ByteString -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="Database.Persist.PersistValue.html#%24bPersistLiteralEscaped"><span class="hs-identifier hs-var hs-var hs-var hs-var">PersistLiteralEscaped</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679923233"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistLiteral_"><span class="hs-identifier hs-type">PersistLiteral_</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679923233"><span class="annot"><a href="#local-6989586621679923233"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistLiteralEscaped"><span class="hs-identifier hs-var">PersistLiteralEscaped</span></a></span><span> </span><span id="local-6989586621679923232"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923232"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LiteralType -&gt; ByteString -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistLiteral_"><span class="hs-identifier hs-var">PersistLiteral_</span></a></span><span> </span><span class="annot"><span class="annottext">LiteralType
</span><a href="Database.Persist.PersistValue.html#Escaped"><span class="hs-identifier hs-var">Escaped</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923232"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">-- | This pattern synonym used to be a data constructor on 'PersistValue',</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- but was changed into a catch-all pattern synonym to allow backwards</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- compatiblity with database types. See the documentation on</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- 'PersistDbSpecific' for more details.</span><span>
</span><span id="line-127"></span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- @since 2.12.0.0</span><span>
</span><span id="line-129"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistLiteral"><span class="hs-identifier hs-type">PersistLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistValue"><span class="hs-identifier hs-type">PersistValue</span></a></span><span>
</span><span id="line-130"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bPersistLiteral"><span id="%24mPersistLiteral"><span id="PersistLiteral"><span class="annot"><span class="annottext">$bPersistLiteral :: ByteString -&gt; PersistValue
$mPersistLiteral :: forall {r}. PersistValue -&gt; (ByteString -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="Database.Persist.PersistValue.html#%24bPersistLiteral"><span class="hs-identifier hs-var hs-var hs-var hs-var">PersistLiteral</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679923229"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistLiteral_"><span class="hs-identifier hs-type">PersistLiteral_</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679923229"><span class="annot"><a href="#local-6989586621679923229"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistLiteral"><span class="hs-identifier hs-var">PersistLiteral</span></a></span><span> </span><span id="local-6989586621679923228"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923228"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LiteralType -&gt; ByteString -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistLiteral_"><span class="hs-identifier hs-var">PersistLiteral_</span></a></span><span> </span><span class="annot"><span class="annottext">LiteralType
</span><a href="Database.Persist.PersistValue.html#Unescaped"><span class="hs-identifier hs-var">Unescaped</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923228"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">PersistDbSpecific</span><span> </span><span class="hs-pragma">&quot;Deprecated since 2.11 because of inconsistent escaping behavior across backends. The Postgres backend escapes these values, while the MySQL backend does not. If you are using this, please switch to 'PersistLiteral_' and provide a relevant 'LiteralType' for your conversion.&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Database.Persist.PersistValue.html#keyToText"><span class="hs-identifier hs-type">keyToText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-136"></span><span class="annot"><a href="Database.Persist.PersistValue.html#keyFromText"><span class="hs-identifier hs-type">keyFromText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span class="hs-cpp">
#if MIN_VERSION_aeson(2,0,0)
</span><span class="hs-keyword">type</span><span> </span><span id="Key"><span class="annot"><a href="Database.Persist.PersistValue.html#Key"><span class="hs-identifier hs-var">Key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">K.Key</span></span><span>
</span><span id="line-139"></span><span id="keyToText"><span class="annot"><span class="annottext">keyToText :: Key -&gt; Text
</span><a href="Database.Persist.PersistValue.html#keyToText"><span class="hs-identifier hs-var hs-var">keyToText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Text
</span><span class="hs-identifier hs-var">K.toText</span></span><span>
</span><span id="line-140"></span><span id="keyFromText"><span class="annot"><span class="annottext">keyFromText :: Text -&gt; Key
</span><a href="Database.Persist.PersistValue.html#keyFromText"><span class="hs-identifier hs-var hs-var">keyFromText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Key
</span><span class="hs-identifier hs-var">K.fromText</span></span><span class="hs-cpp">
#else
</span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Key</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Text</span><span>
</span><span id="line-143"></span><span class="hs-identifier">keyToText</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">id</span><span>
</span><span id="line-144"></span><span class="hs-identifier">keyFromText</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">id</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-147"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679923216"><span id="local-6989586621679923218"><span id="local-6989586621679923220"><span class="annot"><span class="hs-identifier hs-type">ToHttpApiData</span></span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistValue"><span class="hs-identifier hs-type">PersistValue</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621679923212"><span class="annot"><span class="annottext">toUrlPiece :: PersistValue -&gt; Text
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toUrlPiece</span></span></span><span> </span><span id="local-6989586621679923210"><span class="annot"><span class="annottext">PersistValue
</span><a href="#local-6989586621679923210"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PersistValue -&gt; Either Text Text
</span><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-var">fromPersistValueText</span></a></span><span> </span><span class="annot"><span class="annottext">PersistValue
</span><a href="#local-6989586621679923210"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-150"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679923209"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679923209"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">Text.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679923209"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-151"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679923206"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679923206"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679923206"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679923201"><span id="local-6989586621679923203"><span class="annot"><span class="hs-identifier hs-type">FromHttpApiData</span></span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistValue"><span class="hs-identifier hs-type">PersistValue</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-154"></span><span>    </span><span id="local-6989586621679923189"><span class="annot"><span class="annottext">parseUrlPiece :: Text -&gt; Either Text PersistValue
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseUrlPiece</span></span></span><span> </span><span id="local-6989586621679923187"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679923187"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-155"></span><span>          </span><span class="annot"><span class="annottext">Int64 -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistInt64"><span class="hs-identifier hs-var">PersistInt64</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. FromHttpApiData a =&gt; Text -&gt; Either Text a
</span><span class="hs-identifier hs-var">parseUrlPiece</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679923187"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-156"></span><span>      </span><span class="annot"><span class="annottext">forall {a} {b}. Either a b -&gt; Either a b -&gt; Either a b
</span><a href="#local-6989586621679923185"><span class="hs-operator hs-var">&lt;!&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[PersistValue] -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistList"><span class="hs-identifier hs-var">PersistList</span></a></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Read a =&gt; Text -&gt; Either Text a
</span><span class="hs-identifier hs-var">readTextData</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679923187"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-157"></span><span>      </span><span class="annot"><span class="annottext">forall {a} {b}. Either a b -&gt; Either a b -&gt; Either a b
</span><a href="#local-6989586621679923185"><span class="hs-operator hs-var">&lt;!&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistText"><span class="hs-identifier hs-var">PersistText</span></a></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679923187"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-158"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>        </span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">3</span><span> </span><span class="annot"><a href="#local-6989586621679923185"><span class="hs-operator hs-type">&lt;!&gt;</span></a></span><span>
</span><span id="line-160"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679923185"><span class="annot"><span class="annottext">&lt;!&gt; :: Either a b -&gt; Either a b -&gt; Either a b
</span><a href="#local-6989586621679923185"><span class="hs-operator hs-var hs-var">&lt;!&gt;</span></a></span></span><span> </span><span id="local-6989586621679923184"><span class="annot"><span class="annottext">Either a b
</span><a href="#local-6989586621679923184"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either a b
</span><a href="#local-6989586621679923184"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-161"></span><span>        </span><span id="local-6989586621679923183"><span class="annot"><span class="annottext">Either a b
</span><a href="#local-6989586621679923183"><span class="hs-identifier hs-var">x</span></a></span></span><span>      </span><span class="annot"><a href="#local-6989586621679923185"><span class="hs-operator hs-var">&lt;!&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Either a b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either a b
</span><a href="#local-6989586621679923183"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PathPiece</span></span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistValue"><span class="hs-identifier hs-type">PersistValue</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679923177"><span class="annot"><span class="annottext">toPathPiece :: PersistValue -&gt; Text
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toPathPiece</span></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToHttpApiData a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">toUrlPiece</span></span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621679923174"><span class="annot"><span class="annottext">fromPathPiece :: Text -&gt; Maybe PersistValue
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromPathPiece</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. FromHttpApiData a =&gt; Text -&gt; Maybe a
</span><span class="hs-identifier hs-var">parseUrlPieceMaybe</span></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="annot"><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-type">fromPersistValueText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistValue"><span class="hs-identifier hs-type">PersistValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-168"></span><span id="fromPersistValueText"><span class="annot"><span class="annottext">fromPersistValueText :: PersistValue -&gt; Either Text Text
</span><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-var hs-var">fromPersistValueText</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistText"><span class="hs-identifier hs-type">PersistText</span></a></span><span> </span><span id="local-6989586621679923172"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679923172"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679923172"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-169"></span><span class="annot"><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-var">fromPersistValueText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistByteString"><span class="hs-identifier hs-type">PersistByteString</span></a></span><span> </span><span id="local-6989586621679923171"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923171"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OnDecodeError -&gt; ByteString -&gt; Text
</span><span class="hs-identifier hs-var">TE.decodeUtf8With</span></span><span> </span><span class="annot"><span class="annottext">OnDecodeError
</span><span class="hs-identifier hs-var">lenientDecode</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923171"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-171"></span><span class="annot"><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-var">fromPersistValueText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistInt64"><span class="hs-identifier hs-type">PersistInt64</span></a></span><span> </span><span id="local-6989586621679923169"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679923169"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679923169"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-172"></span><span class="annot"><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-var">fromPersistValueText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistDouble"><span class="hs-identifier hs-type">PersistDouble</span></a></span><span> </span><span id="local-6989586621679923166"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679923166"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679923166"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-var">fromPersistValueText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistRational"><span class="hs-identifier hs-type">PersistRational</span></a></span><span> </span><span id="local-6989586621679923165"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679923165"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679923165"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-174"></span><span class="annot"><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-var">fromPersistValueText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistDay"><span class="hs-identifier hs-type">PersistDay</span></a></span><span> </span><span id="local-6989586621679923164"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679923164"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679923164"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-175"></span><span class="annot"><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-var">fromPersistValueText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistTimeOfDay"><span class="hs-identifier hs-type">PersistTimeOfDay</span></a></span><span> </span><span id="local-6989586621679923163"><span class="annot"><span class="annottext">TimeOfDay
</span><a href="#local-6989586621679923163"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TimeOfDay
</span><a href="#local-6989586621679923163"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-var">fromPersistValueText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistUTCTime"><span class="hs-identifier hs-type">PersistUTCTime</span></a></span><span> </span><span id="local-6989586621679923162"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679923162"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679923162"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-177"></span><span class="annot"><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-var">fromPersistValueText</span></a></span><span> </span><span class="annot"><span class="annottext">PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistNull"><span class="hs-identifier hs-var">PersistNull</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Unexpected null&quot;</span></span><span>
</span><span id="line-178"></span><span class="annot"><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-var">fromPersistValueText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistBool"><span class="hs-identifier hs-type">PersistBool</span></a></span><span> </span><span id="local-6989586621679923161"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679923161"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679923161"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-179"></span><span class="annot"><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-var">fromPersistValueText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistList"><span class="hs-identifier hs-type">PersistList</span></a></span><span> </span><span class="annot"><span class="annottext">[PersistValue]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Cannot convert PersistList to Text&quot;</span></span><span>
</span><span id="line-180"></span><span class="annot"><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-var">fromPersistValueText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistMap"><span class="hs-identifier hs-type">PersistMap</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, PersistValue)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Cannot convert PersistMap to Text&quot;</span></span><span>
</span><span id="line-181"></span><span class="annot"><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-var">fromPersistValueText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistObjectId"><span class="hs-identifier hs-type">PersistObjectId</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Cannot convert PersistObjectId to Text&quot;</span></span><span>
</span><span id="line-182"></span><span class="annot"><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-var">fromPersistValueText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistArray"><span class="hs-identifier hs-type">PersistArray</span></a></span><span> </span><span class="annot"><span class="annottext">[PersistValue]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Cannot convert PersistArray to Text&quot;</span></span><span>
</span><span id="line-183"></span><span class="annot"><a href="Database.Persist.PersistValue.html#fromPersistValueText"><span class="hs-identifier hs-var">fromPersistValueText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistLiteral_"><span class="hs-identifier hs-type">PersistLiteral_</span></a></span><span> </span><span class="annot"><span class="annottext">LiteralType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Cannot convert PersistLiteral to Text&quot;</span></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679923154"><span id="local-6989586621679923156"><span id="local-6989586621679923158"><span class="annot"><span class="hs-identifier hs-type">A.ToJSON</span></span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistValue"><span class="hs-identifier hs-type">PersistValue</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621679923123"><span class="annot"><span class="annottext">toJSON :: PersistValue -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistText"><span class="hs-identifier hs-type">PersistText</span></a></span><span> </span><span id="local-6989586621679923121"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679923121"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">A.String</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">Text.cons</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'s'</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679923121"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistByteString"><span class="hs-identifier hs-type">PersistByteString</span></a></span><span> </span><span id="local-6989586621679923118"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923118"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">A.String</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">Text.cons</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'b'</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">TE.decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B64.encode</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923118"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistInt64"><span class="hs-identifier hs-type">PersistInt64</span></a></span><span> </span><span id="local-6989586621679923115"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679923115"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scientific -&gt; Value
</span><span class="hs-identifier hs-var">A.Number</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679923115"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistDouble"><span class="hs-identifier hs-type">PersistDouble</span></a></span><span> </span><span id="local-6989586621679923113"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679923113"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scientific -&gt; Value
</span><span class="hs-identifier hs-var">A.Number</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. RealFloat a =&gt; a -&gt; Scientific
</span><span class="hs-identifier hs-var">Data.Scientific.fromFloatDigits</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679923113"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistRational"><span class="hs-identifier hs-type">PersistRational</span></a></span><span> </span><span id="local-6989586621679923111"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679923111"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">A.String</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'r'</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679923111"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistBool"><span class="hs-identifier hs-type">PersistBool</span></a></span><span> </span><span id="local-6989586621679923110"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679923110"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Value
</span><span class="hs-identifier hs-var">A.Bool</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679923110"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistTimeOfDay"><span class="hs-identifier hs-type">PersistTimeOfDay</span></a></span><span> </span><span id="local-6989586621679923108"><span class="annot"><span class="annottext">TimeOfDay
</span><a href="#local-6989586621679923108"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">A.String</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'t'</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TimeOfDay
</span><a href="#local-6989586621679923108"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistUTCTime"><span class="hs-identifier hs-type">PersistUTCTime</span></a></span><span> </span><span id="local-6989586621679923107"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679923107"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">A.String</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'u'</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679923107"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistDay"><span class="hs-identifier hs-type">PersistDay</span></a></span><span> </span><span id="local-6989586621679923106"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679923106"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">A.String</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'d'</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679923106"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistNull"><span class="hs-identifier hs-var">PersistNull</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier hs-var">A.Null</span></span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistList"><span class="hs-identifier hs-type">PersistList</span></a></span><span> </span><span id="local-6989586621679923104"><span class="annot"><span class="annottext">[PersistValue]
</span><a href="#local-6989586621679923104"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array -&gt; Value
</span><span class="hs-identifier hs-var">A.Array</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">A.toJSON</span></span><span> </span><span class="annot"><span class="annottext">[PersistValue]
</span><a href="#local-6989586621679923104"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistMap"><span class="hs-identifier hs-type">PersistMap</span></a></span><span> </span><span id="local-6989586621679923101"><span class="annot"><span class="annottext">[(Text, PersistValue)]
</span><a href="#local-6989586621679923101"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">A.object</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall {a}. ToJSON a =&gt; (Text, a) -&gt; Pair
</span><a href="#local-6989586621679923099"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, PersistValue)]
</span><a href="#local-6989586621679923101"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679923099"><span class="annot"><span class="annottext">go :: (Text, a) -&gt; Pair
</span><a href="#local-6989586621679923099"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679923096"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679923096"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679923095"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679923095"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Key
</span><a href="Database.Persist.PersistValue.html#keyFromText"><span class="hs-identifier hs-var">keyFromText</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679923096"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">A.toJSON</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679923095"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistLiteral_"><span class="hs-identifier hs-type">PersistLiteral_</span></a></span><span> </span><span id="local-6989586621679923094"><span class="annot"><span class="annottext">LiteralType
</span><a href="#local-6989586621679923094"><span class="hs-identifier hs-var">litTy</span></a></span></span><span> </span><span id="local-6989586621679923093"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923093"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-200"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679923092"><span class="annot"><span class="annottext">encoded :: Text
</span><a href="#local-6989586621679923092"><span class="hs-identifier hs-var hs-var">encoded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">TE.decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B64.encode</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923093"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-201"></span><span>            </span><span id="local-6989586621679923091"><span class="annot"><span class="annottext">prefix :: Char
</span><a href="#local-6989586621679923091"><span class="hs-identifier hs-var hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LiteralType
</span><a href="#local-6989586621679923094"><span class="hs-identifier hs-var">litTy</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-203"></span><span>                    </span><span class="annot"><span class="annottext">LiteralType
</span><a href="Database.Persist.PersistValue.html#DbSpecific"><span class="hs-identifier hs-var">DbSpecific</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'p'</span></span><span>
</span><span id="line-204"></span><span>                    </span><span class="annot"><span class="annottext">LiteralType
</span><a href="Database.Persist.PersistValue.html#Unescaped"><span class="hs-identifier hs-var">Unescaped</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'l'</span></span><span>
</span><span id="line-205"></span><span>                    </span><span class="annot"><span class="annottext">LiteralType
</span><a href="Database.Persist.PersistValue.html#Escaped"><span class="hs-identifier hs-var">Escaped</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'e'</span></span><span>
</span><span id="line-206"></span><span>         </span><span class="hs-keyword">in</span><span>
</span><span id="line-207"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">A.String</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">Text.cons</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679923091"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679923092"><span class="hs-identifier hs-var">encoded</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistArray"><span class="hs-identifier hs-type">PersistArray</span></a></span><span> </span><span id="local-6989586621679923090"><span class="annot"><span class="annottext">[PersistValue]
</span><a href="#local-6989586621679923090"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array -&gt; Value
</span><span class="hs-identifier hs-var">A.Array</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">A.toJSON</span></span><span> </span><span class="annot"><span class="annottext">[PersistValue]
</span><a href="#local-6989586621679923090"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistObjectId"><span class="hs-identifier hs-type">PersistObjectId</span></a></span><span> </span><span id="local-6989586621679923089"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923089"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-210"></span><span>      </span><span class="annot"><span class="annottext">forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">A.toJSON</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'o'</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall n. (Show n, Integral n) =&gt; Int -&gt; n -&gt; ShowS
</span><a href="#local-6989586621679923087"><span class="hs-identifier hs-var">showHexLen</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Integer
</span><a href="#local-6989586621679923086"><span class="hs-identifier hs-var">bs2i</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923085"><span class="hs-identifier hs-var">four</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall n. (Show n, Integral n) =&gt; Int -&gt; n -&gt; ShowS
</span><a href="#local-6989586621679923087"><span class="hs-identifier hs-var">showHexLen</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Integer
</span><a href="#local-6989586621679923086"><span class="hs-identifier hs-var">bs2i</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923084"><span class="hs-identifier hs-var">eight</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-211"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-212"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621679923085"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923085"><span class="hs-identifier hs-var">four</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679923084"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923084"><span class="hs-identifier hs-var">eight</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">BS8.splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923089"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span>         </span><span class="hs-comment">-- taken from crypto-api</span><span>
</span><span id="line-215"></span><span>         </span><span class="annot"><a href="#local-6989586621679923086"><span class="hs-identifier hs-type">bs2i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-216"></span><span>         </span><span id="local-6989586621679923086"><span class="annot"><span class="annottext">bs2i :: ByteString -&gt; Integer
</span><a href="#local-6989586621679923086"><span class="hs-identifier hs-var hs-var">bs2i</span></a></span></span><span> </span><span id="local-6989586621679923082"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923082"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Word8 -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679923081"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679923081"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679923080"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679923080"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679923081"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679923080"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679923082"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-217"></span><span>         </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679923086"><span class="hs-pragma hs-type">bs2i</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>         </span><span class="hs-comment">-- showHex of n padded with leading zeros if necessary to fill d digits</span><span>
</span><span id="line-220"></span><span>         </span><span class="hs-comment">-- taken from Data.BSON</span><span>
</span><span id="line-221"></span><span>         </span><span id="local-6989586621679923634"><span class="annot"><a href="#local-6989586621679923087"><span class="hs-identifier hs-type">showHexLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679923634"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679923634"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679923634"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShowS</span></span></span><span>
</span><span id="line-222"></span><span>         </span><span id="local-6989586621679923087"><span class="annot"><span class="annottext">showHexLen :: forall n. (Show n, Integral n) =&gt; Int -&gt; n -&gt; ShowS
</span><a href="#local-6989586621679923087"><span class="hs-identifier hs-var hs-var">showHexLen</span></a></span></span><span> </span><span id="local-6989586621679923069"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679923069"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679923068"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679923068"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679923069"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {a}. (Integral a, Integral a) =&gt; a -&gt; a
</span><a href="#local-6989586621679923065"><span class="hs-identifier hs-var">sigDigits</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679923068"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (Integral a, Show a) =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showHex</span></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679923068"><span class="hs-identifier hs-var">n</span></a></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-223"></span><span>             </span><span id="local-6989586621679923065"><span class="annot"><span class="annottext">sigDigits :: a -&gt; a
</span><a href="#local-6989586621679923065"><span class="hs-identifier hs-var hs-var">sigDigits</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span>
</span><span id="line-224"></span><span>             </span><span class="annot"><a href="#local-6989586621679923065"><span class="hs-identifier hs-var">sigDigits</span></a></span><span> </span><span id="local-6989586621679923038"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679923038"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">truncate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">logBase</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679923038"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679923033"><span class="annot"><span class="hs-identifier hs-type">A.FromJSON</span></span><span> </span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistValue"><span class="hs-identifier hs-type">PersistValue</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-227"></span><span>    </span><span id="local-6989586621679922960"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser PersistValue
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.String</span></span><span> </span><span id="local-6989586621679922958"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922958"><span class="hs-identifier hs-var">t0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-228"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe (Char, Text)
</span><span class="hs-identifier hs-var">Text.uncons</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922958"><span class="hs-identifier hs-var">t0</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-229"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Char, Text)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Null string&quot;</span></span><span>
</span><span id="line-230"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'p'</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679922956"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922956"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid base64&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistDbSpecific"><span class="hs-identifier hs-var">PersistDbSpecific</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>                           </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String ByteString
</span><span class="hs-identifier hs-var">B64.decode</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">TE.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922956"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-232"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'l'</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679922952"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922952"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid base64&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistLiteral"><span class="hs-identifier hs-var">PersistLiteral</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>                           </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String ByteString
</span><span class="hs-identifier hs-var">B64.decode</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">TE.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922952"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-234"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'e'</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679922951"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922951"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid base64&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistLiteralEscaped"><span class="hs-identifier hs-var">PersistLiteralEscaped</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>                           </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String ByteString
</span><span class="hs-identifier hs-var">B64.decode</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">TE.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922951"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-236"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'s'</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679922950"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922950"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistText"><span class="hs-identifier hs-var">PersistText</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922950"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-237"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'b'</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679922949"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922949"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid base64&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistByteString"><span class="hs-identifier hs-var">PersistByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>                           </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String ByteString
</span><span class="hs-identifier hs-var">B64.decode</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">TE.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922949"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-239"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'t'</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679922948"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922948"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TimeOfDay -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistTimeOfDay"><span class="hs-identifier hs-var">PersistTimeOfDay</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {m :: * -&gt; *}. (Read a, MonadFail m) =&gt; Text -&gt; m a
</span><a href="#local-6989586621679922947"><span class="hs-identifier hs-var">readMay</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922948"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-240"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'u'</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679922946"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922946"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistUTCTime"><span class="hs-identifier hs-var">PersistUTCTime</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {m :: * -&gt; *}. (Read a, MonadFail m) =&gt; Text -&gt; m a
</span><a href="#local-6989586621679922947"><span class="hs-identifier hs-var">readMay</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922946"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-241"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'d'</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679922945"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922945"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Day -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistDay"><span class="hs-identifier hs-var">PersistDay</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {m :: * -&gt; *}. (Read a, MonadFail m) =&gt; Text -&gt; m a
</span><a href="#local-6989586621679922947"><span class="hs-identifier hs-var">readMay</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922945"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-242"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'r'</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679922944"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922944"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistRational"><span class="hs-identifier hs-var">PersistRational</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {m :: * -&gt; *}. (Read a, MonadFail m) =&gt; Text -&gt; m a
</span><a href="#local-6989586621679922947"><span class="hs-identifier hs-var">readMay</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922944"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-243"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'o'</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679922943"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922943"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span>
</span><span id="line-244"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid base64&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistObjectId"><span class="hs-identifier hs-var">PersistObjectId</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; ByteString
</span><a href="#local-6989586621679922941"><span class="hs-identifier hs-var">i2bs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>                </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {a}. [a] -&gt; Maybe a
</span><a href="#local-6989586621679922939"><span class="hs-identifier hs-var">headMay</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (Eq a, Num a) =&gt; ReadS a
</span><span class="hs-identifier hs-var">readHex</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">Text.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922943"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-247"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679922938"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679922938"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unknown prefix: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679922938"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-248"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-249"></span><span>        </span><span id="local-6989586621679922939"><span class="annot"><span class="annottext">headMay :: [a] -&gt; Maybe a
</span><a href="#local-6989586621679922939"><span class="hs-identifier hs-var hs-var">headMay</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-250"></span><span>        </span><span class="annot"><a href="#local-6989586621679922939"><span class="hs-identifier hs-var">headMay</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679922937"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679922937"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679922937"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-251"></span><span>        </span><span id="local-6989586621679922947"><span class="annot"><span class="annottext">readMay :: Text -&gt; m a
</span><a href="#local-6989586621679922947"><span class="hs-identifier hs-var hs-var">readMay</span></a></span></span><span> </span><span id="local-6989586621679922929"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922929"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-252"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. Read a =&gt; ReadS a
</span><span class="hs-identifier hs-var">reads</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">Text.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679922929"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-253"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679922927"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679922927"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(a, String)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679922927"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-254"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Could not read&quot;</span></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span>        </span><span class="hs-comment">-- taken from crypto-api</span><span>
</span><span id="line-257"></span><span>        </span><span class="hs-comment">-- |@i2bs bitLen i@ converts @i@ to a 'ByteString' of @bitLen@ bits (must be a multiple of 8).</span><span>
</span><span id="line-258"></span><span>        </span><span class="annot"><a href="#local-6989586621679922941"><span class="hs-identifier hs-type">i2bs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-259"></span><span>        </span><span id="local-6989586621679922941"><span class="annot"><span class="annottext">i2bs :: Int -&gt; Integer -&gt; ByteString
</span><a href="#local-6989586621679922941"><span class="hs-identifier hs-var hs-var">i2bs</span></a></span></span><span> </span><span id="local-6989586621679922926"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679922926"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679922925"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679922925"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Maybe (Word8, a)) -&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.unfoldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679922923"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679922923"><span class="hs-identifier hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679922923"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679922925"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679922923"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679922923"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679922926"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>        </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679922941"><span class="hs-pragma hs-type">i2bs</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.Number</span></span><span> </span><span id="local-6989586621679922921"><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679922921"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-264"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679922921"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679922921"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-265"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistInt64"><span class="hs-identifier hs-var">PersistInt64</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679922921"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-266"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistDouble"><span class="hs-identifier hs-var">PersistDouble</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679922921"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.Bool</span></span><span> </span><span id="local-6989586621679922919"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679922919"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistBool"><span class="hs-identifier hs-var">PersistBool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679922919"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier hs-var">A.Null</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistNull"><span class="hs-identifier hs-var">PersistNull</span></a></span><span>
</span><span id="line-269"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.Array</span></span><span> </span><span id="local-6989586621679922918"><span class="annot"><span class="annottext">Array
</span><a href="#local-6989586621679922918"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[PersistValue] -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistList"><span class="hs-identifier hs-var">PersistList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">A.parseJSON</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">Array
</span><a href="#local-6989586621679922918"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">A.Object</span></span><span> </span><span id="local-6989586621679922914"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679922914"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-271"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[(Text, PersistValue)] -&gt; PersistValue
</span><a href="Database.Persist.PersistValue.html#PersistMap"><span class="hs-identifier hs-var">PersistMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">forall {a}. FromJSON a =&gt; Pair -&gt; Parser (Text, a)
</span><a href="#local-6989586621679922913"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall v. KeyMap v -&gt; [(Key, v)]
</span><span class="hs-identifier hs-var">AM.toList</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679922914"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-272"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-273"></span><span>        </span><span id="local-6989586621679922913"><span class="annot"><span class="annottext">go :: Pair -&gt; Parser (Text, a)
</span><a href="#local-6989586621679922913"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679922908"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679922908"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679922907"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679922907"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; Text
</span><a href="Database.Persist.PersistValue.html#keyToText"><span class="hs-identifier hs-var">keyToText</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679922908"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">A.parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679922907"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span></pre></body></html>