<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | This module is the primary entry point if you're working with @persistent@</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- on a SQL database.</span><span>
</span><span id="line-3"></span><span class="hs-comment">--</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- = Getting Started</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- First, you'll want to define your database entities. You can do that with</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- &quot;Database.Persist.Quasi.&quot;</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Then, you'll use the operations</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database.Persist.Sql</span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><span class="hs-comment">-- * 'RawSql' and 'PersistFieldSql'</span></span><span>
</span><span id="line-13"></span><span>      </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Class.html"><span class="hs-identifier">Database.Persist.Sql.Class</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Running actions</span></span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Run actions in a transaction with 'runSqlPool'.</span></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Run.html"><span class="hs-identifier">Database.Persist.Sql.Run</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Migrations</span></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Migration.html"><span class="hs-identifier">Database.Persist.Sql.Migration</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><span class="hs-comment">-- * @persistent@ combinators</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-comment">-- | We re-export &quot;Database.Persist&quot; here, to make it easier to use query</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-comment">-- and update combinators. Check out that module for documentation.</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Database.Persist.html"><span class="hs-identifier">Database.Persist</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Orphan.PersistStore.html"><span class="hs-identifier">Database.Persist.Sql.Orphan.PersistStore</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><span class="hs-comment">-- * The Escape Hatch</span></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-comment">-- | @persistent@ offers a set of functions that are useful for operating</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-comment">-- directly on the underlying SQL database. This can allow you to use</span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-comment">-- whatever SQL features you want.</span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-comment">-- Consider going to &lt;https://hackage.haskell.org/package/esqueleto</span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-comment">-- esqueleto&gt; for a more powerful SQL query library built on @persistent@.</span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Raw.html#rawQuery"><span class="hs-identifier">rawQuery</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Raw.html#rawQueryRes"><span class="hs-identifier">rawQueryRes</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Raw.html#rawExecute"><span class="hs-identifier">rawExecute</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Raw.html#rawExecuteCount"><span class="hs-identifier">rawExecuteCount</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Raw.html#rawSql"><span class="hs-identifier">rawSql</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><span class="hs-comment">-- * SQL helpers</span></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Orphan.PersistQuery.html#deleteWhereCount"><span class="hs-identifier">deleteWhereCount</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Orphan.PersistQuery.html#updateWhereCount"><span class="hs-identifier">updateWhereCount</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Orphan.PersistQuery.html#filterClause"><span class="hs-identifier">filterClause</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Orphan.PersistQuery.html#filterClauseWithVals"><span class="hs-identifier">filterClauseWithVals</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Orphan.PersistQuery.html#orderClause"><span class="hs-identifier">orderClause</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Orphan.PersistQuery.html#FilterTablePrefix"><span class="hs-identifier">FilterTablePrefix</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Transactions</span></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.html#transactionSave"><span class="hs-identifier">transactionSave</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.html#transactionSaveWithIsolation"><span class="hs-identifier">transactionSaveWithIsolation</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.html#transactionUndo"><span class="hs-identifier">transactionUndo</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.html#transactionUndoWithIsolation"><span class="hs-identifier">transactionUndoWithIsolation</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Other utilities</span></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Raw.html#getStmtConn"><span class="hs-identifier">getStmtConn</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Internal.html#mkColumns"><span class="hs-identifier">mkColumns</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Internal.html#BackendSpecificOverrides"><span class="hs-identifier">BackendSpecificOverrides</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Internal.html#emptyBackendSpecificOverrides"><span class="hs-identifier">emptyBackendSpecificOverrides</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Internal.html#getBackendSpecificForeignKeyName"><span class="hs-identifier">getBackendSpecificForeignKeyName</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Internal.html#setBackendSpecificForeignKeyName"><span class="hs-identifier">setBackendSpecificForeignKeyName</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Internal.html#defaultAttribute"><span class="hs-identifier">defaultAttribute</span></a></span><span>
</span><span id="line-56"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Internal</span></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.IsolationLevel.html#IsolationLevel"><span class="hs-identifier">IsolationLevel</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Orphan.PersistQuery.html#decorateSQLWithLimitOffset"><span class="hs-identifier">decorateSQLWithLimitOffset</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Types.html"><span class="hs-identifier">Database.Persist.Sql.Types</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ask</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.html"><span class="hs-identifier">Database.Persist</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Class.html"><span class="hs-identifier">Database.Persist.Sql.Class</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Internal.html"><span class="hs-identifier">Database.Persist.Sql.Internal</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Migration.html"><span class="hs-identifier">Database.Persist.Sql.Migration</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Raw.html"><span class="hs-identifier">Database.Persist.Sql.Raw</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Run.html"><span class="hs-identifier">Database.Persist.Sql.Run</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.Sql.Run.html#rawAcquireSqlConn"><span class="hs-identifier">rawAcquireSqlConn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Run.html#rawRunSqlPool"><span class="hs-identifier">rawRunSqlPool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Types.html"><span class="hs-identifier">Database.Persist.Sql.Types</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Types.Internal.html"><span class="hs-identifier">Database.Persist.Sql.Types.Internal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.IsolationLevel.html#IsolationLevel"><span class="hs-identifier">IsolationLevel</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackend"><span class="hs-identifier">SqlBackend</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Orphan.PersistQuery.html"><span class="hs-identifier">Database.Persist.Sql.Orphan.PersistQuery</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Orphan.PersistStore.html"><span class="hs-identifier">Database.Persist.Sql.Orphan.PersistStore</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.Sql.Orphan.PersistUnique.html"><span class="hs-identifier">Database.Persist.Sql.Orphan.PersistUnique</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | Commit the current transaction and begin a new one.</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- This is used when a transaction commit is required within the context of 'runSqlConn'</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- (which brackets its provided action with a transaction begin/commit pair).</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- @since 1.2.0</span><span>
</span><span id="line-83"></span><span id="local-6989586621679963909"><span class="annot"><a href="Database.Persist.Sql.html#transactionSave"><span class="hs-identifier hs-type">transactionSave</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679963909"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackend"><span class="hs-identifier hs-type">SqlBackend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679963909"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-84"></span><span id="transactionSave"><span class="annot"><span class="annottext">transactionSave :: forall (m :: * -&gt; *). MonadIO m =&gt; ReaderT SqlBackend m ()
</span><a href="Database.Persist.Sql.html#transactionSave"><span class="hs-identifier hs-var hs-var">transactionSave</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621679963846"><span class="annot"><span class="annottext">SqlBackend
</span><a href="#local-6989586621679963846"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r. Monad m =&gt; ReaderT r m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679963845"><span class="annot"><span class="annottext">getter :: Text -&gt; IO Statement
</span><a href="#local-6989586621679963845"><span class="hs-identifier hs-var hs-var">getter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlBackend -&gt; Text -&gt; IO Statement
</span><a href="Database.Persist.Sql.Raw.html#getStmtConn"><span class="hs-identifier hs-var">getStmtConn</span></a></span><span> </span><span class="annot"><span class="annottext">SqlBackend
</span><a href="#local-6989586621679963846"><span class="hs-identifier hs-var">conn</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SqlBackend -&gt; (Text -&gt; IO Statement) -&gt; IO ()
</span><a href="Database.Persist.SqlBackend.Internal.html#connCommit"><span class="hs-identifier hs-var">connCommit</span></a></span><span> </span><span class="annot"><span class="annottext">SqlBackend
</span><a href="#local-6989586621679963846"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; IO Statement
</span><a href="#local-6989586621679963845"><span class="hs-identifier hs-var">getter</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SqlBackend
-&gt; (Text -&gt; IO Statement) -&gt; Maybe IsolationLevel -&gt; IO ()
</span><a href="Database.Persist.SqlBackend.Internal.html#connBegin"><span class="hs-identifier hs-var">connBegin</span></a></span><span> </span><span class="annot"><span class="annottext">SqlBackend
</span><a href="#local-6989586621679963846"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; IO Statement
</span><a href="#local-6989586621679963845"><span class="hs-identifier hs-var">getter</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | Commit the current transaction and begin a new one with the specified isolation level.</span><span>
</span><span id="line-90"></span><span class="hs-comment">--</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- @since 2.9.0</span><span>
</span><span id="line-92"></span><span id="local-6989586621679963886"><span class="annot"><a href="Database.Persist.Sql.html#transactionSaveWithIsolation"><span class="hs-identifier hs-type">transactionSaveWithIsolation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679963886"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.IsolationLevel.html#IsolationLevel"><span class="hs-identifier hs-type">IsolationLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackend"><span class="hs-identifier hs-type">SqlBackend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679963886"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-93"></span><span id="transactionSaveWithIsolation"><span class="annot"><span class="annottext">transactionSaveWithIsolation :: forall (m :: * -&gt; *).
MonadIO m =&gt;
IsolationLevel -&gt; ReaderT SqlBackend m ()
</span><a href="Database.Persist.Sql.html#transactionSaveWithIsolation"><span class="hs-identifier hs-var hs-var">transactionSaveWithIsolation</span></a></span></span><span> </span><span id="local-6989586621679963835"><span class="annot"><span class="annottext">IsolationLevel
</span><a href="#local-6989586621679963835"><span class="hs-identifier hs-var">isolation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621679963834"><span class="annot"><span class="annottext">SqlBackend
</span><a href="#local-6989586621679963834"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r. Monad m =&gt; ReaderT r m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679963833"><span class="annot"><span class="annottext">getter :: Text -&gt; IO Statement
</span><a href="#local-6989586621679963833"><span class="hs-identifier hs-var hs-var">getter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlBackend -&gt; Text -&gt; IO Statement
</span><a href="Database.Persist.Sql.Raw.html#getStmtConn"><span class="hs-identifier hs-var">getStmtConn</span></a></span><span> </span><span class="annot"><span class="annottext">SqlBackend
</span><a href="#local-6989586621679963834"><span class="hs-identifier hs-var">conn</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SqlBackend -&gt; (Text -&gt; IO Statement) -&gt; IO ()
</span><a href="Database.Persist.SqlBackend.Internal.html#connCommit"><span class="hs-identifier hs-var">connCommit</span></a></span><span> </span><span class="annot"><span class="annottext">SqlBackend
</span><a href="#local-6989586621679963834"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; IO Statement
</span><a href="#local-6989586621679963833"><span class="hs-identifier hs-var">getter</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SqlBackend
-&gt; (Text -&gt; IO Statement) -&gt; Maybe IsolationLevel -&gt; IO ()
</span><a href="Database.Persist.SqlBackend.Internal.html#connBegin"><span class="hs-identifier hs-var">connBegin</span></a></span><span> </span><span class="annot"><span class="annottext">SqlBackend
</span><a href="#local-6989586621679963834"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; IO Statement
</span><a href="#local-6989586621679963833"><span class="hs-identifier hs-var">getter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">IsolationLevel
</span><a href="#local-6989586621679963835"><span class="hs-identifier hs-var">isolation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | Roll back the current transaction and begin a new one.</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- This rolls back to the state of the last call to 'transactionSave' or the enclosing</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- 'runSqlConn' call.</span><span>
</span><span id="line-101"></span><span class="hs-comment">--</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- @since 1.2.0</span><span>
</span><span id="line-103"></span><span id="local-6989586621679963832"><span class="annot"><a href="Database.Persist.Sql.html#transactionUndo"><span class="hs-identifier hs-type">transactionUndo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679963832"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackend"><span class="hs-identifier hs-type">SqlBackend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679963832"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-104"></span><span id="transactionUndo"><span class="annot"><span class="annottext">transactionUndo :: forall (m :: * -&gt; *). MonadIO m =&gt; ReaderT SqlBackend m ()
</span><a href="Database.Persist.Sql.html#transactionUndo"><span class="hs-identifier hs-var hs-var">transactionUndo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621679963825"><span class="annot"><span class="annottext">SqlBackend
</span><a href="#local-6989586621679963825"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r. Monad m =&gt; ReaderT r m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679963824"><span class="annot"><span class="annottext">getter :: Text -&gt; IO Statement
</span><a href="#local-6989586621679963824"><span class="hs-identifier hs-var hs-var">getter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlBackend -&gt; Text -&gt; IO Statement
</span><a href="Database.Persist.Sql.Raw.html#getStmtConn"><span class="hs-identifier hs-var">getStmtConn</span></a></span><span> </span><span class="annot"><span class="annottext">SqlBackend
</span><a href="#local-6989586621679963825"><span class="hs-identifier hs-var">conn</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SqlBackend -&gt; (Text -&gt; IO Statement) -&gt; IO ()
</span><a href="Database.Persist.SqlBackend.Internal.html#connRollback"><span class="hs-identifier hs-var">connRollback</span></a></span><span> </span><span class="annot"><span class="annottext">SqlBackend
</span><a href="#local-6989586621679963825"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; IO Statement
</span><a href="#local-6989586621679963824"><span class="hs-identifier hs-var">getter</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SqlBackend
-&gt; (Text -&gt; IO Statement) -&gt; Maybe IsolationLevel -&gt; IO ()
</span><a href="Database.Persist.SqlBackend.Internal.html#connBegin"><span class="hs-identifier hs-var">connBegin</span></a></span><span> </span><span class="annot"><span class="annottext">SqlBackend
</span><a href="#local-6989586621679963825"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; IO Statement
</span><a href="#local-6989586621679963824"><span class="hs-identifier hs-var">getter</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Roll back the current transaction and begin a new one with the specified isolation level.</span><span>
</span><span id="line-110"></span><span class="hs-comment">--</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- @since 2.9.0</span><span>
</span><span id="line-112"></span><span id="local-6989586621679963822"><span class="annot"><a href="Database.Persist.Sql.html#transactionUndoWithIsolation"><span class="hs-identifier hs-type">transactionUndoWithIsolation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679963822"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.IsolationLevel.html#IsolationLevel"><span class="hs-identifier hs-type">IsolationLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackend"><span class="hs-identifier hs-type">SqlBackend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679963822"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-113"></span><span id="transactionUndoWithIsolation"><span class="annot"><span class="annottext">transactionUndoWithIsolation :: forall (m :: * -&gt; *).
MonadIO m =&gt;
IsolationLevel -&gt; ReaderT SqlBackend m ()
</span><a href="Database.Persist.Sql.html#transactionUndoWithIsolation"><span class="hs-identifier hs-var hs-var">transactionUndoWithIsolation</span></a></span></span><span> </span><span id="local-6989586621679963815"><span class="annot"><span class="annottext">IsolationLevel
</span><a href="#local-6989586621679963815"><span class="hs-identifier hs-var">isolation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621679963814"><span class="annot"><span class="annottext">SqlBackend
</span><a href="#local-6989586621679963814"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) r. Monad m =&gt; ReaderT r m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679963813"><span class="annot"><span class="annottext">getter :: Text -&gt; IO Statement
</span><a href="#local-6989586621679963813"><span class="hs-identifier hs-var hs-var">getter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlBackend -&gt; Text -&gt; IO Statement
</span><a href="Database.Persist.Sql.Raw.html#getStmtConn"><span class="hs-identifier hs-var">getStmtConn</span></a></span><span> </span><span class="annot"><span class="annottext">SqlBackend
</span><a href="#local-6989586621679963814"><span class="hs-identifier hs-var">conn</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SqlBackend -&gt; (Text -&gt; IO Statement) -&gt; IO ()
</span><a href="Database.Persist.SqlBackend.Internal.html#connRollback"><span class="hs-identifier hs-var">connRollback</span></a></span><span> </span><span class="annot"><span class="annottext">SqlBackend
</span><a href="#local-6989586621679963814"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; IO Statement
</span><a href="#local-6989586621679963813"><span class="hs-identifier hs-var">getter</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SqlBackend
-&gt; (Text -&gt; IO Statement) -&gt; Maybe IsolationLevel -&gt; IO ()
</span><a href="Database.Persist.SqlBackend.Internal.html#connBegin"><span class="hs-identifier hs-var">connBegin</span></a></span><span> </span><span class="annot"><span class="annottext">SqlBackend
</span><a href="#local-6989586621679963814"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; IO Statement
</span><a href="#local-6989586621679963813"><span class="hs-identifier hs-var">getter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">IsolationLevel
</span><a href="#local-6989586621679963815"><span class="hs-identifier hs-var">isolation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span></pre></body></html>