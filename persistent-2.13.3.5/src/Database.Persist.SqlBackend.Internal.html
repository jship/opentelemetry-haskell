<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database.Persist.SqlBackend.Internal</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vault.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Vault</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vault.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Vault</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.Class.PersistStore.html"><span class="hs-identifier">Database.Persist.Class.PersistStore</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.Names.html"><span class="hs-identifier">Database.Persist.Names</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.InsertSqlResult.html"><span class="hs-identifier">Database.Persist.SqlBackend.Internal.InsertSqlResult</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.IsolationLevel.html"><span class="hs-identifier">Database.Persist.SqlBackend.Internal.IsolationLevel</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.MkSqlBackend.html"><span class="hs-identifier">Database.Persist.SqlBackend.Internal.MkSqlBackend</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.Statement.html"><span class="hs-identifier">Database.Persist.SqlBackend.Internal.Statement</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.StatementCache.html"><span class="hs-identifier">Database.Persist.SqlBackend.Internal.StatementCache</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.StatementCache.html#StatementCache"><span class="hs-identifier">StatementCache</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.StatementCache.html"><span class="hs-identifier">Database.Persist.SqlBackend.StatementCache</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Persist.Types.Base.html"><span class="hs-identifier">Database.Persist.Types.Base</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-comment">-- | A 'SqlBackend' represents a handle or connection to a database. It</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- contains functions and values that allow databases to have more</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- optimized implementations, as well as references that benefit</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- performance and sharing.</span><span>
</span><span id="line-24"></span><span class="hs-comment">--</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- Instead of using the 'SqlBackend' constructor directly, use the</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- 'mkSqlBackend' function.</span><span>
</span><span id="line-27"></span><span class="hs-comment">--</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- A 'SqlBackend' is *not* thread-safe. You should not assume that</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- a 'SqlBackend' can be shared among threads and run concurrent queries.</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- This *will* result in problems. Instead, you should create a @'Pool'</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- 'SqlBackend'@, known as a 'ConnectionPool', and pass that around in</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- multi-threaded applications.</span><span>
</span><span id="line-33"></span><span class="hs-comment">--</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- To run actions in the @persistent@ library, you should use the</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- 'runSqlConn' function. If you're using a multithreaded application, use</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- the 'runSqlPool' function.</span><span>
</span><span id="line-37"></span><span class="hs-keyword">data</span><span> </span><span id="SqlBackend"><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackend"><span class="hs-identifier hs-var">SqlBackend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SqlBackend"><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackend"><span class="hs-identifier hs-var">SqlBackend</span></a></span></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="connPrepare"><span class="annot"><span class="annottext">SqlBackend -&gt; Text -&gt; IO Statement
</span><a href="Database.Persist.SqlBackend.Internal.html#connPrepare"><span class="hs-identifier hs-var hs-var">connPrepare</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.Statement.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-comment">-- ^ This function should prepare a 'Statement' in the target database,</span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-comment">-- which should allow for efficient query reuse.</span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connInsertSql"><span class="annot"><span class="annottext">SqlBackend -&gt; EntityDef -&gt; [PersistValue] -&gt; InsertSqlResult
</span><a href="Database.Persist.SqlBackend.Internal.html#connInsertSql"><span class="hs-identifier hs-var hs-var">connInsertSql</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Persist.Types.Base.html#EntityDef"><span class="hs-identifier hs-type">EntityDef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistValue"><span class="hs-identifier hs-type">PersistValue</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.InsertSqlResult.html#InsertSqlResult"><span class="hs-identifier hs-type">InsertSqlResult</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-comment">-- ^ This function generates the SQL and values necessary for</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-comment">-- performing an insert against the database.</span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connInsertManySql"><span class="annot"><span class="annottext">SqlBackend
-&gt; Maybe (EntityDef -&gt; [[PersistValue]] -&gt; InsertSqlResult)
</span><a href="Database.Persist.SqlBackend.Internal.html#connInsertManySql"><span class="hs-identifier hs-var hs-var">connInsertManySql</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.Types.Base.html#EntityDef"><span class="hs-identifier hs-type">EntityDef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="Database.Persist.PersistValue.html#PersistValue"><span class="hs-identifier hs-type">PersistValue</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.InsertSqlResult.html#InsertSqlResult"><span class="hs-identifier hs-type">InsertSqlResult</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-comment">-- ^ SQL for inserting many rows and returning their primary keys, for</span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-comment">-- backends that support this functionality. If 'Nothing', rows will be</span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-comment">-- inserted one-at-a-time using 'connInsertSql'.</span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connUpsertSql"><span class="annot"><span class="annottext">SqlBackend
-&gt; Maybe
     (EntityDef -&gt; NonEmpty (FieldNameHS, FieldNameDB) -&gt; Text -&gt; Text)
</span><a href="Database.Persist.SqlBackend.Internal.html#connUpsertSql"><span class="hs-identifier hs-var hs-var">connUpsertSql</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.Types.Base.html#EntityDef"><span class="hs-identifier hs-type">EntityDef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.Names.html#FieldNameHS"><span class="hs-identifier hs-type">FieldNameHS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Persist.Names.html#FieldNameDB"><span class="hs-identifier hs-type">FieldNameDB</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-comment">-- ^ Some databases support performing UPSERT _and_ RETURN entity</span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-comment">-- in a single call.</span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-comment">-- This field when set will be used to generate the UPSERT+RETURN sql given</span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-comment">-- * an entity definition</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-comment">-- * updates to be run on unique key(s) collision</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-comment">-- When left as 'Nothing', we find the unique key from entity def before</span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-comment">-- * trying to fetch an entity by said key</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-comment">-- * perform an update when result found, else issue an insert</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-comment">-- * return new entity from db</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-comment">-- @since 2.6</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connPutManySql"><span class="annot"><span class="annottext">SqlBackend -&gt; Maybe (EntityDef -&gt; Int -&gt; Text)
</span><a href="Database.Persist.SqlBackend.Internal.html#connPutManySql"><span class="hs-identifier hs-var hs-var">connPutManySql</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.Types.Base.html#EntityDef"><span class="hs-identifier hs-type">EntityDef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-comment">-- ^ Some databases support performing bulk UPSERT, specifically</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-comment">-- &quot;insert or replace many records&quot; in a single call.</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-comment">-- This field when set, given</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-comment">-- * an entity definition</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-comment">-- * number of records to be inserted</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-comment">-- should produce a PUT MANY sql with placeholders for records</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-comment">-- When left as 'Nothing', we default to using 'defaultPutMany'.</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-comment">-- @since 2.8.1</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connStmtMap"><span class="annot"><span class="annottext">SqlBackend -&gt; StatementCache
</span><a href="Database.Persist.SqlBackend.Internal.html#connStmtMap"><span class="hs-identifier hs-var hs-var">connStmtMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.StatementCache.html#StatementCache"><span class="hs-identifier hs-type">StatementCache</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-comment">-- ^ A reference to the cache of statements. 'Statement's are keyed by</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-comment">-- the 'Text' queries that generated them.</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connClose"><span class="annot"><span class="annottext">SqlBackend -&gt; IO ()
</span><a href="Database.Persist.SqlBackend.Internal.html#connClose"><span class="hs-identifier hs-var hs-var">connClose</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-comment">-- ^ Close the underlying connection.</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connMigrateSql"><span class="annot"><span class="annottext">SqlBackend
-&gt; [EntityDef]
-&gt; (Text -&gt; IO Statement)
-&gt; EntityDef
-&gt; IO (Either [Text] [(Bool, Text)])
</span><a href="Database.Persist.SqlBackend.Internal.html#connMigrateSql"><span class="hs-identifier hs-var hs-var">connMigrateSql</span></a></span></span><span>
</span><span id="line-80"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Database.Persist.Types.Base.html#EntityDef"><span class="hs-identifier hs-type">EntityDef</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-81"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.Statement.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Persist.Types.Base.html#EntityDef"><span class="hs-identifier hs-type">EntityDef</span></a></span><span>
</span><span id="line-83"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-comment">-- ^ This function returns the migrations required to include the</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-comment">-- 'EntityDef' parameter in the @['EntityDef']@ database. This might</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-comment">-- include creating a new table if the entity is not present, or</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-comment">-- altering an existing table if it is.</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connBegin"><span class="annot"><span class="annottext">SqlBackend
-&gt; (Text -&gt; IO Statement) -&gt; Maybe IsolationLevel -&gt; IO ()
</span><a href="Database.Persist.SqlBackend.Internal.html#connBegin"><span class="hs-identifier hs-var hs-var">connBegin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.Statement.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.IsolationLevel.html#IsolationLevel"><span class="hs-identifier hs-type">IsolationLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-comment">-- ^ A function to begin a transaction for the underlying database.</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connCommit"><span class="annot"><span class="annottext">SqlBackend -&gt; (Text -&gt; IO Statement) -&gt; IO ()
</span><a href="Database.Persist.SqlBackend.Internal.html#connCommit"><span class="hs-identifier hs-var hs-var">connCommit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.Statement.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-comment">-- ^ A function to commit a transaction to the underlying database.</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connRollback"><span class="annot"><span class="annottext">SqlBackend -&gt; (Text -&gt; IO Statement) -&gt; IO ()
</span><a href="Database.Persist.SqlBackend.Internal.html#connRollback"><span class="hs-identifier hs-var hs-var">connRollback</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.Statement.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-comment">-- ^ A function to roll back a transaction on the underlying database.</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connEscapeFieldName"><span class="annot"><span class="annottext">SqlBackend -&gt; FieldNameDB -&gt; Text
</span><a href="Database.Persist.SqlBackend.Internal.html#connEscapeFieldName"><span class="hs-identifier hs-var hs-var">connEscapeFieldName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Persist.Names.html#FieldNameDB"><span class="hs-identifier hs-type">FieldNameDB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-comment">-- ^ A function to extract and escape the name of the column corresponding</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-comment">-- to the provided field.</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">-- @since 2.12.0.0</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connEscapeTableName"><span class="annot"><span class="annottext">SqlBackend -&gt; EntityDef -&gt; Text
</span><a href="Database.Persist.SqlBackend.Internal.html#connEscapeTableName"><span class="hs-identifier hs-var hs-var">connEscapeTableName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Persist.Types.Base.html#EntityDef"><span class="hs-identifier hs-type">EntityDef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-comment">-- ^ A function to extract and escape the name of the table corresponding</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-comment">-- to the provided entity. PostgreSQL uses this to support schemas.</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-comment">-- @since 2.12.0.0</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connEscapeRawName"><span class="annot"><span class="annottext">SqlBackend -&gt; Text -&gt; Text
</span><a href="Database.Persist.SqlBackend.Internal.html#connEscapeRawName"><span class="hs-identifier hs-var hs-var">connEscapeRawName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-comment">-- ^ A function to escape raw DB identifiers. MySQL uses backticks, while</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-comment">-- PostgreSQL uses quotes, and so on.</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-comment">-- @since 2.12.0.0</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connNoLimit"><span class="annot"><span class="annottext">SqlBackend -&gt; Text
</span><a href="Database.Persist.SqlBackend.Internal.html#connNoLimit"><span class="hs-identifier hs-var hs-var">connNoLimit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connRDBMS"><span class="annot"><span class="annottext">SqlBackend -&gt; Text
</span><a href="Database.Persist.SqlBackend.Internal.html#connRDBMS"><span class="hs-identifier hs-var hs-var">connRDBMS</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-comment">-- ^ A tag displaying what database the 'SqlBackend' is for. Can be</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-comment">-- used to differentiate features in downstream libraries for different</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">-- database backends.</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connLimitOffset"><span class="annot"><span class="annottext">SqlBackend -&gt; (Int, Int) -&gt; Text -&gt; Text
</span><a href="Database.Persist.SqlBackend.Internal.html#connLimitOffset"><span class="hs-identifier hs-var hs-var">connLimitOffset</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-comment">-- ^ Attach a 'LIMIT/OFFSET' clause to a SQL query. Note that</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-comment">-- LIMIT/OFFSET is problematic for performance, and indexed range</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-comment">-- queries are the superior way to offer pagination.</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connLogFunc"><span class="annot"><span class="annottext">SqlBackend -&gt; LogFunc
</span><a href="Database.Persist.SqlBackend.Internal.html#connLogFunc"><span class="hs-identifier hs-var hs-var">connLogFunc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.MkSqlBackend.html#LogFunc"><span class="hs-identifier hs-type">LogFunc</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-comment">-- ^ A log function for the 'SqlBackend' to use.</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connMaxParams"><span class="annot"><span class="annottext">SqlBackend -&gt; Maybe Int
</span><a href="Database.Persist.SqlBackend.Internal.html#connMaxParams"><span class="hs-identifier hs-var hs-var">connMaxParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-comment">-- ^ Some databases (probably only Sqlite) have a limit on how</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-comment">-- many question-mark parameters may be used in a statement</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-comment">-- @since 2.6.1</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connRepsertManySql"><span class="annot"><span class="annottext">SqlBackend -&gt; Maybe (EntityDef -&gt; Int -&gt; Text)
</span><a href="Database.Persist.SqlBackend.Internal.html#connRepsertManySql"><span class="hs-identifier hs-var hs-var">connRepsertManySql</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Persist.Types.Base.html#EntityDef"><span class="hs-identifier hs-type">EntityDef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-comment">-- ^ Some databases support performing bulk an atomic+bulk INSERT where</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-comment">-- constraint conflicting entities can replace existing entities.</span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-comment">-- This field when set, given</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-comment">-- * an entity definition</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-comment">-- * number of records to be inserted</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-comment">-- should produce a INSERT sql with placeholders for primary+record fields</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-comment">-- When left as 'Nothing', we default to using 'defaultRepsertMany'.</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-comment">-- @since 2.9.0</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connVault"><span class="annot"><span class="annottext">SqlBackend -&gt; Vault
</span><a href="Database.Persist.SqlBackend.Internal.html#connVault"><span class="hs-identifier hs-var hs-var">connVault</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vault</span></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-comment">-- ^ Carry arbitrary payloads for the connection that</span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-comment">-- may be used to propagate information into hooks.</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="connHooks"><span class="annot"><span class="annottext">SqlBackend -&gt; SqlBackendHooks
</span><a href="Database.Persist.SqlBackend.Internal.html#connHooks"><span class="hs-identifier hs-var hs-var">connHooks</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackendHooks"><span class="hs-identifier hs-type">SqlBackendHooks</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-comment">-- ^ Instrumentation hooks that may be used to track the</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-comment">-- behaviour of a backend.</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-keyword">newtype</span><span> </span><span id="SqlBackendHooks"><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackendHooks"><span class="hs-identifier hs-var">SqlBackendHooks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SqlBackendHooks"><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackendHooks"><span class="hs-identifier hs-var">SqlBackendHooks</span></a></span></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="hookGetStatement"><span class="annot"><span class="annottext">SqlBackendHooks -&gt; SqlBackend -&gt; Text -&gt; Statement -&gt; IO Statement
</span><a href="Database.Persist.SqlBackend.Internal.html#hookGetStatement"><span class="hs-identifier hs-var hs-var">hookGetStatement</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackend"><span class="hs-identifier hs-type">SqlBackend</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.Statement.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.Statement.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#emptySqlBackendHooks"><span class="hs-identifier hs-type">emptySqlBackendHooks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackendHooks"><span class="hs-identifier hs-type">SqlBackendHooks</span></a></span><span>
</span><span id="line-150"></span><span id="emptySqlBackendHooks"><span class="annot"><span class="annottext">emptySqlBackendHooks :: SqlBackendHooks
</span><a href="Database.Persist.SqlBackend.Internal.html#emptySqlBackendHooks"><span class="hs-identifier hs-var hs-var">emptySqlBackendHooks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackendHooks"><span class="hs-identifier hs-type">SqlBackendHooks</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hookGetStatement :: SqlBackend -&gt; Text -&gt; Statement -&gt; IO Statement
</span><a href="Database.Persist.SqlBackend.Internal.html#hookGetStatement"><span class="hs-identifier hs-var">hookGetStatement</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">SqlBackend
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679931303"><span class="annot"><span class="annottext">Statement
</span><a href="#local-6989586621679931303"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Statement
</span><a href="#local-6989586621679931303"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | A function for creating a value of the 'SqlBackend' type. You should prefer</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- to use this instead of the constructor for 'SqlBackend', because default</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- values for this will be provided for new fields on the record when new</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- functionality is added.</span><span>
</span><span id="line-158"></span><span class="hs-comment">--</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- @since 2.13.0.0</span><span>
</span><span id="line-160"></span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#mkSqlBackend"><span class="hs-identifier hs-type">mkSqlBackend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.MkSqlBackend.html#MkSqlBackendArgs"><span class="hs-identifier hs-type">MkSqlBackendArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackend"><span class="hs-identifier hs-type">SqlBackend</span></a></span><span>
</span><span id="line-161"></span><span id="mkSqlBackend"><span class="annot"><span class="annottext">mkSqlBackend :: MkSqlBackendArgs -&gt; SqlBackend
</span><a href="Database.Persist.SqlBackend.Internal.html#mkSqlBackend"><span class="hs-identifier hs-var hs-var">mkSqlBackend</span></a></span></span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.MkSqlBackend.html#MkSqlBackendArgs"><span class="hs-identifier hs-type">MkSqlBackendArgs</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679931286"><span id="local-6989586621679931287"><span id="local-6989586621679931288"><span id="local-6989586621679931289"><span id="local-6989586621679931290"><span id="local-6989586621679931291"><span id="local-6989586621679931292"><span id="local-6989586621679931293"><span id="local-6989586621679931294"><span id="local-6989586621679931295"><span id="local-6989586621679931296"><span id="local-6989586621679931297"><span id="local-6989586621679931298"><span id="local-6989586621679931299"><span id="local-6989586621679931300"><span class="annot"><span class="annottext">IO ()
Text
IORef (Map Text Statement)
[EntityDef]
-&gt; (Text -&gt; IO Statement)
-&gt; EntityDef
-&gt; IO (Either [Text] [(Bool, Text)])
(Int, Int) -&gt; Text -&gt; Text
Text -&gt; IO Statement
Text -&gt; Text
LogFunc
FieldNameDB -&gt; Text
EntityDef -&gt; Text
EntityDef -&gt; [PersistValue] -&gt; InsertSqlResult
(Text -&gt; IO Statement) -&gt; IO ()
(Text -&gt; IO Statement) -&gt; Maybe IsolationLevel -&gt; IO ()
connLogFunc :: MkSqlBackendArgs -&gt; LogFunc
connLimitOffset :: MkSqlBackendArgs -&gt; (Int, Int) -&gt; Text -&gt; Text
connRDBMS :: MkSqlBackendArgs -&gt; Text
connNoLimit :: MkSqlBackendArgs -&gt; Text
connEscapeRawName :: MkSqlBackendArgs -&gt; Text -&gt; Text
connEscapeTableName :: MkSqlBackendArgs -&gt; EntityDef -&gt; Text
connEscapeFieldName :: MkSqlBackendArgs -&gt; FieldNameDB -&gt; Text
connRollback :: MkSqlBackendArgs -&gt; (Text -&gt; IO Statement) -&gt; IO ()
connCommit :: MkSqlBackendArgs -&gt; (Text -&gt; IO Statement) -&gt; IO ()
connBegin :: MkSqlBackendArgs
-&gt; (Text -&gt; IO Statement) -&gt; Maybe IsolationLevel -&gt; IO ()
connMigrateSql :: MkSqlBackendArgs
-&gt; [EntityDef]
-&gt; (Text -&gt; IO Statement)
-&gt; EntityDef
-&gt; IO (Either [Text] [(Bool, Text)])
connClose :: MkSqlBackendArgs -&gt; IO ()
connStmtMap :: MkSqlBackendArgs -&gt; IORef (Map Text Statement)
connInsertSql :: MkSqlBackendArgs -&gt; EntityDef -&gt; [PersistValue] -&gt; InsertSqlResult
connPrepare :: MkSqlBackendArgs -&gt; Text -&gt; IO Statement
connLogFunc :: LogFunc
connLimitOffset :: (Int, Int) -&gt; Text -&gt; Text
connRDBMS :: Text
connNoLimit :: Text
connEscapeRawName :: Text -&gt; Text
connEscapeTableName :: EntityDef -&gt; Text
connEscapeFieldName :: FieldNameDB -&gt; Text
connRollback :: (Text -&gt; IO Statement) -&gt; IO ()
connCommit :: (Text -&gt; IO Statement) -&gt; IO ()
connBegin :: (Text -&gt; IO Statement) -&gt; Maybe IsolationLevel -&gt; IO ()
connMigrateSql :: [EntityDef]
-&gt; (Text -&gt; IO Statement)
-&gt; EntityDef
-&gt; IO (Either [Text] [(Bool, Text)])
connClose :: IO ()
connStmtMap :: IORef (Map Text Statement)
connInsertSql :: EntityDef -&gt; [PersistValue] -&gt; InsertSqlResult
connPrepare :: Text -&gt; IO Statement
</span><a href="Database.Persist.SqlBackend.Internal.MkSqlBackend.html#connLogFunc"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackend"><span class="hs-identifier hs-type">SqlBackend</span></a></span><span>
</span><span id="line-163"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">connMaxParams :: Maybe Int
</span><a href="Database.Persist.SqlBackend.Internal.html#connMaxParams"><span class="hs-identifier hs-var">connMaxParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-164"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">connRepsertManySql :: Maybe (EntityDef -&gt; Int -&gt; Text)
</span><a href="Database.Persist.SqlBackend.Internal.html#connRepsertManySql"><span class="hs-identifier hs-var">connRepsertManySql</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-165"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">connPutManySql :: Maybe (EntityDef -&gt; Int -&gt; Text)
</span><a href="Database.Persist.SqlBackend.Internal.html#connPutManySql"><span class="hs-identifier hs-var">connPutManySql</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">connUpsertSql :: Maybe
  (EntityDef -&gt; NonEmpty (FieldNameHS, FieldNameDB) -&gt; Text -&gt; Text)
</span><a href="Database.Persist.SqlBackend.Internal.html#connUpsertSql"><span class="hs-identifier hs-var">connUpsertSql</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">connInsertManySql :: Maybe (EntityDef -&gt; [[PersistValue]] -&gt; InsertSqlResult)
</span><a href="Database.Persist.SqlBackend.Internal.html#connInsertManySql"><span class="hs-identifier hs-var">connInsertManySql</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">connVault :: Vault
</span><a href="Database.Persist.SqlBackend.Internal.html#connVault"><span class="hs-identifier hs-var">connVault</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vault
</span><span class="hs-identifier hs-var">Vault.empty</span></span><span>
</span><span id="line-169"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">connHooks :: SqlBackendHooks
</span><a href="Database.Persist.SqlBackend.Internal.html#connHooks"><span class="hs-identifier hs-var">connHooks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlBackendHooks
</span><a href="Database.Persist.SqlBackend.Internal.html#emptySqlBackendHooks"><span class="hs-identifier hs-var">emptySqlBackendHooks</span></a></span><span>
</span><span id="line-170"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">connStmtMap :: StatementCache
</span><a href="Database.Persist.SqlBackend.Internal.html#connStmtMap"><span class="hs-identifier hs-var">connStmtMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MkStatementCache -&gt; StatementCache
</span><a href="Database.Persist.SqlBackend.StatementCache.html#mkStatementCache"><span class="hs-identifier hs-var">mkStatementCache</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IORef (Map Text Statement) -&gt; MkStatementCache
</span><a href="Database.Persist.SqlBackend.StatementCache.html#mkSimpleStatementCache"><span class="hs-identifier hs-var">mkSimpleStatementCache</span></a></span><span> </span><span class="annot"><span class="annottext">IORef (Map Text Statement)
</span><a href="#local-6989586621679931298"><span class="hs-identifier hs-var">connStmtMap</span></a></span><span>
</span><span id="line-171"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IO ()
Text
[EntityDef]
-&gt; (Text -&gt; IO Statement)
-&gt; EntityDef
-&gt; IO (Either [Text] [(Bool, Text)])
(Int, Int) -&gt; Text -&gt; Text
Text -&gt; IO Statement
Text -&gt; Text
LogFunc
FieldNameDB -&gt; Text
EntityDef -&gt; Text
EntityDef -&gt; [PersistValue] -&gt; InsertSqlResult
(Text -&gt; IO Statement) -&gt; IO ()
(Text -&gt; IO Statement) -&gt; Maybe IsolationLevel -&gt; IO ()
connLogFunc :: LogFunc
connLimitOffset :: (Int, Int) -&gt; Text -&gt; Text
connRDBMS :: Text
connNoLimit :: Text
connEscapeRawName :: Text -&gt; Text
connEscapeTableName :: EntityDef -&gt; Text
connEscapeFieldName :: FieldNameDB -&gt; Text
connRollback :: (Text -&gt; IO Statement) -&gt; IO ()
connCommit :: (Text -&gt; IO Statement) -&gt; IO ()
connBegin :: (Text -&gt; IO Statement) -&gt; Maybe IsolationLevel -&gt; IO ()
connMigrateSql :: [EntityDef]
-&gt; (Text -&gt; IO Statement)
-&gt; EntityDef
-&gt; IO (Either [Text] [(Bool, Text)])
connClose :: IO ()
connInsertSql :: EntityDef -&gt; [PersistValue] -&gt; InsertSqlResult
connPrepare :: Text -&gt; IO Statement
connLogFunc :: LogFunc
connLimitOffset :: (Int, Int) -&gt; Text -&gt; Text
connRDBMS :: Text
connNoLimit :: Text
connEscapeRawName :: Text -&gt; Text
connEscapeTableName :: EntityDef -&gt; Text
connEscapeFieldName :: FieldNameDB -&gt; Text
connRollback :: (Text -&gt; IO Statement) -&gt; IO ()
connCommit :: (Text -&gt; IO Statement) -&gt; IO ()
connBegin :: (Text -&gt; IO Statement) -&gt; Maybe IsolationLevel -&gt; IO ()
connMigrateSql :: [EntityDef]
-&gt; (Text -&gt; IO Statement)
-&gt; EntityDef
-&gt; IO (Either [Text] [(Bool, Text)])
connClose :: IO ()
connInsertSql :: EntityDef -&gt; [PersistValue] -&gt; InsertSqlResult
connPrepare :: Text -&gt; IO Statement
</span><a href="#local-6989586621679931286"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span>
</span><span id="line-172"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Database.Persist.Class.PersistStore.html#HasPersistBackend"><span class="hs-identifier hs-type">HasPersistBackend</span></a></span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackend"><span class="hs-identifier hs-type">SqlBackend</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="BaseBackend"><span class="annot"><a href="Database.Persist.Class.PersistStore.html#BaseBackend"><span class="hs-identifier hs-var">BaseBackend</span></a></span></span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackend"><span class="hs-identifier hs-type">SqlBackend</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackend"><span class="hs-identifier hs-type">SqlBackend</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621679931264"><span class="annot"><span class="annottext">persistBackend :: SqlBackend -&gt; BaseBackend SqlBackend
</span><a href="Database.Persist.Class.PersistStore.html#persistBackend"><span class="hs-identifier hs-var hs-var hs-var hs-var">persistBackend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Database.Persist.Class.PersistStore.html#IsPersistBackend"><span class="hs-identifier hs-type">IsPersistBackend</span></a></span><span> </span><span class="annot"><a href="Database.Persist.SqlBackend.Internal.html#SqlBackend"><span class="hs-identifier hs-type">SqlBackend</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679931256"><span class="annot"><span class="annottext">mkPersistBackend :: BaseBackend SqlBackend -&gt; SqlBackend
</span><a href="Database.Persist.Class.PersistStore.html#mkPersistBackend"><span class="hs-identifier hs-var hs-var hs-var hs-var">mkPersistBackend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-180"></span></pre></body></html>