<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Database.Persist.TH</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">persistent-2.13.3.5: Type-safe, multi-backend data serialization.</span><ul class="links" id="page-menu"><li><a href="src/Database.Persist.TH.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Database.Persist.TH</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Parse entity defs</a></li><li><a href="#g:2">Turn <code>EntityDef</code>s into types</a><ul><li><a href="#g:3">Implicit ID Columns</a></li></ul></li><li><a href="#g:4">Various other TH functions</a></li><li><a href="#g:5">Internal</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module provides the tools for defining your database schema and using
 it to generate Haskell data types and migrations.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:persistWith">persistWith</a> :: <a href="Database-Persist-Quasi-Internal.html#t:PersistSettings" title="Database.Persist.Quasi.Internal">PersistSettings</a> -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Quote.html#t:QuasiQuoter" title="Language.Haskell.TH.Quote">QuasiQuoter</a></li><li class="src short"><a href="#v:persistUpperCase">persistUpperCase</a> :: <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Quote.html#t:QuasiQuoter" title="Language.Haskell.TH.Quote">QuasiQuoter</a></li><li class="src short"><a href="#v:persistLowerCase">persistLowerCase</a> :: <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Quote.html#t:QuasiQuoter" title="Language.Haskell.TH.Quote">QuasiQuoter</a></li><li class="src short"><a href="#v:persistFileWith">persistFileWith</a> :: <a href="Database-Persist-Quasi-Internal.html#t:PersistSettings" title="Database.Persist.Quasi.Internal">PersistSettings</a> -&gt; <a href="../base-4.16.4.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Exp" title="Language.Haskell.TH.Syntax">Exp</a></li><li class="src short"><a href="#v:persistManyFileWith">persistManyFileWith</a> :: <a href="Database-Persist-Quasi-Internal.html#t:PersistSettings" title="Database.Persist.Quasi.Internal">PersistSettings</a> -&gt; [<a href="../base-4.16.4.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a>] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Exp" title="Language.Haskell.TH.Syntax">Exp</a></li><li class="src short"><a href="#v:mkPersist">mkPersist</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; [<a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a>] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]</li><li class="src short"><a href="#v:mkPersistWith">mkPersistWith</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; [<a href="Database-Persist-EntityDef-Internal.html#t:EntityDef" title="Database.Persist.EntityDef.Internal">EntityDef</a>] -&gt; [<a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a>] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]</li><li class="src short"><span class="keyword">data</span> <a href="#t:MkPersistSettings">MkPersistSettings</a></li><li class="src short"><a href="#v:mpsBackend">mpsBackend</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Type" title="Language.Haskell.TH.Syntax">Type</a></li><li class="src short"><a href="#v:mpsGeneric">mpsGeneric</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:mpsPrefixFields">mpsPrefixFields</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:mpsFieldLabelModifier">mpsFieldLabelModifier</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a></li><li class="src short"><a href="#v:mpsConstraintLabelModifier">mpsConstraintLabelModifier</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a></li><li class="src short"><a href="#v:mpsEntityJSON">mpsEntityJSON</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Database-Persist-TH.html#t:EntityJSON" title="Database.Persist.TH">EntityJSON</a></li><li class="src short"><a href="#v:mpsGenerateLenses">mpsGenerateLenses</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:mpsDeriveInstances">mpsDeriveInstances</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Name" title="Language.Haskell.TH.Syntax">Name</a>]</li><li class="src short"><span class="keyword">data</span> <a href="#t:EntityJSON">EntityJSON</a> = <a href="#v:EntityJSON">EntityJSON</a> {<ul class="subs"><li><a href="#v:entityToJSON">entityToJSON</a> :: <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Name" title="Language.Haskell.TH.Syntax">Name</a></li><li><a href="#v:entityFromJSON">entityFromJSON</a> :: <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Name" title="Language.Haskell.TH.Syntax">Name</a></li></ul>}</li><li class="src short"><a href="#v:mkPersistSettings">mkPersistSettings</a> :: <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Type" title="Language.Haskell.TH.Syntax">Type</a> -&gt; <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a></li><li class="src short"><a href="#v:sqlSettings">sqlSettings</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:ImplicitIdDef">ImplicitIdDef</a></li><li class="src short"><a href="#v:setImplicitIdDef">setImplicitIdDef</a> :: <a href="Database-Persist-TH.html#t:ImplicitIdDef" title="Database.Persist.TH">ImplicitIdDef</a> -&gt; <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a></li><li class="src short"><a href="#v:mkMigrate">mkMigrate</a> :: <a href="../base-4.16.4.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; [<a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a>] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]</li><li class="src short"><a href="#v:migrateModels">migrateModels</a> :: [<a href="Database-Persist-EntityDef-Internal.html#t:EntityDef" title="Database.Persist.EntityDef.Internal">EntityDef</a>] -&gt; <a href="Database-Persist-Sql-Migration.html#t:Migration" title="Database.Persist.Sql.Migration">Migration</a></li><li class="src short"><a href="#v:discoverEntities">discoverEntities</a> :: <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Exp" title="Language.Haskell.TH.Syntax">Exp</a></li><li class="src short"><a href="#v:mkSave">mkSave</a> :: <a href="../base-4.16.4.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; [<a href="Database-Persist-EntityDef-Internal.html#t:EntityDef" title="Database.Persist.EntityDef.Internal">EntityDef</a>] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]</li><li class="src short"><a href="#v:mkDeleteCascade">mkDeleteCascade</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; [<a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a>] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]</li><li class="src short"><a href="#v:mkEntityDefList">mkEntityDefList</a> :: <a href="../base-4.16.4.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; [<a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a>] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]</li><li class="src short"><a href="#v:share">share</a> :: [[a] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]] -&gt; [a] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]</li><li class="src short"><a href="#v:derivePersistField">derivePersistField</a> :: <a href="../base-4.16.4.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]</li><li class="src short"><a href="#v:derivePersistFieldJSON">derivePersistFieldJSON</a> :: <a href="../base-4.16.4.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]</li><li class="src short"><a href="#v:persistFieldFromEntity">persistFieldFromEntity</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a> -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]</li><li class="src short"><a href="#v:lensPTH">lensPTH</a> :: (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b</li><li class="src short"><a href="#v:parseReferences">parseReferences</a> :: <a href="Database-Persist-Quasi-Internal.html#t:PersistSettings" title="Database.Persist.Quasi.Internal">PersistSettings</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Exp" title="Language.Haskell.TH.Syntax">Exp</a></li><li class="src short"><a href="#v:embedEntityDefs">embedEntityDefs</a> :: [<a href="Database-Persist-EntityDef-Internal.html#t:EntityDef" title="Database.Persist.EntityDef.Internal">EntityDef</a>] -&gt; [<a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a>] -&gt; [<a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a>]</li><li class="src short"><a href="#v:fieldError">fieldError</a> :: <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a></li><li class="src short"><span class="keyword">class</span> <a href="Database-Persist-Class-PersistEntity.html#t:PersistEntity" title="Database.Persist.Class.PersistEntity">PersistEntity</a> record =&gt; <a href="#t:AtLeastOneUniqueKey">AtLeastOneUniqueKey</a> record <span class="keyword">where</span><ul class="subs"><li><a href="#v:requireUniquesP">requireUniquesP</a> :: record -&gt; <a href="../base-4.16.4.0/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> (<a href="Database-Persist-Class-PersistEntity.html#t:Unique" title="Database.Persist.Class.PersistEntity">Unique</a> record)</li></ul></li><li class="src short"><span class="keyword">class</span> <a href="Database-Persist-Class-PersistEntity.html#t:PersistEntity" title="Database.Persist.Class.PersistEntity">PersistEntity</a> record =&gt; <a href="#t:OnlyOneUniqueKey">OnlyOneUniqueKey</a> record <span class="keyword">where</span><ul class="subs"><li><a href="#v:onlyUniqueP">onlyUniqueP</a> :: record -&gt; <a href="Database-Persist-Class-PersistEntity.html#t:Unique" title="Database.Persist.Class.PersistEntity">Unique</a> record</li></ul></li><li class="src short"><a href="#v:pkNewtype">pkNewtype</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a> -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Parse entity defs</h1></a><div class="top"><p class="src"><a id="v:persistWith" class="def">persistWith</a> :: <a href="Database-Persist-Quasi-Internal.html#t:PersistSettings" title="Database.Persist.Quasi.Internal">PersistSettings</a> -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Quote.html#t:QuasiQuoter" title="Language.Haskell.TH.Quote">QuasiQuoter</a> <a href="src/Database.Persist.TH.html#persistWith" class="link">Source</a> <a href="#v:persistWith" class="selflink">#</a></p><div class="doc"><p>Converts a quasi-quoted syntax into a list of entity definitions, to be
 used as input to the template haskell generation code (mkPersist).</p></div></div><div class="top"><p class="src"><a id="v:persistUpperCase" class="def">persistUpperCase</a> :: <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Quote.html#t:QuasiQuoter" title="Language.Haskell.TH.Quote">QuasiQuoter</a> <a href="src/Database.Persist.TH.html#persistUpperCase" class="link">Source</a> <a href="#v:persistUpperCase" class="selflink">#</a></p><div class="doc"><p>Apply <code><a href="Database-Persist-TH.html#v:persistWith" title="Database.Persist.TH">persistWith</a></code> to <code><a href="Database-Persist-Quasi-Internal.html#v:upperCaseSettings" title="Database.Persist.Quasi.Internal">upperCaseSettings</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:persistLowerCase" class="def">persistLowerCase</a> :: <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Quote.html#t:QuasiQuoter" title="Language.Haskell.TH.Quote">QuasiQuoter</a> <a href="src/Database.Persist.TH.html#persistLowerCase" class="link">Source</a> <a href="#v:persistLowerCase" class="selflink">#</a></p><div class="doc"><p>Apply <code><a href="Database-Persist-TH.html#v:persistWith" title="Database.Persist.TH">persistWith</a></code> to <code><a href="Database-Persist-Quasi-Internal.html#v:lowerCaseSettings" title="Database.Persist.Quasi.Internal">lowerCaseSettings</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:persistFileWith" class="def">persistFileWith</a> :: <a href="Database-Persist-Quasi-Internal.html#t:PersistSettings" title="Database.Persist.Quasi.Internal">PersistSettings</a> -&gt; <a href="../base-4.16.4.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Exp" title="Language.Haskell.TH.Syntax">Exp</a> <a href="src/Database.Persist.TH.html#persistFileWith" class="link">Source</a> <a href="#v:persistFileWith" class="selflink">#</a></p><div class="doc"><p>Same as <code><a href="Database-Persist-TH.html#v:persistWith" title="Database.Persist.TH">persistWith</a></code>, but uses an external file instead of a
 quasiquotation. The recommended file extension is <code>.persistentmodels</code>.</p></div></div><div class="top"><p class="src"><a id="v:persistManyFileWith" class="def">persistManyFileWith</a> :: <a href="Database-Persist-Quasi-Internal.html#t:PersistSettings" title="Database.Persist.Quasi.Internal">PersistSettings</a> -&gt; [<a href="../base-4.16.4.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a>] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Exp" title="Language.Haskell.TH.Syntax">Exp</a> <a href="src/Database.Persist.TH.html#persistManyFileWith" class="link">Source</a> <a href="#v:persistManyFileWith" class="selflink">#</a></p><div class="doc"><p>Same as <code><a href="Database-Persist-TH.html#v:persistFileWith" title="Database.Persist.TH">persistFileWith</a></code>, but uses several external files instead of
 one. Splitting your Persistent definitions into multiple modules can
 potentially dramatically speed up compile times.</p><p>The recommended file extension is <code>.persistentmodels</code>.</p><h4 class="subheading details-toggle-control details-toggle" data-details-id="ch:persistManyFileWith0">Examples</h4><details id="ch:persistManyFileWith0"><summary class="hide-when-js-enabled">Expand</summary><p>Split your Persistent definitions into multiple files (<code>models1</code>, <code>models2</code>),
 then create a new module for each new file and run <code><a href="Database-Persist-TH.html#v:mkPersist" title="Database.Persist.TH">mkPersist</a></code> there:</p><pre>-- Model1.hs
<code><a href="Database-Persist-TH.html#v:share" title="Database.Persist.TH">share</a></code>
    [<code><a href="Database-Persist-TH.html#v:mkPersist" title="Database.Persist.TH">mkPersist</a></code> <code><a href="Database-Persist-TH.html#v:sqlSettings" title="Database.Persist.TH">sqlSettings</a></code>]
    $(<code><a href="Database-Persist-TH.html#v:persistFileWith" title="Database.Persist.TH">persistFileWith</a></code> <code><a href="Database-Persist-Quasi-Internal.html#v:lowerCaseSettings" title="Database.Persist.Quasi.Internal">lowerCaseSettings</a></code> &quot;models1&quot;)
</pre><pre>-- Model2.hs
<code><a href="Database-Persist-TH.html#v:share" title="Database.Persist.TH">share</a></code>
    [<code><a href="Database-Persist-TH.html#v:mkPersist" title="Database.Persist.TH">mkPersist</a></code> <code><a href="Database-Persist-TH.html#v:sqlSettings" title="Database.Persist.TH">sqlSettings</a></code>]
    $(<code><a href="Database-Persist-TH.html#v:persistFileWith" title="Database.Persist.TH">persistFileWith</a></code> <code><a href="Database-Persist-Quasi-Internal.html#v:lowerCaseSettings" title="Database.Persist.Quasi.Internal">lowerCaseSettings</a></code> &quot;models2&quot;)
</pre><p>Use <code><a href="Database-Persist-TH.html#v:persistManyFileWith" title="Database.Persist.TH">persistManyFileWith</a></code> to create your migrations:</p><pre>-- Migrate.hs
<code><a href="Database-Persist-TH.html#v:share" title="Database.Persist.TH">share</a></code>
    [<code><a href="Database-Persist-TH.html#v:mkMigrate" title="Database.Persist.TH">mkMigrate</a></code> &quot;migrateAll&quot;]
    $(<code><a href="Database-Persist-TH.html#v:persistManyFileWith" title="Database.Persist.TH">persistManyFileWith</a></code> <code><a href="Database-Persist-Quasi-Internal.html#v:lowerCaseSettings" title="Database.Persist.Quasi.Internal">lowerCaseSettings</a></code> [&quot;models1.persistentmodels&quot;,&quot;models2.persistentmodels&quot;])
</pre><p>Tip: To get the same import behavior as if you were declaring all your models in
 one file, import your new files <code>as Name</code> into another file, then export <code>module Name</code>.</p><p>This approach may be used in the future to reduce memory usage during compilation,
 but so far we've only seen mild reductions.</p><p>See <a href="https://github.com/yesodweb/persistent/issues/778">persistent#778</a> and
 <a href="https://github.com/yesodweb/persistent/pull/791">persistent#791</a> for more details.</p></details><p><em>Since: 2.5.4</em></p></div></div><a href="#g:2" id="g:2"><h1>Turn <code>EntityDef</code>s into types</h1></a><div class="top"><p class="src"><a id="v:mkPersist" class="def">mkPersist</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; [<a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a>] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>] <a href="src/Database.Persist.TH.html#mkPersist" class="link">Source</a> <a href="#v:mkPersist" class="selflink">#</a></p><div class="doc"><p>Create data types and appropriate <code><a href="Database-Persist-Class-PersistEntity.html#t:PersistEntity" title="Database.Persist.Class.PersistEntity">PersistEntity</a></code> instances for the given
 <code><a href="Database-Persist-EntityDef-Internal.html#t:EntityDef" title="Database.Persist.EntityDef.Internal">EntityDef</a></code>s. Works well with the persist quasi-quoter.</p></div></div><div class="top"><p class="src"><a id="v:mkPersistWith" class="def">mkPersistWith</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; [<a href="Database-Persist-EntityDef-Internal.html#t:EntityDef" title="Database.Persist.EntityDef.Internal">EntityDef</a>] -&gt; [<a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a>] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>] <a href="src/Database.Persist.TH.html#mkPersistWith" class="link">Source</a> <a href="#v:mkPersistWith" class="selflink">#</a></p><div class="doc"><p>Like '</p><p><em>Since: 2.13.0.0</em></p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MkPersistSettings" class="def">MkPersistSettings</a> <a href="src/Database.Persist.TH.html#MkPersistSettings" class="link">Source</a> <a href="#t:MkPersistSettings" class="selflink">#</a></p><div class="doc"><p>Settings to be passed to the <code><a href="Database-Persist-TH.html#v:mkPersist" title="Database.Persist.TH">mkPersist</a></code> function.</p></div></div><div class="top"><p class="src"><a id="v:mpsBackend" class="def">mpsBackend</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Type" title="Language.Haskell.TH.Syntax">Type</a> <a href="src/Database.Persist.TH.html#mpsBackend" class="link">Source</a> <a href="#v:mpsBackend" class="selflink">#</a></p><div class="doc"><p>Which database backend we're using. This type is used for the
 <code><a href="Database-Persist-Class-PersistEntity.html#t:PersistEntityBackend" title="Database.Persist.Class.PersistEntity">PersistEntityBackend</a></code> associated type in the entities that are
 generated.</p><p>If the <code><a href="Database-Persist-TH.html#v:mpsGeneric" title="Database.Persist.TH">mpsGeneric</a></code> value is set to <code><a href="../base-4.16.4.0/Data-Bool.html#v:True" title="Data.Bool">True</a></code>, then this type is used for
 the non-Generic type alias. The data and type will be named:</p><pre>data ModelGeneric backend = Model { ... }
</pre><p>And, for convenience's sake, we provide a type alias:</p><pre>type Model = ModelGeneric $(the type you give here)
</pre></div></div><div class="top"><p class="src"><a id="v:mpsGeneric" class="def">mpsGeneric</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Database.Persist.TH.html#mpsGeneric" class="link">Source</a> <a href="#v:mpsGeneric" class="selflink">#</a></p><div class="doc"><div class="warning"><p>Deprecated: The mpsGeneric function adds a considerable amount of overhead and complexity to the library without bringing significant benefit. We would like to remove it. If you require this feature, please comment on the linked GitHub issue, and we'll either keep it around, or we can figure out a nicer way to solve your problem.

 Github: <a href="https://github.com/yesodweb/persistent/issues/1204">https://github.com/yesodweb/persistent/issues/1204</a></p></div><p>Create generic types that can be used with multiple backends. Good for
 reusable code, but makes error messages harder to understand. Default:
 False.</p></div></div><div class="top"><p class="src"><a id="v:mpsPrefixFields" class="def">mpsPrefixFields</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Database.Persist.TH.html#mpsPrefixFields" class="link">Source</a> <a href="#v:mpsPrefixFields" class="selflink">#</a></p><div class="doc"><p>Prefix field names with the model name. Default: True.</p><p>Note: this field is deprecated. Use the mpsFieldLabelModifier  and
 <code><a href="Database-Persist-TH.html#v:mpsConstraintLabelModifier" title="Database.Persist.TH">mpsConstraintLabelModifier</a></code> instead.</p></div></div><div class="top"><p class="src"><a id="v:mpsFieldLabelModifier" class="def">mpsFieldLabelModifier</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="src/Database.Persist.TH.html#mpsFieldLabelModifier" class="link">Source</a> <a href="#v:mpsFieldLabelModifier" class="selflink">#</a></p><div class="doc"><p>Customise the field accessors and lens names using the entity and field
 name.  Both arguments are upper cased.</p><p>Default: appends entity and field.</p><p>Note: this setting is ignored if mpsPrefixFields is set to False.</p><p><em>Since: 2.11.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:mpsConstraintLabelModifier" class="def">mpsConstraintLabelModifier</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="src/Database.Persist.TH.html#mpsConstraintLabelModifier" class="link">Source</a> <a href="#v:mpsConstraintLabelModifier" class="selflink">#</a></p><div class="doc"><p>Customise the Constraint names using the entity and field name. The
 result should be a valid haskell type (start with an upper cased letter).</p><p>Default: appends entity and field</p><p>Note: this setting is ignored if mpsPrefixFields is set to False.</p><p><em>Since: 2.11.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:mpsEntityJSON" class="def">mpsEntityJSON</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="../base-4.16.4.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Database-Persist-TH.html#t:EntityJSON" title="Database.Persist.TH">EntityJSON</a> <a href="src/Database.Persist.TH.html#mpsEntityJSON" class="link">Source</a> <a href="#v:mpsEntityJSON" class="selflink">#</a></p><div class="doc"><p>Generate <code>ToJSON</code>/<code>FromJSON</code> instances for each model types. If it's
 <code>Nothing</code>, no instances will be generated. Default:</p><pre> Just <code><a href="Database-Persist-TH.html#t:EntityJSON" title="Database.Persist.TH">EntityJSON</a></code>
     { <code><a href="Database-Persist-TH.html#v:entityToJSON" title="Database.Persist.TH">entityToJSON</a></code> = 'entityIdToJSON
     , <code><a href="Database-Persist-TH.html#v:entityFromJSON" title="Database.Persist.TH">entityFromJSON</a></code> = 'entityIdFromJSON
     }
</pre></div></div><div class="top"><p class="src"><a id="v:mpsGenerateLenses" class="def">mpsGenerateLenses</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Database.Persist.TH.html#mpsGenerateLenses" class="link">Source</a> <a href="#v:mpsGenerateLenses" class="selflink">#</a></p><div class="doc"><p>Instead of generating normal field accessors, generator lens-style
 accessors.</p><p>Default: False</p><p><em>Since: 1.3.1</em></p></div></div><div class="top"><p class="src"><a id="v:mpsDeriveInstances" class="def">mpsDeriveInstances</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Name" title="Language.Haskell.TH.Syntax">Name</a>] <a href="src/Database.Persist.TH.html#mpsDeriveInstances" class="link">Source</a> <a href="#v:mpsDeriveInstances" class="selflink">#</a></p><div class="doc"><p>Automatically derive these typeclass instances for all record and key
 types.</p><p>Default: []</p><p><em>Since: 2.8.1</em></p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:EntityJSON" class="def">EntityJSON</a> <a href="src/Database.Persist.TH.html#EntityJSON" class="link">Source</a> <a href="#t:EntityJSON" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:EntityJSON" class="def">EntityJSON</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:entityToJSON" class="def">entityToJSON</a> :: <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Name" title="Language.Haskell.TH.Syntax">Name</a></dfn><div class="doc"><p>Name of the <code>toJSON</code> implementation for <code>Entity a</code>.</p></div></li><li><dfn class="src"><a id="v:entityFromJSON" class="def">entityFromJSON</a> :: <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Name" title="Language.Haskell.TH.Syntax">Name</a></dfn><div class="doc"><p>Name of the <code>fromJSON</code> implementation for <code>Entity a</code>.</p></div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><a id="v:mkPersistSettings" class="def">mkPersistSettings</a> <a href="src/Database.Persist.TH.html#mkPersistSettings" class="link">Source</a> <a href="#v:mkPersistSettings" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Type" title="Language.Haskell.TH.Syntax">Type</a></td><td class="doc"><p>Value for <code><a href="Database-Persist-TH.html#v:mpsBackend" title="Database.Persist.TH">mpsBackend</a></code></p></td></tr><tr><td class="src">-&gt; <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Create an <code>MkPersistSettings</code> with default values.</p></div></div><div class="top"><p class="src"><a id="v:sqlSettings" class="def">sqlSettings</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> <a href="src/Database.Persist.TH.html#sqlSettings" class="link">Source</a> <a href="#v:sqlSettings" class="selflink">#</a></p><div class="doc"><p>Use the <code>SqlPersist</code> backend.</p></div></div><a href="#g:3" id="g:3"><h2>Implicit ID Columns</h2></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ImplicitIdDef" class="def">ImplicitIdDef</a> <a href="src/Database.Persist.ImplicitIdDef.Internal.html#ImplicitIdDef" class="link">Source</a> <a href="#t:ImplicitIdDef" class="selflink">#</a></p><div class="doc"><p>A specification for how the implied ID columns are created.</p><p>By default, <code>persistent</code> will give each table a default column named <code>id</code>
 (customizable by <code>PersistSettings</code>), and the column type will be whatever
 you'd expect from <code><code>BackendKey</code> yourBackendType</code>. For The <code>SqlBackend</code> type,
 this is an auto incrementing integer primary key.</p><p>You might want to give a different example. A common use case in postgresql
 is to use the UUID type, and automatically generate them using a SQL
 function.</p><p>Previously, you'd need to add a custom <code>Id</code> annotation for each model.</p><pre>User
    Id   UUID default=&quot;uuid_generate_v1mc()&quot;
    name Text

Dog
    Id   UUID default=&quot;uuid_generate_v1mc()&quot;
    name Text
    user UserId</pre><p>Now, you can simply create an <code><a href="Database-Persist-TH.html#t:ImplicitIdDef" title="Database.Persist.TH">ImplicitIdDef</a></code> that corresponds to this
 declaration.</p><pre>newtype UUID = UUID <code>ByteString</code>

instance <code><a href="Database-Persist-Class-PersistField.html#t:PersistField" title="Database.Persist.Class.PersistField">PersistField</a></code> UUID where
    <code>toPersistValue</code> (UUID bs) =
        <code><a href="Database-Persist-PersistValue.html#v:PersistLiteral_" title="Database.Persist.PersistValue">PersistLiteral_</a></code> <code><a href="Database-Persist-PersistValue.html#v:Escaped" title="Database.Persist.PersistValue">Escaped</a></code> bs
    <code>fromPersistValue</code> pv =
        case pv of
            PersistLiteral_ Escaped bs -&gt;
                Right (UUID bs)
            _ -&gt;
                Left &quot;nope&quot;

instance <code><a href="Database-Persist-Sql.html#t:PersistFieldSql" title="Database.Persist.Sql">PersistFieldSql</a></code> UUID where
    <code><a href="Database-Persist-Sql.html#v:sqlType" title="Database.Persist.Sql">sqlType</a></code> _ = <code><a href="Database-Persist-Types.html#v:SqlOther" title="Database.Persist.Types">SqlOther</a></code> <a href="UUID.html">UUID</a>
</pre><p>With this instance at the ready, we can now create our implicit definition:</p><pre>uuidDef :: ImplicitIdDef
uuidDef = mkImplicitIdDef @UUID &quot;uuid_generate_v1mc()&quot;
</pre><p>And we can use <code>setImplicitIdDef</code> to use this with the <code>MkPersistSettings</code>
 for our block.</p><pre>mkPersist (setImplicitIdDef uuidDef sqlSettings) [persistLowerCase| ... |]
</pre><p>TODO: either explain interaction with mkMigrate or fix it. see issue #1249
 for more details.</p><p><em>Since: 2.13.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:setImplicitIdDef" class="def">setImplicitIdDef</a> :: <a href="Database-Persist-TH.html#t:ImplicitIdDef" title="Database.Persist.TH">ImplicitIdDef</a> -&gt; <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> <a href="src/Database.Persist.TH.html#setImplicitIdDef" class="link">Source</a> <a href="#v:setImplicitIdDef" class="selflink">#</a></p><div class="doc"><p>Set the <code><a href="Database-Persist-TH.html#t:ImplicitIdDef" title="Database.Persist.TH">ImplicitIdDef</a></code> in the given <code><a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a></code>. The default
 value is <code><a href="Database-Persist-ImplicitIdDef.html#v:autoIncrementingInteger" title="Database.Persist.ImplicitIdDef">autoIncrementingInteger</a></code>.</p><p><em>Since: 2.13.0.0</em></p></div></div><a href="#g:4" id="g:4"><h1>Various other TH functions</h1></a><div class="top"><p class="src"><a id="v:mkMigrate" class="def">mkMigrate</a> :: <a href="../base-4.16.4.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; [<a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a>] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>] <a href="src/Database.Persist.TH.html#mkMigrate" class="link">Source</a> <a href="#v:mkMigrate" class="selflink">#</a></p><div class="doc"><p>Creates a single function to perform all migrations for the entities
 defined here. One thing to be aware of is dependencies: if you have entities
 with foreign references, make sure to place those definitions after the
 entities they reference.</p><p>In <code>persistent-2.13.0.0</code>, this was changed to *ignore* the input entity def
 list, and instead defer to <code><a href="Database-Persist-TH.html#v:mkEntityDefList" title="Database.Persist.TH">mkEntityDefList</a></code> to get the correct entities.
 This avoids problems where the QuasiQuoter is unable to know what the right
 reference types are. This sets <code><a href="Database-Persist-TH.html#v:mkPersist" title="Database.Persist.TH">mkPersist</a></code> to be the &quot;single source of truth&quot;
 for entity definitions.</p></div></div><div class="top"><p class="src"><a id="v:migrateModels" class="def">migrateModels</a> :: [<a href="Database-Persist-EntityDef-Internal.html#t:EntityDef" title="Database.Persist.EntityDef.Internal">EntityDef</a>] -&gt; <a href="Database-Persist-Sql-Migration.html#t:Migration" title="Database.Persist.Sql.Migration">Migration</a> <a href="src/Database.Persist.TH.html#migrateModels" class="link">Source</a> <a href="#v:migrateModels" class="selflink">#</a></p><div class="doc"><p>The basic function for migrating models, no Template Haskell required.</p><p>It's probably best to use this in concert with <code><a href="Database-Persist-TH.html#v:mkEntityDefList" title="Database.Persist.TH">mkEntityDefList</a></code>, and then
 call <code><a href="Database-Persist-TH.html#v:migrateModels" title="Database.Persist.TH">migrateModels</a></code> with the result from that function.</p><pre>share [mkPersist sqlSettings, mkEntityDefList &quot;entities&quot;] [persistLowerCase| ... |]

migrateAll = <code><a href="Database-Persist-TH.html#v:migrateModels" title="Database.Persist.TH">migrateModels</a></code> entities
</pre><p>The function <code><a href="Database-Persist-TH.html#v:mkMigrate" title="Database.Persist.TH">mkMigrate</a></code> currently implements exactly this behavior now. If
 you're splitting up the entity definitions into separate files, then it is
 better to use the entity definition list and the concatenate all the models
 together into a big list to call with <code><a href="Database-Persist-TH.html#v:migrateModels" title="Database.Persist.TH">migrateModels</a></code>.</p><pre>module Foo where

    share [mkPersist s, mkEntityDefList &quot;fooModels&quot;] ...


module Bar where

    share [mkPersist s, mkEntityDefList &quot;barModels&quot;] ...

module Migration where

    import Foo
    import Bar

    migrateAll = migrateModels (fooModels &lt;&gt; barModels)
</pre><p><em>Since: 2.13.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:discoverEntities" class="def">discoverEntities</a> :: <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Exp" title="Language.Haskell.TH.Syntax">Exp</a> <a href="src/Database.Persist.TH.html#discoverEntities" class="link">Source</a> <a href="#v:discoverEntities" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mkSave" class="def">mkSave</a> :: <a href="../base-4.16.4.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; [<a href="Database-Persist-EntityDef-Internal.html#t:EntityDef" title="Database.Persist.EntityDef.Internal">EntityDef</a>] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>] <a href="src/Database.Persist.TH.html#mkSave" class="link">Source</a> <a href="#v:mkSave" class="selflink">#</a></p><div class="doc"><div class="warning"><p>Deprecated: This function is broken. mkEntityDefList is a drop-in replacement that will properly handle foreign keys correctly.</p></div><p>Save the <code>EntityDef</code>s passed in under the given name.</p><p>This function was deprecated in <code>persistent-2.13.0.0</code>. It doesn't properly
 fix foreign keys. Please refer to <code><a href="Database-Persist-TH.html#v:mkEntityDefList" title="Database.Persist.TH">mkEntityDefList</a></code> for a replacement.</p></div></div><div class="top"><p class="src"><a id="v:mkDeleteCascade" class="def">mkDeleteCascade</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; [<a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a>] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>] <a href="src/Database.Persist.TH.html#mkDeleteCascade" class="link">Source</a> <a href="#v:mkDeleteCascade" class="selflink">#</a></p><div class="doc"><div class="warning"><p>Deprecated: You can now set update and delete cascade behavior directly on the entity in the quasiquoter. This function and class are deprecated and will be removed in the next major ersion.</p></div><p>Generate a <code><a href="Database-Persist-Class-DeleteCascade.html#t:DeleteCascade" title="Database.Persist.Class.DeleteCascade">DeleteCascade</a></code> instance for the given <code>EntityDef</code>s.</p><p>This function is deprecated as of 2.13.0.0. You can now set cascade
 behavior directly in the quasiquoter.</p></div></div><div class="top"><p class="src"><a id="v:mkEntityDefList" class="def">mkEntityDefList</a> <a href="src/Database.Persist.TH.html#mkEntityDefList" class="link">Source</a> <a href="#v:mkEntityDefList" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../base-4.16.4.0/Data-String.html#t:String" title="Data.String">String</a></td><td class="doc"><p>The name that will be given to the <code><a href="Database-Persist-EntityDef-Internal.html#t:EntityDef" title="Database.Persist.EntityDef.Internal">EntityDef</a></code> list.</p></td></tr><tr><td class="src">-&gt; [<a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a>]</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Creates a declaration for the <code>[<code><a href="Database-Persist-EntityDef-Internal.html#t:EntityDef" title="Database.Persist.EntityDef.Internal">EntityDef</a></code>]</code> from the <code>persistent</code>
 schema. This is necessary because the Persistent QuasiQuoter is unable
 to know the correct type of ID fields, and assumes that they are all
 Int64.</p><p>Provide this in the list you give to <code><a href="Database-Persist-TH.html#v:share" title="Database.Persist.TH">share</a></code>, much like <code><code><a href="Database-Persist-TH.html#v:mkMigrate" title="Database.Persist.TH">mkMigrate</a></code></code>.</p><pre><code><a href="Database-Persist-TH.html#v:share" title="Database.Persist.TH">share</a></code> [<code><a href="Database-Persist-TH.html#v:mkMigrate" title="Database.Persist.TH">mkMigrate</a></code> &quot;migrateAll&quot;, <code><a href="Database-Persist-TH.html#v:mkEntityDefList" title="Database.Persist.TH">mkEntityDefList</a></code> &quot;entityDefs&quot;] [...]
</pre><p><em>Since: 2.7.1</em></p></div></div><div class="top"><p class="src"><a id="v:share" class="def">share</a> :: [[a] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>]] -&gt; [a] -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>] <a href="src/Database.Persist.TH.html#share" class="link">Source</a> <a href="#v:share" class="selflink">#</a></p><div class="doc"><p>Apply the given list of functions to the same <code>EntityDef</code>s.</p><p>This function is useful for cases such as:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>share [mkSave &quot;myDefs&quot;, mkPersist sqlSettings] [persistLowerCase|...|]
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:derivePersistField" class="def">derivePersistField</a> :: <a href="../base-4.16.4.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>] <a href="src/Database.Persist.TH.html#derivePersistField" class="link">Source</a> <a href="#v:derivePersistField" class="selflink">#</a></p><div class="doc"><p>Automatically creates a valid <code><a href="Database-Persist-Class-PersistField.html#t:PersistField" title="Database.Persist.Class.PersistField">PersistField</a></code> instance for any datatype
 that has valid <code><a href="../base-4.16.4.0/Text-Show.html#t:Show" title="Text.Show">Show</a></code> and <code><a href="../base-4.16.4.0/Text-Read.html#t:Read" title="Text.Read">Read</a></code> instances. Can be very convenient for
 <code><a href="../base-4.16.4.0/Prelude.html#t:Enum" title="Prelude">Enum</a></code> types.</p></div></div><div class="top"><p class="src"><a id="v:derivePersistFieldJSON" class="def">derivePersistFieldJSON</a> :: <a href="../base-4.16.4.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>] <a href="src/Database.Persist.TH.html#derivePersistFieldJSON" class="link">Source</a> <a href="#v:derivePersistFieldJSON" class="selflink">#</a></p><div class="doc"><p>Automatically creates a valid <code><a href="Database-Persist-Class-PersistField.html#t:PersistField" title="Database.Persist.Class.PersistField">PersistField</a></code> instance for any datatype
 that has valid <code><a href="../aeson-2.0.3.0/Data-Aeson-Types.html#t:ToJSON" title="Data.Aeson.Types">ToJSON</a></code> and <code><a href="../aeson-2.0.3.0/Data-Aeson-Types.html#t:FromJSON" title="Data.Aeson.Types">FromJSON</a></code> instances. For a datatype <code>T</code> it
 generates instances similar to these:</p><pre>   instance PersistField T where
       toPersistValue = PersistByteString . L.toStrict . encode
       fromPersistValue = (left T.pack) . eitherDecodeStrict' &lt;=&lt; fromPersistValue
   instance PersistFieldSql T where
       sqlType _ = SqlString
</pre></div></div><div class="top"><p class="src"><a id="v:persistFieldFromEntity" class="def">persistFieldFromEntity</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a> -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> [<a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Dec" title="Language.Haskell.TH.Syntax">Dec</a>] <a href="src/Database.Persist.TH.html#persistFieldFromEntity" class="link">Source</a> <a href="#v:persistFieldFromEntity" class="selflink">#</a></p><div class="doc"><p>Produce code similar to the following:</p><pre>  instance PersistEntity e =&gt; PersistField e where
     toPersistValue = entityToPersistValueHelper
     fromPersistValue = entityFromPersistValueHelper [&quot;col1&quot;, &quot;col2&quot;]
     sqlType _ = SqlString
</pre></div></div><a href="#g:5" id="g:5"><h1>Internal</h1></a><div class="top"><p class="src"><a id="v:lensPTH" class="def">lensPTH</a> :: (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b <a href="src/Database.Persist.TH.html#lensPTH" class="link">Source</a> <a href="#v:lensPTH" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:parseReferences" class="def">parseReferences</a> :: <a href="Database-Persist-Quasi-Internal.html#t:PersistSettings" title="Database.Persist.Quasi.Internal">PersistSettings</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Q" title="Language.Haskell.TH.Syntax">Q</a> <a href="../template-haskell-2.18.0.0/Language-Haskell-TH-Syntax.html#t:Exp" title="Language.Haskell.TH.Syntax">Exp</a> <a href="src/Database.Persist.TH.html#parseReferences" class="link">Source</a> <a href="#v:parseReferences" class="selflink">#</a></p><div class="doc"><p>Calls <code><a href="Database-Persist-Quasi-Internal.html#v:parse" title="Database.Persist.Quasi.Internal">parse</a></code> to Quasi.parse individual entities in isolation
 afterwards, sets references to other entities</p><p>In 2.13.0.0, this was changed to splice in <code>[<code><a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a></code>]</code>
 instead of <code>[<code><a href="Database-Persist-EntityDef-Internal.html#t:EntityDef" title="Database.Persist.EntityDef.Internal">EntityDef</a></code>]</code>.</p><p><em>Since: 2.5.3</em></p></div></div><div class="top"><p class="src"><a id="v:embedEntityDefs" class="def">embedEntityDefs</a> <a href="src/Database.Persist.TH.html#embedEntityDefs" class="link">Source</a> <a href="#v:embedEntityDefs" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [<a href="Database-Persist-EntityDef-Internal.html#t:EntityDef" title="Database.Persist.EntityDef.Internal">EntityDef</a>]</td><td class="doc"><p>A list of <code><a href="Database-Persist-EntityDef-Internal.html#t:EntityDef" title="Database.Persist.EntityDef.Internal">EntityDef</a></code> that have been defined in a previous <code><a href="Database-Persist-TH.html#v:mkPersist" title="Database.Persist.TH">mkPersist</a></code>
 call.</p><p><em>Since: 2.13.0.0</em></p></td></tr><tr><td class="src">-&gt; [<a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a>]</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; [<a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a>]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Takes a list of (potentially) independently defined entities and properly
 links all foreign keys to reference the right <code><a href="Database-Persist-EntityDef-Internal.html#t:EntityDef" title="Database.Persist.EntityDef.Internal">EntityDef</a></code>, tying the knot
 between entities.</p><p>Allows users to define entities indepedently or in separate modules and then
 fix the cross-references between them at runtime to create a <code><a href="Database-Persist-Sql-Migration.html#t:Migration" title="Database.Persist.Sql.Migration">Migration</a></code>.</p><p><em>Since: 2.7.2</em></p></div></div><div class="top"><p class="src"><a id="v:fieldError" class="def">fieldError</a> :: <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.5.0/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="src/Database.Persist.TH.html#fieldError" class="link">Source</a> <a href="#v:fieldError" class="selflink">#</a></p><div class="doc"><p>Render an error message based on the <code>tableName</code> and <code>fieldName</code> with
 the provided message.</p><p><em>Since: 2.8.2</em></p></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a href="Database-Persist-Class-PersistEntity.html#t:PersistEntity" title="Database.Persist.Class.PersistEntity">PersistEntity</a> record =&gt; <a id="t:AtLeastOneUniqueKey" class="def">AtLeastOneUniqueKey</a> record <span class="keyword">where</span> <a href="src/Database.Persist.Class.PersistUnique.html#AtLeastOneUniqueKey" class="link">Source</a> <a href="#t:AtLeastOneUniqueKey" class="selflink">#</a></p><div class="doc"><p>This class is used to ensure that functions requring at least one
 unique key are not called with records that have 0 unique keys. The
 quasiquoter automatically writes working instances for appropriate
 entities, and generates <code>TypeError</code> instances for records that have
 0 unique keys.</p><p><em>Since: 2.10.0</em></p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:requireUniquesP" class="def">requireUniquesP</a> :: record -&gt; <a href="../base-4.16.4.0/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> (<a href="Database-Persist-Class-PersistEntity.html#t:Unique" title="Database.Persist.Class.PersistEntity">Unique</a> record) <a href="src/Database.Persist.Class.PersistUnique.html#requireUniquesP" class="link">Source</a> <a href="#v:requireUniquesP" class="selflink">#</a></p></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a href="Database-Persist-Class-PersistEntity.html#t:PersistEntity" title="Database.Persist.Class.PersistEntity">PersistEntity</a> record =&gt; <a id="t:OnlyOneUniqueKey" class="def">OnlyOneUniqueKey</a> record <span class="keyword">where</span> <a href="src/Database.Persist.Class.PersistUnique.html#OnlyOneUniqueKey" class="link">Source</a> <a href="#t:OnlyOneUniqueKey" class="selflink">#</a></p><div class="doc"><p>This class is used to ensure that <code><a href="Database-Persist-Class-PersistUnique.html#v:upsert" title="Database.Persist.Class.PersistUnique">upsert</a></code> is only called on records
 that have a single <code><a href="Database-Persist-Class-PersistEntity.html#t:Unique" title="Database.Persist.Class.PersistEntity">Unique</a></code> key. The quasiquoter automatically generates
 working instances for appropriate records, and generates <code>TypeError</code>
 instances for records that have 0 or multiple unique keys.</p><p><em>Since: 2.10.0</em></p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:onlyUniqueP" class="def">onlyUniqueP</a> :: record -&gt; <a href="Database-Persist-Class-PersistEntity.html#t:Unique" title="Database.Persist.Class.PersistEntity">Unique</a> record <a href="src/Database.Persist.Class.PersistUnique.html#onlyUniqueP" class="link">Source</a> <a href="#v:onlyUniqueP" class="selflink">#</a></p></div></div><div class="top"><p class="src"><a id="v:pkNewtype" class="def">pkNewtype</a> :: <a href="Database-Persist-TH.html#t:MkPersistSettings" title="Database.Persist.TH">MkPersistSettings</a> -&gt; <a href="Database-Persist-Quasi-Internal.html#t:UnboundEntityDef" title="Database.Persist.Quasi.Internal">UnboundEntityDef</a> -&gt; <a href="../base-4.16.4.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Database.Persist.TH.html#pkNewtype" class="link">Source</a> <a href="#v:pkNewtype" class="selflink">#</a></p><div class="doc"><p>Returns <code><a href="../base-4.16.4.0/Data-Bool.html#v:True" title="Data.Bool">True</a></code> if the key definition has less than 2 fields.</p><p><em>Since: 2.11.0.0</em></p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.26.0</p></div></body></html>