<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP             #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveFunctor   #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_GHC -optc-DNON_POSIX_SOURCE #-}</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">--  (c) The University of Glasgow 2002-2006</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-comment">-- | Bytecode assembler and linker</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.ByteCode.Asm</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-11"></span><span>        </span><span class="annot"><a href="GHC.ByteCode.Asm.html#assembleBCOs"><span class="hs-identifier">assembleBCOs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#assembleOneBCO"><span class="hs-identifier">assembleOneBCO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>        </span><span class="annot"><a href="GHC.ByteCode.Asm.html#bcoFreeNames"><span class="hs-identifier">bcoFreeNames</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>        </span><span class="annot"><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#SizedSeq"><span class="hs-identifier">SizedSeq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#sizeSS"><span class="hs-identifier">sizeSS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#ssElts"><span class="hs-identifier">ssElts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>        </span><span class="annot"><a href="GHC.ByteCode.Asm.html#iNTERP_STACK_CHECK_THRESH"><span class="hs-identifier">iNTERP_STACK_CHECK_THRESH</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>        </span><span class="annot"><a href="GHC.ByteCode.Asm.html#mkTupleInfoLit"><span class="hs-identifier">mkTupleInfoLit</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#include &quot;HsVersions.h&quot;
</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html"><span class="hs-identifier">GHC.ByteCode.Instr</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.ByteCode.InfoTable.html"><span class="hs-identifier">GHC.ByteCode.InfoTable</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html"><span class="hs-identifier">GHC.ByteCode.Types</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../ghci-9.2.7/src/GHCi-RemoteTypes.html#"><span class="hs-identifier">GHCi.RemoteTypes</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Runtime.Interpreter.html"><span class="hs-identifier">GHC.Runtime.Interpreter</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Runtime.Heap.Layout.html"><span class="hs-identifier">GHC.Runtime.Heap.Layout</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Types.html#WordOff"><span class="hs-identifier">WordOff</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html"><span class="hs-identifier">GHC.Types.Name.Set</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html"><span class="hs-identifier">GHC.Types.Literal</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html"><span class="hs-identifier">GHC.Types.Unique</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSet.html"><span class="hs-identifier">GHC.Types.Unique.DSet</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#"><span class="hs-identifier">GHC.Data.SizedSeq</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.StgToCmm.Layout.html"><span class="hs-identifier">GHC.StgToCmm.Layout</span></a></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.StgToCmm.ArgRep.html#ArgRep"><span class="hs-identifier">ArgRep</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Expr.html"><span class="hs-identifier">GHC.Cmm.Expr</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.CallConv.html"><span class="hs-identifier">GHC.Cmm.CallConv</span></a></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Cmm.CallConv.html#tupleRegsCover"><span class="hs-identifier">tupleRegsCover</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.html"><span class="hs-identifier">GHC.Platform</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.Profile.html"><span class="hs-identifier">GHC.Platform.Profile</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Control-Monad.html#"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Control-Monad-ST.html#"><span class="hs-identifier">Control.Monad.ST</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-ST.html#runST"><span class="hs-identifier">runST</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-Class.html#"><span class="hs-identifier">Control.Monad.Trans.Class</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-State-Strict.html#"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../array-0.5.4.0/src/Data-Array-MArray.html#"><span class="hs-identifier">Data.Array.MArray</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../array-0.5.4.0/src/Data-Array-Unboxed.html#"><span class="hs-identifier">Data.Array.Unboxed</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Array</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../array-0.5.4.0/src/Data-Array-Base.html#"><span class="hs-identifier">Data.Array.Base</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../array-0.5.4.0/src/Data-Array-Base.html#UArray"><span class="hs-identifier">UArray</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../array-0.5.4.0/src/Data-Array-Unsafe.html#"><span class="hs-identifier">Data.Array.Unsafe</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../array-0.5.4.0/src/Data-Array-Base.html#castSTUArray"><span class="hs-identifier">castSTUArray</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Foreign.html#"><span class="hs-identifier">Foreign</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Bits.html#shiftL"><span class="hs-identifier">shiftL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Bits.html#shiftR"><span class="hs-identifier">shiftR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-Char.html#"><span class="hs-identifier">Data.Char</span></a></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#ord"><span class="hs-identifier">ord</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-List.html#"><span class="hs-identifier">Data.List</span></a></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-OldList.html#genericLength"><span class="hs-identifier">genericLength</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../containers-0.6.5.1/src/Data-Map-Strict.html#"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../containers-0.6.5.1/src/Data-Map-Internal.html#Map"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-Maybe.html#"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.4.0/src/Data-Maybe.html#fromMaybe"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.6.5.1/src/Data-Map-Strict.html#"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- Unlinked BCOs</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- CompiledByteCode represents the result of byte-code</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- compiling a bunch of functions and data types</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- | Finds external references.  Remember to remove the names</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- defined by this group of BCOs themselves</span><span>
</span><span id="line-76"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#bcoFreeNames"><span class="hs-identifier hs-type">bcoFreeNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-type">UnlinkedBCO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.DSet.html#UniqDSet"><span class="hs-identifier hs-type">UniqDSet</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-77"></span><span id="bcoFreeNames"><span class="annot"><span class="annottext">bcoFreeNames :: UnlinkedBCO -&gt; UniqDSet Name
</span><a href="GHC.ByteCode.Asm.html#bcoFreeNames"><span class="hs-identifier hs-var hs-var">bcoFreeNames</span></a></span></span><span> </span><span id="local-6989586621681285332"><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621681285332"><span class="hs-identifier hs-var">bco</span></a></span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; UniqDSet Name
</span><a href="#local-6989586621681285331"><span class="hs-identifier hs-var">bco_refs</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621681285332"><span class="hs-identifier hs-var">bco</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. UniqDSet a -&gt; UniqSet a -&gt; UniqDSet a
</span><a href="GHC.Types.Unique.DSet.html#uniqDSetMinusUniqSet"><span class="hs-operator hs-var">`uniqDSetMinusUniqSet`</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; NameSet
</span><a href="GHC.Types.Name.Set.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; Name
</span><a href="GHC.ByteCode.Types.html#unlinkedBCOName"><span class="hs-identifier hs-var">unlinkedBCOName</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621681285332"><span class="hs-identifier hs-var">bco</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>    </span><span id="local-6989586621681285331"><span class="annot"><span class="annottext">bco_refs :: UnlinkedBCO -&gt; UniqDSet Name
</span><a href="#local-6989586621681285331"><span class="hs-identifier hs-var hs-var">bco_refs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-type">UnlinkedBCO</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UArray Int Word16
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UArray Int Word64
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681285323"><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621681285323"><span class="hs-identifier hs-var">nonptrs</span></a></span></span><span> </span><span id="local-6989586621681285322"><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681285322"><span class="hs-identifier hs-var">ptrs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [UniqDSet a] -&gt; UniqDSet a
</span><a href="GHC.Types.Unique.DSet.html#unionManyUniqDSets"><span class="hs-identifier hs-var">unionManyUniqDSets</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-82"></span><span>             </span><span class="annot"><span class="annottext">forall a. Uniquable a =&gt; [a] -&gt; UniqDSet a
</span><a href="GHC.Types.Unique.DSet.html#mkUniqDSet"><span class="hs-identifier hs-var">mkUniqDSet</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681285319"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtrName"><span class="hs-identifier hs-type">BCOPtrName</span></a></span><span> </span><span id="local-6989586621681285319"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681285319"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. SizedSeq a -&gt; [a]
</span><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#ssElts"><span class="hs-identifier hs-var">ssElts</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681285322"><span class="hs-identifier hs-var">ptrs</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-83"></span><span>             </span><span class="annot"><span class="annottext">forall a. Uniquable a =&gt; [a] -&gt; UniqDSet a
</span><a href="GHC.Types.Unique.DSet.html#mkUniqDSet"><span class="hs-identifier hs-var">mkUniqDSet</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681285317"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCONPtrItbl"><span class="hs-identifier hs-type">BCONPtrItbl</span></a></span><span> </span><span id="local-6989586621681285317"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681285317"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. SizedSeq a -&gt; [a]
</span><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#ssElts"><span class="hs-identifier hs-var">ssElts</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621681285323"><span class="hs-identifier hs-var">nonptrs</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-84"></span><span>             </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; UniqDSet Name
</span><a href="#local-6989586621681285331"><span class="hs-identifier hs-var">bco_refs</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621681285315"><span class="hs-identifier hs-var">bco</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-type">BCOPtrBCO</span></a></span><span> </span><span id="local-6989586621681285315"><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621681285315"><span class="hs-identifier hs-var">bco</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. SizedSeq a -&gt; [a]
</span><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#ssElts"><span class="hs-identifier hs-var">ssElts</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681285322"><span class="hs-identifier hs-var">ptrs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-85"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- The bytecode assembler</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- The object format for bytecodes is: 16 bits for the opcode, and 16</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- for each field -- so the code can be considered a sequence of</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- 16-bit ints.  Each field denotes either a stack offset or number of</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- items on the stack (eg SLIDE), and index into the pointer table (eg</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- PUSH_G), an index into the literal table (eg PUSH_I/D/L), or a</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- bytecode address in this BCO.</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">-- Top level assembler fn.</span><span>
</span><span id="line-98"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#assembleBCOs"><span class="hs-identifier hs-type">assembleBCOs</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Runtime.Interpreter.Types.html#Interp"><span class="hs-identifier hs-type">Interp</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Profile.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.ByteCode.Instr.html#ProtoBCO"><span class="hs-identifier hs-type">ProtoBCO</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../ghci-9.2.7/src/GHCi-RemoteTypes.html#RemotePtr"><span class="hs-identifier hs-type">RemotePtr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#ModBreaks"><span class="hs-identifier hs-type">ModBreaks</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#CompiledByteCode"><span class="hs-identifier hs-type">CompiledByteCode</span></a></span><span>
</span><span id="line-106"></span><span id="assembleBCOs"><span class="annot"><span class="annottext">assembleBCOs :: Interp
-&gt; Profile
-&gt; [ProtoBCO Name]
-&gt; [TyCon]
-&gt; [RemotePtr ()]
-&gt; Maybe ModBreaks
-&gt; IO CompiledByteCode
</span><a href="GHC.ByteCode.Asm.html#assembleBCOs"><span class="hs-identifier hs-var hs-var">assembleBCOs</span></a></span></span><span> </span><span id="local-6989586621681285313"><span class="annot"><span class="annottext">Interp
</span><a href="#local-6989586621681285313"><span class="hs-identifier hs-var">interp</span></a></span></span><span> </span><span id="local-6989586621681285312"><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621681285312"><span class="hs-identifier hs-var">profile</span></a></span></span><span> </span><span id="local-6989586621681285311"><span class="annot"><span class="annottext">[ProtoBCO Name]
</span><a href="#local-6989586621681285311"><span class="hs-identifier hs-var">proto_bcos</span></a></span></span><span> </span><span id="local-6989586621681285310"><span class="annot"><span class="annottext">[TyCon]
</span><a href="#local-6989586621681285310"><span class="hs-identifier hs-var">tycons</span></a></span></span><span> </span><span id="local-6989586621681285309"><span class="annot"><span class="annottext">[RemotePtr ()]
</span><a href="#local-6989586621681285309"><span class="hs-identifier hs-var">top_strs</span></a></span></span><span> </span><span id="local-6989586621681285308"><span class="annot"><span class="annottext">Maybe ModBreaks
</span><a href="#local-6989586621681285308"><span class="hs-identifier hs-var">modbreaks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-comment">-- TODO: the profile should be bundled with the interpreter: the rts ways are</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-comment">-- fixed for an interpreter</span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621681285307"><span class="annot"><span class="annottext">ItblEnv
</span><a href="#local-6989586621681285307"><span class="hs-identifier hs-var">itblenv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Interp -&gt; Profile -&gt; [TyCon] -&gt; IO ItblEnv
</span><a href="GHC.ByteCode.InfoTable.html#mkITbls"><span class="hs-identifier hs-var">mkITbls</span></a></span><span> </span><span class="annot"><span class="annottext">Interp
</span><a href="#local-6989586621681285313"><span class="hs-identifier hs-var">interp</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621681285312"><span class="hs-identifier hs-var">profile</span></a></span><span> </span><span class="annot"><span class="annottext">[TyCon]
</span><a href="#local-6989586621681285310"><span class="hs-identifier hs-var">tycons</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621681285305"><span class="annot"><span class="annottext">[UnlinkedBCO]
</span><a href="#local-6989586621681285305"><span class="hs-identifier hs-var">bcos</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base-4.16.4.0/src/Data-Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; ProtoBCO Name -&gt; IO UnlinkedBCO
</span><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-var">assembleBCO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Profile -&gt; Platform
</span><a href="GHC.Platform.Profile.html#profilePlatform"><span class="hs-identifier hs-var">profilePlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621681285312"><span class="hs-identifier hs-var">profile</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProtoBCO Name]
</span><a href="#local-6989586621681285311"><span class="hs-identifier hs-var">proto_bcos</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681285301"><span class="annot"><span class="annottext">[UnlinkedBCO]
</span><a href="#local-6989586621681285301"><span class="hs-identifier hs-var">bcos'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681285300"><span class="annot"><span class="annottext">[RemotePtr ()]
</span><a href="#local-6989586621681285300"><span class="hs-identifier hs-var">ptrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Interp -&gt; [UnlinkedBCO] -&gt; IO ([UnlinkedBCO], [RemotePtr ()])
</span><a href="GHC.ByteCode.Asm.html#mallocStrings"><span class="hs-identifier hs-var">mallocStrings</span></a></span><span> </span><span class="annot"><span class="annottext">Interp
</span><a href="#local-6989586621681285313"><span class="hs-identifier hs-var">interp</span></a></span><span> </span><span class="annot"><span class="annottext">[UnlinkedBCO]
</span><a href="#local-6989586621681285305"><span class="hs-identifier hs-var">bcos</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#CompiledByteCode"><span class="hs-identifier hs-type">CompiledByteCode</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bc_bcos :: [UnlinkedBCO]
</span><a href="GHC.ByteCode.Types.html#bc_bcos"><span class="hs-identifier hs-var">bc_bcos</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[UnlinkedBCO]
</span><a href="#local-6989586621681285301"><span class="hs-identifier hs-var">bcos'</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bc_itbls :: ItblEnv
</span><a href="GHC.ByteCode.Types.html#bc_itbls"><span class="hs-identifier hs-var">bc_itbls</span></a></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">ItblEnv
</span><a href="#local-6989586621681285307"><span class="hs-identifier hs-var">itblenv</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bc_ffis :: [FFIInfo]
</span><a href="GHC.ByteCode.Types.html#bc_ffis"><span class="hs-identifier hs-var">bc_ffis</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. ProtoBCO a -&gt; [FFIInfo]
</span><a href="GHC.ByteCode.Instr.html#protoBCOFFIs"><span class="hs-identifier hs-var">protoBCOFFIs</span></a></span><span> </span><span class="annot"><span class="annottext">[ProtoBCO Name]
</span><a href="#local-6989586621681285311"><span class="hs-identifier hs-var">proto_bcos</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bc_strs :: [RemotePtr ()]
</span><a href="GHC.ByteCode.Types.html#bc_strs"><span class="hs-identifier hs-var">bc_strs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RemotePtr ()]
</span><a href="#local-6989586621681285309"><span class="hs-identifier hs-var">top_strs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[RemotePtr ()]
</span><a href="#local-6989586621681285300"><span class="hs-identifier hs-var">ptrs</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bc_breaks :: Maybe ModBreaks
</span><a href="GHC.ByteCode.Types.html#bc_breaks"><span class="hs-identifier hs-var">bc_breaks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ModBreaks
</span><a href="#local-6989586621681285308"><span class="hs-identifier hs-var">modbreaks</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- Find all the literal strings and malloc them together.  We want to</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- do this because:</span><span>
</span><span id="line-122"></span><span class="hs-comment">--</span><span>
</span><span id="line-123"></span><span class="hs-comment">--  a) It should be done when we compile the module, not each time we relink it</span><span>
</span><span id="line-124"></span><span class="hs-comment">--  b) For -fexternal-interpreter It's more efficient to malloc the strings</span><span>
</span><span id="line-125"></span><span class="hs-comment">--     as a single batch message, especially when compiling in parallel.</span><span>
</span><span id="line-126"></span><span class="hs-comment">--</span><span>
</span><span id="line-127"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#mallocStrings"><span class="hs-identifier hs-type">mallocStrings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Runtime.Interpreter.Types.html#Interp"><span class="hs-identifier hs-type">Interp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-type">UnlinkedBCO</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-type">UnlinkedBCO</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../ghci-9.2.7/src/GHCi-RemoteTypes.html#RemotePtr"><span class="hs-identifier hs-type">RemotePtr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span id="mallocStrings"><span class="annot"><span class="annottext">mallocStrings :: Interp -&gt; [UnlinkedBCO] -&gt; IO ([UnlinkedBCO], [RemotePtr ()])
</span><a href="GHC.ByteCode.Asm.html#mallocStrings"><span class="hs-identifier hs-var hs-var">mallocStrings</span></a></span></span><span> </span><span id="local-6989586621681285290"><span class="annot"><span class="annottext">Interp
</span><a href="#local-6989586621681285290"><span class="hs-identifier hs-var">interp</span></a></span></span><span> </span><span id="local-6989586621681285289"><span class="annot"><span class="annottext">[UnlinkedBCO]
</span><a href="#local-6989586621681285289"><span class="hs-identifier hs-var">ulbcos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681285288"><span class="annot"><span class="annottext">bytestrings :: [ByteString]
</span><a href="#local-6989586621681285288"><span class="hs-identifier hs-var hs-var">bytestrings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s a. State s a -&gt; s -&gt; s
</span><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-State-Strict.html#execState"><span class="hs-identifier hs-var">execState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *}.
Monad m =&gt;
UnlinkedBCO -&gt; StateT [ByteString] m ()
</span><a href="#local-6989586621681285284"><span class="hs-identifier hs-var">collect</span></a></span><span> </span><span class="annot"><span class="annottext">[UnlinkedBCO]
</span><a href="#local-6989586621681285289"><span class="hs-identifier hs-var">ulbcos</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621681285283"><span class="annot"><span class="annottext">[RemotePtr ()]
</span><a href="#local-6989586621681285283"><span class="hs-identifier hs-var">ptrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Binary a =&gt; Interp -&gt; Message a -&gt; IO a
</span><a href="GHC.Runtime.Interpreter.html#interpCmd"><span class="hs-identifier hs-var">interpCmd</span></a></span><span> </span><span class="annot"><span class="annottext">Interp
</span><a href="#local-6989586621681285290"><span class="hs-identifier hs-var">interp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; Message [RemotePtr ()]
</span><a href="../../ghci-9.2.7/src/GHCi-Message.html#MallocStrings"><span class="hs-identifier hs-var">MallocStrings</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621681285288"><span class="hs-identifier hs-var">bytestrings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s a. State s a -&gt; s -&gt; a
</span><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-State-Strict.html#evalState"><span class="hs-identifier hs-var">evalState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base-4.16.4.0/src/Data-Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a}.
Monad m =&gt;
UnlinkedBCO -&gt; StateT [RemotePtr a] m UnlinkedBCO
</span><a href="#local-6989586621681285279"><span class="hs-identifier hs-var">splice</span></a></span><span> </span><span class="annot"><span class="annottext">[UnlinkedBCO]
</span><a href="#local-6989586621681285289"><span class="hs-identifier hs-var">ulbcos</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RemotePtr ()]
</span><a href="#local-6989586621681285283"><span class="hs-identifier hs-var">ptrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[RemotePtr ()]
</span><a href="#local-6989586621681285283"><span class="hs-identifier hs-var">ptrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span>  </span><span id="local-6989586621681285279"><span class="annot"><span class="annottext">splice :: UnlinkedBCO -&gt; StateT [RemotePtr a] m UnlinkedBCO
</span><a href="#local-6989586621681285279"><span class="hs-identifier hs-var hs-var">splice</span></a></span></span><span> </span><span id="local-6989586621681285259"><span class="annot"><span class="annottext">bco :: UnlinkedBCO
</span><a href="#local-6989586621681285259"><span class="hs-identifier hs-var">bco</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-type">UnlinkedBCO</span></a></span><span class="hs-special">{</span><span id="local-6989586621681285253"><span id="local-6989586621681285254"><span id="local-6989586621681285255"><span id="local-6989586621681285256"><span id="local-6989586621681285257"><span id="local-6989586621681285258"><span class="annot"><span class="annottext">Int
UArray Int Word16
UArray Int Word64
SizedSeq BCONPtr
SizedSeq BCOPtr
Name
unlinkedBCOPtrs :: UnlinkedBCO -&gt; SizedSeq BCOPtr
unlinkedBCOLits :: UnlinkedBCO -&gt; SizedSeq BCONPtr
unlinkedBCOInstrs :: UnlinkedBCO -&gt; UArray Int Word16
unlinkedBCOBitmap :: UnlinkedBCO -&gt; UArray Int Word64
unlinkedBCOArity :: UnlinkedBCO -&gt; Int
unlinkedBCOPtrs :: SizedSeq BCOPtr
unlinkedBCOLits :: SizedSeq BCONPtr
unlinkedBCOBitmap :: UArray Int Word64
unlinkedBCOInstrs :: UArray Int Word16
unlinkedBCOArity :: Int
unlinkedBCOName :: Name
unlinkedBCOName :: UnlinkedBCO -&gt; Name
</span><a href="GHC.ByteCode.Types.html#unlinkedBCOPtrs"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621681285247"><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621681285247"><span class="hs-identifier hs-var">lits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base-4.16.4.0/src/Data-Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a}.
Monad m =&gt;
BCONPtr -&gt; StateT [RemotePtr a] m BCONPtr
</span><a href="#local-6989586621681285246"><span class="hs-identifier hs-var">spliceLit</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621681285254"><span class="hs-identifier hs-var">unlinkedBCOLits</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621681285245"><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681285245"><span class="hs-identifier hs-var">ptrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base-4.16.4.0/src/Data-Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">BCOPtr -&gt; StateT [RemotePtr a] m BCOPtr
</span><a href="#local-6989586621681285244"><span class="hs-identifier hs-var">splicePtr</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681285253"><span class="hs-identifier hs-var">unlinkedBCOPtrs</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621681285259"><span class="hs-identifier hs-var">bco</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">unlinkedBCOLits :: SizedSeq BCONPtr
</span><a href="GHC.ByteCode.Types.html#unlinkedBCOLits"><span class="hs-identifier hs-var">unlinkedBCOLits</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621681285247"><span class="hs-identifier hs-var">lits</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">unlinkedBCOPtrs :: SizedSeq BCOPtr
</span><a href="GHC.ByteCode.Types.html#unlinkedBCOPtrs"><span class="hs-identifier hs-var">unlinkedBCOPtrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681285245"><span class="hs-identifier hs-var">ptrs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621681285246"><span class="annot"><span class="annottext">spliceLit :: BCONPtr -&gt; StateT [RemotePtr a] m BCONPtr
</span><a href="#local-6989586621681285246"><span class="hs-identifier hs-var hs-var">spliceLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Types.html#BCONPtrStr"><span class="hs-identifier hs-type">BCONPtrStr</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621681285231"><span class="annot"><span class="annottext">[RemotePtr a]
</span><a href="#local-6989586621681285231"><span class="hs-identifier hs-var">rptrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-State-Strict.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[RemotePtr a]
</span><a href="#local-6989586621681285231"><span class="hs-identifier hs-var">rptrs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-141"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="../../ghci-9.2.7/src/GHCi-RemoteTypes.html#RemotePtr"><span class="hs-identifier hs-type">RemotePtr</span></a></span><span> </span><span id="local-6989586621681285228"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681285228"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681285227"><span class="annot"><span class="annottext">[RemotePtr a]
</span><a href="#local-6989586621681285227"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s. Monad m =&gt; s -&gt; StateT s m ()
</span><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-State-Strict.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">[RemotePtr a]
</span><a href="#local-6989586621681285227"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; BCONPtr
</span><a href="GHC.ByteCode.Types.html#BCONPtrWord"><span class="hs-identifier hs-var">BCONPtrWord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681285228"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><span class="annottext">[RemotePtr a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mallocStrings:spliceLit&quot;</span></span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><a href="#local-6989586621681285246"><span class="hs-identifier hs-var">spliceLit</span></a></span><span> </span><span id="local-6989586621681285223"><span class="annot"><span class="annottext">BCONPtr
</span><a href="#local-6989586621681285223"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">BCONPtr
</span><a href="#local-6989586621681285223"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>  </span><span id="local-6989586621681285244"><span class="annot"><span class="annottext">splicePtr :: BCOPtr -&gt; StateT [RemotePtr a] m BCOPtr
</span><a href="#local-6989586621681285244"><span class="hs-identifier hs-var hs-var">splicePtr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-type">BCOPtrBCO</span></a></span><span> </span><span id="local-6989586621681285222"><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621681285222"><span class="hs-identifier hs-var">bco</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; BCOPtr
</span><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-var">BCOPtrBCO</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.4.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; StateT [RemotePtr a] m UnlinkedBCO
</span><a href="#local-6989586621681285279"><span class="hs-identifier hs-var">splice</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621681285222"><span class="hs-identifier hs-var">bco</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><a href="#local-6989586621681285244"><span class="hs-identifier hs-var">splicePtr</span></a></span><span> </span><span id="local-6989586621681285220"><span class="annot"><span class="annottext">BCOPtr
</span><a href="#local-6989586621681285220"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">BCOPtr
</span><a href="#local-6989586621681285220"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>  </span><span id="local-6989586621681285284"><span class="annot"><span class="annottext">collect :: UnlinkedBCO -&gt; StateT [ByteString] m ()
</span><a href="#local-6989586621681285284"><span class="hs-identifier hs-var hs-var">collect</span></a></span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-type">UnlinkedBCO</span></a></span><span class="hs-special">{</span><span id="local-6989586621681285204"><span id="local-6989586621681285205"><span id="local-6989586621681285206"><span id="local-6989586621681285207"><span id="local-6989586621681285208"><span id="local-6989586621681285209"><span class="annot"><span class="annottext">Int
UArray Int Word16
UArray Int Word64
SizedSeq BCONPtr
SizedSeq BCOPtr
Name
unlinkedBCOPtrs :: SizedSeq BCOPtr
unlinkedBCOLits :: SizedSeq BCONPtr
unlinkedBCOBitmap :: UArray Int Word64
unlinkedBCOInstrs :: UArray Int Word16
unlinkedBCOArity :: Int
unlinkedBCOName :: Name
unlinkedBCOPtrs :: UnlinkedBCO -&gt; SizedSeq BCOPtr
unlinkedBCOLits :: UnlinkedBCO -&gt; SizedSeq BCONPtr
unlinkedBCOInstrs :: UnlinkedBCO -&gt; UArray Int Word16
unlinkedBCOBitmap :: UnlinkedBCO -&gt; UArray Int Word64
unlinkedBCOArity :: UnlinkedBCO -&gt; Int
unlinkedBCOName :: UnlinkedBCO -&gt; Name
</span><a href="#local-6989586621681285204"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *}.
Monad m =&gt;
BCONPtr -&gt; StateT [ByteString] m ()
</span><a href="#local-6989586621681285203"><span class="hs-identifier hs-var">collectLit</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621681285205"><span class="hs-identifier hs-var">unlinkedBCOLits</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">BCOPtr -&gt; StateT [ByteString] m ()
</span><a href="#local-6989586621681285202"><span class="hs-identifier hs-var">collectPtr</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681285204"><span class="hs-identifier hs-var">unlinkedBCOPtrs</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621681285203"><span class="annot"><span class="annottext">collectLit :: BCONPtr -&gt; StateT [ByteString] m ()
</span><a href="#local-6989586621681285203"><span class="hs-identifier hs-var hs-var">collectLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Types.html#BCONPtrStr"><span class="hs-identifier hs-type">BCONPtrStr</span></a></span><span> </span><span id="local-6989586621681285195"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681285195"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-155"></span><span>    </span><span id="local-6989586621681285194"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621681285194"><span class="hs-identifier hs-var">strs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-State-Strict.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s. Monad m =&gt; s -&gt; StateT s m ()
</span><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-State-Strict.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681285195"><span class="hs-identifier hs-var">bs</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621681285194"><span class="hs-identifier hs-var">strs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>  </span><span class="annot"><a href="#local-6989586621681285203"><span class="hs-identifier hs-var">collectLit</span></a></span><span> </span><span class="annot"><span class="annottext">BCONPtr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>  </span><span id="local-6989586621681285202"><span class="annot"><span class="annottext">collectPtr :: BCOPtr -&gt; StateT [ByteString] m ()
</span><a href="#local-6989586621681285202"><span class="hs-identifier hs-var hs-var">collectPtr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-type">BCOPtrBCO</span></a></span><span> </span><span id="local-6989586621681285193"><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621681285193"><span class="hs-identifier hs-var">bco</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; StateT [ByteString] m ()
</span><a href="#local-6989586621681285284"><span class="hs-identifier hs-var">collect</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621681285193"><span class="hs-identifier hs-var">bco</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><a href="#local-6989586621681285202"><span class="hs-identifier hs-var">collectPtr</span></a></span><span> </span><span class="annot"><span class="annottext">BCOPtr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#assembleOneBCO"><span class="hs-identifier hs-type">assembleOneBCO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Runtime.Interpreter.Types.html#Interp"><span class="hs-identifier hs-type">Interp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Platform.Profile.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#ProtoBCO"><span class="hs-identifier hs-type">ProtoBCO</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-type">UnlinkedBCO</span></a></span><span>
</span><span id="line-164"></span><span id="assembleOneBCO"><span class="annot"><span class="annottext">assembleOneBCO :: Interp -&gt; Profile -&gt; ProtoBCO Name -&gt; IO UnlinkedBCO
</span><a href="GHC.ByteCode.Asm.html#assembleOneBCO"><span class="hs-identifier hs-var hs-var">assembleOneBCO</span></a></span></span><span> </span><span id="local-6989586621681285192"><span class="annot"><span class="annottext">Interp
</span><a href="#local-6989586621681285192"><span class="hs-identifier hs-var">interp</span></a></span></span><span> </span><span id="local-6989586621681285191"><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621681285191"><span class="hs-identifier hs-var">profile</span></a></span></span><span> </span><span id="local-6989586621681285190"><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621681285190"><span class="hs-identifier hs-var">pbco</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-comment">-- TODO: the profile should be bundled with the interpreter: the rts ways are</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-comment">-- fixed for an interpreter</span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621681285189"><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621681285189"><span class="hs-identifier hs-var">ubco</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ProtoBCO Name -&gt; IO UnlinkedBCO
</span><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-var">assembleBCO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Profile -&gt; Platform
</span><a href="GHC.Platform.Profile.html#profilePlatform"><span class="hs-identifier hs-var">profilePlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621681285191"><span class="hs-identifier hs-var">profile</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621681285190"><span class="hs-identifier hs-var">pbco</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span id="local-6989586621681285188"><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621681285188"><span class="hs-identifier hs-var">ubco'</span></a></span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681285187"><span class="annot"><span class="annottext">[RemotePtr ()]
</span><a href="#local-6989586621681285187"><span class="hs-identifier hs-var">_ptrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Interp -&gt; [UnlinkedBCO] -&gt; IO ([UnlinkedBCO], [RemotePtr ()])
</span><a href="GHC.ByteCode.Asm.html#mallocStrings"><span class="hs-identifier hs-var">mallocStrings</span></a></span><span> </span><span class="annot"><span class="annottext">Interp
</span><a href="#local-6989586621681285192"><span class="hs-identifier hs-var">interp</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621681285189"><span class="hs-identifier hs-var">ubco</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621681285188"><span class="hs-identifier hs-var">ubco'</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-type">assembleBCO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#ProtoBCO"><span class="hs-identifier hs-type">ProtoBCO</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-type">UnlinkedBCO</span></a></span><span>
</span><span id="line-172"></span><span id="assembleBCO"><span class="annot"><span class="annottext">assembleBCO :: Platform -&gt; ProtoBCO Name -&gt; IO UnlinkedBCO
</span><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-var hs-var">assembleBCO</span></a></span></span><span> </span><span id="local-6989586621681285186"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681285186"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Instr.html#ProtoBCO"><span class="hs-identifier hs-type">ProtoBCO</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">protoBCOName :: forall a. ProtoBCO a -&gt; a
</span><a href="GHC.ByteCode.Instr.html#protoBCOName"><span class="hs-identifier hs-var">protoBCOName</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681285183"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681285183"><span class="hs-identifier hs-var">nm</span></a></span></span><span>
</span><span id="line-173"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">protoBCOInstrs :: forall a. ProtoBCO a -&gt; [BCInstr]
</span><a href="GHC.ByteCode.Instr.html#protoBCOInstrs"><span class="hs-identifier hs-var">protoBCOInstrs</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681285181"><span class="annot"><span class="annottext">[BCInstr]
</span><a href="#local-6989586621681285181"><span class="hs-identifier hs-var">instrs</span></a></span></span><span>
</span><span id="line-174"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">protoBCOBitmap :: forall a. ProtoBCO a -&gt; [StgWord]
</span><a href="GHC.ByteCode.Instr.html#protoBCOBitmap"><span class="hs-identifier hs-var">protoBCOBitmap</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681285179"><span class="annot"><span class="annottext">[StgWord]
</span><a href="#local-6989586621681285179"><span class="hs-identifier hs-var">bitmap</span></a></span></span><span>
</span><span id="line-175"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">protoBCOBitmapSize :: forall a. ProtoBCO a -&gt; Word16
</span><a href="GHC.ByteCode.Instr.html#protoBCOBitmapSize"><span class="hs-identifier hs-var">protoBCOBitmapSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681285177"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681285177"><span class="hs-identifier hs-var">bsize</span></a></span></span><span>
</span><span id="line-176"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">protoBCOArity :: forall a. ProtoBCO a -&gt; Int
</span><a href="GHC.ByteCode.Instr.html#protoBCOArity"><span class="hs-identifier hs-var">protoBCOArity</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681285175"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681285175"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-comment">-- pass 1: collect up the offsets of the local labels.</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681285174"><span class="annot"><span class="annottext">asm :: Assembler ()
</span><a href="#local-6989586621681285174"><span class="hs-identifier hs-var hs-var">asm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; BCInstr -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#assembleI"><span class="hs-identifier hs-var">assembleI</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681285186"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BCInstr]
</span><a href="#local-6989586621681285181"><span class="hs-identifier hs-var">instrs</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>      </span><span id="local-6989586621681285171"><span class="annot"><span class="annottext">initial_offset :: Word
</span><a href="#local-6989586621681285171"><span class="hs-identifier hs-var hs-var">initial_offset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>      </span><span class="hs-comment">-- Jump instructions are variable-sized, there are long and short variants</span><span>
</span><span id="line-183"></span><span>      </span><span class="hs-comment">-- depending on the magnitude of the offset.  However, we can't tell what</span><span>
</span><span id="line-184"></span><span>      </span><span class="hs-comment">-- size instructions we will need until we have calculated the offsets of</span><span>
</span><span id="line-185"></span><span>      </span><span class="hs-comment">-- the labels, which depends on the size of the instructions...  So we</span><span>
</span><span id="line-186"></span><span>      </span><span class="hs-comment">-- first create the label environment assuming that all jumps are short,</span><span>
</span><span id="line-187"></span><span>      </span><span class="hs-comment">-- and if the final size is indeed small enough for short jumps, we are</span><span>
</span><span id="line-188"></span><span>      </span><span class="hs-comment">-- done.  Otherwise, we repeat the calculation, and we force all jumps in</span><span>
</span><span id="line-189"></span><span>      </span><span class="hs-comment">-- this BCO to be long.</span><span>
</span><span id="line-190"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681285170"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681285170"><span class="hs-identifier hs-var">n_insns0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681285169"><span class="annot"><span class="annottext">LabelEnvMap
</span><a href="#local-6989586621681285169"><span class="hs-identifier hs-var">lbl_map0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
Platform -&gt; Bool -&gt; Word -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="GHC.ByteCode.Asm.html#inspectAsm"><span class="hs-identifier hs-var">inspectAsm</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681285186"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681285171"><span class="hs-identifier hs-var">initial_offset</span></a></span><span> </span><span class="annot"><span class="annottext">Assembler ()
</span><a href="#local-6989586621681285174"><span class="hs-identifier hs-var">asm</span></a></span><span>
</span><span id="line-191"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681285167"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681285167"><span class="hs-identifier hs-var">n_insns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681285166"><span class="annot"><span class="annottext">LabelEnvMap
</span><a href="#local-6989586621681285166"><span class="hs-identifier hs-var">lbl_map</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681285165"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681285165"><span class="hs-identifier hs-var">long_jumps</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Bool
</span><a href="GHC.ByteCode.Asm.html#isLarge"><span class="hs-identifier hs-var">isLarge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; Int
</span><a href="../../containers-0.6.5.1/src/Data-Map-Internal.html#size"><span class="hs-identifier hs-var">Map.size</span></a></span><span> </span><span class="annot"><span class="annottext">LabelEnvMap
</span><a href="#local-6989586621681285169"><span class="hs-identifier hs-var">lbl_map0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Bool
</span><a href="GHC.ByteCode.Asm.html#isLarge"><span class="hs-identifier hs-var">isLarge</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681285170"><span class="hs-identifier hs-var">n_insns0</span></a></span><span>
</span><span id="line-194"></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a.
Platform -&gt; Bool -&gt; Word -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="GHC.ByteCode.Asm.html#inspectAsm"><span class="hs-identifier hs-var">inspectAsm</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681285186"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681285171"><span class="hs-identifier hs-var">initial_offset</span></a></span><span> </span><span class="annot"><span class="annottext">Assembler ()
</span><a href="#local-6989586621681285174"><span class="hs-identifier hs-var">asm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681285170"><span class="hs-identifier hs-var">n_insns0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LabelEnvMap
</span><a href="#local-6989586621681285169"><span class="hs-identifier hs-var">lbl_map0</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>      </span><span class="annot"><a href="#local-6989586621681285161"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#LocalLabel"><span class="hs-identifier hs-type">LocalLabel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-198"></span><span>      </span><span id="local-6989586621681285161"><span class="annot"><span class="annottext">env :: LocalLabel -&gt; Word
</span><a href="#local-6989586621681285161"><span class="hs-identifier hs-var hs-var">env</span></a></span></span><span> </span><span id="local-6989586621681285160"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681285160"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../base-4.16.4.0/src/Data-Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;assembleBCO.findLabel&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681285160"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.6.5.1/src/Data-Map-Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681285160"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">LabelEnvMap
</span><a href="#local-6989586621681285166"><span class="hs-identifier hs-var">lbl_map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-comment">-- pass 2: run assembler and generate instructions, literals and pointers</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681285156"><span class="annot"><span class="annottext">initial_state :: (SizedSeq a, SizedSeq a, SizedSeq a)
</span><a href="#local-6989586621681285156"><span class="hs-identifier hs-var hs-var">initial_state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SizedSeq a
</span><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#emptySS"><span class="hs-identifier hs-var">emptySS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. SizedSeq a
</span><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#emptySS"><span class="hs-identifier hs-var">emptySS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. SizedSeq a
</span><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#emptySS"><span class="hs-identifier hs-var">emptySS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681285154"><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621681285154"><span class="hs-identifier hs-var">final_insns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681285153"><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621681285153"><span class="hs-identifier hs-var">final_lits</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681285152"><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681285152"><span class="hs-identifier hs-var">final_ptrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m s
</span><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-State-Strict.html#execStateT"><span class="hs-identifier hs-var">execStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a} {a} {a}. (SizedSeq a, SizedSeq a, SizedSeq a)
</span><a href="#local-6989586621681285156"><span class="hs-identifier hs-var">initial_state</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a.
Platform
-&gt; Bool
-&gt; (LocalLabel -&gt; Word)
-&gt; Assembler a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO a
</span><a href="GHC.ByteCode.Asm.html#runAsm"><span class="hs-identifier hs-var">runAsm</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681285186"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681285165"><span class="hs-identifier hs-var">long_jumps</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel -&gt; Word
</span><a href="#local-6989586621681285161"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Assembler ()
</span><a href="#local-6989586621681285174"><span class="hs-identifier hs-var">asm</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-comment">-- precomputed size should be equal to final size</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span class="hs-identifier">n_insns</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">sizeSS</span><span> </span><span class="hs-identifier">final_insns</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681285144"><span class="annot"><span class="annottext">asm_insns :: [Word16]
</span><a href="#local-6989586621681285144"><span class="hs-identifier hs-var hs-var">asm_insns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. SizedSeq a -&gt; [a]
</span><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#ssElts"><span class="hs-identifier hs-var">ssElts</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621681285154"><span class="hs-identifier hs-var">final_insns</span></a></span><span>
</span><span id="line-210"></span><span>      </span><span id="local-6989586621681285143"><span class="annot"><span class="annottext">insns_arr :: UArray Int Word16
</span><a href="#local-6989586621681285143"><span class="hs-identifier hs-var hs-var">insns_arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [e] -&gt; a i e
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#listArray"><span class="hs-identifier hs-var">Array.listArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681285167"><span class="hs-identifier hs-var">n_insns</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Word16]
</span><a href="#local-6989586621681285144"><span class="hs-identifier hs-var">asm_insns</span></a></span><span>
</span><span id="line-211"></span><span>      </span><span id="local-6989586621681285141"><span class="annot"><span class="annottext">bitmap_arr :: UArray Int Word64
</span><a href="#local-6989586621681285141"><span class="hs-identifier hs-var hs-var">bitmap_arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [StgWord] -&gt; UArray Int Word64
</span><a href="GHC.ByteCode.Asm.html#mkBitmapArray"><span class="hs-identifier hs-var">mkBitmapArray</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681285177"><span class="hs-identifier hs-var">bsize</span></a></span><span> </span><span class="annot"><span class="annottext">[StgWord]
</span><a href="#local-6989586621681285179"><span class="hs-identifier hs-var">bitmap</span></a></span><span>
</span><span id="line-212"></span><span>      </span><span id="local-6989586621681285139"><span class="annot"><span class="annottext">ul_bco :: UnlinkedBCO
</span><a href="#local-6989586621681285139"><span class="hs-identifier hs-var hs-var">ul_bco</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Int
-&gt; UArray Int Word16
-&gt; UArray Int Word64
-&gt; SizedSeq BCONPtr
-&gt; SizedSeq BCOPtr
-&gt; UnlinkedBCO
</span><a href="GHC.ByteCode.Types.html#UnlinkedBCO"><span class="hs-identifier hs-var">UnlinkedBCO</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681285183"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681285175"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">UArray Int Word16
</span><a href="#local-6989586621681285143"><span class="hs-identifier hs-var">insns_arr</span></a></span><span> </span><span class="annot"><span class="annottext">UArray Int Word64
</span><a href="#local-6989586621681285141"><span class="hs-identifier hs-var">bitmap_arr</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621681285153"><span class="hs-identifier hs-var">final_lits</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681285152"><span class="hs-identifier hs-var">final_ptrs</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-comment">-- 8 Aug 01: Finalisers aren't safe when attached to non-primitive</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-comment">-- objects, since they might get run too early.  Disable this until</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-comment">-- we figure out what to do.</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-comment">-- when (notNull malloced) (addFinalizer ul_bco (mapM_ zonk malloced))</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO
</span><a href="#local-6989586621681285139"><span class="hs-identifier hs-var">ul_bco</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#mkBitmapArray"><span class="hs-identifier hs-type">mkBitmapArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Word.html#Word16"><span class="hs-identifier hs-type">Word16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Runtime.Heap.Layout.html#StgWord"><span class="hs-identifier hs-type">StgWord</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../array-0.5.4.0/src/Data-Array-Base.html#UArray"><span class="hs-identifier hs-type">UArray</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-222"></span><span class="hs-comment">-- Here the return type must be an array of Words, not StgWords,</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- because the underlying ByteArray# will end up as a component</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- of a BCO object.</span><span>
</span><span id="line-225"></span><span id="mkBitmapArray"><span class="annot"><span class="annottext">mkBitmapArray :: Word16 -&gt; [StgWord] -&gt; UArray Int Word64
</span><a href="GHC.ByteCode.Asm.html#mkBitmapArray"><span class="hs-identifier hs-var hs-var">mkBitmapArray</span></a></span></span><span> </span><span id="local-6989586621681285138"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681285138"><span class="hs-identifier hs-var">bsize</span></a></span></span><span> </span><span id="local-6989586621681285137"><span class="annot"><span class="annottext">[StgWord]
</span><a href="#local-6989586621681285137"><span class="hs-identifier hs-var">bitmap</span></a></span></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [e] -&gt; a i e
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#listArray"><span class="hs-identifier hs-var">Array.listArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[StgWord]
</span><a href="#local-6989586621681285137"><span class="hs-identifier hs-var">bitmap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-227"></span><span>      </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681285138"><span class="hs-identifier hs-var">bsize</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Num a =&gt; Integer -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Num.html#fromInteger"><span class="hs-identifier hs-var">fromInteger</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">StgWord -&gt; Integer
</span><a href="GHC.Runtime.Heap.Layout.html#fromStgWord"><span class="hs-identifier hs-var">fromStgWord</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StgWord]
</span><a href="#local-6989586621681285137"><span class="hs-identifier hs-var">bitmap</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-comment">-- instrs nonptrs ptrs</span><span>
</span><span id="line-230"></span><span class="hs-keyword">type</span><span> </span><span id="AsmState"><span class="annot"><a href="GHC.ByteCode.Asm.html#AsmState"><span class="hs-identifier hs-var">AsmState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#SizedSeq"><span class="hs-identifier hs-type">SizedSeq</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Word.html#Word16"><span class="hs-identifier hs-type">Word16</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-231"></span><span>                 </span><span class="annot"><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#SizedSeq"><span class="hs-identifier hs-type">SizedSeq</span></a></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCONPtr"><span class="hs-identifier hs-type">BCONPtr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-232"></span><span>                 </span><span class="annot"><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#SizedSeq"><span class="hs-identifier hs-type">SizedSeq</span></a></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtr"><span class="hs-identifier hs-type">BCOPtr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-keyword">data</span><span> </span><span id="Operand"><span class="annot"><a href="GHC.ByteCode.Asm.html#Operand"><span class="hs-identifier hs-var">Operand</span></a></span></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Op"><span class="annot"><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-var">Op</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SmallOp"><span class="annot"><a href="GHC.ByteCode.Asm.html#SmallOp"><span class="hs-identifier hs-var">SmallOp</span></a></span></span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Word.html#Word16"><span class="hs-identifier hs-type">Word16</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LabelOp"><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelOp"><span class="hs-identifier hs-var">LabelOp</span></a></span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#LocalLabel"><span class="hs-identifier hs-type">LocalLabel</span></a></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- (unused)  | LargeOp Word</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-keyword">data</span><span> </span><span id="Assembler"><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-var">Assembler</span></a></span></span><span> </span><span id="local-6989586621681285732"><span class="annot"><a href="#local-6989586621681285732"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="AllocPtr"><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocPtr"><span class="hs-identifier hs-var">AllocPtr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtr"><span class="hs-identifier hs-type">BCOPtr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681285732"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AllocLit"><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocLit"><span class="hs-identifier hs-var">AllocLit</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.ByteCode.Types.html#BCONPtr"><span class="hs-identifier hs-type">BCONPtr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681285732"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AllocLabel"><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocLabel"><span class="hs-identifier hs-var">AllocLabel</span></a></span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#LocalLabel"><span class="hs-identifier hs-type">LocalLabel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681285732"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Emit"><span class="annot"><a href="GHC.ByteCode.Asm.html#Emit"><span class="hs-identifier hs-var">Emit</span></a></span></span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Word.html#Word16"><span class="hs-identifier hs-type">Word16</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681285732"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NullAsm"><span class="annot"><a href="GHC.ByteCode.Asm.html#NullAsm"><span class="hs-identifier hs-var">NullAsm</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621681285732"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681285116"><span id="local-6989586621681285123"><span class="annot"><span class="annottext">forall a b. a -&gt; Assembler b -&gt; Assembler a
forall a b. (a -&gt; b) -&gt; Assembler a -&gt; Assembler b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: forall a b. a -&gt; Assembler b -&gt; Assembler a
$c&lt;$ :: forall a b. a -&gt; Assembler b -&gt; Assembler a
fmap :: forall a b. (a -&gt; b) -&gt; Assembler a -&gt; Assembler b
$cfmap :: forall a b. (a -&gt; b) -&gt; Assembler a -&gt; Assembler b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#Functor"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681285101"><span id="local-6989586621681285103"><span id="local-6989586621681285105"><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-249"></span><span>    </span><span id="local-6989586621681285099"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; Assembler a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#pure"><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#NullAsm"><span class="hs-identifier hs-var">NullAsm</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span id="local-6989586621681285097"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b. Assembler (a -&gt; b) -&gt; Assembler a -&gt; Assembler b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%3C%2A%3E"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;*&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#ap"><span class="hs-identifier hs-var">ap</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681285089"><span id="local-6989586621681285091"><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Asm.html#NullAsm"><span class="hs-identifier hs-type">NullAsm</span></a></span><span> </span><span id="local-6989586621681285083"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681285083"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681285082"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b. Assembler a -&gt; (a -&gt; Assembler b) -&gt; Assembler b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%3E%3E%3D"><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></a></span></span><span> </span><span id="local-6989586621681285081"><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621681285081"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621681285081"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681285083"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocPtr"><span class="hs-identifier hs-type">AllocPtr</span></a></span><span> </span><span id="local-6989586621681285080"><span class="annot"><span class="annottext">IO BCOPtr
</span><a href="#local-6989586621681285080"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681285079"><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621681285079"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span id="local-6989586621681285078"><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621681285078"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. IO BCOPtr -&gt; (Word -&gt; Assembler a) -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#AllocPtr"><span class="hs-identifier hs-var">AllocPtr</span></a></span><span> </span><span class="annot"><span class="annottext">IO BCOPtr
</span><a href="#local-6989586621681285080"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621681285079"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../base-4.16.4.0/src/Control-Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621681285078"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocLit"><span class="hs-identifier hs-type">AllocLit</span></a></span><span> </span><span id="local-6989586621681285076"><span class="annot"><span class="annottext">[BCONPtr]
</span><a href="#local-6989586621681285076"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681285075"><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621681285075"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span id="local-6989586621681285074"><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621681285074"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [BCONPtr] -&gt; (Word -&gt; Assembler a) -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#AllocLit"><span class="hs-identifier hs-var">AllocLit</span></a></span><span> </span><span class="annot"><span class="annottext">[BCONPtr]
</span><a href="#local-6989586621681285076"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621681285075"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../base-4.16.4.0/src/Control-Monad.html#%3E%3D%3E"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621681285074"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocLabel"><span class="hs-identifier hs-type">AllocLabel</span></a></span><span> </span><span id="local-6989586621681285073"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681285073"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621681285072"><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621681285072"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span id="local-6989586621681285071"><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621681285071"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. LocalLabel -&gt; Assembler a -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#AllocLabel"><span class="hs-identifier hs-var">AllocLabel</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681285073"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621681285072"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621681285071"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Emit"><span class="hs-identifier hs-type">Emit</span></a></span><span> </span><span id="local-6989586621681285070"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681285070"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621681285069"><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621681285069"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621681285068"><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621681285068"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span id="local-6989586621681285067"><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621681285067"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Word16 -&gt; [Operand] -&gt; Assembler a -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#Emit"><span class="hs-identifier hs-var">Emit</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681285070"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621681285069"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621681285068"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Assembler b
</span><a href="#local-6989586621681285067"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#ioptr"><span class="hs-identifier hs-type">ioptr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtr"><span class="hs-identifier hs-type">BCOPtr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-260"></span><span id="ioptr"><span class="annot"><span class="annottext">ioptr :: IO BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ioptr"><span class="hs-identifier hs-var hs-var">ioptr</span></a></span></span><span> </span><span id="local-6989586621681285065"><span class="annot"><span class="annottext">IO BCOPtr
</span><a href="#local-6989586621681285065"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. IO BCOPtr -&gt; (Word -&gt; Assembler a) -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#AllocPtr"><span class="hs-identifier hs-var">AllocPtr</span></a></span><span> </span><span class="annot"><span class="annottext">IO BCOPtr
</span><a href="#local-6989586621681285065"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#ptr"><span class="hs-identifier hs-type">ptr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#BCOPtr"><span class="hs-identifier hs-type">BCOPtr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-263"></span><span id="ptr"><span class="annot"><span class="annottext">ptr :: BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ptr"><span class="hs-identifier hs-var hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ioptr"><span class="hs-identifier hs-var">ioptr</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#lit"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.ByteCode.Types.html#BCONPtr"><span class="hs-identifier hs-type">BCONPtr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-266"></span><span id="lit"><span class="annot"><span class="annottext">lit :: [BCONPtr] -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#lit"><span class="hs-identifier hs-var hs-var">lit</span></a></span></span><span> </span><span id="local-6989586621681285062"><span class="annot"><span class="annottext">[BCONPtr]
</span><a href="#local-6989586621681285062"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [BCONPtr] -&gt; (Word -&gt; Assembler a) -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#AllocLit"><span class="hs-identifier hs-var">AllocLit</span></a></span><span> </span><span class="annot"><span class="annottext">[BCONPtr]
</span><a href="#local-6989586621681285062"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#label"><span class="hs-keyword hs-type">label</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#LocalLabel"><span class="hs-identifier hs-type">LocalLabel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span id="label"><span class="annot"><span class="annottext">label :: LocalLabel -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#label"><span class="hs-keyword hs-var hs-var">label</span></a></span></span><span> </span><span id="local-6989586621681285060"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681285060"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. LocalLabel -&gt; Assembler a -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#AllocLabel"><span class="hs-identifier hs-var">AllocLabel</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681285060"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-type">emit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Word.html#Word16"><span class="hs-identifier hs-type">Word16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span id="emit"><span class="annot"><span class="annottext">emit :: Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var hs-var">emit</span></a></span></span><span> </span><span id="local-6989586621681285058"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681285058"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621681285057"><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621681285057"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Word16 -&gt; [Operand] -&gt; Assembler a -&gt; Assembler a
</span><a href="GHC.ByteCode.Asm.html#Emit"><span class="hs-identifier hs-var">Emit</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681285058"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621681285057"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-keyword">type</span><span> </span><span id="LabelEnv"><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelEnv"><span class="hs-identifier hs-var">LabelEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#LocalLabel"><span class="hs-identifier hs-type">LocalLabel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#largeOp"><span class="hs-identifier hs-type">largeOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Operand"><span class="hs-identifier hs-type">Operand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-277"></span><span id="largeOp"><span class="annot"><span class="annottext">largeOp :: Bool -&gt; Operand -&gt; Bool
</span><a href="GHC.ByteCode.Asm.html#largeOp"><span class="hs-identifier hs-var hs-var">largeOp</span></a></span></span><span> </span><span id="local-6989586621681285054"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681285054"><span class="hs-identifier hs-var">long_jumps</span></a></span></span><span> </span><span id="local-6989586621681285053"><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621681285053"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Operand
</span><a href="#local-6989586621681285053"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-278"></span><span>   </span><span class="annot"><a href="GHC.ByteCode.Asm.html#SmallOp"><span class="hs-identifier hs-type">SmallOp</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-279"></span><span>   </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span id="local-6989586621681285052"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681285052"><span class="hs-identifier hs-var">w</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Bool
</span><a href="GHC.ByteCode.Asm.html#isLarge"><span class="hs-identifier hs-var">isLarge</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681285052"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-280"></span><span>   </span><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelOp"><span class="hs-identifier hs-type">LabelOp</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681285054"><span class="hs-identifier hs-var">long_jumps</span></a></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- LargeOp _ -&gt; True</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span id="local-6989586621681285769"><span class="annot"><a href="GHC.ByteCode.Asm.html#runAsm"><span class="hs-identifier hs-type">runAsm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelEnv"><span class="hs-identifier hs-type">LabelEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681285769"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-State-Strict.html#StateT"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#AsmState"><span class="hs-identifier hs-type">AsmState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621681285769"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-284"></span><span id="runAsm"><span class="annot"><span class="annottext">runAsm :: forall a.
Platform
-&gt; Bool
-&gt; (LocalLabel -&gt; Word)
-&gt; Assembler a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO a
</span><a href="GHC.ByteCode.Asm.html#runAsm"><span class="hs-identifier hs-var hs-var">runAsm</span></a></span></span><span> </span><span id="local-6989586621681285036"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681285036"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621681285035"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681285035"><span class="hs-identifier hs-var">long_jumps</span></a></span></span><span> </span><span id="local-6989586621681285034"><span class="annot"><span class="annottext">LocalLabel -&gt; Word
</span><a href="#local-6989586621681285034"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assembler a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO a
</span><a href="#local-6989586621681285033"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621681285033"><span class="annot"><span class="annottext">go :: Assembler a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO a
</span><a href="#local-6989586621681285033"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#NullAsm"><span class="hs-identifier hs-type">NullAsm</span></a></span><span> </span><span id="local-6989586621681285032"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681285032"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681285032"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><a href="#local-6989586621681285033"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocPtr"><span class="hs-identifier hs-type">AllocPtr</span></a></span><span> </span><span id="local-6989586621681285031"><span class="annot"><span class="annottext">IO BCOPtr
</span><a href="#local-6989586621681285031"><span class="hs-identifier hs-var">p_io</span></a></span></span><span> </span><span id="local-6989586621681285030"><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621681285030"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-288"></span><span>      </span><span id="local-6989586621681285029"><span class="annot"><span class="annottext">BCOPtr
</span><a href="#local-6989586621681285029"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">IO BCOPtr
</span><a href="#local-6989586621681285031"><span class="hs-identifier hs-var">p_io</span></a></span><span>
</span><span id="line-289"></span><span>      </span><span id="local-6989586621681285027"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681285027"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; (a, s)) -&gt; StateT s m a
</span><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-State-Strict.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681285025"><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621681285025"><span class="hs-identifier hs-var">st_i0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681285024"><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621681285024"><span class="hs-identifier hs-var">st_l0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681285023"><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681285023"><span class="hs-identifier hs-var">st_p0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-290"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681285022"><span class="annot"><span class="annottext">st_p1 :: SizedSeq BCOPtr
</span><a href="#local-6989586621681285022"><span class="hs-identifier hs-var hs-var">st_p1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. SizedSeq a -&gt; a -&gt; SizedSeq a
</span><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#addToSS"><span class="hs-identifier hs-var">addToSS</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681285023"><span class="hs-identifier hs-var">st_p0</span></a></span><span> </span><span class="annot"><span class="annottext">BCOPtr
</span><a href="#local-6989586621681285029"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-291"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SizedSeq a -&gt; Word
</span><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#sizeSS"><span class="hs-identifier hs-var">sizeSS</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681285023"><span class="hs-identifier hs-var">st_p0</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621681285025"><span class="hs-identifier hs-var">st_i0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621681285024"><span class="hs-identifier hs-var">st_l0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681285022"><span class="hs-identifier hs-var">st_p1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>      </span><span class="annot"><span class="annottext">Assembler a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO a
</span><a href="#local-6989586621681285033"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621681285030"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681285027"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><a href="#local-6989586621681285033"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocLit"><span class="hs-identifier hs-type">AllocLit</span></a></span><span> </span><span id="local-6989586621681285020"><span class="annot"><span class="annottext">[BCONPtr]
</span><a href="#local-6989586621681285020"><span class="hs-identifier hs-var">lits</span></a></span></span><span> </span><span id="local-6989586621681285019"><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621681285019"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-294"></span><span>      </span><span id="local-6989586621681285018"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681285018"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; (a, s)) -&gt; StateT s m a
</span><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-State-Strict.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681285017"><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621681285017"><span class="hs-identifier hs-var">st_i0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681285016"><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621681285016"><span class="hs-identifier hs-var">st_l0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681285015"><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681285015"><span class="hs-identifier hs-var">st_p0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-295"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681285014"><span class="annot"><span class="annottext">st_l1 :: SizedSeq BCONPtr
</span><a href="#local-6989586621681285014"><span class="hs-identifier hs-var hs-var">st_l1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. SizedSeq a -&gt; [a] -&gt; SizedSeq a
</span><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#addListToSS"><span class="hs-identifier hs-var">addListToSS</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621681285016"><span class="hs-identifier hs-var">st_l0</span></a></span><span> </span><span class="annot"><span class="annottext">[BCONPtr]
</span><a href="#local-6989586621681285020"><span class="hs-identifier hs-var">lits</span></a></span><span>
</span><span id="line-296"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SizedSeq a -&gt; Word
</span><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#sizeSS"><span class="hs-identifier hs-var">sizeSS</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621681285016"><span class="hs-identifier hs-var">st_l0</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621681285017"><span class="hs-identifier hs-var">st_i0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621681285014"><span class="hs-identifier hs-var">st_l1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681285015"><span class="hs-identifier hs-var">st_p0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>      </span><span class="annot"><span class="annottext">Assembler a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO a
</span><a href="#local-6989586621681285033"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621681285019"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681285018"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><a href="#local-6989586621681285033"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocLabel"><span class="hs-identifier hs-type">AllocLabel</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681285012"><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621681285012"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assembler a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO a
</span><a href="#local-6989586621681285033"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621681285012"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><a href="#local-6989586621681285033"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Emit"><span class="hs-identifier hs-type">Emit</span></a></span><span> </span><span id="local-6989586621681285011"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681285011"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621681285010"><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621681285010"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621681285009"><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621681285009"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-300"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681285008"><span class="annot"><span class="annottext">largeOps :: Bool
</span><a href="#local-6989586621681285008"><span class="hs-identifier hs-var hs-var">largeOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#any"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Operand -&gt; Bool
</span><a href="GHC.ByteCode.Asm.html#largeOp"><span class="hs-identifier hs-var">largeOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681285035"><span class="hs-identifier hs-var">long_jumps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621681285010"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-301"></span><span>          </span><span id="local-6989586621681285006"><span class="annot"><span class="annottext">opcode :: Word16
</span><a href="#local-6989586621681285006"><span class="hs-identifier hs-var hs-var">opcode</span></a></span></span><span>
</span><span id="line-302"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681285008"><span class="hs-identifier hs-var">largeOps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16
</span><a href="GHC.ByteCode.Asm.html#largeArgInstr"><span class="hs-identifier hs-var">largeArgInstr</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681285011"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-303"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681285011"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-304"></span><span>          </span><span id="local-6989586621681285004"><span class="annot"><span class="annottext">words :: [Word16]
</span><a href="#local-6989586621681285004"><span class="hs-identifier hs-var hs-var">words</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; [Word16]
</span><a href="#local-6989586621681285003"><span class="hs-identifier hs-var">expand</span></a></span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621681285010"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-305"></span><span>          </span><span id="local-6989586621681285003"><span class="annot"><span class="annottext">expand :: Operand -&gt; [Word16]
</span><a href="#local-6989586621681285003"><span class="hs-identifier hs-var hs-var">expand</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#SmallOp"><span class="hs-identifier hs-type">SmallOp</span></a></span><span> </span><span id="local-6989586621681285002"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681285002"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681285002"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-306"></span><span>          </span><span class="annot"><a href="#local-6989586621681285003"><span class="hs-identifier hs-var">expand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelOp"><span class="hs-identifier hs-type">LabelOp</span></a></span><span> </span><span id="local-6989586621681285001"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681285001"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Operand -&gt; [Word16]
</span><a href="#local-6989586621681285003"><span class="hs-identifier hs-var">expand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Operand
</span><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalLabel -&gt; Word
</span><a href="#local-6989586621681285034"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681285001"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>          </span><span class="annot"><a href="#local-6989586621681285003"><span class="hs-identifier hs-var">expand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span id="local-6989586621681285000"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681285000"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681285008"><span class="hs-identifier hs-var">largeOps</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Word -&gt; [Word16]
</span><a href="GHC.ByteCode.Asm.html#largeArg"><span class="hs-identifier hs-var">largeArg</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681285036"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681285000"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681285000"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-308"></span><span class="hs-comment">--        expand (LargeOp w) = largeArg platform w</span><span>
</span><span id="line-309"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; (a, s)) -&gt; StateT s m a
</span><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-State-Strict.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681284998"><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621681284998"><span class="hs-identifier hs-var">st_i0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681284997"><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621681284997"><span class="hs-identifier hs-var">st_l0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681284996"><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681284996"><span class="hs-identifier hs-var">st_p0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-310"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681284995"><span class="annot"><span class="annottext">st_i1 :: SizedSeq Word16
</span><a href="#local-6989586621681284995"><span class="hs-identifier hs-var hs-var">st_i1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. SizedSeq a -&gt; [a] -&gt; SizedSeq a
</span><a href="../../ghc-boot-9.2.7/src/GHC-Data-SizedSeq.html#addListToSS"><span class="hs-identifier hs-var">addListToSS</span></a></span><span> </span><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621681284998"><span class="hs-identifier hs-var">st_i0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681285006"><span class="hs-identifier hs-var">opcode</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Word16]
</span><a href="#local-6989586621681285004"><span class="hs-identifier hs-var">words</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SizedSeq Word16
</span><a href="#local-6989586621681284995"><span class="hs-identifier hs-var">st_i1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SizedSeq BCONPtr
</span><a href="#local-6989586621681284997"><span class="hs-identifier hs-var">st_l0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SizedSeq BCOPtr
</span><a href="#local-6989586621681284996"><span class="hs-identifier hs-var">st_p0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>      </span><span class="annot"><span class="annottext">Assembler a
-&gt; StateT (SizedSeq Word16, SizedSeq BCONPtr, SizedSeq BCOPtr) IO a
</span><a href="#local-6989586621681285033"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621681285009"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-keyword">type</span><span> </span><span id="LabelEnvMap"><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelEnvMap"><span class="hs-identifier hs-var">LabelEnvMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../containers-0.6.5.1/src/Data-Map-Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#LocalLabel"><span class="hs-identifier hs-type">LocalLabel</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-keyword">data</span><span> </span><span id="InspectState"><span class="annot"><a href="GHC.ByteCode.Asm.html#InspectState"><span class="hs-identifier hs-var">InspectState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="InspectState"><span class="annot"><a href="GHC.ByteCode.Asm.html#InspectState"><span class="hs-identifier hs-var">InspectState</span></a></span></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="instrCount"><span class="annot"><span class="annottext">InspectState -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#instrCount"><span class="hs-identifier hs-var hs-var">instrCount</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ptrCount"><span class="annot"><span class="annottext">InspectState -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#ptrCount"><span class="hs-identifier hs-var hs-var">ptrCount</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="litCount"><span class="annot"><span class="annottext">InspectState -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#litCount"><span class="hs-identifier hs-var hs-var">litCount</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="lblEnv"><span class="annot"><span class="annottext">InspectState -&gt; LabelEnvMap
</span><a href="GHC.ByteCode.Asm.html#lblEnv"><span class="hs-identifier hs-var hs-var">lblEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelEnvMap"><span class="hs-identifier hs-type">LabelEnvMap</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span id="local-6989586621681285792"><span class="annot"><a href="GHC.ByteCode.Asm.html#inspectAsm"><span class="hs-identifier hs-type">inspectAsm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681285792"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelEnvMap"><span class="hs-identifier hs-type">LabelEnvMap</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-324"></span><span id="inspectAsm"><span class="annot"><span class="annottext">inspectAsm :: forall a.
Platform -&gt; Bool -&gt; Word -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="GHC.ByteCode.Asm.html#inspectAsm"><span class="hs-identifier hs-var hs-var">inspectAsm</span></a></span></span><span> </span><span id="local-6989586621681284976"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284976"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621681284975"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681284975"><span class="hs-identifier hs-var">long_jumps</span></a></span></span><span> </span><span id="local-6989586621681284974"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284974"><span class="hs-identifier hs-var">initial_offset</span></a></span></span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="#local-6989586621681284973"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word -&gt; LabelEnvMap -&gt; InspectState
</span><a href="GHC.ByteCode.Asm.html#InspectState"><span class="hs-identifier hs-var">InspectState</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284974"><span class="hs-identifier hs-var">initial_offset</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><a href="../../containers-0.6.5.1/src/Data-Map-Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-327"></span><span>    </span><span id="local-6989586621681284973"><span class="annot"><span class="annottext">go :: InspectState -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="#local-6989586621681284973"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681284971"><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284971"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#NullAsm"><span class="hs-identifier hs-type">NullAsm</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InspectState -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#instrCount"><span class="hs-identifier hs-var">instrCount</span></a></span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284971"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; LabelEnvMap
</span><a href="GHC.ByteCode.Asm.html#lblEnv"><span class="hs-identifier hs-var">lblEnv</span></a></span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284971"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><a href="#local-6989586621681284973"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681284970"><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284970"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocPtr"><span class="hs-identifier hs-type">AllocPtr</span></a></span><span> </span><span class="annot"><span class="annottext">IO BCOPtr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681284969"><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621681284969"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="#local-6989586621681284973"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284970"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ptrCount :: Word
</span><a href="GHC.ByteCode.Asm.html#ptrCount"><span class="hs-identifier hs-var">ptrCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284968"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621681284969"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284968"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681284968"><span class="annot"><span class="annottext">n :: Word
</span><a href="#local-6989586621681284968"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#ptrCount"><span class="hs-identifier hs-var">ptrCount</span></a></span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284970"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><a href="#local-6989586621681284973"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681284966"><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284966"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocLit"><span class="hs-identifier hs-type">AllocLit</span></a></span><span> </span><span id="local-6989586621681284965"><span class="annot"><span class="annottext">[BCONPtr]
</span><a href="#local-6989586621681284965"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621681284964"><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621681284964"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="#local-6989586621681284973"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284966"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">litCount :: Word
</span><a href="GHC.ByteCode.Asm.html#litCount"><span class="hs-identifier hs-var">litCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284963"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">forall i a. Num i =&gt; [a] -&gt; i
</span><a href="../../base-4.16.4.0/src/Data-OldList.html#genericLength"><span class="hs-identifier hs-var">genericLength</span></a></span><span> </span><span class="annot"><span class="annottext">[BCONPtr]
</span><a href="#local-6989586621681284965"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Assembler a
</span><a href="#local-6989586621681284964"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284963"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681284963"><span class="annot"><span class="annottext">n :: Word
</span><a href="#local-6989586621681284963"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#litCount"><span class="hs-identifier hs-var">litCount</span></a></span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284966"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><a href="#local-6989586621681284973"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681284962"><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284962"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#AllocLabel"><span class="hs-identifier hs-type">AllocLabel</span></a></span><span> </span><span id="local-6989586621681284961"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681284961"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621681284960"><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621681284960"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="#local-6989586621681284973"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284959"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621681284960"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-333"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681284959"><span class="annot"><span class="annottext">s' :: InspectState
</span><a href="#local-6989586621681284959"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284962"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">lblEnv :: LabelEnvMap
</span><a href="GHC.ByteCode.Asm.html#lblEnv"><span class="hs-identifier hs-var">lblEnv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../../containers-0.6.5.1/src/Data-Map-Strict-Internal.html#insert"><span class="hs-identifier hs-var">Map.insert</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681284961"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InspectState -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#instrCount"><span class="hs-identifier hs-var">instrCount</span></a></span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284962"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InspectState -&gt; LabelEnvMap
</span><a href="GHC.ByteCode.Asm.html#lblEnv"><span class="hs-identifier hs-var">lblEnv</span></a></span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284962"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-334"></span><span>    </span><span class="annot"><a href="#local-6989586621681284973"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681284957"><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284957"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Emit"><span class="hs-identifier hs-type">Emit</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681284956"><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621681284956"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621681284955"><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621681284955"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; Assembler a -&gt; (Word, LabelEnvMap)
</span><a href="#local-6989586621681284973"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284954"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">Assembler a
</span><a href="#local-6989586621681284955"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-335"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-336"></span><span>        </span><span id="local-6989586621681284954"><span class="annot"><span class="annottext">s' :: InspectState
</span><a href="#local-6989586621681284954"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284957"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">instrCount :: Word
</span><a href="GHC.ByteCode.Asm.html#instrCount"><span class="hs-identifier hs-var">instrCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InspectState -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#instrCount"><span class="hs-identifier hs-var">instrCount</span></a></span><span> </span><span class="annot"><span class="annottext">InspectState
</span><a href="#local-6989586621681284957"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284953"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-337"></span><span>        </span><span id="local-6989586621681284953"><span class="annot"><span class="annottext">size :: Word
</span><a href="#local-6989586621681284953"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#sum"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Word
</span><a href="#local-6989586621681284951"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621681284956"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span>
</span><span id="line-338"></span><span>        </span><span id="local-6989586621681284950"><span class="annot"><span class="annottext">largeOps :: Bool
</span><a href="#local-6989586621681284950"><span class="hs-identifier hs-var hs-var">largeOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#any"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Operand -&gt; Bool
</span><a href="GHC.ByteCode.Asm.html#largeOp"><span class="hs-identifier hs-var">largeOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681284975"><span class="hs-identifier hs-var">long_jumps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Operand]
</span><a href="#local-6989586621681284956"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-339"></span><span>        </span><span id="local-6989586621681284951"><span class="annot"><span class="annottext">count :: Operand -&gt; Word
</span><a href="#local-6989586621681284951"><span class="hs-identifier hs-var hs-var">count</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#SmallOp"><span class="hs-identifier hs-type">SmallOp</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span>
</span><span id="line-340"></span><span>        </span><span class="annot"><a href="#local-6989586621681284951"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#LabelOp"><span class="hs-identifier hs-type">LabelOp</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Operand -&gt; Word
</span><a href="#local-6989586621681284951"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Operand
</span><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>        </span><span class="annot"><a href="#local-6989586621681284951"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681284950"><span class="hs-identifier hs-var">largeOps</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#largeArg16s"><span class="hs-identifier hs-var">largeArg16s</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284976"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span>
</span><span id="line-342"></span><span class="hs-comment">--      count (LargeOp _) = largeArg16s platform</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-comment">-- Bring in all the bci_ bytecode constants.</span><span class="hs-cpp">
#include &quot;rts/Bytecodes.h&quot;
</span><span>
</span><span id="line-347"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#largeArgInstr"><span class="hs-identifier hs-type">largeArgInstr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Word.html#Word16"><span class="hs-identifier hs-type">Word16</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Word.html#Word16"><span class="hs-identifier hs-type">Word16</span></a></span><span>
</span><span id="line-348"></span><span id="largeArgInstr"><span class="annot"><span class="annottext">largeArgInstr :: Word16 -&gt; Word16
</span><a href="GHC.ByteCode.Asm.html#largeArgInstr"><span class="hs-identifier hs-var hs-var">largeArgInstr</span></a></span></span><span> </span><span id="local-6989586621681284948"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284948"><span class="hs-identifier hs-var">bci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_FLAG_LARGE_ARGS</span><span> </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">bci</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#largeArg"><span class="hs-identifier hs-type">largeArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Word.html#Word16"><span class="hs-identifier hs-type">Word16</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-351"></span><span id="largeArg"><span class="annot"><span class="annottext">largeArg :: Platform -&gt; Word -&gt; [Word16]
</span><a href="GHC.ByteCode.Asm.html#largeArg"><span class="hs-identifier hs-var hs-var">largeArg</span></a></span></span><span> </span><span id="local-6989586621681284946"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284946"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621681284945"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284945"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; PlatformWordSize
</span><a href="GHC.Platform.html#platformWordSize"><span class="hs-identifier hs-var">platformWordSize</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284946"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-352"></span><span>   </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW8"><span class="hs-identifier hs-var">PW8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284945"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">48</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-353"></span><span>           </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284945"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-354"></span><span>           </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284945"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-355"></span><span>           </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284945"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-356"></span><span>   </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW4"><span class="hs-identifier hs-var">PW4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284945"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-357"></span><span>           </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284945"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#largeArg16s"><span class="hs-identifier hs-type">largeArg16s</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>
</span><span id="line-360"></span><span id="largeArg16s"><span class="annot"><span class="annottext">largeArg16s :: Platform -&gt; Word
</span><a href="GHC.ByteCode.Asm.html#largeArg16s"><span class="hs-identifier hs-var hs-var">largeArg16s</span></a></span></span><span> </span><span id="local-6989586621681284940"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284940"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; PlatformWordSize
</span><a href="GHC.Platform.html#platformWordSize"><span class="hs-identifier hs-var">platformWordSize</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284940"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-361"></span><span>   </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW8"><span class="hs-identifier hs-var">PW8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">4</span></span><span>
</span><span id="line-362"></span><span>   </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW4"><span class="hs-identifier hs-var">PW4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#assembleI"><span class="hs-identifier hs-type">assembleI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span>
</span><span id="line-365"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Instr.html#BCInstr"><span class="hs-identifier hs-type">BCInstr</span></a></span><span>
</span><span id="line-366"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Asm.html#Assembler"><span class="hs-identifier hs-type">Assembler</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span id="assembleI"><span class="annot"><span class="annottext">assembleI :: Platform -&gt; BCInstr -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#assembleI"><span class="hs-identifier hs-var hs-var">assembleI</span></a></span></span><span> </span><span id="local-6989586621681284939"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284939"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621681284938"><span class="annot"><span class="annottext">BCInstr
</span><a href="#local-6989586621681284938"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BCInstr
</span><a href="#local-6989586621681284938"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-368"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#STKCHECK"><span class="hs-identifier hs-type">STKCHECK</span></a></span><span> </span><span id="local-6989586621681284936"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284936"><span class="hs-identifier hs-var">n</span></a></span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_STKCHECK</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span>
</span><span id="line-369"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_L"><span class="hs-identifier hs-type">PUSH_L</span></a></span><span> </span><span id="local-6989586621681284934"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284934"><span class="hs-identifier hs-var">o1</span></a></span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_L</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">]</span><span>
</span><span id="line-370"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_LL"><span class="hs-identifier hs-type">PUSH_LL</span></a></span><span> </span><span id="local-6989586621681284932"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284932"><span class="hs-identifier hs-var">o1</span></a></span></span><span> </span><span id="local-6989586621681284931"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284931"><span class="hs-identifier hs-var">o2</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_LL</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">o2</span><span class="hs-special">]</span><span>
</span><span id="line-371"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_LLL"><span class="hs-identifier hs-type">PUSH_LLL</span></a></span><span> </span><span id="local-6989586621681284929"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284929"><span class="hs-identifier hs-var">o1</span></a></span></span><span> </span><span id="local-6989586621681284928"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284928"><span class="hs-identifier hs-var">o2</span></a></span></span><span> </span><span id="local-6989586621681284927"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284927"><span class="hs-identifier hs-var">o3</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_LLL</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">o2</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">o3</span><span class="hs-special">]</span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH8"><span class="hs-identifier hs-type">PUSH8</span></a></span><span> </span><span id="local-6989586621681284925"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284925"><span class="hs-identifier hs-var">o1</span></a></span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH8</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">]</span><span>
</span><span id="line-373"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH16"><span class="hs-identifier hs-type">PUSH16</span></a></span><span> </span><span id="local-6989586621681284923"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284923"><span class="hs-identifier hs-var">o1</span></a></span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH16</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">]</span><span>
</span><span id="line-374"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH32"><span class="hs-identifier hs-type">PUSH32</span></a></span><span> </span><span id="local-6989586621681284921"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284921"><span class="hs-identifier hs-var">o1</span></a></span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH32</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">]</span><span>
</span><span id="line-375"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH8_W"><span class="hs-identifier hs-type">PUSH8_W</span></a></span><span> </span><span id="local-6989586621681284919"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284919"><span class="hs-identifier hs-var">o1</span></a></span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH8_W</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">]</span><span>
</span><span id="line-376"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH16_W"><span class="hs-identifier hs-type">PUSH16_W</span></a></span><span> </span><span id="local-6989586621681284917"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284917"><span class="hs-identifier hs-var">o1</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH16_W</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">]</span><span>
</span><span id="line-377"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH32_W"><span class="hs-identifier hs-type">PUSH32_W</span></a></span><span> </span><span id="local-6989586621681284915"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284915"><span class="hs-identifier hs-var">o1</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH32_W</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">o1</span><span class="hs-special">]</span><span>
</span><span id="line-378"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_G"><span class="hs-identifier hs-type">PUSH_G</span></a></span><span> </span><span id="local-6989586621681284913"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681284913"><span class="hs-identifier hs-var">nm</span></a></span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284912"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284912"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ptr"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; BCOPtr
</span><a href="GHC.ByteCode.Types.html#BCOPtrName"><span class="hs-identifier hs-var">BCOPtrName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681284913"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_G</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">]</span><span>
</span><span id="line-380"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_PRIMOP"><span class="hs-identifier hs-type">PUSH_PRIMOP</span></a></span><span> </span><span id="local-6989586621681284910"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621681284910"><span class="hs-identifier hs-var">op</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284909"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284909"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ptr"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; BCOPtr
</span><a href="GHC.ByteCode.Types.html#BCOPtrPrimOp"><span class="hs-identifier hs-var">BCOPtrPrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621681284910"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_G</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">]</span><span>
</span><span id="line-382"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_BCO"><span class="hs-identifier hs-type">PUSH_BCO</span></a></span><span> </span><span id="local-6989586621681284906"><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621681284906"><span class="hs-identifier hs-var">proto</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681284905"><span class="annot"><span class="annottext">ul_bco :: IO UnlinkedBCO
</span><a href="#local-6989586621681284905"><span class="hs-identifier hs-var hs-var">ul_bco</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ProtoBCO Name -&gt; IO UnlinkedBCO
</span><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-var">assembleBCO</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284939"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621681284906"><span class="hs-identifier hs-var">proto</span></a></span><span>
</span><span id="line-383"></span><span>                                 </span><span id="local-6989586621681284904"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284904"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ioptr"><span class="hs-identifier hs-var">ioptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; BCOPtr
</span><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-var">BCOPtrBCO</span></a></span><span> </span><span class="annot"><span class="annottext">IO UnlinkedBCO
</span><a href="#local-6989586621681284905"><span class="hs-identifier hs-var">ul_bco</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_G</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">]</span><span>
</span><span id="line-385"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_ALTS"><span class="hs-identifier hs-type">PUSH_ALTS</span></a></span><span> </span><span id="local-6989586621681284901"><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621681284901"><span class="hs-identifier hs-var">proto</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681284900"><span class="annot"><span class="annottext">ul_bco :: IO UnlinkedBCO
</span><a href="#local-6989586621681284900"><span class="hs-identifier hs-var hs-var">ul_bco</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ProtoBCO Name -&gt; IO UnlinkedBCO
</span><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-var">assembleBCO</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284939"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621681284901"><span class="hs-identifier hs-var">proto</span></a></span><span>
</span><span id="line-386"></span><span>                                 </span><span id="local-6989586621681284899"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284899"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ioptr"><span class="hs-identifier hs-var">ioptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; BCOPtr
</span><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-var">BCOPtrBCO</span></a></span><span> </span><span class="annot"><span class="annottext">IO UnlinkedBCO
</span><a href="#local-6989586621681284900"><span class="hs-identifier hs-var">ul_bco</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_ALTS</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">]</span><span>
</span><span id="line-388"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_ALTS_UNLIFTED"><span class="hs-identifier hs-type">PUSH_ALTS_UNLIFTED</span></a></span><span> </span><span id="local-6989586621681284897"><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621681284897"><span class="hs-identifier hs-var">proto</span></a></span></span><span> </span><span id="local-6989586621681284896"><span class="annot"><span class="annottext">ArgRep
</span><a href="#local-6989586621681284896"><span class="hs-identifier hs-var">pk</span></a></span></span><span>
</span><span id="line-389"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681284895"><span class="annot"><span class="annottext">ul_bco :: IO UnlinkedBCO
</span><a href="#local-6989586621681284895"><span class="hs-identifier hs-var hs-var">ul_bco</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ProtoBCO Name -&gt; IO UnlinkedBCO
</span><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-var">assembleBCO</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284939"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621681284897"><span class="hs-identifier hs-var">proto</span></a></span><span>
</span><span id="line-390"></span><span>                                 </span><span id="local-6989586621681284894"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284894"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ioptr"><span class="hs-identifier hs-var">ioptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; BCOPtr
</span><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-var">BCOPtrBCO</span></a></span><span> </span><span class="annot"><span class="annottext">IO UnlinkedBCO
</span><a href="#local-6989586621681284895"><span class="hs-identifier hs-var">ul_bco</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgRep -&gt; Word16
</span><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="#local-6989586621681284896"><span class="hs-identifier hs-var">pk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word -&gt; Operand
</span><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284894"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-392"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_ALTS_TUPLE"><span class="hs-identifier hs-type">PUSH_ALTS_TUPLE</span></a></span><span> </span><span id="local-6989586621681284891"><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621681284891"><span class="hs-identifier hs-var">proto</span></a></span></span><span> </span><span id="local-6989586621681284890"><span class="annot"><span class="annottext">TupleInfo
</span><a href="#local-6989586621681284890"><span class="hs-identifier hs-var">tuple_info</span></a></span></span><span> </span><span id="local-6989586621681284889"><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621681284889"><span class="hs-identifier hs-var">tuple_proto</span></a></span></span><span>
</span><span id="line-393"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681284888"><span class="annot"><span class="annottext">ul_bco :: IO UnlinkedBCO
</span><a href="#local-6989586621681284888"><span class="hs-identifier hs-var hs-var">ul_bco</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ProtoBCO Name -&gt; IO UnlinkedBCO
</span><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-var">assembleBCO</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284939"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621681284891"><span class="hs-identifier hs-var">proto</span></a></span><span>
</span><span id="line-394"></span><span>                                     </span><span id="local-6989586621681284887"><span class="annot"><span class="annottext">ul_tuple_bco :: IO UnlinkedBCO
</span><a href="#local-6989586621681284887"><span class="hs-identifier hs-var hs-var">ul_tuple_bco</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ProtoBCO Name -&gt; IO UnlinkedBCO
</span><a href="GHC.ByteCode.Asm.html#assembleBCO"><span class="hs-identifier hs-var">assembleBCO</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284939"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-395"></span><span>                                                                </span><span class="annot"><span class="annottext">ProtoBCO Name
</span><a href="#local-6989586621681284889"><span class="hs-identifier hs-var">tuple_proto</span></a></span><span>
</span><span id="line-396"></span><span>                                 </span><span id="local-6989586621681284886"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284886"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ioptr"><span class="hs-identifier hs-var">ioptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; BCOPtr
</span><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-var">BCOPtrBCO</span></a></span><span> </span><span class="annot"><span class="annottext">IO UnlinkedBCO
</span><a href="#local-6989586621681284888"><span class="hs-identifier hs-var">ul_bco</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>                                 </span><span id="local-6989586621681284885"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284885"><span class="hs-identifier hs-var">p_tup</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ioptr"><span class="hs-identifier hs-var">ioptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="annot"><span class="annottext">UnlinkedBCO -&gt; BCOPtr
</span><a href="GHC.ByteCode.Types.html#BCOPtrBCO"><span class="hs-identifier hs-var">BCOPtrBCO</span></a></span><span> </span><span class="annot"><span class="annottext">IO UnlinkedBCO
</span><a href="#local-6989586621681284887"><span class="hs-identifier hs-var">ul_tuple_bco</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>                                 </span><span id="local-6989586621681284884"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284884"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Assembler Word
</span><a href="#local-6989586621681284883"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-399"></span><span>                                              </span><span class="annot"><span class="annottext">Platform -&gt; TupleInfo -&gt; Word32
</span><a href="GHC.ByteCode.Asm.html#mkTupleInfoSig"><span class="hs-identifier hs-var">mkTupleInfoSig</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284939"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">TupleInfo
</span><a href="#local-6989586621681284890"><span class="hs-identifier hs-var">tuple_info</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_ALTS_T</span><span>
</span><span id="line-401"></span><span>                                      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word -&gt; Operand
</span><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284886"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Operand
</span><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284884"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Operand
</span><a href="GHC.ByteCode.Asm.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284885"><span class="hs-identifier hs-var">p_tup</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-402"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_PAD8"><span class="hs-identifier hs-var">PUSH_PAD8</span></a></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_PAD8</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-403"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_PAD16"><span class="hs-identifier hs-var">PUSH_PAD16</span></a></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_PAD16</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-404"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_PAD32"><span class="hs-identifier hs-var">PUSH_PAD32</span></a></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_PAD32</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-405"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_UBX8"><span class="hs-identifier hs-type">PUSH_UBX8</span></a></span><span> </span><span id="local-6989586621681284877"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681284877"><span class="hs-identifier hs-var">lit</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284876"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284876"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Assembler Word
</span><a href="#local-6989586621681284875"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681284877"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-406"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_UBX8</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">]</span><span>
</span><span id="line-407"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_UBX16"><span class="hs-identifier hs-type">PUSH_UBX16</span></a></span><span> </span><span id="local-6989586621681284873"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681284873"><span class="hs-identifier hs-var">lit</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284872"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284872"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Assembler Word
</span><a href="#local-6989586621681284875"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681284873"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-408"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_UBX16</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">]</span><span>
</span><span id="line-409"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_UBX32"><span class="hs-identifier hs-type">PUSH_UBX32</span></a></span><span> </span><span id="local-6989586621681284870"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681284870"><span class="hs-identifier hs-var">lit</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284869"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284869"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Assembler Word
</span><a href="#local-6989586621681284875"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681284870"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-410"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_UBX32</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">]</span><span>
</span><span id="line-411"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PUSH_UBX"><span class="hs-identifier hs-type">PUSH_UBX</span></a></span><span> </span><span id="local-6989586621681284867"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681284867"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span id="local-6989586621681284866"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284866"><span class="hs-identifier hs-var">nws</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284865"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284865"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Assembler Word
</span><a href="#local-6989586621681284875"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681284867"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-412"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_UBX</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">nws</span><span class="hs-special">]</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_N"><span class="hs-identifier hs-var">PUSH_APPLY_N</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_N</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-415"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_V"><span class="hs-identifier hs-var">PUSH_APPLY_V</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_V</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-416"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_F"><span class="hs-identifier hs-var">PUSH_APPLY_F</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_F</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-417"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_D"><span class="hs-identifier hs-var">PUSH_APPLY_D</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_D</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-418"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_L"><span class="hs-identifier hs-var">PUSH_APPLY_L</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_L</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-419"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_P"><span class="hs-identifier hs-var">PUSH_APPLY_P</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_P</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-420"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_PP"><span class="hs-identifier hs-var">PUSH_APPLY_PP</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_PP</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-421"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_PPP"><span class="hs-identifier hs-var">PUSH_APPLY_PPP</span></a></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_PPP</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-422"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_PPPP"><span class="hs-identifier hs-var">PUSH_APPLY_PPPP</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_PPPP</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-423"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_PPPPP"><span class="hs-identifier hs-var">PUSH_APPLY_PPPPP</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_PPPPP</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-424"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#PUSH_APPLY_PPPPPP"><span class="hs-identifier hs-var">PUSH_APPLY_PPPPPP</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PUSH_APPLY_PPPPPP</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#SLIDE"><span class="hs-identifier hs-type">SLIDE</span></a></span><span>     </span><span id="local-6989586621681284852"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284852"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681284851"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284851"><span class="hs-identifier hs-var">by</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_SLIDE</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">by</span><span class="hs-special">]</span><span>
</span><span id="line-427"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#ALLOC_AP"><span class="hs-identifier hs-type">ALLOC_AP</span></a></span><span>  </span><span id="local-6989586621681284849"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284849"><span class="hs-identifier hs-var">n</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_ALLOC_AP</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span>
</span><span id="line-428"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#ALLOC_AP_NOUPD"><span class="hs-identifier hs-type">ALLOC_AP_NOUPD</span></a></span><span> </span><span id="local-6989586621681284847"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284847"><span class="hs-identifier hs-var">n</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_ALLOC_AP_NOUPD</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span>
</span><span id="line-429"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#ALLOC_PAP"><span class="hs-identifier hs-type">ALLOC_PAP</span></a></span><span> </span><span id="local-6989586621681284845"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284845"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span id="local-6989586621681284844"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284844"><span class="hs-identifier hs-var">n</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_ALLOC_PAP</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">arity</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span>
</span><span id="line-430"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#MKAP"><span class="hs-identifier hs-type">MKAP</span></a></span><span>      </span><span id="local-6989586621681284842"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284842"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span id="local-6989586621681284841"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284841"><span class="hs-identifier hs-var">sz</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_MKAP</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">off</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">sz</span><span class="hs-special">]</span><span>
</span><span id="line-431"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#MKPAP"><span class="hs-identifier hs-type">MKPAP</span></a></span><span>     </span><span id="local-6989586621681284839"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284839"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span id="local-6989586621681284838"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284838"><span class="hs-identifier hs-var">sz</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_MKPAP</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">off</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">sz</span><span class="hs-special">]</span><span>
</span><span id="line-432"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#UNPACK"><span class="hs-identifier hs-type">UNPACK</span></a></span><span>    </span><span id="local-6989586621681284836"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284836"><span class="hs-identifier hs-var">n</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_UNPACK</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span>
</span><span id="line-433"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#PACK"><span class="hs-identifier hs-type">PACK</span></a></span><span>      </span><span id="local-6989586621681284834"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681284834"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span id="local-6989586621681284833"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284833"><span class="hs-identifier hs-var">sz</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284832"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284832"><span class="hs-identifier hs-var">itbl_no</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[BCONPtr] -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#lit"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; BCONPtr
</span><a href="GHC.ByteCode.Types.html#BCONPtrItbl"><span class="hs-identifier hs-var">BCONPtrItbl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. NamedThing a =&gt; a -&gt; Name
</span><a href="GHC.Types.Name.html#getName"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621681284834"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-434"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_PACK</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">itbl_no</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">sz</span><span class="hs-special">]</span><span>
</span><span id="line-435"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#LABEL"><span class="hs-identifier hs-type">LABEL</span></a></span><span>     </span><span id="local-6989586621681284829"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681284829"><span class="hs-identifier hs-var">lbl</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocalLabel -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#label"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681284829"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-436"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_I"><span class="hs-identifier hs-type">TESTLT_I</span></a></span><span>  </span><span id="local-6989586621681284827"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681284827"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681284826"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681284826"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284825"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284825"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Assembler Word
</span><a href="#local-6989586621681284883"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681284827"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-437"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_I</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-438"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_I"><span class="hs-identifier hs-type">TESTEQ_I</span></a></span><span>  </span><span id="local-6989586621681284823"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681284823"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681284822"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681284822"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284821"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284821"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Assembler Word
</span><a href="#local-6989586621681284883"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681284823"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-439"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_I</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-440"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_W"><span class="hs-identifier hs-type">TESTLT_W</span></a></span><span>  </span><span id="local-6989586621681284819"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284819"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621681284818"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681284818"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284817"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284817"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621681284816"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284819"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-441"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_W</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-442"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_W"><span class="hs-identifier hs-type">TESTEQ_W</span></a></span><span>  </span><span id="local-6989586621681284814"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284814"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621681284813"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681284813"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284812"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284812"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Assembler Word
</span><a href="#local-6989586621681284816"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284814"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-443"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_W</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-444"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_F"><span class="hs-identifier hs-type">TESTLT_F</span></a></span><span>  </span><span id="local-6989586621681284810"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621681284810"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681284809"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681284809"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284808"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284808"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Assembler Word
</span><a href="#local-6989586621681284807"><span class="hs-identifier hs-var">float</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621681284810"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-445"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_F</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-446"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_F"><span class="hs-identifier hs-type">TESTEQ_F</span></a></span><span>  </span><span id="local-6989586621681284805"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621681284805"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681284804"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681284804"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284803"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284803"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Assembler Word
</span><a href="#local-6989586621681284807"><span class="hs-identifier hs-var">float</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621681284805"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-447"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_F</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-448"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_D"><span class="hs-identifier hs-type">TESTLT_D</span></a></span><span>  </span><span id="local-6989586621681284801"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681284801"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621681284800"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681284800"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284799"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284799"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Assembler Word
</span><a href="#local-6989586621681284798"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681284801"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-449"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_D</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-450"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_D"><span class="hs-identifier hs-type">TESTEQ_D</span></a></span><span>  </span><span id="local-6989586621681284796"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681284796"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621681284795"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681284795"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284794"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284794"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Assembler Word
</span><a href="#local-6989586621681284798"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681284796"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-451"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_D</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-452"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTLT_P"><span class="hs-identifier hs-type">TESTLT_P</span></a></span><span>  </span><span id="local-6989586621681284792"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284792"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681284791"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681284791"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTLT_P</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-453"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#TESTEQ_P"><span class="hs-identifier hs-type">TESTEQ_P</span></a></span><span>  </span><span id="local-6989586621681284789"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284789"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681284788"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681284788"><span class="hs-identifier hs-var">l</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_TESTEQ_P</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-454"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#CASEFAIL"><span class="hs-identifier hs-var">CASEFAIL</span></a></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_CASEFAIL</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-455"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#SWIZZLE"><span class="hs-identifier hs-type">SWIZZLE</span></a></span><span>   </span><span id="local-6989586621681284785"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284785"><span class="hs-identifier hs-var">stkoff</span></a></span></span><span> </span><span id="local-6989586621681284784"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284784"><span class="hs-identifier hs-var">n</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_SWIZZLE</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">stkoff</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span>
</span><span id="line-456"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#JMP"><span class="hs-identifier hs-type">JMP</span></a></span><span>       </span><span id="local-6989586621681284782"><span class="annot"><span class="annottext">LocalLabel
</span><a href="#local-6989586621681284782"><span class="hs-identifier hs-var">l</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_JMP</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">LabelOp</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">]</span><span>
</span><span id="line-457"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#ENTER"><span class="hs-identifier hs-var">ENTER</span></a></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_ENTER</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-458"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#RETURN"><span class="hs-identifier hs-var">RETURN</span></a></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_RETURN</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-459"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#RETURN_UNLIFTED"><span class="hs-identifier hs-type">RETURN_UNLIFTED</span></a></span><span> </span><span id="local-6989586621681284778"><span class="annot"><span class="annottext">ArgRep
</span><a href="#local-6989586621681284778"><span class="hs-identifier hs-var">rep</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgRep -&gt; Word16
</span><a href="GHC.ByteCode.Asm.html#return_unlifted"><span class="hs-identifier hs-var">return_unlifted</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="#local-6989586621681284778"><span class="hs-identifier hs-var">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-460"></span><span>  </span><span class="annot"><span class="annottext">BCInstr
</span><a href="GHC.ByteCode.Instr.html#RETURN_TUPLE"><span class="hs-identifier hs-var">RETURN_TUPLE</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_RETURN_T</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-461"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#CCALL"><span class="hs-identifier hs-type">CCALL</span></a></span><span> </span><span id="local-6989586621681284774"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284774"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span id="local-6989586621681284773"><span class="annot"><span class="annottext">RemotePtr C_ffi_cif
</span><a href="#local-6989586621681284773"><span class="hs-identifier hs-var">m_addr</span></a></span></span><span> </span><span id="local-6989586621681284772"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284772"><span class="hs-identifier hs-var">i</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284771"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284771"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {a}. RemotePtr a -&gt; Assembler Word
</span><a href="#local-6989586621681284770"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">RemotePtr C_ffi_cif
</span><a href="#local-6989586621681284773"><span class="hs-identifier hs-var">m_addr</span></a></span><span>
</span><span id="line-462"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_CCALL</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">off</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">]</span><span>
</span><span id="line-463"></span><span>  </span><span class="annot"><a href="GHC.ByteCode.Instr.html#BRK_FUN"><span class="hs-identifier hs-type">BRK_FUN</span></a></span><span> </span><span id="local-6989586621681284768"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621681284768"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span id="local-6989586621681284767"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681284767"><span class="hs-identifier hs-var">uniq</span></a></span></span><span> </span><span id="local-6989586621681284766"><span class="annot"><span class="annottext">RemotePtr CostCentre
</span><a href="#local-6989586621681284766"><span class="hs-identifier hs-var">cc</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681284765"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284765"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BCOPtr -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#ptr"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">BCOPtr
</span><a href="GHC.ByteCode.Types.html#BCOPtrBreakArray"><span class="hs-identifier hs-var">BCOPtrBreakArray</span></a></span><span>
</span><span id="line-464"></span><span>                                 </span><span id="local-6989586621681284763"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284763"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Assembler Word
</span><a href="#local-6989586621681284883"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unique -&gt; Int
</span><a href="GHC.Types.Unique.html#getKey"><span class="hs-identifier hs-var">getKey</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681284767"><span class="hs-identifier hs-var">uniq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>                                 </span><span id="local-6989586621681284761"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284761"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {a}. RemotePtr a -&gt; Assembler Word
</span><a href="#local-6989586621681284770"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">RemotePtr CostCentre
</span><a href="#local-6989586621681284766"><span class="hs-identifier hs-var">cc</span></a></span><span>
</span><span id="line-466"></span><span>                                 </span><span class="annot"><span class="annottext">Word16 -&gt; [Operand] -&gt; Assembler ()
</span><a href="GHC.ByteCode.Asm.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="hs-identifier">bci_BRK_FUN</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">p1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SmallOp</span><span> </span><span class="hs-identifier">index</span><span class="hs-special">,</span><span>
</span><span id="line-467"></span><span>                                                   </span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">q</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Op</span><span> </span><span class="hs-identifier">np</span><span class="hs-special">]</span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-470"></span><span>    </span><span id="local-6989586621681284875"><span class="annot"><span class="annottext">literal :: Literal -&gt; Assembler Word
</span><a href="#local-6989586621681284875"><span class="hs-identifier hs-var hs-var">literal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitLabel"><span class="hs-identifier hs-type">LitLabel</span></a></span><span> </span><span id="local-6989586621681284759"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681284759"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681284758"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681284758"><span class="hs-identifier hs-var">sz</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FunctionOrData
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284939"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../ghc-boot-9.2.7/src/GHC-Platform-ArchOS.html#OSMinGW32"><span class="hs-identifier hs-var">OSMinGW32</span></a></span><span>
</span><span id="line-472"></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Assembler Word
</span><a href="#local-6989586621681284755"><span class="hs-identifier hs-var">litlabel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; FastString -&gt; FastString
</span><a href="GHC.Data.FastString.html#appendFS"><span class="hs-identifier hs-var">appendFS</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681284759"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#mkFastString"><span class="hs-identifier hs-var">mkFastString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'@'</span></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../base-4.16.4.0/src/GHC-Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681284758"><span class="hs-identifier hs-var">sz</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>     </span><span class="hs-comment">-- On Windows, stdcall labels have a suffix indicating the no. of</span><span>
</span><span id="line-474"></span><span>     </span><span class="hs-comment">-- arg words, e.g. foo@8.  testcase: ffi012(ghci)</span><span>
</span><span id="line-475"></span><span>    </span><span class="annot"><a href="#local-6989586621681284875"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitLabel"><span class="hs-identifier hs-type">LitLabel</span></a></span><span> </span><span id="local-6989586621681284751"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681284751"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FunctionOrData
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Assembler Word
</span><a href="#local-6989586621681284755"><span class="hs-identifier hs-var">litlabel</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681284751"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-476"></span><span>    </span><span class="annot"><a href="#local-6989586621681284875"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Types.Literal.html#LitNullAddr"><span class="hs-identifier hs-var">LitNullAddr</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Assembler Word
</span><a href="#local-6989586621681284883"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-477"></span><span>    </span><span class="annot"><a href="#local-6989586621681284875"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span id="local-6989586621681284748"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621681284748"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Assembler Word
</span><a href="#local-6989586621681284807"><span class="hs-identifier hs-var">float</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; Rational -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromRational"><span class="hs-identifier hs-var">fromRational</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621681284748"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>    </span><span class="annot"><a href="#local-6989586621681284875"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621681284746"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621681284746"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Assembler Word
</span><a href="#local-6989586621681284798"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; Rational -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromRational"><span class="hs-identifier hs-var">fromRational</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621681284746"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>    </span><span class="annot"><a href="#local-6989586621681284875"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitChar"><span class="hs-identifier hs-type">LitChar</span></a></span><span> </span><span id="local-6989586621681284744"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681284744"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Assembler Word
</span><a href="#local-6989586621681284883"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681284744"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>    </span><span class="annot"><a href="#local-6989586621681284875"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621681284742"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681284742"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BCONPtr] -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#lit"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString -&gt; BCONPtr
</span><a href="GHC.ByteCode.Types.html#BCONPtrStr"><span class="hs-identifier hs-var">BCONPtrStr</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681284742"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-481"></span><span>       </span><span class="hs-comment">-- LitString requires a zero-terminator when emitted</span><span>
</span><span id="line-482"></span><span>    </span><span class="annot"><a href="#local-6989586621681284875"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span id="local-6989586621681284740"><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621681284740"><span class="hs-identifier hs-var">nt</span></a></span></span><span> </span><span id="local-6989586621681284739"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681284739"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621681284740"><span class="hs-identifier hs-var">nt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-483"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Assembler Word
</span><a href="#local-6989586621681284883"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681284739"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Assembler Word
</span><a href="#local-6989586621681284883"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681284739"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt8"><span class="hs-identifier hs-var">LitNumInt8</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Assembler Word
</span><a href="#local-6989586621681284735"><span class="hs-identifier hs-var">int8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681284739"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord8"><span class="hs-identifier hs-var">LitNumWord8</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Assembler Word
</span><a href="#local-6989586621681284735"><span class="hs-identifier hs-var">int8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681284739"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt16"><span class="hs-identifier hs-var">LitNumInt16</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Assembler Word
</span><a href="#local-6989586621681284732"><span class="hs-identifier hs-var">int16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681284739"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord16"><span class="hs-identifier hs-var">LitNumWord16</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Assembler Word
</span><a href="#local-6989586621681284732"><span class="hs-identifier hs-var">int16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681284739"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt32"><span class="hs-identifier hs-var">LitNumInt32</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Assembler Word
</span><a href="#local-6989586621681284729"><span class="hs-identifier hs-var">int32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681284739"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord32"><span class="hs-identifier hs-var">LitNumWord32</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Assembler Word
</span><a href="#local-6989586621681284729"><span class="hs-identifier hs-var">int32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681284739"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Assembler Word
</span><a href="#local-6989586621681284726"><span class="hs-identifier hs-var">int64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681284739"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Assembler Word
</span><a href="#local-6989586621681284726"><span class="hs-identifier hs-var">int64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681284739"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInteger"><span class="hs-identifier hs-var">LitNumInteger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GHC.ByteCode.Asm.literal: LitNumInteger&quot;</span></span><span>
</span><span id="line-494"></span><span>      </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumNatural"><span class="hs-identifier hs-var">LitNumNatural</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GHC.ByteCode.Asm.literal: LitNumNatural&quot;</span></span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span>    </span><span class="hs-comment">-- We can lower 'LitRubbish' to an arbitrary constant, but @NULL@ is most</span><span>
</span><span id="line-497"></span><span>    </span><span class="hs-comment">-- likely to elicit a crash (rather than corrupt memory) in case absence</span><span>
</span><span id="line-498"></span><span>    </span><span class="hs-comment">-- analysis messed up.</span><span>
</span><span id="line-499"></span><span>    </span><span class="annot"><a href="#local-6989586621681284875"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitRubbish"><span class="hs-identifier hs-type">LitRubbish</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Assembler Word
</span><a href="#local-6989586621681284883"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span>    </span><span id="local-6989586621681284755"><span class="annot"><span class="annottext">litlabel :: FastString -&gt; Assembler Word
</span><a href="#local-6989586621681284755"><span class="hs-identifier hs-var hs-var">litlabel</span></a></span></span><span> </span><span id="local-6989586621681284721"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681284721"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BCONPtr] -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#lit"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FastString -&gt; BCONPtr
</span><a href="GHC.ByteCode.Types.html#BCONPtrLbl"><span class="hs-identifier hs-var">BCONPtrLbl</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681284721"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-502"></span><span>    </span><span id="local-6989586621681284770"><span class="annot"><span class="annottext">addr :: RemotePtr a -&gt; Assembler Word
</span><a href="#local-6989586621681284770"><span class="hs-identifier hs-var hs-var">addr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghci-9.2.7/src/GHCi-RemoteTypes.html#RemotePtr"><span class="hs-identifier hs-type">RemotePtr</span></a></span><span> </span><span id="local-6989586621681284717"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681284717"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word] -&gt; Assembler Word
</span><a href="#local-6989586621681284716"><span class="hs-identifier hs-var">words</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681284717"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-503"></span><span>    </span><span id="local-6989586621681284807"><span class="annot"><span class="annottext">float :: Float -&gt; Assembler Word
</span><a href="#local-6989586621681284807"><span class="hs-identifier hs-var hs-var">float</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word] -&gt; Assembler Word
</span><a href="#local-6989586621681284716"><span class="hs-identifier hs-var">words</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; [Word]
</span><a href="GHC.ByteCode.Asm.html#mkLitF"><span class="hs-identifier hs-var">mkLitF</span></a></span><span>
</span><span id="line-504"></span><span>    </span><span id="local-6989586621681284798"><span class="annot"><span class="annottext">double :: Double -&gt; Assembler Word
</span><a href="#local-6989586621681284798"><span class="hs-identifier hs-var hs-var">double</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word] -&gt; Assembler Word
</span><a href="#local-6989586621681284716"><span class="hs-identifier hs-var">words</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Double -&gt; [Word]
</span><a href="GHC.ByteCode.Asm.html#mkLitD"><span class="hs-identifier hs-var">mkLitD</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284939"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-505"></span><span>    </span><span id="local-6989586621681284883"><span class="annot"><span class="annottext">int :: Int -&gt; Assembler Word
</span><a href="#local-6989586621681284883"><span class="hs-identifier hs-var hs-var">int</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word] -&gt; Assembler Word
</span><a href="#local-6989586621681284716"><span class="hs-identifier hs-var">words</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Word]
</span><a href="GHC.ByteCode.Asm.html#mkLitI"><span class="hs-identifier hs-var">mkLitI</span></a></span><span>
</span><span id="line-506"></span><span>    </span><span id="local-6989586621681284735"><span class="annot"><span class="annottext">int8 :: Int64 -&gt; Assembler Word
</span><a href="#local-6989586621681284735"><span class="hs-identifier hs-var hs-var">int8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word] -&gt; Assembler Word
</span><a href="#local-6989586621681284716"><span class="hs-identifier hs-var">words</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int64 -&gt; [Word]
</span><a href="GHC.ByteCode.Asm.html#mkLitI64"><span class="hs-identifier hs-var">mkLitI64</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284939"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-507"></span><span>    </span><span id="local-6989586621681284732"><span class="annot"><span class="annottext">int16 :: Int64 -&gt; Assembler Word
</span><a href="#local-6989586621681284732"><span class="hs-identifier hs-var hs-var">int16</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word] -&gt; Assembler Word
</span><a href="#local-6989586621681284716"><span class="hs-identifier hs-var">words</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int64 -&gt; [Word]
</span><a href="GHC.ByteCode.Asm.html#mkLitI64"><span class="hs-identifier hs-var">mkLitI64</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284939"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-508"></span><span>    </span><span id="local-6989586621681284729"><span class="annot"><span class="annottext">int32 :: Int64 -&gt; Assembler Word
</span><a href="#local-6989586621681284729"><span class="hs-identifier hs-var hs-var">int32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word] -&gt; Assembler Word
</span><a href="#local-6989586621681284716"><span class="hs-identifier hs-var">words</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int64 -&gt; [Word]
</span><a href="GHC.ByteCode.Asm.html#mkLitI64"><span class="hs-identifier hs-var">mkLitI64</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284939"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-509"></span><span>    </span><span id="local-6989586621681284726"><span class="annot"><span class="annottext">int64 :: Int64 -&gt; Assembler Word
</span><a href="#local-6989586621681284726"><span class="hs-identifier hs-var hs-var">int64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word] -&gt; Assembler Word
</span><a href="#local-6989586621681284716"><span class="hs-identifier hs-var">words</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Int64 -&gt; [Word]
</span><a href="GHC.ByteCode.Asm.html#mkLitI64"><span class="hs-identifier hs-var">mkLitI64</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284939"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-510"></span><span>    </span><span id="local-6989586621681284716"><span class="annot"><span class="annottext">words :: [Word] -&gt; Assembler Word
</span><a href="#local-6989586621681284716"><span class="hs-identifier hs-var hs-var">words</span></a></span></span><span> </span><span id="local-6989586621681284711"><span class="annot"><span class="annottext">[Word]
</span><a href="#local-6989586621681284711"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BCONPtr] -&gt; Assembler Word
</span><a href="GHC.ByteCode.Asm.html#lit"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; BCONPtr
</span><a href="GHC.ByteCode.Types.html#BCONPtrWord"><span class="hs-identifier hs-var">BCONPtrWord</span></a></span><span> </span><span class="annot"><span class="annottext">[Word]
</span><a href="#local-6989586621681284711"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>    </span><span id="local-6989586621681284816"><span class="annot"><span class="annottext">word :: Word -&gt; Assembler Word
</span><a href="#local-6989586621681284816"><span class="hs-identifier hs-var hs-var">word</span></a></span></span><span> </span><span id="local-6989586621681284710"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284710"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word] -&gt; Assembler Word
</span><a href="#local-6989586621681284716"><span class="hs-identifier hs-var">words</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284710"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#isLarge"><span class="hs-identifier hs-type">isLarge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-514"></span><span id="isLarge"><span class="annot"><span class="annottext">isLarge :: Word -&gt; Bool
</span><a href="GHC.ByteCode.Asm.html#isLarge"><span class="hs-identifier hs-var hs-var">isLarge</span></a></span></span><span> </span><span id="local-6989586621681284709"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284709"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284709"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">65535</span></span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-type">push_alts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.StgToCmm.ArgRep.html#ArgRep"><span class="hs-identifier hs-type">ArgRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Word.html#Word16"><span class="hs-identifier hs-type">Word16</span></a></span><span>
</span><span id="line-517"></span><span id="push_alts"><span class="annot"><span class="annottext">push_alts :: ArgRep -&gt; Word16
</span><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var hs-var">push_alts</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#V"><span class="hs-identifier hs-var">V</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_PUSH_ALTS_V</span><span>
</span><span id="line-518"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#P"><span class="hs-identifier hs-var">P</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_PUSH_ALTS_P</span><span>
</span><span id="line-519"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#N"><span class="hs-identifier hs-var">N</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_PUSH_ALTS_N</span><span>
</span><span id="line-520"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#L"><span class="hs-identifier hs-var">L</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_PUSH_ALTS_L</span><span>
</span><span id="line-521"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#F"><span class="hs-identifier hs-var">F</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_PUSH_ALTS_F</span><span>
</span><span id="line-522"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#D"><span class="hs-identifier hs-var">D</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_PUSH_ALTS_D</span><span>
</span><span id="line-523"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#V16"><span class="hs-identifier hs-var">V16</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;push_alts: vector&quot;</span></span><span>
</span><span id="line-524"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#V32"><span class="hs-identifier hs-var">V32</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;push_alts: vector&quot;</span></span><span>
</span><span id="line-525"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#push_alts"><span class="hs-identifier hs-var">push_alts</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#V64"><span class="hs-identifier hs-var">V64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;push_alts: vector&quot;</span></span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_unlifted"><span class="hs-identifier hs-type">return_unlifted</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.StgToCmm.ArgRep.html#ArgRep"><span class="hs-identifier hs-type">ArgRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Word.html#Word16"><span class="hs-identifier hs-type">Word16</span></a></span><span>
</span><span id="line-528"></span><span id="return_unlifted"><span class="annot"><span class="annottext">return_unlifted :: ArgRep -&gt; Word16
</span><a href="GHC.ByteCode.Asm.html#return_unlifted"><span class="hs-identifier hs-var hs-var">return_unlifted</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#V"><span class="hs-identifier hs-var">V</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_RETURN_V</span><span>
</span><span id="line-529"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_unlifted"><span class="hs-identifier hs-var">return_unlifted</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#P"><span class="hs-identifier hs-var">P</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_RETURN_P</span><span>
</span><span id="line-530"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_unlifted"><span class="hs-identifier hs-var">return_unlifted</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#N"><span class="hs-identifier hs-var">N</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_RETURN_N</span><span>
</span><span id="line-531"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_unlifted"><span class="hs-identifier hs-var">return_unlifted</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#L"><span class="hs-identifier hs-var">L</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_RETURN_L</span><span>
</span><span id="line-532"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_unlifted"><span class="hs-identifier hs-var">return_unlifted</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#F"><span class="hs-identifier hs-var">F</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_RETURN_F</span><span>
</span><span id="line-533"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_unlifted"><span class="hs-identifier hs-var">return_unlifted</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#D"><span class="hs-identifier hs-var">D</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bci_RETURN_D</span><span>
</span><span id="line-534"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_unlifted"><span class="hs-identifier hs-var">return_unlifted</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#V16"><span class="hs-identifier hs-var">V16</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;return_unlifted: vector&quot;</span></span><span>
</span><span id="line-535"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_unlifted"><span class="hs-identifier hs-var">return_unlifted</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#V32"><span class="hs-identifier hs-var">V32</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;return_unlifted: vector&quot;</span></span><span>
</span><span id="line-536"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#return_unlifted"><span class="hs-identifier hs-var">return_unlifted</span></a></span><span> </span><span class="annot"><span class="annottext">ArgRep
</span><a href="GHC.StgToCmm.ArgRep.html#V64"><span class="hs-identifier hs-var">V64</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;return_unlifted: vector&quot;</span></span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span class="hs-comment">{-
  we can only handle up to a fixed number of words on the stack,
  because we need a stg_ctoi_tN stack frame for each size N. See
  Note [unboxed tuple bytecodes and tuple_BCO].

  If needed, you can support larger tuples by adding more in
  StgMiscClosures.cmm, Interpreter.c and MiscClosures.h and
  raising this limit.

  Note that the limit is the number of words passed on the stack.
  If the calling convention passes part of the tuple in registers, the
  maximum number of tuple elements may be larger. Elements can also
  take multiple words on the stack (for example Double# on a 32 bit
  platform).

 -}</span><span>
</span><span id="line-554"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#maxTupleNativeStackSize"><span class="hs-identifier hs-type">maxTupleNativeStackSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#WordOff"><span class="hs-identifier hs-type">WordOff</span></a></span><span>
</span><span id="line-555"></span><span id="maxTupleNativeStackSize"><span class="annot"><span class="annottext">maxTupleNativeStackSize :: WordOff
</span><a href="GHC.ByteCode.Asm.html#maxTupleNativeStackSize"><span class="hs-identifier hs-var hs-var">maxTupleNativeStackSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WordOff
</span><span class="hs-number">62</span></span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span class="hs-comment">{-
  Construct the tuple_info word that stg_ctoi_t and stg_ret_t use
  to convert a tuple between the native calling convention and the
  interpreter.

  See Note [GHCi tuple layout] for more information.
 -}</span><span>
</span><span id="line-564"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#mkTupleInfoSig"><span class="hs-identifier hs-type">mkTupleInfoSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#TupleInfo"><span class="hs-identifier hs-type">TupleInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-565"></span><span id="mkTupleInfoSig"><span class="annot"><span class="annottext">mkTupleInfoSig :: Platform -&gt; TupleInfo -&gt; Word32
</span><a href="GHC.ByteCode.Asm.html#mkTupleInfoSig"><span class="hs-identifier hs-var hs-var">mkTupleInfoSig</span></a></span></span><span> </span><span id="local-6989586621681284696"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284696"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#TupleInfo"><span class="hs-identifier hs-type">TupleInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621681284692"><span id="local-6989586621681284693"><span id="local-6989586621681284694"><span class="annot"><span class="annottext">GlobalRegSet
WordOff
tupleSize :: TupleInfo -&gt; WordOff
tupleRegs :: TupleInfo -&gt; GlobalRegSet
tupleNativeStackSize :: TupleInfo -&gt; WordOff
tupleNativeStackSize :: WordOff
tupleRegs :: GlobalRegSet
tupleSize :: WordOff
</span><a href="GHC.ByteCode.Types.html#tupleSize"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span>
</span><span id="line-566"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621681284692"><span class="hs-identifier hs-var">tupleNativeStackSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">WordOff
</span><a href="GHC.ByteCode.Asm.html#maxTupleNativeStackSize"><span class="hs-identifier hs-var">maxTupleNativeStackSize</span></a></span><span>
</span><span id="line-567"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkTupleInfoSig: tuple too big for the bytecode compiler&quot;</span></span><span>
</span><span id="line-568"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621681284692"><span class="hs-identifier hs-var">tupleNativeStackSize</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;stack words.&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-569"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Use -fobject-code to get around this limit&quot;</span></span><span>
</span><span id="line-570"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span class="hs-identifier">length</span><span> </span><span class="hs-identifier">regs</span><span> </span><span class="hs-operator">&lt;=</span><span> </span><span class="hs-number">24</span><span class="hs-special">)</span><span> </span><span class="hs-comment">{- 24 bits for bitmap -}</span><span>
</span><span id="line-573"></span><span>    </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span class="hs-identifier">tupleNativeStackSize</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-number">255</span><span class="hs-special">)</span><span> </span><span class="hs-comment">{- 8 bits for stack size -}</span><span>
</span><span id="line-574"></span><span>    </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span class="hs-identifier">all</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier">elem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">regs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">regSetToList</span><span> </span><span class="hs-identifier">tupleRegs</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">{- all regs accounted for -}</span><span>
</span><span id="line-575"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; (GlobalReg, Int) -&gt; Word32
</span><a href="#local-6989586621681284679"><span class="hs-identifier hs-var">reg_bit</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../base-4.16.4.0/src/GHC-List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalReg]
</span><a href="#local-6989586621681284686"><span class="hs-identifier hs-var">regs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span>
</span><span id="line-576"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">WordOff
</span><a href="#local-6989586621681284692"><span class="hs-identifier hs-var">tupleNativeStackSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-578"></span><span>    </span><span class="annot"><a href="#local-6989586621681284679"><span class="hs-identifier hs-type">reg_bit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Cmm.Expr.html#GlobalReg"><span class="hs-identifier hs-type">GlobalReg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-579"></span><span>    </span><span id="local-6989586621681284679"><span class="annot"><span class="annottext">reg_bit :: Word32 -&gt; (GlobalReg, Int) -&gt; Word32
</span><a href="#local-6989586621681284679"><span class="hs-identifier hs-var hs-var">reg_bit</span></a></span></span><span> </span><span id="local-6989586621681284677"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681284677"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681284676"><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621681284676"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681284675"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681284675"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-580"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">GlobalReg
</span><a href="#local-6989586621681284676"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Ord r =&gt; r -&gt; RegSet r -&gt; Bool
</span><a href="GHC.Cmm.Expr.html#elemRegSet"><span class="hs-operator hs-var">`elemRegSet`</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRegSet
</span><a href="#local-6989586621681284693"><span class="hs-identifier hs-var">tupleRegs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681284677"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681284675"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-581"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621681284677"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-582"></span><span>    </span><span id="local-6989586621681284686"><span class="annot"><span class="annottext">regs :: [GlobalReg]
</span><a href="#local-6989586621681284686"><span class="hs-identifier hs-var hs-var">regs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; [GlobalReg]
</span><a href="GHC.Cmm.CallConv.html#tupleRegsCover"><span class="hs-identifier hs-var">tupleRegsCover</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284696"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#mkTupleInfoLit"><span class="hs-identifier hs-type">mkTupleInfoLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.ByteCode.Types.html#TupleInfo"><span class="hs-identifier hs-type">TupleInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-585"></span><span id="mkTupleInfoLit"><span class="annot"><span class="annottext">mkTupleInfoLit :: Platform -&gt; TupleInfo -&gt; Literal
</span><a href="GHC.ByteCode.Asm.html#mkTupleInfoLit"><span class="hs-identifier hs-var hs-var">mkTupleInfoLit</span></a></span></span><span> </span><span id="local-6989586621681284673"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284673"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621681284672"><span class="annot"><span class="annottext">TupleInfo
</span><a href="#local-6989586621681284672"><span class="hs-identifier hs-var">tuple_info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-586"></span><span>  </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord"><span class="hs-identifier hs-var">mkLitWord</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284673"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; TupleInfo -&gt; Word32
</span><a href="GHC.ByteCode.Asm.html#mkTupleInfoSig"><span class="hs-identifier hs-var">mkTupleInfoSig</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284673"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">TupleInfo
</span><a href="#local-6989586621681284672"><span class="hs-identifier hs-var">tuple_info</span></a></span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span class="hs-comment">-- Make lists of host-sized words for literals, so that when the</span><span>
</span><span id="line-589"></span><span class="hs-comment">-- words are placed in memory at increasing addresses, the</span><span>
</span><span id="line-590"></span><span class="hs-comment">-- bit pattern is correct for the host's word size and endianness.</span><span>
</span><span id="line-591"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#mkLitI"><span class="hs-identifier hs-type">mkLitI</span></a></span><span>   </span><span class="hs-glyph">::</span><span>             </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span class="hs-special">]</span><span>
</span><span id="line-592"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#mkLitF"><span class="hs-identifier hs-type">mkLitF</span></a></span><span>   </span><span class="hs-glyph">::</span><span>             </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span class="hs-special">]</span><span>
</span><span id="line-593"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#mkLitD"><span class="hs-identifier hs-type">mkLitD</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span class="hs-special">]</span><span>
</span><span id="line-594"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#mkLitI64"><span class="hs-identifier hs-type">mkLitI64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span class="hs-special">]</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span id="mkLitF"><span class="annot"><span class="annottext">mkLitF :: Float -&gt; [Word]
</span><a href="GHC.ByteCode.Asm.html#mkLitF"><span class="hs-identifier hs-var hs-var">mkLitF</span></a></span></span><span> </span><span id="local-6989586621681284670"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621681284670"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-597"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (forall s. ST s a) -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-ST.html#runST"><span class="hs-identifier hs-var">runST</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><span id="line-598"></span><span>        </span><span id="local-6989586621681284652"><span class="annot"><span class="annottext">STUArray s Int Float
</span><a href="#local-6989586621681284652"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; m (a i e)
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#newArray_"><span class="hs-identifier hs-var">newArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>        </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; e -&gt; m ()
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#writeArray"><span class="hs-identifier hs-var">writeArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Float
</span><a href="#local-6989586621681284652"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621681284670"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-600"></span><span>        </span><span id="local-6989586621681284649"><span class="annot"><span class="annottext">STUArray s Int Word
</span><a href="#local-6989586621681284649"><span class="hs-identifier hs-var">f_arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s ix a b. STUArray s ix a -&gt; ST s (STUArray s ix b)
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#castSTUArray"><span class="hs-identifier hs-var">castSTUArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Float
</span><a href="#local-6989586621681284652"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-601"></span><span>        </span><span id="local-6989586621681284648"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284648"><span class="hs-identifier hs-var">w0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; m e
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#readArray"><span class="hs-identifier hs-var">readArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Word
</span><a href="#local-6989586621681284649"><span class="hs-identifier hs-var">f_arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-602"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284648"><span class="hs-identifier hs-var">w0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span class="hs-special">]</span><span>
</span><span id="line-603"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-604"></span><span>
</span><span id="line-605"></span><span id="mkLitD"><span class="annot"><span class="annottext">mkLitD :: Platform -&gt; Double -&gt; [Word]
</span><a href="GHC.ByteCode.Asm.html#mkLitD"><span class="hs-identifier hs-var hs-var">mkLitD</span></a></span></span><span> </span><span id="local-6989586621681284646"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284646"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621681284645"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681284645"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; PlatformWordSize
</span><a href="GHC.Platform.html#platformWordSize"><span class="hs-identifier hs-var">platformWordSize</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284646"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-606"></span><span>   </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW4"><span class="hs-identifier hs-var">PW4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (forall s. ST s a) -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-ST.html#runST"><span class="hs-identifier hs-var">runST</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><span id="line-607"></span><span>        </span><span id="local-6989586621681284625"><span class="annot"><span class="annottext">STUArray s Int Double
</span><a href="#local-6989586621681284625"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; m (a i e)
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#newArray_"><span class="hs-identifier hs-var">newArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>        </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; e -&gt; m ()
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#writeArray"><span class="hs-identifier hs-var">writeArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Double
</span><a href="#local-6989586621681284625"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681284645"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-609"></span><span>        </span><span id="local-6989586621681284624"><span class="annot"><span class="annottext">STUArray s Int Word
</span><a href="#local-6989586621681284624"><span class="hs-identifier hs-var">d_arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s ix a b. STUArray s ix a -&gt; ST s (STUArray s ix b)
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#castSTUArray"><span class="hs-identifier hs-var">castSTUArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Double
</span><a href="#local-6989586621681284625"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-610"></span><span>        </span><span id="local-6989586621681284623"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284623"><span class="hs-identifier hs-var">w0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; m e
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#readArray"><span class="hs-identifier hs-var">readArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Word
</span><a href="#local-6989586621681284624"><span class="hs-identifier hs-var">d_arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-611"></span><span>        </span><span id="local-6989586621681284622"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284622"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; m e
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#readArray"><span class="hs-identifier hs-var">readArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Word
</span><a href="#local-6989586621681284624"><span class="hs-identifier hs-var">d_arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-612"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284623"><span class="hs-identifier hs-var">w0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284622"><span class="hs-identifier hs-var">w1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-613"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>   </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW8"><span class="hs-identifier hs-var">PW8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (forall s. ST s a) -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-ST.html#runST"><span class="hs-identifier hs-var">runST</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><span id="line-615"></span><span>        </span><span id="local-6989586621681284607"><span class="annot"><span class="annottext">STUArray s Int Double
</span><a href="#local-6989586621681284607"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; m (a i e)
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#newArray_"><span class="hs-identifier hs-var">newArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>        </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; e -&gt; m ()
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#writeArray"><span class="hs-identifier hs-var">writeArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Double
</span><a href="#local-6989586621681284607"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681284645"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-617"></span><span>        </span><span id="local-6989586621681284606"><span class="annot"><span class="annottext">STUArray s Int Word
</span><a href="#local-6989586621681284606"><span class="hs-identifier hs-var">d_arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s ix a b. STUArray s ix a -&gt; ST s (STUArray s ix b)
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#castSTUArray"><span class="hs-identifier hs-var">castSTUArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Double
</span><a href="#local-6989586621681284607"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-618"></span><span>        </span><span id="local-6989586621681284605"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284605"><span class="hs-identifier hs-var">w0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; m e
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#readArray"><span class="hs-identifier hs-var">readArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Word
</span><a href="#local-6989586621681284606"><span class="hs-identifier hs-var">d_arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-619"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284605"><span class="hs-identifier hs-var">w0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span class="hs-special">]</span><span>
</span><span id="line-620"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span id="mkLitI64"><span class="annot"><span class="annottext">mkLitI64 :: Platform -&gt; Int64 -&gt; [Word]
</span><a href="GHC.ByteCode.Asm.html#mkLitI64"><span class="hs-identifier hs-var hs-var">mkLitI64</span></a></span></span><span> </span><span id="local-6989586621681284604"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284604"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621681284603"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621681284603"><span class="hs-identifier hs-var">ii</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; PlatformWordSize
</span><a href="GHC.Platform.html#platformWordSize"><span class="hs-identifier hs-var">platformWordSize</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681284604"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-623"></span><span>   </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW4"><span class="hs-identifier hs-var">PW4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (forall s. ST s a) -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-ST.html#runST"><span class="hs-identifier hs-var">runST</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><span id="line-624"></span><span>        </span><span id="local-6989586621681284583"><span class="annot"><span class="annottext">STUArray s Int Int64
</span><a href="#local-6989586621681284583"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; m (a i e)
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#newArray_"><span class="hs-identifier hs-var">newArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>        </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; e -&gt; m ()
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#writeArray"><span class="hs-identifier hs-var">writeArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Int64
</span><a href="#local-6989586621681284583"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621681284603"><span class="hs-identifier hs-var">ii</span></a></span><span>
</span><span id="line-626"></span><span>        </span><span id="local-6989586621681284582"><span class="annot"><span class="annottext">STUArray s Int Word
</span><a href="#local-6989586621681284582"><span class="hs-identifier hs-var">d_arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s ix a b. STUArray s ix a -&gt; ST s (STUArray s ix b)
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#castSTUArray"><span class="hs-identifier hs-var">castSTUArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Int64
</span><a href="#local-6989586621681284583"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-627"></span><span>        </span><span id="local-6989586621681284581"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284581"><span class="hs-identifier hs-var">w0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; m e
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#readArray"><span class="hs-identifier hs-var">readArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Word
</span><a href="#local-6989586621681284582"><span class="hs-identifier hs-var">d_arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-628"></span><span>        </span><span id="local-6989586621681284580"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284580"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; m e
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#readArray"><span class="hs-identifier hs-var">readArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Word
</span><a href="#local-6989586621681284582"><span class="hs-identifier hs-var">d_arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-629"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284581"><span class="hs-identifier hs-var">w0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284580"><span class="hs-identifier hs-var">w1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-630"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>   </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW8"><span class="hs-identifier hs-var">PW8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (forall s. ST s a) -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-ST.html#runST"><span class="hs-identifier hs-var">runST</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><span id="line-632"></span><span>        </span><span id="local-6989586621681284565"><span class="annot"><span class="annottext">STUArray s Int Int64
</span><a href="#local-6989586621681284565"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
(i, i) -&gt; m (a i e)
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#newArray_"><span class="hs-identifier hs-var">newArray_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>        </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; e -&gt; m ()
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#writeArray"><span class="hs-identifier hs-var">writeArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Int64
</span><a href="#local-6989586621681284565"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621681284603"><span class="hs-identifier hs-var">ii</span></a></span><span>
</span><span id="line-634"></span><span>        </span><span id="local-6989586621681284564"><span class="annot"><span class="annottext">STUArray s Int Word
</span><a href="#local-6989586621681284564"><span class="hs-identifier hs-var">d_arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s ix a b. STUArray s ix a -&gt; ST s (STUArray s ix b)
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#castSTUArray"><span class="hs-identifier hs-var">castSTUArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Int64
</span><a href="#local-6989586621681284565"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-635"></span><span>        </span><span id="local-6989586621681284563"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284563"><span class="hs-identifier hs-var">w0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) e (m :: * -&gt; *) i.
(MArray a e m, Ix i) =&gt;
a i e -&gt; i -&gt; m e
</span><a href="../../array-0.5.4.0/src/Data-Array-Base.html#readArray"><span class="hs-identifier hs-var">readArray</span></a></span><span> </span><span class="annot"><span class="annottext">STUArray s Int Word
</span><a href="#local-6989586621681284564"><span class="hs-identifier hs-var">d_arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-636"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681284563"><span class="hs-identifier hs-var">w0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span class="hs-special">]</span><span>
</span><span id="line-637"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span id="mkLitI"><span class="annot"><span class="annottext">mkLitI :: Int -&gt; [Word]
</span><a href="GHC.ByteCode.Asm.html#mkLitI"><span class="hs-identifier hs-var hs-var">mkLitI</span></a></span></span><span> </span><span id="local-6989586621681284562"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681284562"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681284562"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span class="hs-special">]</span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span class="annot"><a href="GHC.ByteCode.Asm.html#iNTERP_STACK_CHECK_THRESH"><span class="hs-identifier hs-type">iNTERP_STACK_CHECK_THRESH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-642"></span><span id="iNTERP_STACK_CHECK_THRESH"><span class="annot"><span class="annottext">iNTERP_STACK_CHECK_THRESH :: Int
</span><a href="GHC.ByteCode.Asm.html#iNTERP_STACK_CHECK_THRESH"><span class="hs-identifier hs-var hs-var">iNTERP_STACK_CHECK_THRESH</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">INTERP_STACK_CHECK_THRESH</span><span>
</span><span id="line-643"></span></pre></body></html>