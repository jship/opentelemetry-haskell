<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- (c) The University of Glasgow 2002-2006</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE CPP, RankNTypes, BangPatterns #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Iface.Env</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-6"></span><span>        </span><span class="annot"><a href="GHC.Iface.Env.html#newGlobalBinder"><span class="hs-identifier">newGlobalBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Iface.Env.html#newInteractiveBinder"><span class="hs-identifier">newInteractiveBinder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>        </span><span class="annot"><a href="GHC.Iface.Env.html#externaliseName"><span class="hs-identifier">externaliseName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>        </span><span class="annot"><a href="GHC.Iface.Env.html#lookupIfaceTop"><span class="hs-identifier">lookupIfaceTop</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>        </span><span class="annot"><a href="GHC.Iface.Env.html#lookupOrig"><span class="hs-identifier">lookupOrig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Iface.Env.html#lookupOrigIO"><span class="hs-identifier">lookupOrigIO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Cache.html#lookupOrigNameCache"><span class="hs-identifier">lookupOrigNameCache</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Cache.html#extendNameCache"><span class="hs-identifier">extendNameCache</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>        </span><span class="annot"><a href="GHC.Iface.Env.html#newIfaceName"><span class="hs-identifier">newIfaceName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Iface.Env.html#newIfaceNames"><span class="hs-identifier">newIfaceNames</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>        </span><span class="annot"><a href="GHC.Iface.Env.html#extendIfaceIdEnv"><span class="hs-identifier">extendIfaceIdEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Iface.Env.html#extendIfaceTyVarEnv"><span class="hs-identifier">extendIfaceTyVarEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>        </span><span class="annot"><a href="GHC.Iface.Env.html#tcIfaceLclId"><span class="hs-identifier">tcIfaceLclId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Iface.Env.html#tcIfaceTyVar"><span class="hs-identifier">tcIfaceTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Iface.Env.html#lookupIfaceVar"><span class="hs-identifier">lookupIfaceVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>        </span><span class="annot"><a href="GHC.Iface.Env.html#lookupIfaceTyVar"><span class="hs-identifier">lookupIfaceTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Iface.Env.html#extendIfaceEnvs"><span class="hs-identifier">extendIfaceEnvs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>        </span><span class="annot"><a href="GHC.Iface.Env.html#setNameModule"><span class="hs-identifier">setNameModule</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>        </span><span class="annot"><a href="GHC.Iface.Env.html#ifaceExportNames"><span class="hs-identifier">ifaceExportNames</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span>        </span><span class="hs-comment">-- Name-cache stuff</span><span>
</span><span id="line-19"></span><span>        </span><span class="annot"><a href="GHC.Iface.Env.html#allocateGlobalBinder"><span class="hs-identifier">allocateGlobalBinder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Iface.Env.html#updNameCacheTc"><span class="hs-identifier">updNameCacheTc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Iface.Env.html#updNameCache"><span class="hs-identifier">updNameCache</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>        </span><span class="annot"><a href="GHC.Iface.Env.html#mkNameCacheUpdater"><span class="hs-identifier">mkNameCacheUpdater</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Iface.Env.html#NameCacheUpdater"><span class="hs-identifier">NameCacheUpdater</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#include &quot;HsVersions.h&quot;
</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Env.html"><span class="hs-identifier">GHC.Driver.Env</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html"><span class="hs-identifier">GHC.Tc.Utils.Monad</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Iface.Type.html"><span class="hs-identifier">GHC.Iface.Type</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Runtime.Context.html"><span class="hs-identifier">GHC.Runtime.Context</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.html"><span class="hs-identifier">GHC.Unit.Module</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModIface.html"><span class="hs-identifier">GHC.Unit.Module.ModIface</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.Env.html"><span class="hs-identifier">GHC.Data.FastString.Env</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.html"><span class="hs-identifier">GHC.Types.Var</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Avail.html"><span class="hs-identifier">GHC.Types.Avail</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Cache.html"><span class="hs-identifier">GHC.Types.Name.Cache</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html"><span class="hs-identifier">GHC.Types.Unique.Supply</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-List.html#"><span class="hs-identifier">Data.List</span></a></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-OldList.html#partition"><span class="hs-identifier">partition</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-IORef.html#"><span class="hs-identifier">Data.IORef</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">{-
*********************************************************
*                                                      *
        Allocating new Names in the Name Cache
*                                                      *
*********************************************************

See Also: Note [The Name Cache] in GHC.Types.Name.Cache
-}</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span id="local-6989586621681323438"><span id="local-6989586621681323439"><span class="annot"><a href="GHC.Iface.Env.html#newGlobalBinder"><span class="hs-identifier hs-type">newGlobalBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323439"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323438"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span></span></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- Used for source code and interface files, to make the</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- Name for a thing, given its Module and OccName</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- See Note [The Name Cache] in GHC.Types.Name.Cache</span><span>
</span><span id="line-65"></span><span class="hs-comment">--</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- The cache may already have a binding for this thing,</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- because we may have seen an occurrence before, but now is the</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- moment when we know its Module and SrcLoc in their full glory</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span id="newGlobalBinder"><span class="annot"><span class="annottext">newGlobalBinder :: forall a b. Module -&gt; OccName -&gt; SrcSpan -&gt; TcRnIf a b Name
</span><a href="GHC.Iface.Env.html#newGlobalBinder"><span class="hs-identifier hs-var hs-var">newGlobalBinder</span></a></span></span><span> </span><span id="local-6989586621681323291"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323291"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621681323290"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323290"><span class="hs-identifier hs-var">occ</span></a></span></span><span> </span><span id="local-6989586621681323289"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681323289"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681323288"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323288"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall c a b.
Module -&gt; OccName -&gt; (NameCache -&gt; (NameCache, c)) -&gt; TcRnIf a b c
</span><a href="GHC.Iface.Env.html#updNameCacheTc"><span class="hs-identifier hs-var">updNameCacheTc</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323291"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323290"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681323287"><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323287"><span class="hs-identifier hs-var">name_cache</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-72"></span><span>                 </span><span class="annot"><span class="annottext">NameCache -&gt; Module -&gt; OccName -&gt; SrcSpan -&gt; (NameCache, Name)
</span><a href="GHC.Iface.Env.html#allocateGlobalBinder"><span class="hs-identifier hs-var">allocateGlobalBinder</span></a></span><span> </span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323287"><span class="hs-identifier hs-var">name_cache</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323291"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323290"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681323289"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-73"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall m n. SDoc -&gt; TcRnIf m n ()
</span><a href="GHC.Tc.Utils.Monad.html#traceIf"><span class="hs-identifier hs-var">traceIf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;newGlobalBinder&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-74"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323291"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323290"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681323289"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323288"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323288"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><a href="GHC.Iface.Env.html#newInteractiveBinder"><span class="hs-identifier hs-type">newInteractiveBinder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- Works in the IO monad, and gets the Module</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- from the interactive context</span><span>
</span><span id="line-80"></span><span id="newInteractiveBinder"><span class="annot"><span class="annottext">newInteractiveBinder :: HscEnv -&gt; OccName -&gt; SrcSpan -&gt; IO Name
</span><a href="GHC.Iface.Env.html#newInteractiveBinder"><span class="hs-identifier hs-var hs-var">newInteractiveBinder</span></a></span></span><span> </span><span id="local-6989586621681323281"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681323281"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621681323280"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323280"><span class="hs-identifier hs-var">occ</span></a></span></span><span> </span><span id="local-6989586621681323279"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681323279"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-81"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681323278"><span class="annot"><span class="annottext">mod :: Module
</span><a href="#local-6989586621681323278"><span class="hs-identifier hs-var hs-var">mod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InteractiveContext -&gt; Module
</span><a href="GHC.Runtime.Context.html#icInteractiveModule"><span class="hs-identifier hs-var">icInteractiveModule</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; InteractiveContext
</span><a href="GHC.Driver.Env.Types.html#hsc_IC"><span class="hs-identifier hs-var">hsc_IC</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681323281"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall c.
HscEnv
-&gt; Module -&gt; OccName -&gt; (NameCache -&gt; (NameCache, c)) -&gt; IO c
</span><a href="GHC.Iface.Env.html#updNameCacheIO"><span class="hs-identifier hs-var">updNameCacheIO</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681323281"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323278"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323280"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681323274"><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323274"><span class="hs-identifier hs-var">name_cache</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-83"></span><span>         </span><span class="annot"><span class="annottext">NameCache -&gt; Module -&gt; OccName -&gt; SrcSpan -&gt; (NameCache, Name)
</span><a href="GHC.Iface.Env.html#allocateGlobalBinder"><span class="hs-identifier hs-var">allocateGlobalBinder</span></a></span><span> </span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323274"><span class="hs-identifier hs-var">name_cache</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323278"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323280"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681323279"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="annot"><a href="GHC.Iface.Env.html#allocateGlobalBinder"><span class="hs-identifier hs-type">allocateGlobalBinder</span></a></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Cache.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Cache.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- See Note [The Name Cache] in GHC.Types.Name.Cache</span><span>
</span><span id="line-90"></span><span id="allocateGlobalBinder"><span class="annot"><span class="annottext">allocateGlobalBinder :: NameCache -&gt; Module -&gt; OccName -&gt; SrcSpan -&gt; (NameCache, Name)
</span><a href="GHC.Iface.Env.html#allocateGlobalBinder"><span class="hs-identifier hs-var hs-var">allocateGlobalBinder</span></a></span></span><span> </span><span id="local-6989586621681323273"><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323273"><span class="hs-identifier hs-var">name_supply</span></a></span></span><span> </span><span id="local-6989586621681323272"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323272"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621681323271"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323271"><span class="hs-identifier hs-var">occ</span></a></span></span><span> </span><span id="local-6989586621681323270"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681323270"><span class="hs-identifier hs-var">loc</span></a></span></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OrigNameCache -&gt; Module -&gt; OccName -&gt; Maybe Name
</span><a href="GHC.Types.Name.Cache.html#lookupOrigNameCache"><span class="hs-identifier hs-var">lookupOrigNameCache</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameCache -&gt; OrigNameCache
</span><a href="GHC.Types.Name.Cache.html#nsNames"><span class="hs-identifier hs-var">nsNames</span></a></span><span> </span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323273"><span class="hs-identifier hs-var">name_supply</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323272"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323271"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-92"></span><span>        </span><span class="hs-comment">-- A hit in the cache!  We are at the binding site of the name.</span><span>
</span><span id="line-93"></span><span>        </span><span class="hs-comment">-- This is the moment when we know the SrcLoc</span><span>
</span><span id="line-94"></span><span>        </span><span class="hs-comment">-- of the Name, so we set this field in the Name we return.</span><span>
</span><span id="line-95"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-96"></span><span>        </span><span class="hs-comment">-- Then (bogus) multiple bindings of the same Name</span><span>
</span><span id="line-97"></span><span>        </span><span class="hs-comment">-- get different SrcLocs can be reported as such.</span><span>
</span><span id="line-98"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-99"></span><span>        </span><span class="hs-comment">-- Possible other reason: it might be in the cache because we</span><span>
</span><span id="line-100"></span><span>        </span><span class="hs-comment">--      encountered an occurrence before the binding site for an</span><span>
</span><span id="line-101"></span><span>        </span><span class="hs-comment">--      implicitly-imported Name.  Perhaps the current SrcLoc is</span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-comment">--      better... but not really: it'll still just say 'imported'</span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-104"></span><span>        </span><span class="hs-comment">-- IMPORTANT: Don't mess with wired-in names.</span><span>
</span><span id="line-105"></span><span>        </span><span class="hs-comment">--            Their wired-in-ness is in their NameSort</span><span>
</span><span id="line-106"></span><span>        </span><span class="hs-comment">--            and their Module is correct.</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681323268"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323268"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="GHC.Types.Name.html#isWiredInName"><span class="hs-identifier hs-var">isWiredInName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323268"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-109"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323273"><span class="hs-identifier hs-var">name_supply</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323268"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-111"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323266"><span class="hs-identifier hs-var">new_name_supply</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323265"><span class="hs-identifier hs-var">name'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>                  </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>                    </span><span id="local-6989586621681323264"><span class="annot"><span class="annottext">uniq :: Unique
</span><a href="#local-6989586621681323264"><span class="hs-identifier hs-var hs-var">uniq</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Unique
</span><a href="GHC.Types.Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323268"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-114"></span><span>                    </span><span id="local-6989586621681323265"><span class="annot"><span class="annottext">name' :: Name
</span><a href="#local-6989586621681323265"><span class="hs-identifier hs-var hs-var">name'</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Module -&gt; OccName -&gt; SrcSpan -&gt; Name
</span><a href="GHC.Types.Name.html#mkExternalName"><span class="hs-identifier hs-var">mkExternalName</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681323264"><span class="hs-identifier hs-var">uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323272"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323271"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681323270"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-115"></span><span>                                      </span><span class="hs-comment">-- name' is like name, but with the right SrcSpan</span><span>
</span><span id="line-116"></span><span>                    </span><span id="local-6989586621681323261"><span class="annot"><span class="annottext">new_cache :: OrigNameCache
</span><a href="#local-6989586621681323261"><span class="hs-identifier hs-var hs-var">new_cache</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrigNameCache -&gt; Module -&gt; OccName -&gt; Name -&gt; OrigNameCache
</span><a href="GHC.Types.Name.Cache.html#extendNameCache"><span class="hs-identifier hs-var">extendNameCache</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameCache -&gt; OrigNameCache
</span><a href="GHC.Types.Name.Cache.html#nsNames"><span class="hs-identifier hs-var">nsNames</span></a></span><span> </span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323273"><span class="hs-identifier hs-var">name_supply</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323272"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323271"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323265"><span class="hs-identifier hs-var">name'</span></a></span><span>
</span><span id="line-117"></span><span>                    </span><span id="local-6989586621681323266"><span class="annot"><span class="annottext">new_name_supply :: NameCache
</span><a href="#local-6989586621681323266"><span class="hs-identifier hs-var hs-var">new_name_supply</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323273"><span class="hs-identifier hs-var">name_supply</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">nsNames :: OrigNameCache
</span><a href="GHC.Types.Name.Cache.html#nsNames"><span class="hs-identifier hs-var">nsNames</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrigNameCache
</span><a href="#local-6989586621681323261"><span class="hs-identifier hs-var">new_cache</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-comment">-- Miss in the cache!</span><span>
</span><span id="line-120"></span><span>        </span><span class="hs-comment">-- Build a completely new Name, and put it in the cache</span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><span class="annottext">Maybe Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323260"><span class="hs-identifier hs-var">new_name_supply</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323259"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>                  </span><span class="hs-keyword">where</span><span>
</span><span id="line-123"></span><span>                    </span><span class="hs-special">(</span><span id="local-6989586621681323258"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681323258"><span class="hs-identifier hs-var">uniq</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681323257"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681323257"><span class="hs-identifier hs-var">us'</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; (Unique, UniqSupply)
</span><a href="GHC.Types.Unique.Supply.html#takeUniqFromSupply"><span class="hs-identifier hs-var">takeUniqFromSupply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameCache -&gt; UniqSupply
</span><a href="GHC.Types.Name.Cache.html#nsUniqs"><span class="hs-identifier hs-var">nsUniqs</span></a></span><span> </span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323273"><span class="hs-identifier hs-var">name_supply</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>                    </span><span id="local-6989586621681323259"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621681323259"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Module -&gt; OccName -&gt; SrcSpan -&gt; Name
</span><a href="GHC.Types.Name.html#mkExternalName"><span class="hs-identifier hs-var">mkExternalName</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681323258"><span class="hs-identifier hs-var">uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323272"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323271"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681323270"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-125"></span><span>                    </span><span id="local-6989586621681323254"><span class="annot"><span class="annottext">new_cache :: OrigNameCache
</span><a href="#local-6989586621681323254"><span class="hs-identifier hs-var hs-var">new_cache</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrigNameCache -&gt; Module -&gt; OccName -&gt; Name -&gt; OrigNameCache
</span><a href="GHC.Types.Name.Cache.html#extendNameCache"><span class="hs-identifier hs-var">extendNameCache</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameCache -&gt; OrigNameCache
</span><a href="GHC.Types.Name.Cache.html#nsNames"><span class="hs-identifier hs-var">nsNames</span></a></span><span> </span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323273"><span class="hs-identifier hs-var">name_supply</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323272"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323271"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323259"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-126"></span><span>                    </span><span id="local-6989586621681323260"><span class="annot"><span class="annottext">new_name_supply :: NameCache
</span><a href="#local-6989586621681323260"><span class="hs-identifier hs-var hs-var">new_name_supply</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323273"><span class="hs-identifier hs-var">name_supply</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">nsUniqs :: UniqSupply
</span><a href="GHC.Types.Name.Cache.html#nsUniqs"><span class="hs-identifier hs-var">nsUniqs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681323257"><span class="hs-identifier hs-var">us'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nsNames :: OrigNameCache
</span><a href="GHC.Types.Name.Cache.html#nsNames"><span class="hs-identifier hs-var">nsNames</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrigNameCache
</span><a href="#local-6989586621681323254"><span class="hs-identifier hs-var">new_cache</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span id="local-6989586621681323412"><span id="local-6989586621681323413"><span class="annot"><a href="GHC.Iface.Env.html#ifaceExportNames"><span class="hs-identifier hs-type">ifaceExportNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Unit.Module.ModIface.html#IfaceExport"><span class="hs-identifier hs-type">IfaceExport</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323413"><span class="hs-identifier hs-type">gbl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323412"><span class="hs-identifier hs-type">lcl</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-129"></span><span id="ifaceExportNames"><span class="annot"><span class="annottext">ifaceExportNames :: forall gbl lcl. [IfaceExport] -&gt; TcRnIf gbl lcl [IfaceExport]
</span><a href="GHC.Iface.Env.html#ifaceExportNames"><span class="hs-identifier hs-var hs-var">ifaceExportNames</span></a></span></span><span> </span><span id="local-6989586621681323251"><span class="annot"><span class="annottext">[IfaceExport]
</span><a href="#local-6989586621681323251"><span class="hs-identifier hs-var">exports</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">[IfaceExport]
</span><a href="#local-6989586621681323251"><span class="hs-identifier hs-var">exports</span></a></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">-- | A function that atomically updates the name cache given a modifier</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- function.  The second result of the modifier function will be the result</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- of the IO action.</span><span>
</span><span id="line-134"></span><span class="hs-keyword">newtype</span><span> </span><span id="NameCacheUpdater"><span class="annot"><a href="GHC.Iface.Env.html#NameCacheUpdater"><span class="hs-identifier hs-var">NameCacheUpdater</span></a></span></span><span>
</span><span id="line-135"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span id="NCU"><span class="annot"><a href="GHC.Iface.Env.html#NCU"><span class="hs-identifier hs-var">NCU</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="updateNameCache"><span class="annot"><span class="annottext">NameCacheUpdater -&gt; forall c. (NameCache -&gt; (NameCache, c)) -&gt; IO c
</span><a href="GHC.Iface.Env.html#updateNameCache"><span class="hs-identifier hs-var hs-var">updateNameCache</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681323408"><span class="annot"><a href="#local-6989586621681323408"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Cache.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Cache.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681323408"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621681323408"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621681323406"><span id="local-6989586621681323407"><span class="annot"><a href="GHC.Iface.Env.html#mkNameCacheUpdater"><span class="hs-identifier hs-type">mkNameCacheUpdater</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323407"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323406"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="GHC.Iface.Env.html#NameCacheUpdater"><span class="hs-identifier hs-type">NameCacheUpdater</span></a></span></span></span><span>
</span><span id="line-138"></span><span id="mkNameCacheUpdater"><span class="annot"><span class="annottext">mkNameCacheUpdater :: forall a b. TcRnIf a b NameCacheUpdater
</span><a href="GHC.Iface.Env.html#mkNameCacheUpdater"><span class="hs-identifier hs-var hs-var">mkNameCacheUpdater</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681323245"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681323245"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. TcRnIf gbl lcl HscEnv
</span><a href="GHC.Tc.Utils.Monad.html#getTopEnv"><span class="hs-identifier hs-var">getTopEnv</span></a></span><span>
</span><span id="line-139"></span><span>                        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681323243"><span class="annot"><span class="annottext">ncRef :: IORef NameCache
</span><a href="#local-6989586621681323243"><span class="hs-identifier hs-var hs-var">ncRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HscEnv -&gt; IORef NameCache
</span><a href="GHC.Driver.Env.Types.html#hsc_NC"><span class="hs-identifier hs-var">hsc_NC</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681323245"><span class="hs-identifier hs-var">hsc_env</span></a></span><span>
</span><span id="line-140"></span><span>                        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall c. (NameCache -&gt; (NameCache, c)) -&gt; IO c)
-&gt; NameCacheUpdater
</span><a href="GHC.Iface.Env.html#NCU"><span class="hs-identifier hs-var">NCU</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall c. IORef NameCache -&gt; (NameCache -&gt; (NameCache, c)) -&gt; IO c
</span><a href="GHC.Iface.Env.html#updNameCache"><span class="hs-identifier hs-var">updNameCache</span></a></span><span> </span><span class="annot"><span class="annottext">IORef NameCache
</span><a href="#local-6989586621681323243"><span class="hs-identifier hs-var">ncRef</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span id="local-6989586621681323430"><span id="local-6989586621681323431"><span id="local-6989586621681323432"><span class="annot"><a href="GHC.Iface.Env.html#updNameCacheTc"><span class="hs-identifier hs-type">updNameCacheTc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Cache.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Cache.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681323432"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323431"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323430"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323432"><span class="hs-identifier hs-type">c</span></a></span></span></span></span><span>
</span><span id="line-144"></span><span id="updNameCacheTc"><span class="annot"><span class="annottext">updNameCacheTc :: forall c a b.
Module -&gt; OccName -&gt; (NameCache -&gt; (NameCache, c)) -&gt; TcRnIf a b c
</span><a href="GHC.Iface.Env.html#updNameCacheTc"><span class="hs-identifier hs-var hs-var">updNameCacheTc</span></a></span></span><span> </span><span id="local-6989586621681323238"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323238"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621681323237"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323237"><span class="hs-identifier hs-var">occ</span></a></span></span><span> </span><span id="local-6989586621681323236"><span class="annot"><span class="annottext">NameCache -&gt; (NameCache, c)
</span><a href="#local-6989586621681323236"><span class="hs-identifier hs-var">upd_fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621681323235"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681323235"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. TcRnIf gbl lcl HscEnv
</span><a href="GHC.Tc.Utils.Monad.html#getTopEnv"><span class="hs-identifier hs-var">getTopEnv</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.16.4.0/src/Control-Monad-IO-Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall c.
HscEnv
-&gt; Module -&gt; OccName -&gt; (NameCache -&gt; (NameCache, c)) -&gt; IO c
</span><a href="GHC.Iface.Env.html#updNameCacheIO"><span class="hs-identifier hs-var">updNameCacheIO</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681323235"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323238"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323237"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">NameCache -&gt; (NameCache, c)
</span><a href="#local-6989586621681323236"><span class="hs-identifier hs-var">upd_fn</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span id="local-6989586621681323418"><span class="annot"><a href="GHC.Iface.Env.html#updNameCacheIO"><span class="hs-identifier hs-type">updNameCacheIO</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span>
</span><span id="line-150"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Cache.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Cache.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681323418"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621681323418"><span class="hs-identifier hs-type">c</span></a></span></span><span>
</span><span id="line-152"></span><span id="updNameCacheIO"><span class="annot"><span class="annottext">updNameCacheIO :: forall c.
HscEnv
-&gt; Module -&gt; OccName -&gt; (NameCache -&gt; (NameCache, c)) -&gt; IO c
</span><a href="GHC.Iface.Env.html#updNameCacheIO"><span class="hs-identifier hs-var hs-var">updNameCacheIO</span></a></span></span><span> </span><span id="local-6989586621681323230"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681323230"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621681323229"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323229"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621681323228"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323228"><span class="hs-identifier hs-var">occ</span></a></span></span><span> </span><span id="local-6989586621681323227"><span class="annot"><span class="annottext">NameCache -&gt; (NameCache, c)
</span><a href="#local-6989586621681323227"><span class="hs-identifier hs-var">upd_fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-comment">-- First ensure that mod and occ are evaluated</span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-comment">-- If not, chaos can ensue:</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-comment">--      we read the name-cache</span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-comment">--      then pull on mod (say)</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-comment">--      which does some stuff that modifies the name cache</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-comment">-- This did happen, with tycon_mod in GHC.IfaceToCore.tcIfaceAlt (DataAlt..)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323229"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">seq :: forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-type">`seq`</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323228"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">seq :: forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-type">`seq`</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall c. IORef NameCache -&gt; (NameCache -&gt; (NameCache, c)) -&gt; IO c
</span><a href="GHC.Iface.Env.html#updNameCache"><span class="hs-identifier hs-var">updNameCache</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HscEnv -&gt; IORef NameCache
</span><a href="GHC.Driver.Env.Types.html#hsc_NC"><span class="hs-identifier hs-var">hsc_NC</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681323230"><span class="hs-identifier hs-var">hsc_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NameCache -&gt; (NameCache, c)
</span><a href="#local-6989586621681323227"><span class="hs-identifier hs-var">upd_fn</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Name cache access
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Look up the 'Name' for a given 'Module' and 'OccName'.</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- Consider alternatively using 'lookupIfaceTop' if you're in the 'IfL' monad</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- and 'Module' is simply that of the 'ModIface' you are typechecking.</span><span>
</span><span id="line-176"></span><span id="local-6989586621681323387"><span id="local-6989586621681323388"><span class="annot"><a href="GHC.Iface.Env.html#lookupOrig"><span class="hs-identifier hs-type">lookupOrig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323388"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323387"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span></span></span><span>
</span><span id="line-177"></span><span id="lookupOrig"><span class="annot"><span class="annottext">lookupOrig :: forall a b. Module -&gt; OccName -&gt; TcRnIf a b Name
</span><a href="GHC.Iface.Env.html#lookupOrig"><span class="hs-identifier hs-var hs-var">lookupOrig</span></a></span></span><span> </span><span id="local-6989586621681323223"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323223"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621681323222"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323222"><span class="hs-identifier hs-var">occ</span></a></span></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">forall m n. SDoc -&gt; TcRnIf m n ()
</span><a href="GHC.Tc.Utils.Monad.html#traceIf"><span class="hs-identifier hs-var">traceIf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lookup_orig&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323223"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323222"><span class="hs-identifier hs-var">occ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall c a b.
Module -&gt; OccName -&gt; (NameCache -&gt; (NameCache, c)) -&gt; TcRnIf a b c
</span><a href="GHC.Iface.Env.html#updNameCacheTc"><span class="hs-identifier hs-var">updNameCacheTc</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323223"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323222"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Module -&gt; OccName -&gt; NameCache -&gt; (NameCache, Name)
</span><a href="GHC.Iface.Env.html#lookupNameCache"><span class="hs-identifier hs-var">lookupNameCache</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323223"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323222"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><a href="GHC.Iface.Env.html#lookupOrigIO"><span class="hs-identifier hs-type">lookupOrigIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Env.Types.html#HscEnv"><span class="hs-identifier hs-type">HscEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-183"></span><span id="lookupOrigIO"><span class="annot"><span class="annottext">lookupOrigIO :: HscEnv -&gt; Module -&gt; OccName -&gt; IO Name
</span><a href="GHC.Iface.Env.html#lookupOrigIO"><span class="hs-identifier hs-var hs-var">lookupOrigIO</span></a></span></span><span> </span><span id="local-6989586621681323220"><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681323220"><span class="hs-identifier hs-var">hsc_env</span></a></span></span><span> </span><span id="local-6989586621681323219"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323219"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621681323218"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323218"><span class="hs-identifier hs-var">occ</span></a></span></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall c.
HscEnv
-&gt; Module -&gt; OccName -&gt; (NameCache -&gt; (NameCache, c)) -&gt; IO c
</span><a href="GHC.Iface.Env.html#updNameCacheIO"><span class="hs-identifier hs-var">updNameCacheIO</span></a></span><span> </span><span class="annot"><span class="annottext">HscEnv
</span><a href="#local-6989586621681323220"><span class="hs-identifier hs-var">hsc_env</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323219"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323218"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Module -&gt; OccName -&gt; NameCache -&gt; (NameCache, Name)
</span><a href="GHC.Iface.Env.html#lookupNameCache"><span class="hs-identifier hs-var">lookupNameCache</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323219"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323218"><span class="hs-identifier hs-var">occ</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="annot"><a href="GHC.Iface.Env.html#lookupNameCache"><span class="hs-identifier hs-type">lookupNameCache</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Cache.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Cache.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- Lookup up the (Module,OccName) in the NameCache</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- If you find it, return it; if not, allocate a fresh original name and extend</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- the NameCache.</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- Reason: this may the first occurrence of (say) Foo.bar we have encountered.</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- If we need to explore its value we will load Foo.hi; but meanwhile all we</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- need is a Name for it.</span><span>
</span><span id="line-193"></span><span id="lookupNameCache"><span class="annot"><span class="annottext">lookupNameCache :: Module -&gt; OccName -&gt; NameCache -&gt; (NameCache, Name)
</span><a href="GHC.Iface.Env.html#lookupNameCache"><span class="hs-identifier hs-var hs-var">lookupNameCache</span></a></span></span><span> </span><span id="local-6989586621681323217"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323217"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621681323216"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323216"><span class="hs-identifier hs-var">occ</span></a></span></span><span> </span><span id="local-6989586621681323215"><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323215"><span class="hs-identifier hs-var">name_cache</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OrigNameCache -&gt; Module -&gt; OccName -&gt; Maybe Name
</span><a href="GHC.Types.Name.Cache.html#lookupOrigNameCache"><span class="hs-identifier hs-var">lookupOrigNameCache</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameCache -&gt; OrigNameCache
</span><a href="GHC.Types.Name.Cache.html#nsNames"><span class="hs-identifier hs-var">nsNames</span></a></span><span> </span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323215"><span class="hs-identifier hs-var">name_cache</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323217"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323216"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681323214"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323214"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323215"><span class="hs-identifier hs-var">name_cache</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323214"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; (Unique, UniqSupply)
</span><a href="GHC.Types.Unique.Supply.html#takeUniqFromSupply"><span class="hs-identifier hs-var">takeUniqFromSupply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameCache -&gt; UniqSupply
</span><a href="GHC.Types.Name.Cache.html#nsUniqs"><span class="hs-identifier hs-var">nsUniqs</span></a></span><span> </span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323215"><span class="hs-identifier hs-var">name_cache</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-198"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621681323213"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681323213"><span class="hs-identifier hs-var">uniq</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681323212"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681323212"><span class="hs-identifier hs-var">us</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-199"></span><span>              </span><span class="hs-keyword">let</span><span>
</span><span id="line-200"></span><span>                </span><span id="local-6989586621681323211"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621681323211"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Module -&gt; OccName -&gt; SrcSpan -&gt; Name
</span><a href="GHC.Types.Name.html#mkExternalName"><span class="hs-identifier hs-var">mkExternalName</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681323213"><span class="hs-identifier hs-var">uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323217"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323216"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="GHC.Types.SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a></span><span>
</span><span id="line-201"></span><span>                </span><span id="local-6989586621681323209"><span class="annot"><span class="annottext">new_cache :: OrigNameCache
</span><a href="#local-6989586621681323209"><span class="hs-identifier hs-var hs-var">new_cache</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrigNameCache -&gt; Module -&gt; OccName -&gt; Name -&gt; OrigNameCache
</span><a href="GHC.Types.Name.Cache.html#extendNameCache"><span class="hs-identifier hs-var">extendNameCache</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameCache -&gt; OrigNameCache
</span><a href="GHC.Types.Name.Cache.html#nsNames"><span class="hs-identifier hs-var">nsNames</span></a></span><span> </span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323215"><span class="hs-identifier hs-var">name_cache</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323217"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323216"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323211"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-202"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323215"><span class="hs-identifier hs-var">name_cache</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">nsUniqs :: UniqSupply
</span><a href="GHC.Types.Name.Cache.html#nsUniqs"><span class="hs-identifier hs-var">nsUniqs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681323212"><span class="hs-identifier hs-var">us</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nsNames :: OrigNameCache
</span><a href="GHC.Types.Name.Cache.html#nsNames"><span class="hs-identifier hs-var">nsNames</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrigNameCache
</span><a href="#local-6989586621681323209"><span class="hs-identifier hs-var">new_cache</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323211"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span id="local-6989586621681323383"><span id="local-6989586621681323384"><span class="annot"><a href="GHC.Iface.Env.html#externaliseName"><span class="hs-identifier hs-type">externaliseName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323384"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323383"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span></span></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- Take an Internal Name and make it an External one,</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- with the same unique</span><span>
</span><span id="line-207"></span><span id="externaliseName"><span class="annot"><span class="annottext">externaliseName :: forall m n. Module -&gt; Name -&gt; TcRnIf m n Name
</span><a href="GHC.Iface.Env.html#externaliseName"><span class="hs-identifier hs-var hs-var">externaliseName</span></a></span></span><span> </span><span id="local-6989586621681323206"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323206"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621681323205"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323205"><span class="hs-identifier hs-var">name</span></a></span></span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681323204"><span class="annot"><span class="annottext">occ :: OccName
</span><a href="#local-6989586621681323204"><span class="hs-identifier hs-var hs-var">occ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323205"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-209"></span><span>             </span><span id="local-6989586621681323202"><span class="annot"><span class="annottext">loc :: SrcSpan
</span><a href="#local-6989586621681323202"><span class="hs-identifier hs-var hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; SrcSpan
</span><a href="GHC.Types.Name.html#nameSrcSpan"><span class="hs-identifier hs-var">nameSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323205"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-210"></span><span>             </span><span id="local-6989586621681323200"><span class="annot"><span class="annottext">uniq :: Unique
</span><a href="#local-6989586621681323200"><span class="hs-identifier hs-var hs-var">uniq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Unique
</span><a href="GHC.Types.Name.html#nameUnique"><span class="hs-identifier hs-var">nameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323205"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-211"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323204"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">seq :: forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-type">`seq`</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- c.f. seq in newGlobalBinder</span><span>
</span><span id="line-212"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall c a b.
Module -&gt; OccName -&gt; (NameCache -&gt; (NameCache, c)) -&gt; TcRnIf a b c
</span><a href="GHC.Iface.Env.html#updNameCacheTc"><span class="hs-identifier hs-var">updNameCacheTc</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323206"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323204"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681323199"><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323199"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-213"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681323198"><span class="annot"><span class="annottext">name' :: Name
</span><a href="#local-6989586621681323198"><span class="hs-identifier hs-var hs-var">name'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Module -&gt; OccName -&gt; SrcSpan -&gt; Name
</span><a href="GHC.Types.Name.html#mkExternalName"><span class="hs-identifier hs-var">mkExternalName</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681323200"><span class="hs-identifier hs-var">uniq</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323206"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323204"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681323202"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-214"></span><span>             </span><span id="local-6989586621681323197"><span class="annot"><span class="annottext">ns' :: NameCache
</span><a href="#local-6989586621681323197"><span class="hs-identifier hs-var hs-var">ns'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323199"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">nsNames :: OrigNameCache
</span><a href="GHC.Types.Name.Cache.html#nsNames"><span class="hs-identifier hs-var">nsNames</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrigNameCache -&gt; Module -&gt; OccName -&gt; Name -&gt; OrigNameCache
</span><a href="GHC.Types.Name.Cache.html#extendNameCache"><span class="hs-identifier hs-var">extendNameCache</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameCache -&gt; OrigNameCache
</span><a href="GHC.Types.Name.Cache.html#nsNames"><span class="hs-identifier hs-var">nsNames</span></a></span><span> </span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323199"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323206"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323204"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323198"><span class="hs-identifier hs-var">name'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-215"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameCache
</span><a href="#local-6989586621681323197"><span class="hs-identifier hs-var">ns'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323198"><span class="hs-identifier hs-var">name'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- | Set the 'Module' of a 'Name'.</span><span>
</span><span id="line-218"></span><span id="local-6989586621681323379"><span id="local-6989586621681323380"><span class="annot"><a href="GHC.Iface.Env.html#setNameModule"><span class="hs-identifier hs-type">setNameModule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRnIf"><span class="hs-identifier hs-type">TcRnIf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323380"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323379"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span></span></span><span>
</span><span id="line-219"></span><span id="setNameModule"><span class="annot"><span class="annottext">setNameModule :: forall m n. Maybe Module -&gt; Name -&gt; TcRnIf m n Name
</span><a href="GHC.Iface.Env.html#setNameModule"><span class="hs-identifier hs-var hs-var">setNameModule</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Module
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span id="local-6989586621681323195"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323195"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323195"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-220"></span><span class="annot"><a href="GHC.Iface.Env.html#setNameModule"><span class="hs-identifier hs-var">setNameModule</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681323194"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323194"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681323193"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323193"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="annottext">forall a b. Module -&gt; OccName -&gt; SrcSpan -&gt; TcRnIf a b Name
</span><a href="GHC.Iface.Env.html#newGlobalBinder"><span class="hs-identifier hs-var">newGlobalBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681323194"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323193"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; SrcSpan
</span><a href="GHC.Types.Name.html#nameSrcSpan"><span class="hs-identifier hs-var">nameSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681323193"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Type variables and local Ids
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="annot"><a href="GHC.Iface.Env.html#tcIfaceLclId"><span class="hs-identifier hs-type">tcIfaceLclId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#IfL"><span class="hs-identifier hs-type">IfL</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-232"></span><span id="tcIfaceLclId"><span class="annot"><span class="annottext">tcIfaceLclId :: FastString -&gt; IfL Id
</span><a href="GHC.Iface.Env.html#tcIfaceLclId"><span class="hs-identifier hs-var hs-var">tcIfaceLclId</span></a></span></span><span> </span><span id="local-6989586621681323192"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681323192"><span class="hs-identifier hs-var">occ</span></a></span></span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681323191"><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323191"><span class="hs-identifier hs-var">lcl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. TcRnIf gbl lcl lcl
</span><a href="GHC.Tc.Utils.Monad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a></span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. FastStringEnv a -&gt; FastString -&gt; Maybe a
</span><a href="GHC.Data.FastString.Env.html#lookupFsEnv"><span class="hs-identifier hs-var">lookupFsEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IfLclEnv -&gt; FastStringEnv Id
</span><a href="GHC.Tc.Types.html#if_id_env"><span class="hs-identifier hs-var">if_id_env</span></a></span><span> </span><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323191"><span class="hs-identifier hs-var">lcl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681323192"><span class="hs-identifier hs-var">occ</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-235"></span><span>            </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681323187"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681323187"><span class="hs-identifier hs-var">ty_var</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681323187"><span class="hs-identifier hs-var">ty_var</span></a></span><span>
</span><span id="line-236"></span><span>            </span><span class="annot"><span class="annottext">Maybe Id
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. SDoc -&gt; IfL a
</span><a href="GHC.Tc.Utils.Monad.html#failIfM"><span class="hs-identifier hs-var">failIfM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Iface id out of scope: &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681323192"><span class="hs-identifier hs-var">occ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span id="local-6989586621681323369"><span class="annot"><a href="GHC.Iface.Env.html#extendIfaceIdEnv"><span class="hs-identifier hs-type">extendIfaceIdEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#IfL"><span class="hs-identifier hs-type">IfL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323369"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#IfL"><span class="hs-identifier hs-type">IfL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323369"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-240"></span><span id="extendIfaceIdEnv"><span class="annot"><span class="annottext">extendIfaceIdEnv :: forall a. [Id] -&gt; IfL a -&gt; IfL a
</span><a href="GHC.Iface.Env.html#extendIfaceIdEnv"><span class="hs-identifier hs-var hs-var">extendIfaceIdEnv</span></a></span></span><span> </span><span id="local-6989586621681323182"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681323182"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span id="local-6989586621681323181"><span class="annot"><span class="annottext">IfL a
</span><a href="#local-6989586621681323181"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681323180"><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323180"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. TcRnIf gbl lcl lcl
</span><a href="GHC.Tc.Utils.Monad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a></span><span>
</span><span id="line-242"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681323179"><span class="annot"><span class="annottext">id_env' :: FastStringEnv Id
</span><a href="#local-6989586621681323179"><span class="hs-identifier hs-var hs-var">id_env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. FastStringEnv a -&gt; [(FastString, a)] -&gt; FastStringEnv a
</span><a href="GHC.Data.FastString.Env.html#extendFsEnvList"><span class="hs-identifier hs-var">extendFsEnvList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IfLclEnv -&gt; FastStringEnv Id
</span><a href="GHC.Tc.Types.html#if_id_env"><span class="hs-identifier hs-var">if_id_env</span></a></span><span> </span><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323180"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(FastString, Id)]
</span><a href="#local-6989586621681323177"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-243"></span><span>              </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681323177"><span class="annot"><span class="annottext">pairs :: [(FastString, Id)]
</span><a href="#local-6989586621681323177"><span class="hs-identifier hs-var hs-var">pairs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">OccName -&gt; FastString
</span><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. NamedThing a =&gt; a -&gt; OccName
</span><a href="GHC.Types.Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681323174"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681323174"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681323174"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681323174"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681323182"><span class="hs-identifier hs-var">ids</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-244"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall lcl' gbl a lcl.
lcl' -&gt; TcRnIf gbl lcl' a -&gt; TcRnIf gbl lcl a
</span><a href="GHC.Tc.Utils.Monad.html#setLclEnv"><span class="hs-identifier hs-var">setLclEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323180"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">if_id_env :: FastStringEnv Id
</span><a href="GHC.Tc.Types.html#if_id_env"><span class="hs-identifier hs-var">if_id_env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastStringEnv Id
</span><a href="#local-6989586621681323179"><span class="hs-identifier hs-var">id_env'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IfL a
</span><a href="#local-6989586621681323181"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="annot"><a href="GHC.Iface.Env.html#tcIfaceTyVar"><span class="hs-identifier hs-type">tcIfaceTyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#IfL"><span class="hs-identifier hs-type">IfL</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span>
</span><span id="line-248"></span><span id="tcIfaceTyVar"><span class="annot"><span class="annottext">tcIfaceTyVar :: FastString -&gt; IfL Id
</span><a href="GHC.Iface.Env.html#tcIfaceTyVar"><span class="hs-identifier hs-var hs-var">tcIfaceTyVar</span></a></span></span><span> </span><span id="local-6989586621681323171"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681323171"><span class="hs-identifier hs-var">occ</span></a></span></span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681323170"><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323170"><span class="hs-identifier hs-var">lcl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. TcRnIf gbl lcl lcl
</span><a href="GHC.Tc.Utils.Monad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a></span><span>
</span><span id="line-250"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. FastStringEnv a -&gt; FastString -&gt; Maybe a
</span><a href="GHC.Data.FastString.Env.html#lookupFsEnv"><span class="hs-identifier hs-var">lookupFsEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IfLclEnv -&gt; FastStringEnv Id
</span><a href="GHC.Tc.Types.html#if_tv_env"><span class="hs-identifier hs-var">if_tv_env</span></a></span><span> </span><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323170"><span class="hs-identifier hs-var">lcl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681323171"><span class="hs-identifier hs-var">occ</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-251"></span><span>            </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681323168"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681323168"><span class="hs-identifier hs-var">ty_var</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681323168"><span class="hs-identifier hs-var">ty_var</span></a></span><span>
</span><span id="line-252"></span><span>            </span><span class="annot"><span class="annottext">Maybe Id
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. SDoc -&gt; IfL a
</span><a href="GHC.Tc.Utils.Monad.html#failIfM"><span class="hs-identifier hs-var">failIfM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Iface type variable out of scope: &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681323171"><span class="hs-identifier hs-var">occ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="annot"><a href="GHC.Iface.Env.html#lookupIfaceTyVar"><span class="hs-identifier hs-type">lookupIfaceTyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Iface.Type.html#IfaceTvBndr"><span class="hs-identifier hs-type">IfaceTvBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#IfL"><span class="hs-identifier hs-type">IfL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span id="lookupIfaceTyVar"><span class="annot"><span class="annottext">lookupIfaceTyVar :: IfaceTvBndr -&gt; IfL (Maybe Id)
</span><a href="GHC.Iface.Env.html#lookupIfaceTyVar"><span class="hs-identifier hs-var hs-var">lookupIfaceTyVar</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681323167"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681323167"><span class="hs-identifier hs-var">occ</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IfaceKind
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681323166"><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323166"><span class="hs-identifier hs-var">lcl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. TcRnIf gbl lcl lcl
</span><a href="GHC.Tc.Utils.Monad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a></span><span>
</span><span id="line-258"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. FastStringEnv a -&gt; FastString -&gt; Maybe a
</span><a href="GHC.Data.FastString.Env.html#lookupFsEnv"><span class="hs-identifier hs-var">lookupFsEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IfLclEnv -&gt; FastStringEnv Id
</span><a href="GHC.Tc.Types.html#if_tv_env"><span class="hs-identifier hs-var">if_tv_env</span></a></span><span> </span><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323166"><span class="hs-identifier hs-var">lcl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681323167"><span class="hs-identifier hs-var">occ</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="annot"><a href="GHC.Iface.Env.html#lookupIfaceVar"><span class="hs-identifier hs-type">lookupIfaceVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Iface.Type.html#IfaceBndr"><span class="hs-identifier hs-type">IfaceBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#IfL"><span class="hs-identifier hs-type">IfL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span id="lookupIfaceVar"><span class="annot"><span class="annottext">lookupIfaceVar :: IfaceBndr -&gt; IfL (Maybe Id)
</span><a href="GHC.Iface.Env.html#lookupIfaceVar"><span class="hs-identifier hs-var hs-var">lookupIfaceVar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Iface.Type.html#IfaceIdBndr"><span class="hs-identifier hs-type">IfaceIdBndr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IfaceKind
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681323163"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681323163"><span class="hs-identifier hs-var">occ</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IfaceKind
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681323162"><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323162"><span class="hs-identifier hs-var">lcl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. TcRnIf gbl lcl lcl
</span><a href="GHC.Tc.Utils.Monad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a></span><span>
</span><span id="line-263"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. FastStringEnv a -&gt; FastString -&gt; Maybe a
</span><a href="GHC.Data.FastString.Env.html#lookupFsEnv"><span class="hs-identifier hs-var">lookupFsEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IfLclEnv -&gt; FastStringEnv Id
</span><a href="GHC.Tc.Types.html#if_id_env"><span class="hs-identifier hs-var">if_id_env</span></a></span><span> </span><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323162"><span class="hs-identifier hs-var">lcl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681323163"><span class="hs-identifier hs-var">occ</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-264"></span><span class="annot"><a href="GHC.Iface.Env.html#lookupIfaceVar"><span class="hs-identifier hs-var">lookupIfaceVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Iface.Type.html#IfaceTvBndr"><span class="hs-identifier hs-type">IfaceTvBndr</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681323160"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681323160"><span class="hs-identifier hs-var">occ</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IfaceKind
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681323159"><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323159"><span class="hs-identifier hs-var">lcl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. TcRnIf gbl lcl lcl
</span><a href="GHC.Tc.Utils.Monad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a></span><span>
</span><span id="line-266"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. FastStringEnv a -&gt; FastString -&gt; Maybe a
</span><a href="GHC.Data.FastString.Env.html#lookupFsEnv"><span class="hs-identifier hs-var">lookupFsEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IfLclEnv -&gt; FastStringEnv Id
</span><a href="GHC.Tc.Types.html#if_tv_env"><span class="hs-identifier hs-var">if_tv_env</span></a></span><span> </span><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323159"><span class="hs-identifier hs-var">lcl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681323160"><span class="hs-identifier hs-var">occ</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span id="local-6989586621681323158"><span class="annot"><a href="GHC.Iface.Env.html#extendIfaceTyVarEnv"><span class="hs-identifier hs-type">extendIfaceTyVarEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#IfL"><span class="hs-identifier hs-type">IfL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323158"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#IfL"><span class="hs-identifier hs-type">IfL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323158"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-269"></span><span id="extendIfaceTyVarEnv"><span class="annot"><span class="annottext">extendIfaceTyVarEnv :: forall a. [Id] -&gt; IfL a -&gt; IfL a
</span><a href="GHC.Iface.Env.html#extendIfaceTyVarEnv"><span class="hs-identifier hs-var hs-var">extendIfaceTyVarEnv</span></a></span></span><span> </span><span id="local-6989586621681323155"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681323155"><span class="hs-identifier hs-var">tyvars</span></a></span></span><span> </span><span id="local-6989586621681323154"><span class="annot"><span class="annottext">IfL a
</span><a href="#local-6989586621681323154"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681323153"><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323153"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. TcRnIf gbl lcl lcl
</span><a href="GHC.Tc.Utils.Monad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a></span><span>
</span><span id="line-271"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681323152"><span class="annot"><span class="annottext">tv_env' :: FastStringEnv Id
</span><a href="#local-6989586621681323152"><span class="hs-identifier hs-var hs-var">tv_env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. FastStringEnv a -&gt; [(FastString, a)] -&gt; FastStringEnv a
</span><a href="GHC.Data.FastString.Env.html#extendFsEnvList"><span class="hs-identifier hs-var">extendFsEnvList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IfLclEnv -&gt; FastStringEnv Id
</span><a href="GHC.Tc.Types.html#if_tv_env"><span class="hs-identifier hs-var">if_tv_env</span></a></span><span> </span><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323153"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(FastString, Id)]
</span><a href="#local-6989586621681323151"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-272"></span><span>              </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681323151"><span class="annot"><span class="annottext">pairs :: [(FastString, Id)]
</span><a href="#local-6989586621681323151"><span class="hs-identifier hs-var hs-var">pairs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">OccName -&gt; FastString
</span><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. NamedThing a =&gt; a -&gt; OccName
</span><a href="GHC.Types.Name.html#getOccName"><span class="hs-identifier hs-var">getOccName</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681323150"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681323150"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681323150"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681323150"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681323155"><span class="hs-identifier hs-var">tyvars</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-273"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall lcl' gbl a lcl.
lcl' -&gt; TcRnIf gbl lcl' a -&gt; TcRnIf gbl lcl a
</span><a href="GHC.Tc.Utils.Monad.html#setLclEnv"><span class="hs-identifier hs-var">setLclEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323153"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">if_tv_env :: FastStringEnv Id
</span><a href="GHC.Tc.Types.html#if_tv_env"><span class="hs-identifier hs-var">if_tv_env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastStringEnv Id
</span><a href="#local-6989586621681323152"><span class="hs-identifier hs-var">tv_env'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IfL a
</span><a href="#local-6989586621681323154"><span class="hs-identifier hs-var">thing_inside</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span id="local-6989586621681323149"><span class="annot"><a href="GHC.Iface.Env.html#extendIfaceEnvs"><span class="hs-identifier hs-type">extendIfaceEnvs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#IfL"><span class="hs-identifier hs-type">IfL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323149"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#IfL"><span class="hs-identifier hs-type">IfL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681323149"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-276"></span><span id="extendIfaceEnvs"><span class="annot"><span class="annottext">extendIfaceEnvs :: forall a. [Id] -&gt; IfL a -&gt; IfL a
</span><a href="GHC.Iface.Env.html#extendIfaceEnvs"><span class="hs-identifier hs-var hs-var">extendIfaceEnvs</span></a></span></span><span> </span><span id="local-6989586621681323148"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681323148"><span class="hs-identifier hs-var">tcvs</span></a></span></span><span> </span><span id="local-6989586621681323147"><span class="annot"><span class="annottext">IfL a
</span><a href="#local-6989586621681323147"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [Id] -&gt; IfL a -&gt; IfL a
</span><a href="GHC.Iface.Env.html#extendIfaceTyVarEnv"><span class="hs-identifier hs-var">extendIfaceTyVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681323146"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><span class="annottext">forall a. [Id] -&gt; IfL a -&gt; IfL a
</span><a href="GHC.Iface.Env.html#extendIfaceIdEnv"><span class="hs-identifier hs-var">extendIfaceIdEnv</span></a></span><span>    </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681323145"><span class="hs-identifier hs-var">cvs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><span class="annottext">IfL a
</span><a href="#local-6989586621681323147"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681323146"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681323146"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681323145"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681323145"><span class="hs-identifier hs-var">cvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="../../base-4.16.4.0/src/Data-OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621681323148"><span class="hs-identifier hs-var">tcvs</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Getting from RdrNames to Names
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-comment">-- | Look up a top-level name from the current Iface module</span><span>
</span><span id="line-292"></span><span class="annot"><a href="GHC.Iface.Env.html#lookupIfaceTop"><span class="hs-identifier hs-type">lookupIfaceTop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#IfL"><span class="hs-identifier hs-type">IfL</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-293"></span><span id="lookupIfaceTop"><span class="annot"><span class="annottext">lookupIfaceTop :: OccName -&gt; IfL Name
</span><a href="GHC.Iface.Env.html#lookupIfaceTop"><span class="hs-identifier hs-var hs-var">lookupIfaceTop</span></a></span></span><span> </span><span id="local-6989586621681323143"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323143"><span class="hs-identifier hs-var">occ</span></a></span></span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681323142"><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323142"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. TcRnIf gbl lcl lcl
</span><a href="GHC.Tc.Utils.Monad.html#getLclEnv"><span class="hs-identifier hs-var">getLclEnv</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall a b. Module -&gt; OccName -&gt; TcRnIf a b Name
</span><a href="GHC.Iface.Env.html#lookupOrig"><span class="hs-identifier hs-var">lookupOrig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IfLclEnv -&gt; Module
</span><a href="GHC.Tc.Types.html#if_mod"><span class="hs-identifier hs-var">if_mod</span></a></span><span> </span><span class="annot"><span class="annottext">IfLclEnv
</span><a href="#local-6989586621681323142"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323143"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="annot"><a href="GHC.Iface.Env.html#newIfaceName"><span class="hs-identifier hs-type">newIfaceName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#IfL"><span class="hs-identifier hs-type">IfL</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-297"></span><span id="newIfaceName"><span class="annot"><span class="annottext">newIfaceName :: OccName -&gt; IfL Name
</span><a href="GHC.Iface.Env.html#newIfaceName"><span class="hs-identifier hs-var hs-var">newIfaceName</span></a></span></span><span> </span><span id="local-6989586621681323140"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323140"><span class="hs-identifier hs-var">occ</span></a></span></span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681323139"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681323139"><span class="hs-identifier hs-var">uniq</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. TcRnIf gbl lcl Unique
</span><a href="GHC.Tc.Utils.Monad.html#newUnique"><span class="hs-identifier hs-var">newUnique</span></a></span><span>
</span><span id="line-299"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; OccName -&gt; SrcSpan -&gt; Name
</span><a href="GHC.Types.Name.html#mkInternalName"><span class="hs-identifier hs-var">mkInternalName</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681323139"><span class="hs-identifier hs-var">uniq</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323140"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="GHC.Types.SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="annot"><a href="GHC.Iface.Env.html#newIfaceNames"><span class="hs-identifier hs-type">newIfaceNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#IfL"><span class="hs-identifier hs-type">IfL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-302"></span><span id="newIfaceNames"><span class="annot"><span class="annottext">newIfaceNames :: [OccName] -&gt; IfL [Name]
</span><a href="GHC.Iface.Env.html#newIfaceNames"><span class="hs-identifier hs-var hs-var">newIfaceNames</span></a></span></span><span> </span><span id="local-6989586621681323135"><span class="annot"><span class="annottext">[OccName]
</span><a href="#local-6989586621681323135"><span class="hs-identifier hs-var">occs</span></a></span></span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681323134"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681323134"><span class="hs-identifier hs-var">uniqs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. TcRnIf gbl lcl UniqSupply
</span><a href="GHC.Tc.Utils.Monad.html#newUniqueSupply"><span class="hs-identifier hs-var">newUniqueSupply</span></a></span><span>
</span><span id="line-304"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; OccName -&gt; SrcSpan -&gt; Name
</span><a href="GHC.Types.Name.html#mkInternalName"><span class="hs-identifier hs-var">mkInternalName</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681323132"><span class="hs-identifier hs-var">uniq</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323131"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="GHC.Types.SrcLoc.html#noSrcSpan"><span class="hs-identifier hs-var">noSrcSpan</span></a></span><span>
</span><span id="line-305"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681323131"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681323131"><span class="hs-identifier hs-var">occ</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681323132"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681323132"><span class="hs-identifier hs-var">uniq</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[OccName]
</span><a href="#local-6989586621681323135"><span class="hs-identifier hs-var">occs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../base-4.16.4.0/src/GHC-List.html#zip"><span class="hs-operator hs-var">`zip`</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; [Unique]
</span><a href="GHC.Types.Unique.Supply.html#uniqsFromSupply"><span class="hs-identifier hs-var">uniqsFromSupply</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681323134"><span class="hs-identifier hs-var">uniqs</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-comment">{-
Names in a NameCache are always stored as a Global, and have the SrcLoc
of their binding locations.

Actually that's not quite right.  When we first encounter the original
name, we might not be at its binding site (e.g. we are reading an
interface file); so we give it 'noSrcLoc' then.  Later, when we find
its binding site, we fix it up.
-}</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span id="local-6989586621681323400"><span class="annot"><a href="GHC.Iface.Env.html#updNameCache"><span class="hs-identifier hs-type">updNameCache</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-IORef.html#IORef"><span class="hs-identifier hs-type">IORef</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Cache.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a></span><span>
</span><span id="line-318"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Cache.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Cache.html#NameCache"><span class="hs-identifier hs-type">NameCache</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681323400"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- The updating function</span><span>
</span><span id="line-319"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621681323400"><span class="hs-identifier hs-type">c</span></a></span></span><span>
</span><span id="line-320"></span><span id="updNameCache"><span class="annot"><span class="annottext">updNameCache :: forall c. IORef NameCache -&gt; (NameCache -&gt; (NameCache, c)) -&gt; IO c
</span><a href="GHC.Iface.Env.html#updNameCache"><span class="hs-identifier hs-var hs-var">updNameCache</span></a></span></span><span> </span><span id="local-6989586621681323129"><span class="annot"><span class="annottext">IORef NameCache
</span><a href="#local-6989586621681323129"><span class="hs-identifier hs-var">ncRef</span></a></span></span><span> </span><span id="local-6989586621681323128"><span class="annot"><span class="annottext">NameCache -&gt; (NameCache, c)
</span><a href="#local-6989586621681323128"><span class="hs-identifier hs-var">upd_fn</span></a></span></span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. IORef a -&gt; (a -&gt; (a, b)) -&gt; IO b
</span><a href="../../base-4.16.4.0/src/GHC-IORef.html#atomicModifyIORef%27"><span class="hs-identifier hs-var">atomicModifyIORef'</span></a></span><span> </span><span class="annot"><span class="annottext">IORef NameCache
</span><a href="#local-6989586621681323129"><span class="hs-identifier hs-var">ncRef</span></a></span><span> </span><span class="annot"><span class="annottext">NameCache -&gt; (NameCache, c)
</span><a href="#local-6989586621681323128"><span class="hs-identifier hs-var">upd_fn</span></a></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span></pre></body></html>