<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1998
Type and Coercion - friends' interface
-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-record-updates #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-comment">-- | Substitution into types and coercions.</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Core.TyCo.Subst</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-14"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Substitutions</span></span><span>
</span><span id="line-15"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier">TCvSubst</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TvSubstEnv"><span class="hs-identifier">TvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#CvSubstEnv"><span class="hs-identifier">CvSubstEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#emptyTvSubstEnv"><span class="hs-identifier">emptyTvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#emptyCvSubstEnv"><span class="hs-identifier">emptyCvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#composeTCvSubstEnv"><span class="hs-identifier">composeTCvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#composeTCvSubst"><span class="hs-identifier">composeTCvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#emptyTCvSubst"><span class="hs-identifier">emptyTCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkEmptyTCvSubst"><span class="hs-identifier">mkEmptyTCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#isEmptyTCvSubst"><span class="hs-identifier">isEmptyTCvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkTCvSubst"><span class="hs-identifier">mkTCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkTvSubst"><span class="hs-identifier">mkTvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkCvSubst"><span class="hs-identifier">mkCvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#getTvSubstEnv"><span class="hs-identifier">getTvSubstEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#getCvSubstEnv"><span class="hs-identifier">getCvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#getTCvInScope"><span class="hs-identifier">getTCvInScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#getTCvSubstRangeFVs"><span class="hs-identifier">getTCvSubstRangeFVs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#isInScope"><span class="hs-identifier">isInScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#elemTCvSubst"><span class="hs-identifier">elemTCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#notElemTCvSubst"><span class="hs-identifier">notElemTCvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#setTvSubstEnv"><span class="hs-identifier">setTvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#setCvSubstEnv"><span class="hs-identifier">setCvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zapTCvSubst"><span class="hs-identifier">zapTCvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvInScope"><span class="hs-identifier">extendTCvInScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvInScopeList"><span class="hs-identifier">extendTCvInScopeList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvInScopeSet"><span class="hs-identifier">extendTCvInScopeSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier">extendTCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvSubstWithClone"><span class="hs-identifier">extendTCvSubstWithClone</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendCvSubst"><span class="hs-identifier">extendCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendCvSubstWithClone"><span class="hs-identifier">extendCvSubstWithClone</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubst"><span class="hs-identifier">extendTvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstBinderAndInScope"><span class="hs-identifier">extendTvSubstBinderAndInScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstWithClone"><span class="hs-identifier">extendTvSubstWithClone</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstList"><span class="hs-identifier">extendTvSubstList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstAndInScope"><span class="hs-identifier">extendTvSubstAndInScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvSubstList"><span class="hs-identifier">extendTCvSubstList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#unionTCvSubst"><span class="hs-identifier">unionTCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipTyEnv"><span class="hs-identifier">zipTyEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipCoEnv"><span class="hs-identifier">zipCoEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipTvSubst"><span class="hs-identifier">zipTvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipCvSubst"><span class="hs-identifier">zipCvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipTCvSubst"><span class="hs-identifier">zipTCvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkTvSubstPrs"><span class="hs-identifier">mkTvSubstPrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWith"><span class="hs-identifier">substTyWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWithCoVars"><span class="hs-identifier">substTyWithCoVars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTysWith"><span class="hs-identifier">substTysWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTysWithCoVars"><span class="hs-identifier">substTysWithCoVars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoWith"><span class="hs-identifier">substCoWith</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier">substTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyAddInScope"><span class="hs-identifier">substTyAddInScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTy"><span class="hs-identifier">substScaledTy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyUnchecked"><span class="hs-identifier">substTyUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTysUnchecked"><span class="hs-identifier">substTysUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTysUnchecked"><span class="hs-identifier">substScaledTysUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substThetaUnchecked"><span class="hs-identifier">substThetaUnchecked</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWithUnchecked"><span class="hs-identifier">substTyWithUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTyUnchecked"><span class="hs-identifier">substScaledTyUnchecked</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoUnchecked"><span class="hs-identifier">substCoUnchecked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoWithUnchecked"><span class="hs-identifier">substCoWithUnchecked</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWithInScope"><span class="hs-identifier">substTyWithInScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTys"><span class="hs-identifier">substTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTys"><span class="hs-identifier">substScaledTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTheta"><span class="hs-identifier">substTheta</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#lookupTyVar"><span class="hs-identifier">lookupTyVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCo"><span class="hs-identifier">substCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCos"><span class="hs-identifier">substCos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoVar"><span class="hs-identifier">substCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoVars"><span class="hs-identifier">substCoVars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#lookupCoVar"><span class="hs-identifier">lookupCoVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#cloneTyVarBndr"><span class="hs-identifier">cloneTyVarBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#cloneTyVarBndrs"><span class="hs-identifier">cloneTyVarBndrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substVarBndr"><span class="hs-identifier">substVarBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substVarBndrs"><span class="hs-identifier">substVarBndrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVarBndr"><span class="hs-identifier">substTyVarBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVarBndrs"><span class="hs-identifier">substTyVarBndrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoVarBndr"><span class="hs-identifier">substCoVarBndr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVar"><span class="hs-identifier">substTyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVars"><span class="hs-identifier">substTyVars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyCoVars"><span class="hs-identifier">substTyCoVars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyCoBndr"><span class="hs-identifier">substTyCoBndr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substForAllCoBndr"><span class="hs-identifier">substForAllCoBndr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substVarBndrUsing"><span class="hs-identifier">substVarBndrUsing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substForAllCoBndrUsing"><span class="hs-identifier">substForAllCoBndrUsing</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#checkValidSubst"><span class="hs-identifier">checkValidSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#isValidTCvSubst"><span class="hs-identifier">isValidTCvSubst</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#include &quot;HsVersions.h&quot;
</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-60"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier">mkCastTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier">mkAppTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#isCoercionTy"><span class="hs-identifier">isCoercionTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier">mkTyConApp</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html"><span class="hs-identifier">GHC.Core.Coercion</span></a></span><span>
</span><span id="line-62"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkCoVarCo"><span class="hs-identifier">mkCoVarCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkKindCo"><span class="hs-identifier">mkKindCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkNthCo"><span class="hs-identifier">mkNthCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkTransCo"><span class="hs-identifier">mkTransCo</span></a></span><span>
</span><span id="line-63"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkNomReflCo"><span class="hs-identifier">mkNomReflCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkSubCo"><span class="hs-identifier">mkSubCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkSymCo"><span class="hs-identifier">mkSymCo</span></a></span><span>
</span><span id="line-64"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkFunCo"><span class="hs-identifier">mkFunCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkForAllCo"><span class="hs-identifier">mkForAllCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkUnivCo"><span class="hs-identifier">mkUnivCo</span></a></span><span>
</span><span id="line-65"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkAxiomInstCo"><span class="hs-identifier">mkAxiomInstCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkAppCo"><span class="hs-identifier">mkAppCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkGReflCo"><span class="hs-identifier">mkGReflCo</span></a></span><span>
</span><span id="line-66"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkInstCo"><span class="hs-identifier">mkInstCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkLRCo"><span class="hs-identifier">mkLRCo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkTyConAppCo"><span class="hs-identifier">mkTyConAppCo</span></a></span><span>
</span><span id="line-67"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#mkCoercionType"><span class="hs-identifier">mkCoercionType</span></a></span><span>
</span><span id="line-68"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier">coercionKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coercionLKind"><span class="hs-identifier">coercionLKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Coercion.html#coVarKindsTypesRole"><span class="hs-identifier">coVarKindsTypesRole</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html"><span class="hs-identifier">GHC.Core.TyCo.Ppr</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html#pprTyVar"><span class="hs-identifier">pprTyVar</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html"><span class="hs-identifier">GHC.Core.TyCo.Rep</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.FVs.html"><span class="hs-identifier">GHC.Core.TyCo.FVs</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.html"><span class="hs-identifier">GHC.Types.Var</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html"><span class="hs-identifier">GHC.Types.Var.Set</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html"><span class="hs-identifier">GHC.Types.Var.Env</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Pair.html"><span class="hs-identifier">GHC.Data.Pair</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html"><span class="hs-identifier">GHC.Types.Unique.Supply</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html"><span class="hs-identifier">GHC.Types.Unique</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.FM.html"><span class="hs-identifier">GHC.Types.Unique.FM</span></a></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Set.html"><span class="hs-identifier">GHC.Types.Unique.Set</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-List.html#"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.4.0/src/Data-Traversable.html#mapAccumL"><span class="hs-identifier">mapAccumL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
                        Substitutions
      Data type defined here to avoid unnecessary mutual recursion
%*                                                                      *
%************************************************************************
-}</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | Type &amp; coercion substitution</span><span>
</span><span id="line-99"></span><span class="hs-comment">--</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- #tcvsubst_invariant#</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- The following invariants must hold of a 'TCvSubst':</span><span>
</span><span id="line-102"></span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- 1. The in-scope set is needed /only/ to</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- guide the generation of fresh uniques</span><span>
</span><span id="line-105"></span><span class="hs-comment">--</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- 2. In particular, the /kind/ of the type variables in</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- the in-scope set is not relevant</span><span>
</span><span id="line-108"></span><span class="hs-comment">--</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- 3. The substitution is only applied ONCE! This is because</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- in general such application will not reach a fixed point.</span><span>
</span><span id="line-111"></span><span class="hs-keyword">data</span><span> </span><span id="TCvSubst"><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TCvSubst"><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#InScopeSet"><span class="hs-identifier hs-type">InScopeSet</span></a></span><span> </span><span class="hs-comment">-- The in-scope type and kind variables</span><span>
</span><span id="line-113"></span><span>             </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TvSubstEnv"><span class="hs-identifier hs-type">TvSubstEnv</span></a></span><span> </span><span class="hs-comment">-- Substitutes both type and kind variables</span><span>
</span><span id="line-114"></span><span>             </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#CvSubstEnv"><span class="hs-identifier hs-type">CvSubstEnv</span></a></span><span> </span><span class="hs-comment">-- Substitutes coercion variables</span><span>
</span><span id="line-115"></span><span>        </span><span class="hs-comment">-- See Note [Substitutions apply only once]</span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-comment">-- and Note [Extending the TvSubstEnv]</span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-comment">-- and Note [Substituting types and coercions]</span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-comment">-- and Note [The substitution invariant]</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- | A substitution of 'Type's for 'TyVar's</span><span>
</span><span id="line-121"></span><span class="hs-comment">--                 and 'Kind's for 'KindVar's</span><span>
</span><span id="line-122"></span><span class="hs-keyword">type</span><span> </span><span id="TvSubstEnv"><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TvSubstEnv"><span class="hs-identifier hs-var">TvSubstEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#TyVarEnv"><span class="hs-identifier hs-type">TyVarEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-comment">-- NB: A TvSubstEnv is used</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-comment">--   both inside a TCvSubst (with the apply-once invariant</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-comment">--        discussed in Note [Substitutions apply only once],</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-comment">--   and  also independently in the middle of matching,</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-comment">--        and unification (see Types.Unify).</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-comment">-- So you have to look at the context to know if it's idempotent or</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-comment">-- apply-once or whatever</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">-- | A substitution of 'Coercion's for 'CoVar's</span><span>
</span><span id="line-132"></span><span class="hs-keyword">type</span><span> </span><span id="CvSubstEnv"><span class="annot"><a href="GHC.Core.TyCo.Subst.html#CvSubstEnv"><span class="hs-identifier hs-var">CvSubstEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#CoVarEnv"><span class="hs-identifier hs-type">CoVarEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">{- Note [The substitution invariant]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When calling (substTy subst ty) it should be the case that
the in-scope set in the substitution is a superset of both:

  (SIa) The free vars of the range of the substitution
  (SIb) The free vars of ty minus the domain of the substitution

The same rules apply to other substitutions (notably GHC.Core.Subst.Subst)

* Reason for (SIa). Consider
      substTy [a :-&gt; Maybe b] (forall b. b-&gt;a)
  we must rename the forall b, to get
      forall b2. b2 -&gt; Maybe b
  Making 'b' part of the in-scope set forces this renaming to
  take place.

* Reason for (SIb). Consider
     substTy [a :-&gt; Maybe b] (forall b. (a,b,x))
  Then if we use the in-scope set {b}, satisfying (SIa), there is
  a danger we will rename the forall'd variable to 'x' by mistake,
  getting this:
      forall x. (Maybe b, x, x)
  Breaking (SIb) caused the bug from #11371.

Note: if the free vars of the range of the substitution are freshly created,
then the problems of (SIa) can't happen, and so it would be sound to
ignore (SIa).

Note [Substitutions apply only once]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We use TCvSubsts to instantiate things, and we might instantiate
        forall a b. ty
with the types
        [a, b], or [b, a].
So the substitution might go [a-&gt;b, b-&gt;a].  A similar situation arises in Core
when we find a beta redex like
        (/\ a /\ b -&gt; e) b a
Then we also end up with a substitution that permutes type variables. Other
variations happen to; for example [a -&gt; (a, b)].

        ********************************************************
        *** So a substitution must be applied precisely once ***
        ********************************************************

A TCvSubst is not idempotent, but, unlike the non-idempotent substitution
we use during unifications, it must not be repeatedly applied.

Note [Extending the TvSubstEnv]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
See #tcvsubst_invariant# for the invariants that must hold.

This invariant allows a short-cut when the subst envs are empty:
if the TvSubstEnv and CvSubstEnv are empty --- i.e. (isEmptyTCvSubst subst)
holds --- then (substTy subst ty) does nothing.

For example, consider:
        (/\a. /\b:(a~Int). ...b..) Int
We substitute Int for 'a'.  The Unique of 'b' does not change, but
nevertheless we add 'b' to the TvSubstEnv, because b's kind does change

This invariant has several crucial consequences:

* In substVarBndr, we need extend the TvSubstEnv
        - if the unique has changed
        - or if the kind has changed

* In substTyVar, we do not need to consult the in-scope set;
  the TvSubstEnv is enough

* In substTy, substTheta, we can short-circuit when the TvSubstEnv is empty

Note [Substituting types and coercions]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Types and coercions are mutually recursive, and either may have variables
&quot;belonging&quot; to the other. Thus, every time we wish to substitute in a
type, we may also need to substitute in a coercion, and vice versa.
However, the constructor used to create type variables is distinct from
that of coercion variables, so we carry two VarEnvs in a TCvSubst. Note
that it would be possible to use the CoercionTy constructor to combine
these environments, but that seems like a false economy.

Note that the TvSubstEnv should *never* map a CoVar (built with the Id
constructor) and the CvSubstEnv should *never* map a TyVar. Furthermore,
the range of the TvSubstEnv should *never* include a type headed with
CoercionTy.
-}</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#emptyTvSubstEnv"><span class="hs-identifier hs-type">emptyTvSubstEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TvSubstEnv"><span class="hs-identifier hs-type">TvSubstEnv</span></a></span><span>
</span><span id="line-223"></span><span id="emptyTvSubstEnv"><span class="annot"><span class="annottext">emptyTvSubstEnv :: TvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#emptyTvSubstEnv"><span class="hs-identifier hs-var hs-var">emptyTvSubstEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a
</span><a href="GHC.Types.Var.Env.html#emptyVarEnv"><span class="hs-identifier hs-var">emptyVarEnv</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#emptyCvSubstEnv"><span class="hs-identifier hs-type">emptyCvSubstEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#CvSubstEnv"><span class="hs-identifier hs-type">CvSubstEnv</span></a></span><span>
</span><span id="line-226"></span><span id="emptyCvSubstEnv"><span class="annot"><span class="annottext">emptyCvSubstEnv :: CvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#emptyCvSubstEnv"><span class="hs-identifier hs-var hs-var">emptyCvSubstEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a
</span><a href="GHC.Types.Var.Env.html#emptyVarEnv"><span class="hs-identifier hs-var">emptyVarEnv</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#composeTCvSubstEnv"><span class="hs-identifier hs-type">composeTCvSubstEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#InScopeSet"><span class="hs-identifier hs-type">InScopeSet</span></a></span><span>
</span><span id="line-229"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TvSubstEnv"><span class="hs-identifier hs-type">TvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#CvSubstEnv"><span class="hs-identifier hs-type">CvSubstEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TvSubstEnv"><span class="hs-identifier hs-type">TvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#CvSubstEnv"><span class="hs-identifier hs-type">CvSubstEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TvSubstEnv"><span class="hs-identifier hs-type">TvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#CvSubstEnv"><span class="hs-identifier hs-type">CvSubstEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- ^ @(compose env1 env2)(x)@ is @env1(env2(x))@; i.e. apply @env2@ then @env1@.</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- It assumes that both are idempotent.</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- Typically, @env1@ is the refinement to a base substitution @env2@</span><span>
</span><span id="line-235"></span><span id="composeTCvSubstEnv"><span class="annot"><span class="annottext">composeTCvSubstEnv :: InScopeSet
-&gt; (TvSubstEnv, CvSubstEnv)
-&gt; (TvSubstEnv, CvSubstEnv)
-&gt; (TvSubstEnv, CvSubstEnv)
</span><a href="GHC.Core.TyCo.Subst.html#composeTCvSubstEnv"><span class="hs-identifier hs-var hs-var">composeTCvSubstEnv</span></a></span></span><span> </span><span id="local-6989586621681025351"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025351"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681025350"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025350"><span class="hs-identifier hs-var">tenv1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681025349"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025349"><span class="hs-identifier hs-var">cenv1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681025348"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025348"><span class="hs-identifier hs-var">tenv2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681025347"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025347"><span class="hs-identifier hs-var">cenv2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025350"><span class="hs-identifier hs-var">tenv1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; VarEnv a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#plusVarEnv"><span class="hs-operator hs-var">`plusVarEnv`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; VarEnv a -&gt; VarEnv b
</span><a href="GHC.Types.Var.Env.html#mapVarEnv"><span class="hs-identifier hs-var">mapVarEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025344"><span class="hs-identifier hs-var">subst1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025348"><span class="hs-identifier hs-var">tenv2</span></a></span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025349"><span class="hs-identifier hs-var">cenv1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; VarEnv a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#plusVarEnv"><span class="hs-operator hs-var">`plusVarEnv`</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; VarEnv a -&gt; VarEnv b
</span><a href="GHC.Types.Var.Env.html#mapVarEnv"><span class="hs-identifier hs-var">mapVarEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#substCo"><span class="hs-identifier hs-var">substCo</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025344"><span class="hs-identifier hs-var">subst1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025347"><span class="hs-identifier hs-var">cenv2</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>        </span><span class="hs-comment">-- First apply env1 to the range of env2</span><span>
</span><span id="line-239"></span><span>        </span><span class="hs-comment">-- Then combine the two, making sure that env1 loses if</span><span>
</span><span id="line-240"></span><span>        </span><span class="hs-comment">-- both bind the same variable; that's why env1 is the</span><span>
</span><span id="line-241"></span><span>        </span><span class="hs-comment">--  *left* argument to plusVarEnv, because the right arg wins</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621681025344"><span class="annot"><span class="annottext">subst1 :: TCvSubst
</span><a href="#local-6989586621681025344"><span class="hs-identifier hs-var hs-var">subst1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025351"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025350"><span class="hs-identifier hs-var">tenv1</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025349"><span class="hs-identifier hs-var">cenv1</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">-- | Composes two substitutions, applying the second one provided first,</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- like in function composition.</span><span>
</span><span id="line-247"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#composeTCvSubst"><span class="hs-identifier hs-type">composeTCvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-248"></span><span id="composeTCvSubst"><span class="annot"><span class="annottext">composeTCvSubst :: TCvSubst -&gt; TCvSubst -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#composeTCvSubst"><span class="hs-identifier hs-var hs-var">composeTCvSubst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025343"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025343"><span class="hs-identifier hs-var">is1</span></a></span></span><span> </span><span id="local-6989586621681025342"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025342"><span class="hs-identifier hs-var">tenv1</span></a></span></span><span> </span><span id="local-6989586621681025341"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025341"><span class="hs-identifier hs-var">cenv1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025340"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025340"><span class="hs-identifier hs-var">is2</span></a></span></span><span> </span><span id="local-6989586621681025339"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025339"><span class="hs-identifier hs-var">tenv2</span></a></span></span><span> </span><span id="local-6989586621681025338"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025338"><span class="hs-identifier hs-var">cenv2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025337"><span class="hs-identifier hs-var">is3</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025336"><span class="hs-identifier hs-var">tenv3</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025335"><span class="hs-identifier hs-var">cenv3</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-251"></span><span>    </span><span id="local-6989586621681025337"><span class="annot"><span class="annottext">is3 :: InScopeSet
</span><a href="#local-6989586621681025337"><span class="hs-identifier hs-var hs-var">is3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025343"><span class="hs-identifier hs-var">is1</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; InScopeSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#unionInScope"><span class="hs-operator hs-var">`unionInScope`</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025340"><span class="hs-identifier hs-var">is2</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681025336"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025336"><span class="hs-identifier hs-var">tenv3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681025335"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025335"><span class="hs-identifier hs-var">cenv3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet
-&gt; (TvSubstEnv, CvSubstEnv)
-&gt; (TvSubstEnv, CvSubstEnv)
-&gt; (TvSubstEnv, CvSubstEnv)
</span><a href="GHC.Core.TyCo.Subst.html#composeTCvSubstEnv"><span class="hs-identifier hs-var">composeTCvSubstEnv</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025337"><span class="hs-identifier hs-var">is3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025342"><span class="hs-identifier hs-var">tenv1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025341"><span class="hs-identifier hs-var">cenv1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025339"><span class="hs-identifier hs-var">tenv2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025338"><span class="hs-identifier hs-var">cenv2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#emptyTCvSubst"><span class="hs-identifier hs-type">emptyTCvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-255"></span><span id="emptyTCvSubst"><span class="annot"><span class="annottext">emptyTCvSubst :: TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#emptyTCvSubst"><span class="hs-identifier hs-var hs-var">emptyTCvSubst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="GHC.Types.Var.Env.html#emptyInScopeSet"><span class="hs-identifier hs-var">emptyInScopeSet</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#emptyTvSubstEnv"><span class="hs-identifier hs-var">emptyTvSubstEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#emptyCvSubstEnv"><span class="hs-identifier hs-var">emptyCvSubstEnv</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkEmptyTCvSubst"><span class="hs-identifier hs-type">mkEmptyTCvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#InScopeSet"><span class="hs-identifier hs-type">InScopeSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-258"></span><span id="mkEmptyTCvSubst"><span class="annot"><span class="annottext">mkEmptyTCvSubst :: InScopeSet -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#mkEmptyTCvSubst"><span class="hs-identifier hs-var hs-var">mkEmptyTCvSubst</span></a></span></span><span> </span><span id="local-6989586621681025332"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025332"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025332"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#emptyTvSubstEnv"><span class="hs-identifier hs-var">emptyTvSubstEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#emptyCvSubstEnv"><span class="hs-identifier hs-var">emptyCvSubstEnv</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#isEmptyTCvSubst"><span class="hs-identifier hs-type">isEmptyTCvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-261"></span><span>         </span><span class="hs-comment">-- See Note [Extending the TvSubstEnv]</span><span>
</span><span id="line-262"></span><span id="isEmptyTCvSubst"><span class="annot"><span class="annottext">isEmptyTCvSubst :: TCvSubst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#isEmptyTCvSubst"><span class="hs-identifier hs-var hs-var">isEmptyTCvSubst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681025331"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025331"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681025330"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025330"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Bool
</span><a href="GHC.Types.Var.Env.html#isEmptyVarEnv"><span class="hs-identifier hs-var">isEmptyVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025331"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Bool
</span><a href="GHC.Types.Var.Env.html#isEmptyVarEnv"><span class="hs-identifier hs-var">isEmptyVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025330"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkTCvSubst"><span class="hs-identifier hs-type">mkTCvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#InScopeSet"><span class="hs-identifier hs-type">InScopeSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TvSubstEnv"><span class="hs-identifier hs-type">TvSubstEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#CvSubstEnv"><span class="hs-identifier hs-type">CvSubstEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-265"></span><span id="mkTCvSubst"><span class="annot"><span class="annottext">mkTCvSubst :: InScopeSet -&gt; (TvSubstEnv, CvSubstEnv) -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#mkTCvSubst"><span class="hs-identifier hs-var hs-var">mkTCvSubst</span></a></span></span><span> </span><span id="local-6989586621681025327"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025327"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681025326"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025326"><span class="hs-identifier hs-var">tenv</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681025325"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025325"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025327"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025326"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025325"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkTvSubst"><span class="hs-identifier hs-type">mkTvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#InScopeSet"><span class="hs-identifier hs-type">InScopeSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TvSubstEnv"><span class="hs-identifier hs-type">TvSubstEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-268"></span><span class="hs-comment">-- ^ Make a TCvSubst with specified tyvar subst and empty covar subst</span><span>
</span><span id="line-269"></span><span id="mkTvSubst"><span class="annot"><span class="annottext">mkTvSubst :: InScopeSet -&gt; TvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#mkTvSubst"><span class="hs-identifier hs-var hs-var">mkTvSubst</span></a></span></span><span> </span><span id="local-6989586621681025324"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025324"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681025323"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025323"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025324"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025323"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#emptyCvSubstEnv"><span class="hs-identifier hs-var">emptyCvSubstEnv</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkCvSubst"><span class="hs-identifier hs-type">mkCvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#InScopeSet"><span class="hs-identifier hs-type">InScopeSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#CvSubstEnv"><span class="hs-identifier hs-type">CvSubstEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- ^ Make a TCvSubst with specified covar subst and empty tyvar subst</span><span>
</span><span id="line-273"></span><span id="mkCvSubst"><span class="annot"><span class="annottext">mkCvSubst :: InScopeSet -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#mkCvSubst"><span class="hs-identifier hs-var hs-var">mkCvSubst</span></a></span></span><span> </span><span id="local-6989586621681025322"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025322"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681025321"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025321"><span class="hs-identifier hs-var">cenv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025322"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#emptyTvSubstEnv"><span class="hs-identifier hs-var">emptyTvSubstEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025321"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#getTvSubstEnv"><span class="hs-identifier hs-type">getTvSubstEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TvSubstEnv"><span class="hs-identifier hs-type">TvSubstEnv</span></a></span><span>
</span><span id="line-276"></span><span id="getTvSubstEnv"><span class="annot"><span class="annottext">getTvSubstEnv :: TCvSubst -&gt; TvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#getTvSubstEnv"><span class="hs-identifier hs-var hs-var">getTvSubstEnv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681025320"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025320"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025320"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#getCvSubstEnv"><span class="hs-identifier hs-type">getCvSubstEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#CvSubstEnv"><span class="hs-identifier hs-type">CvSubstEnv</span></a></span><span>
</span><span id="line-279"></span><span id="getCvSubstEnv"><span class="annot"><span class="annottext">getCvSubstEnv :: TCvSubst -&gt; CvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#getCvSubstEnv"><span class="hs-identifier hs-var hs-var">getCvSubstEnv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681025319"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025319"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025319"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#getTCvInScope"><span class="hs-identifier hs-type">getTCvInScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#InScopeSet"><span class="hs-identifier hs-type">InScopeSet</span></a></span><span>
</span><span id="line-282"></span><span id="getTCvInScope"><span class="annot"><span class="annottext">getTCvInScope :: TCvSubst -&gt; InScopeSet
</span><a href="GHC.Core.TyCo.Subst.html#getTCvInScope"><span class="hs-identifier hs-var hs-var">getTCvInScope</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025318"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025318"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025318"><span class="hs-identifier hs-var">in_scope</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">-- | Returns the free variables of the types in the range of a substitution as</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- a non-deterministic set.</span><span>
</span><span id="line-286"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#getTCvSubstRangeFVs"><span class="hs-identifier hs-type">getTCvSubstRangeFVs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-287"></span><span id="getTCvSubstRangeFVs"><span class="annot"><span class="annottext">getTCvSubstRangeFVs :: TCvSubst -&gt; VarSet
</span><a href="GHC.Core.TyCo.Subst.html#getTCvSubstRangeFVs"><span class="hs-identifier hs-var hs-var">getTCvSubstRangeFVs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681025317"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025317"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681025316"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025316"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#unionVarSet"><span class="hs-identifier hs-var">unionVarSet</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681025314"><span class="hs-identifier hs-var">tenvFVs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681025313"><span class="hs-identifier hs-var">cenvFVs</span></a></span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-290"></span><span>    </span><span id="local-6989586621681025314"><span class="annot"><span class="annottext">tenvFVs :: VarSet
</span><a href="#local-6989586621681025314"><span class="hs-identifier hs-var hs-var">tenvFVs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TvSubstEnv -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfTyVarEnv"><span class="hs-identifier hs-var">shallowTyCoVarsOfTyVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025317"><span class="hs-identifier hs-var">tenv</span></a></span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621681025313"><span class="annot"><span class="annottext">cenvFVs :: VarSet
</span><a href="#local-6989586621681025313"><span class="hs-identifier hs-var hs-var">cenvFVs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CvSubstEnv -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfCoVarEnv"><span class="hs-identifier hs-var">shallowTyCoVarsOfCoVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025316"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#isInScope"><span class="hs-identifier hs-type">isInScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-294"></span><span id="isInScope"><span class="annot"><span class="annottext">isInScope :: Var -&gt; TCvSubst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#isInScope"><span class="hs-identifier hs-var hs-var">isInScope</span></a></span></span><span> </span><span id="local-6989586621681025310"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025310"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025309"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025309"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025310"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; InScopeSet -&gt; Bool
</span><a href="GHC.Types.Var.Env.html#elemInScopeSet"><span class="hs-operator hs-var">`elemInScopeSet`</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025309"><span class="hs-identifier hs-var">in_scope</span></a></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#elemTCvSubst"><span class="hs-identifier hs-type">elemTCvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-297"></span><span id="elemTCvSubst"><span class="annot"><span class="annottext">elemTCvSubst :: Var -&gt; TCvSubst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#elemTCvSubst"><span class="hs-identifier hs-var hs-var">elemTCvSubst</span></a></span></span><span> </span><span id="local-6989586621681025307"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025307"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681025306"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025306"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681025305"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025305"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025307"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025307"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Var -&gt; VarEnv a -&gt; Bool
</span><a href="GHC.Types.Var.Env.html#elemVarEnv"><span class="hs-operator hs-var">`elemVarEnv`</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025306"><span class="hs-identifier hs-var">tenv</span></a></span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025307"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Var -&gt; VarEnv a -&gt; Bool
</span><a href="GHC.Types.Var.Env.html#elemVarEnv"><span class="hs-operator hs-var">`elemVarEnv`</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025305"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#notElemTCvSubst"><span class="hs-identifier hs-type">notElemTCvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-304"></span><span id="notElemTCvSubst"><span class="annot"><span class="annottext">notElemTCvSubst :: Var -&gt; TCvSubst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#notElemTCvSubst"><span class="hs-identifier hs-var hs-var">notElemTCvSubst</span></a></span></span><span> </span><span id="local-6989586621681025302"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025302"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; TCvSubst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#elemTCvSubst"><span class="hs-identifier hs-var">elemTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025302"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#setTvSubstEnv"><span class="hs-identifier hs-type">setTvSubstEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TvSubstEnv"><span class="hs-identifier hs-type">TvSubstEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-307"></span><span id="setTvSubstEnv"><span class="annot"><span class="annottext">setTvSubstEnv :: TCvSubst -&gt; TvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#setTvSubstEnv"><span class="hs-identifier hs-var hs-var">setTvSubstEnv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025299"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025299"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681025298"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025298"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681025297"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025297"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025299"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025297"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025298"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#setCvSubstEnv"><span class="hs-identifier hs-type">setCvSubstEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#CvSubstEnv"><span class="hs-identifier hs-type">CvSubstEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-310"></span><span id="setCvSubstEnv"><span class="annot"><span class="annottext">setCvSubstEnv :: TCvSubst -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#setCvSubstEnv"><span class="hs-identifier hs-var hs-var">setCvSubstEnv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025296"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025296"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681025295"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025295"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681025294"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025294"><span class="hs-identifier hs-var">cenv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025296"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025295"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025294"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zapTCvSubst"><span class="hs-identifier hs-type">zapTCvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-313"></span><span id="zapTCvSubst"><span class="annot"><span class="annottext">zapTCvSubst :: TCvSubst -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#zapTCvSubst"><span class="hs-identifier hs-var hs-var">zapTCvSubst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025293"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025293"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025293"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a
</span><a href="GHC.Types.Var.Env.html#emptyVarEnv"><span class="hs-identifier hs-var">emptyVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a
</span><a href="GHC.Types.Var.Env.html#emptyVarEnv"><span class="hs-identifier hs-var">emptyVarEnv</span></a></span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvInScope"><span class="hs-identifier hs-type">extendTCvInScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-316"></span><span id="extendTCvInScope"><span class="annot"><span class="annottext">extendTCvInScope :: TCvSubst -&gt; Var -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvInScope"><span class="hs-identifier hs-var hs-var">extendTCvInScope</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025292"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025292"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681025291"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025291"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681025290"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025290"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681025289"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025289"><span class="hs-identifier hs-var">var</span></a></span></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet -&gt; Var -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#extendInScopeSet"><span class="hs-identifier hs-var">extendInScopeSet</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025292"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025289"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025291"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025290"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvInScopeList"><span class="hs-identifier hs-type">extendTCvInScopeList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-320"></span><span id="extendTCvInScopeList"><span class="annot"><span class="annottext">extendTCvInScopeList :: TCvSubst -&gt; [Var] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvInScopeList"><span class="hs-identifier hs-var hs-var">extendTCvInScopeList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025287"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025287"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681025286"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025286"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681025285"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025285"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681025284"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025284"><span class="hs-identifier hs-var">vars</span></a></span></span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet -&gt; [Var] -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#extendInScopeSetList"><span class="hs-identifier hs-var">extendInScopeSetList</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025287"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025284"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025286"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025285"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvInScopeSet"><span class="hs-identifier hs-type">extendTCvInScopeSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.Set.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-324"></span><span id="extendTCvInScopeSet"><span class="annot"><span class="annottext">extendTCvInScopeSet :: TCvSubst -&gt; VarSet -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvInScopeSet"><span class="hs-identifier hs-var hs-var">extendTCvInScopeSet</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025282"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025282"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681025281"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025281"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681025280"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025280"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681025279"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681025279"><span class="hs-identifier hs-var">vars</span></a></span></span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet -&gt; VarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#extendInScopeSetSet"><span class="hs-identifier hs-var">extendInScopeSetSet</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025282"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681025279"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025281"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025280"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier hs-type">extendTCvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-328"></span><span id="extendTCvSubst"><span class="annot"><span class="annottext">extendTCvSubst :: TCvSubst -&gt; Var -&gt; Type -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier hs-var hs-var">extendTCvSubst</span></a></span></span><span> </span><span id="local-6989586621681025276"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025276"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681025275"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025275"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621681025274"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025274"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025275"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Type -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTvSubst"><span class="hs-identifier hs-var">extendTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025276"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025275"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025274"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621681025272"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681025272"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025274"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Coercion -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendCvSubst"><span class="hs-identifier hs-var">extendCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025276"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025275"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681025272"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;extendTCvSubst&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025275"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;|-&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025274"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvSubstWithClone"><span class="hs-identifier hs-type">extendTCvSubstWithClone</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-337"></span><span id="extendTCvSubstWithClone"><span class="annot"><span class="annottext">extendTCvSubstWithClone :: TCvSubst -&gt; Var -&gt; Var -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvSubstWithClone"><span class="hs-identifier hs-var hs-var">extendTCvSubstWithClone</span></a></span></span><span> </span><span id="local-6989586621681025267"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025267"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681025266"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025266"><span class="hs-identifier hs-var">tcv</span></a></span></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025266"><span class="hs-identifier hs-var">tcv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Var -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTvSubstWithClone"><span class="hs-identifier hs-var">extendTvSubstWithClone</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025267"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025266"><span class="hs-identifier hs-var">tcv</span></a></span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Var -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendCvSubstWithClone"><span class="hs-identifier hs-var">extendCvSubstWithClone</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025267"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025266"><span class="hs-identifier hs-var">tcv</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubst"><span class="hs-identifier hs-type">extendTvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-342"></span><span id="extendTvSubst"><span class="annot"><span class="annottext">extendTvSubst :: TCvSubst -&gt; Var -&gt; Type -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTvSubst"><span class="hs-identifier hs-var hs-var">extendTvSubst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025264"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025264"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681025263"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025263"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681025262"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025262"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681025261"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025261"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621681025260"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025260"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025264"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025263"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025261"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025260"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025262"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstBinderAndInScope"><span class="hs-identifier hs-type">extendTvSubstBinderAndInScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoBinder"><span class="hs-identifier hs-type">TyCoBinder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-346"></span><span id="extendTvSubstBinderAndInScope"><span class="annot"><span class="annottext">extendTvSubstBinderAndInScope :: TCvSubst -&gt; TyCoBinder -&gt; Type -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTvSubstBinderAndInScope"><span class="hs-identifier hs-var hs-var">extendTvSubstBinderAndInScope</span></a></span></span><span> </span><span id="local-6989586621681025258"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025258"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621681025255"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025255"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621681025254"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025254"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Type -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTvSubstAndInScope"><span class="hs-identifier hs-var">extendTvSubstAndInScope</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025258"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025255"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025254"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-349"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstBinderAndInScope"><span class="hs-identifier hs-var">extendTvSubstBinderAndInScope</span></a></span><span> </span><span id="local-6989586621681025251"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025251"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Anon"><span class="hs-identifier hs-type">Anon</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025251"><span class="hs-identifier hs-var">subst</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstWithClone"><span class="hs-identifier hs-type">extendTvSubstWithClone</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-353"></span><span class="hs-comment">-- Adds a new tv -&gt; tv mapping, /and/ extends the in-scope set</span><span>
</span><span id="line-354"></span><span id="extendTvSubstWithClone"><span class="annot"><span class="annottext">extendTvSubstWithClone :: TCvSubst -&gt; Var -&gt; Var -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTvSubstWithClone"><span class="hs-identifier hs-var hs-var">extendTvSubstWithClone</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025249"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025249"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681025248"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025248"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681025247"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025247"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681025246"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025246"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621681025245"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025245"><span class="hs-identifier hs-var">tv'</span></a></span></span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet -&gt; VarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#extendInScopeSetSet"><span class="hs-identifier hs-var">extendInScopeSetSet</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025249"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681025244"><span class="hs-identifier hs-var">new_in_scope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025248"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025246"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025245"><span class="hs-identifier hs-var">tv'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>             </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025247"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-359"></span><span>    </span><span id="local-6989586621681025244"><span class="annot"><span class="annottext">new_in_scope :: VarSet
</span><a href="#local-6989586621681025244"><span class="hs-identifier hs-var hs-var">new_in_scope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025245"><span class="hs-identifier hs-var">tv'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#extendVarSet"><span class="hs-operator hs-var">`extendVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025245"><span class="hs-identifier hs-var">tv'</span></a></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendCvSubst"><span class="hs-identifier hs-type">extendCvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-362"></span><span id="extendCvSubst"><span class="annot"><span class="annottext">extendCvSubst :: TCvSubst -&gt; Var -&gt; Coercion -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendCvSubst"><span class="hs-identifier hs-var hs-var">extendCvSubst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025238"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025238"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681025237"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025237"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681025236"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025236"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681025235"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025235"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621681025234"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681025234"><span class="hs-identifier hs-var">co</span></a></span></span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025238"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025237"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025236"><span class="hs-identifier hs-var">cenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025235"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681025234"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendCvSubstWithClone"><span class="hs-identifier hs-type">extendCvSubstWithClone</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-366"></span><span id="extendCvSubstWithClone"><span class="annot"><span class="annottext">extendCvSubstWithClone :: TCvSubst -&gt; Var -&gt; Var -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendCvSubstWithClone"><span class="hs-identifier hs-var hs-var">extendCvSubstWithClone</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025233"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025233"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681025232"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025232"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681025231"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025231"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681025230"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025230"><span class="hs-identifier hs-var">cv</span></a></span></span><span> </span><span id="local-6989586621681025229"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025229"><span class="hs-identifier hs-var">cv'</span></a></span></span><span>
</span><span id="line-367"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet -&gt; VarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#extendInScopeSetSet"><span class="hs-identifier hs-var">extendInScopeSetSet</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025233"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681025228"><span class="hs-identifier hs-var">new_in_scope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>             </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025232"><span class="hs-identifier hs-var">tenv</span></a></span><span>
</span><span id="line-369"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025231"><span class="hs-identifier hs-var">cenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025230"><span class="hs-identifier hs-var">cv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkCoVarCo"><span class="hs-identifier hs-var">mkCoVarCo</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025229"><span class="hs-identifier hs-var">cv'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-371"></span><span>    </span><span id="local-6989586621681025228"><span class="annot"><span class="annottext">new_in_scope :: VarSet
</span><a href="#local-6989586621681025228"><span class="hs-identifier hs-var hs-var">new_in_scope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#varType"><span class="hs-identifier hs-var">varType</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025229"><span class="hs-identifier hs-var">cv'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Var -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#extendVarSet"><span class="hs-operator hs-var">`extendVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025229"><span class="hs-identifier hs-var">cv'</span></a></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstAndInScope"><span class="hs-identifier hs-type">extendTvSubstAndInScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-374"></span><span class="hs-comment">-- Also extends the in-scope set</span><span>
</span><span id="line-375"></span><span id="extendTvSubstAndInScope"><span class="annot"><span class="annottext">extendTvSubstAndInScope :: TCvSubst -&gt; Var -&gt; Type -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTvSubstAndInScope"><span class="hs-identifier hs-var hs-var">extendTvSubstAndInScope</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025226"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025226"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681025225"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025225"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681025224"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025224"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681025223"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025223"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621681025222"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025222"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025226"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; VarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#extendInScopeSetSet"><span class="hs-operator hs-var">`extendInScopeSetSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025222"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025225"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025223"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025222"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>             </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025224"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTvSubstList"><span class="hs-identifier hs-type">extendTvSubstList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-381"></span><span id="extendTvSubstList"><span class="annot"><span class="annottext">extendTvSubstList :: TCvSubst -&gt; [Var] -&gt; [Type] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTvSubstList"><span class="hs-identifier hs-var hs-var">extendTvSubstList</span></a></span></span><span> </span><span id="local-6989586621681025221"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025221"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681025220"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025220"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621681025219"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025219"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall acc a b. (acc -&gt; a -&gt; b -&gt; acc) -&gt; acc -&gt; [a] -&gt; [b] -&gt; acc
</span><a href="GHC.Utils.Misc.html#foldl2"><span class="hs-identifier hs-var">foldl2</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Type -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTvSubst"><span class="hs-identifier hs-var">extendTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025221"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025220"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025219"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#extendTCvSubstList"><span class="hs-identifier hs-type">extendTCvSubstList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-385"></span><span id="extendTCvSubstList"><span class="annot"><span class="annottext">extendTCvSubstList :: TCvSubst -&gt; [Var] -&gt; [Type] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvSubstList"><span class="hs-identifier hs-var hs-var">extendTCvSubstList</span></a></span></span><span> </span><span id="local-6989586621681025217"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025217"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681025216"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025216"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621681025215"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025215"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall acc a b. (acc -&gt; a -&gt; b -&gt; acc) -&gt; acc -&gt; [a] -&gt; [b] -&gt; acc
</span><a href="GHC.Utils.Misc.html#foldl2"><span class="hs-identifier hs-var">foldl2</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Type -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier hs-var">extendTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025217"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025216"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025215"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#unionTCvSubst"><span class="hs-identifier hs-type">unionTCvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-389"></span><span class="hs-comment">-- Works when the ranges are disjoint</span><span>
</span><span id="line-390"></span><span id="unionTCvSubst"><span class="annot"><span class="annottext">unionTCvSubst :: TCvSubst -&gt; TCvSubst -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#unionTCvSubst"><span class="hs-identifier hs-var hs-var">unionTCvSubst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025214"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025214"><span class="hs-identifier hs-var">in_scope1</span></a></span></span><span> </span><span id="local-6989586621681025213"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025213"><span class="hs-identifier hs-var">tenv1</span></a></span></span><span> </span><span id="local-6989586621681025212"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025212"><span class="hs-identifier hs-var">cenv1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025211"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025211"><span class="hs-identifier hs-var">in_scope2</span></a></span></span><span> </span><span id="local-6989586621681025210"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025210"><span class="hs-identifier hs-var">tenv2</span></a></span></span><span> </span><span id="local-6989586621681025209"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025209"><span class="hs-identifier hs-var">cenv2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">tenv1</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">disjointVarEnv</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tenv2</span><span>
</span><span id="line-392"></span><span>         </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">cenv1</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">disjointVarEnv</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">cenv2</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025214"><span class="hs-identifier hs-var">in_scope1</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; InScopeSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#unionInScope"><span class="hs-operator hs-var">`unionInScope`</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025211"><span class="hs-identifier hs-var">in_scope2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025213"><span class="hs-identifier hs-var">tenv1</span></a></span><span>     </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; VarEnv a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#plusVarEnv"><span class="hs-operator hs-var">`plusVarEnv`</span></a></span><span>   </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025210"><span class="hs-identifier hs-var">tenv2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025212"><span class="hs-identifier hs-var">cenv1</span></a></span><span>     </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; VarEnv a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#plusVarEnv"><span class="hs-operator hs-var">`plusVarEnv`</span></a></span><span>   </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025209"><span class="hs-identifier hs-var">cenv2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-comment">-- mkTvSubstPrs and zipTvSubst generate the in-scope set from</span><span>
</span><span id="line-398"></span><span class="hs-comment">-- the types given; but it's just a thunk so with a bit of luck</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- it'll never be evaluated</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- | Generates the in-scope set for the 'TCvSubst' from the types in the incoming</span><span>
</span><span id="line-402"></span><span class="hs-comment">-- environment. No CoVars, please!</span><span>
</span><span id="line-403"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipTvSubst"><span class="hs-identifier hs-type">zipTvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-404"></span><span id="zipTvSubst"><span class="annot"><span class="annottext">zipTvSubst :: HasDebugCallStack =&gt; [Var] -&gt; [Type] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#zipTvSubst"><span class="hs-identifier hs-var hs-var">zipTvSubst</span></a></span></span><span> </span><span id="local-6989586621681025205"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025205"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621681025204"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025204"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#mkTvSubst"><span class="hs-identifier hs-var">mkTvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfTypes"><span class="hs-identifier hs-var">shallowTyCoVarsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025204"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025201"><span class="hs-identifier hs-var">tenv</span></a></span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-407"></span><span>    </span><span id="local-6989586621681025201"><span class="annot"><span class="annottext">tenv :: TvSubstEnv
</span><a href="#local-6989586621681025201"><span class="hs-identifier hs-var hs-var">tenv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; [Var] -&gt; [Type] -&gt; TvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#zipTyEnv"><span class="hs-identifier hs-var">zipTyEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025205"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025204"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-comment">-- | Generates the in-scope set for the 'TCvSubst' from the types in the incoming</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- environment.  No TyVars, please!</span><span>
</span><span id="line-411"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipCvSubst"><span class="hs-identifier hs-type">zipCvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-412"></span><span id="zipCvSubst"><span class="annot"><span class="annottext">zipCvSubst :: HasDebugCallStack =&gt; [Var] -&gt; [Coercion] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#zipCvSubst"><span class="hs-identifier hs-var hs-var">zipCvSubst</span></a></span></span><span> </span><span id="local-6989586621681025198"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025198"><span class="hs-identifier hs-var">cvs</span></a></span></span><span> </span><span id="local-6989586621681025197"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681025197"><span class="hs-identifier hs-var">cos</span></a></span></span><span>
</span><span id="line-413"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Coercion] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfCos"><span class="hs-identifier hs-var">shallowTyCoVarsOfCos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681025197"><span class="hs-identifier hs-var">cos</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#emptyTvSubstEnv"><span class="hs-identifier hs-var">emptyTvSubstEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025195"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-415"></span><span>    </span><span id="local-6989586621681025195"><span class="annot"><span class="annottext">cenv :: CvSubstEnv
</span><a href="#local-6989586621681025195"><span class="hs-identifier hs-var hs-var">cenv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; [Var] -&gt; [Coercion] -&gt; CvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#zipCoEnv"><span class="hs-identifier hs-var">zipCoEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025198"><span class="hs-identifier hs-var">cvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681025197"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipTCvSubst"><span class="hs-identifier hs-type">zipTCvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-418"></span><span id="zipTCvSubst"><span class="annot"><span class="annottext">zipTCvSubst :: HasDebugCallStack =&gt; [Var] -&gt; [Type] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#zipTCvSubst"><span class="hs-identifier hs-var hs-var">zipTCvSubst</span></a></span></span><span> </span><span id="local-6989586621681025189"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025189"><span class="hs-identifier hs-var">tcvs</span></a></span></span><span> </span><span id="local-6989586621681025188"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025188"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-419"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Type] -&gt; TCvSubst -&gt; TCvSubst
</span><a href="#local-6989586621681025187"><span class="hs-identifier hs-var">zip_tcvsubst</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025189"><span class="hs-identifier hs-var">tcvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025188"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-420"></span><span>    </span><span class="annot"><span class="annottext">InScopeSet -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#mkEmptyTCvSubst"><span class="hs-identifier hs-var">mkEmptyTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfTypes"><span class="hs-identifier hs-var">shallowTyCoVarsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025188"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="#local-6989586621681025187"><span class="hs-identifier hs-type">zip_tcvsubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-422"></span><span>        </span><span id="local-6989586621681025187"><span class="annot"><span class="annottext">zip_tcvsubst :: [Var] -&gt; [Type] -&gt; TCvSubst -&gt; TCvSubst
</span><a href="#local-6989586621681025187"><span class="hs-identifier hs-var hs-var">zip_tcvsubst</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681025186"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025186"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681025185"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025185"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681025184"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025184"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681025183"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025183"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681025182"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025182"><span class="hs-identifier hs-var">subst</span></a></span></span><span>
</span><span id="line-423"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Type] -&gt; TCvSubst -&gt; TCvSubst
</span><a href="#local-6989586621681025187"><span class="hs-identifier hs-var">zip_tcvsubst</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025185"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025183"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Type -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvSubst"><span class="hs-identifier hs-var">extendTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025182"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025186"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025184"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>        </span><span class="annot"><a href="#local-6989586621681025187"><span class="hs-identifier hs-var">zip_tcvsubst</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621681025181"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025181"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025181"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-comment">-- empty case</span><span>
</span><span id="line-425"></span><span>        </span><span class="annot"><a href="#local-6989586621681025187"><span class="hs-identifier hs-var">zip_tcvsubst</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">TCvSubst
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;zipTCvSubst: length mismatch&quot;</span></span><span>
</span><span id="line-426"></span><span>                                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025189"><span class="hs-identifier hs-var">tcvs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025188"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="hs-comment">-- | Generates the in-scope set for the 'TCvSubst' from the types in the</span><span>
</span><span id="line-429"></span><span class="hs-comment">-- incoming environment. No CoVars, please!</span><span>
</span><span id="line-430"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkTvSubstPrs"><span class="hs-identifier hs-type">mkTvSubstPrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span>
</span><span id="line-431"></span><span id="mkTvSubstPrs"><span class="annot"><span class="annottext">mkTvSubstPrs :: [(Var, Type)] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#mkTvSubstPrs"><span class="hs-identifier hs-var hs-var">mkTvSubstPrs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#emptyTCvSubst"><span class="hs-identifier hs-var">emptyTCvSubst</span></a></span><span>
</span><span id="line-432"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#mkTvSubstPrs"><span class="hs-identifier hs-var">mkTvSubstPrs</span></a></span><span> </span><span id="local-6989586621681025180"><span class="annot"><span class="annottext">[(Var, Type)]
</span><a href="#local-6989586621681025180"><span class="hs-identifier hs-var">prs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">onlyTyVarsAndNoCoercionTy</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;prs&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">prs</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>    </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#mkTvSubst"><span class="hs-identifier hs-var">mkTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025177"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025176"><span class="hs-identifier hs-var">tenv</span></a></span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681025176"><span class="annot"><span class="annottext">tenv :: TvSubstEnv
</span><a href="#local-6989586621681025176"><span class="hs-identifier hs-var hs-var">tenv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [(Var, a)] -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#mkVarEnv"><span class="hs-identifier hs-var">mkVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Type)]
</span><a href="#local-6989586621681025180"><span class="hs-identifier hs-var">prs</span></a></span><span>
</span><span id="line-436"></span><span>        </span><span id="local-6989586621681025177"><span class="annot"><span class="annottext">in_scope :: InScopeSet
</span><a href="#local-6989586621681025177"><span class="hs-identifier hs-var hs-var">in_scope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#mkInScopeSet"><span class="hs-identifier hs-var">mkInScopeSet</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfTypes"><span class="hs-identifier hs-var">shallowTyCoVarsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../../base-4.16.4.0/src/Data-Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Type)]
</span><a href="#local-6989586621681025180"><span class="hs-identifier hs-var">prs</span></a></span><span>
</span><span id="line-437"></span><span>        </span><span id="local-6989586621681025179"><span class="annot"><span class="annottext">onlyTyVarsAndNoCoercionTy :: Bool
</span><a href="#local-6989586621681025179"><span class="hs-identifier hs-var hs-var">onlyTyVarsAndNoCoercionTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-438"></span><span>          </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#and"><span class="hs-identifier hs-var">and</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025173"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.Type.html#isCoercionTy"><span class="hs-identifier hs-var">isCoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025172"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681025173"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025173"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681025172"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025172"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, Type)]
</span><a href="#local-6989586621681025180"><span class="hs-identifier hs-var">prs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipTyEnv"><span class="hs-identifier hs-type">zipTyEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TvSubstEnv"><span class="hs-identifier hs-type">TvSubstEnv</span></a></span><span>
</span><span id="line-442"></span><span id="zipTyEnv"><span class="annot"><span class="annottext">zipTyEnv :: HasDebugCallStack =&gt; [Var] -&gt; [Type] -&gt; TvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#zipTyEnv"><span class="hs-identifier hs-var hs-var">zipTyEnv</span></a></span></span><span> </span><span id="local-6989586621681025162"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025162"><span class="hs-identifier hs-var">tyvars</span></a></span></span><span> </span><span id="local-6989586621681025161"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025161"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-443"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="GHC.Utils.Misc.html#debugIsOn"><span class="hs-identifier hs-var">debugIsOn</span></a></span><span>
</span><span id="line-444"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025162"><span class="hs-identifier hs-var">tyvars</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025162"><span class="hs-identifier hs-var">tyvars</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; Bool
</span><a href="GHC.Utils.Misc.html#equalLength"><span class="hs-operator hs-var">`equalLength`</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025161"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;zipTyEnv&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025162"><span class="hs-identifier hs-var">tyvars</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025161"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">all</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">not</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">isCoercionTy</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>    </span><span class="annot"><span class="annottext">forall key elt. Uniquable key =&gt; [key] -&gt; [elt] -&gt; UniqFM key elt
</span><a href="GHC.Types.Unique.FM.html#zipToUFM"><span class="hs-identifier hs-var">zipToUFM</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025162"><span class="hs-identifier hs-var">tyvars</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025161"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-449"></span><span>        </span><span class="hs-comment">-- There used to be a special case for when</span><span>
</span><span id="line-450"></span><span>        </span><span class="hs-comment">--      ty == TyVarTy tv</span><span>
</span><span id="line-451"></span><span>        </span><span class="hs-comment">-- (a not-uncommon case) in which case the substitution was dropped.</span><span>
</span><span id="line-452"></span><span>        </span><span class="hs-comment">-- But the type-tidier changes the print-name of a type variable without</span><span>
</span><span id="line-453"></span><span>        </span><span class="hs-comment">-- changing the unique, and that led to a bug.   Why?  Pre-tidying, we had</span><span>
</span><span id="line-454"></span><span>        </span><span class="hs-comment">-- a type {Foo t}, where Foo is a one-method class.  So Foo is really a newtype.</span><span>
</span><span id="line-455"></span><span>        </span><span class="hs-comment">-- And it happened that t was the type variable of the class.  Post-tiding,</span><span>
</span><span id="line-456"></span><span>        </span><span class="hs-comment">-- it got turned into {Foo t2}.  The ext-core printer expanded this using</span><span>
</span><span id="line-457"></span><span>        </span><span class="hs-comment">-- sourceTypeRep, but that said &quot;Oh, t == t2&quot; because they have the same unique,</span><span>
</span><span id="line-458"></span><span>        </span><span class="hs-comment">-- and so generated a rep type mentioning t not t2.</span><span>
</span><span id="line-459"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-460"></span><span>        </span><span class="hs-comment">-- Simplest fix is to nuke the &quot;optimisation&quot;</span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#zipCoEnv"><span class="hs-identifier hs-type">zipCoEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#HasDebugCallStack"><span class="hs-identifier hs-type">HasDebugCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#CvSubstEnv"><span class="hs-identifier hs-type">CvSubstEnv</span></a></span><span>
</span><span id="line-463"></span><span id="zipCoEnv"><span class="annot"><span class="annottext">zipCoEnv :: HasDebugCallStack =&gt; [Var] -&gt; [Coercion] -&gt; CvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#zipCoEnv"><span class="hs-identifier hs-var hs-var">zipCoEnv</span></a></span></span><span> </span><span id="local-6989586621681025148"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025148"><span class="hs-identifier hs-var">cvs</span></a></span></span><span> </span><span id="local-6989586621681025147"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681025147"><span class="hs-identifier hs-var">cos</span></a></span></span><span>
</span><span id="line-464"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="GHC.Utils.Misc.html#debugIsOn"><span class="hs-identifier hs-var">debugIsOn</span></a></span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isCoVar"><span class="hs-identifier hs-var">isCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025148"><span class="hs-identifier hs-var">cvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;zipCoEnv&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025148"><span class="hs-identifier hs-var">cvs</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681025147"><span class="hs-identifier hs-var">cos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [(Var, a)] -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#mkVarEnv"><span class="hs-identifier hs-var">mkVarEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. String -&gt; [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="GHC.Utils.Misc.html#zipEqual"><span class="hs-identifier hs-var">zipEqual</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;zipCoEnv&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025148"><span class="hs-identifier hs-var">cvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681025147"><span class="hs-identifier hs-var">cos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-471"></span><span>  </span><span id="local-6989586621681025136"><span class="annot"><span class="annottext">ppr :: TCvSubst -&gt; SDoc
</span><a href="#local-6989586621681025136"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025135"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025135"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span id="local-6989586621681025134"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025134"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681025133"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025133"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#brackets"><span class="hs-identifier hs-var">brackets</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TCvSubst&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-473"></span><span>                      </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In scope:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025135"><span class="hs-identifier hs-var">ins</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-474"></span><span>                      </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Type env:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025134"><span class="hs-identifier hs-var">tenv</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-475"></span><span>                      </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Co env:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025133"><span class="hs-identifier hs-var">cenv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="hs-comment">{-
%************************************************************************
%*                                                                      *
                Performing type or kind substitutions
%*                                                                      *
%************************************************************************

Note [Sym and ForAllCo]
~~~~~~~~~~~~~~~~~~~~~~~
In OptCoercion, we try to push &quot;sym&quot; out to the leaves of a coercion. But,
how do we push sym into a ForAllCo? It's a little ugly.

Here is the typing rule:

h : k1 ~# k2
(tv : k1) |- g : ty1 ~# ty2
----------------------------
ForAllCo tv h g : (ForAllTy (tv : k1) ty1) ~#
                  (ForAllTy (tv : k2) (ty2[tv |-&gt; tv |&gt; sym h]))

Here is what we want:

ForAllCo tv h' g' : (ForAllTy (tv : k2) (ty2[tv |-&gt; tv |&gt; sym h])) ~#
                    (ForAllTy (tv : k1) ty1)


Because the kinds of the type variables to the right of the colon are the kinds
coerced by h', we know (h' : k2 ~# k1). Thus, (h' = sym h).

Now, we can rewrite ty1 to be (ty1[tv |-&gt; tv |&gt; sym h' |&gt; h']). We thus want

ForAllCo tv h' g' :
  (ForAllTy (tv : k2) (ty2[tv |-&gt; tv |&gt; h'])) ~#
  (ForAllTy (tv : k1) (ty1[tv |-&gt; tv |&gt; h'][tv |-&gt; tv |&gt; sym h']))

We thus see that we want

g' : ty2[tv |-&gt; tv |&gt; h'] ~# ty1[tv |-&gt; tv |&gt; h']

and thus g' = sym (g[tv |-&gt; tv |&gt; h']).

Putting it all together, we get this:

sym (ForAllCo tv h g)
==&gt;
ForAllCo tv (sym h) (sym g[tv |-&gt; tv |&gt; sym h])

Note [Substituting in a coercion hole]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
It seems highly suspicious to be substituting in a coercion that still
has coercion holes. Yet, this can happen in a situation like this:

  f :: forall k. k :~: Type -&gt; ()
  f Refl = let x :: forall (a :: k). [a] -&gt; ...
               x = ...

When we check x's type signature, we require that k ~ Type. We indeed
know this due to the Refl pattern match, but the eager unifier can't
make use of givens. So, when we're done looking at x's type, a coercion
hole will remain. Then, when we're checking x's definition, we skolemise
x's type (in order to, e.g., bring the scoped type variable `a` into scope).
This requires performing a substitution for the fresh skolem variables.

This substitution needs to affect the kind of the coercion hole, too --
otherwise, the kind will have an out-of-scope variable in it. More problematically
in practice (we won't actually notice the out-of-scope variable ever), skolems
in the kind might have too high a level, triggering a failure to uphold the
invariant that no free variables in a type have a higher level than the
ambient level in the type checker. In the event of having free variables in the
hole's kind, I'm pretty sure we'll always have an erroneous program, so we
don't need to worry what will happen when the hole gets filled in. After all,
a hole relating a locally-bound type variable will be unable to be solved. This
is why it's OK not to look through the IORef of a coercion hole during
substitution.

-}</span><span>
</span><span id="line-553"></span><span>
</span><span id="line-554"></span><span class="hs-comment">-- | Type substitution, see 'zipTvSubst'</span><span>
</span><span id="line-555"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWith"><span class="hs-identifier hs-type">substTyWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Stack-Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-556"></span><span class="hs-comment">-- Works only if the domain of the substitution is a</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- superset of the type being substituted into</span><span>
</span><span id="line-558"></span><span id="substTyWith"><span class="annot"><span class="annottext">substTyWith :: HasCallStack =&gt; [Var] -&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyWith"><span class="hs-identifier hs-var hs-var">substTyWith</span></a></span></span><span> </span><span id="local-6989586621681025125"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025125"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621681025124"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025124"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-#SCC</span><span> </span><span class="hs-pragma">&quot;substTyWith&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-559"></span><span>                      </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">tvs</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">equalLength</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>                      </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; [Var] -&gt; [Type] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#zipTvSubst"><span class="hs-identifier hs-var">zipTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025125"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025124"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="hs-comment">-- | Type substitution, see 'zipTvSubst'. Disables sanity checks.</span><span>
</span><span id="line-563"></span><span class="hs-comment">-- The problems that the sanity checks in substTy catch are described in</span><span>
</span><span id="line-564"></span><span class="hs-comment">-- Note [The substitution invariant].</span><span>
</span><span id="line-565"></span><span class="hs-comment">-- The goal of #11371 is to migrate all the calls of substTyUnchecked to</span><span>
</span><span id="line-566"></span><span class="hs-comment">-- substTy and remove this function. Please don't use in new code.</span><span>
</span><span id="line-567"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWithUnchecked"><span class="hs-identifier hs-type">substTyWithUnchecked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-568"></span><span id="substTyWithUnchecked"><span class="annot"><span class="annottext">substTyWithUnchecked :: [Var] -&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyWithUnchecked"><span class="hs-identifier hs-var hs-var">substTyWithUnchecked</span></a></span></span><span> </span><span id="local-6989586621681025123"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025123"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621681025122"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025122"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-569"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">tvs</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">equalLength</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>    </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyUnchecked"><span class="hs-identifier hs-var">substTyUnchecked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; [Var] -&gt; [Type] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#zipTvSubst"><span class="hs-identifier hs-var">zipTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025123"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025122"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span class="hs-comment">-- | Substitute tyvars within a type using a known 'InScopeSet'.</span><span>
</span><span id="line-573"></span><span class="hs-comment">-- Pre-condition: the 'in_scope' set should satisfy Note [The substitution</span><span>
</span><span id="line-574"></span><span class="hs-comment">-- invariant]; specifically it should include the free vars of 'tys',</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- and of 'ty' minus the domain of the subst.</span><span>
</span><span id="line-576"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWithInScope"><span class="hs-identifier hs-type">substTyWithInScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.Env.html#InScopeSet"><span class="hs-identifier hs-type">InScopeSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-577"></span><span id="substTyWithInScope"><span class="annot"><span class="annottext">substTyWithInScope :: InScopeSet -&gt; [Var] -&gt; [Type] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyWithInScope"><span class="hs-identifier hs-var hs-var">substTyWithInScope</span></a></span></span><span> </span><span id="local-6989586621681025121"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025121"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681025120"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025120"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621681025119"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025119"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span id="local-6989586621681025118"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025118"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-578"></span><span>  </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">tvs</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">equalLength</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#mkTvSubst"><span class="hs-identifier hs-var">mkTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025121"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025117"><span class="hs-identifier hs-var">tenv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025118"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-580"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681025117"><span class="annot"><span class="annottext">tenv :: TvSubstEnv
</span><a href="#local-6989586621681025117"><span class="hs-identifier hs-var hs-var">tenv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; [Var] -&gt; [Type] -&gt; TvSubstEnv
</span><a href="GHC.Core.TyCo.Subst.html#zipTyEnv"><span class="hs-identifier hs-var">zipTyEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025120"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025119"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-581"></span><span>
</span><span id="line-582"></span><span class="hs-comment">-- | Coercion substitution, see 'zipTvSubst'</span><span>
</span><span id="line-583"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoWith"><span class="hs-identifier hs-type">substCoWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Stack-Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-584"></span><span id="substCoWith"><span class="annot"><span class="annottext">substCoWith :: HasCallStack =&gt; [Var] -&gt; [Type] -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#substCoWith"><span class="hs-identifier hs-var hs-var">substCoWith</span></a></span></span><span> </span><span id="local-6989586621681025112"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025112"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621681025111"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025111"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">tvs</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">equalLength</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>                      </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#substCo"><span class="hs-identifier hs-var">substCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; [Var] -&gt; [Type] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#zipTvSubst"><span class="hs-identifier hs-var">zipTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025112"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025111"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span class="hs-comment">-- | Coercion substitution, see 'zipTvSubst'. Disables sanity checks.</span><span>
</span><span id="line-588"></span><span class="hs-comment">-- The problems that the sanity checks in substCo catch are described in</span><span>
</span><span id="line-589"></span><span class="hs-comment">-- Note [The substitution invariant].</span><span>
</span><span id="line-590"></span><span class="hs-comment">-- The goal of #11371 is to migrate all the calls of substCoUnchecked to</span><span>
</span><span id="line-591"></span><span class="hs-comment">-- substCo and remove this function. Please don't use in new code.</span><span>
</span><span id="line-592"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoWithUnchecked"><span class="hs-identifier hs-type">substCoWithUnchecked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-593"></span><span id="substCoWithUnchecked"><span class="annot"><span class="annottext">substCoWithUnchecked :: [Var] -&gt; [Type] -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#substCoWithUnchecked"><span class="hs-identifier hs-var hs-var">substCoWithUnchecked</span></a></span></span><span> </span><span id="local-6989586621681025110"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025110"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621681025109"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025109"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-594"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">tvs</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">equalLength</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>    </span><span class="annot"><span class="annottext">TCvSubst -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#substCoUnchecked"><span class="hs-identifier hs-var">substCoUnchecked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; [Var] -&gt; [Type] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#zipTvSubst"><span class="hs-identifier hs-var">zipTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025110"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025109"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="hs-comment">-- | Substitute covars within a type</span><span>
</span><span id="line-600"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyWithCoVars"><span class="hs-identifier hs-type">substTyWithCoVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-601"></span><span id="substTyWithCoVars"><span class="annot"><span class="annottext">substTyWithCoVars :: [Var] -&gt; [Coercion] -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyWithCoVars"><span class="hs-identifier hs-var hs-var">substTyWithCoVars</span></a></span></span><span> </span><span id="local-6989586621681025108"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025108"><span class="hs-identifier hs-var">cvs</span></a></span></span><span> </span><span id="local-6989586621681025107"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681025107"><span class="hs-identifier hs-var">cos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; [Var] -&gt; [Coercion] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#zipCvSubst"><span class="hs-identifier hs-var">zipCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025108"><span class="hs-identifier hs-var">cvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681025107"><span class="hs-identifier hs-var">cos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span class="hs-comment">-- | Type substitution, see 'zipTvSubst'</span><span>
</span><span id="line-604"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTysWith"><span class="hs-identifier hs-type">substTysWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-605"></span><span id="substTysWith"><span class="annot"><span class="annottext">substTysWith :: [Var] -&gt; [Type] -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Subst.html#substTysWith"><span class="hs-identifier hs-var hs-var">substTysWith</span></a></span></span><span> </span><span id="local-6989586621681025106"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025106"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621681025105"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025105"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">tvs</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">equalLength</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>                       </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Subst.html#substTys"><span class="hs-identifier hs-var">substTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; [Var] -&gt; [Type] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#zipTvSubst"><span class="hs-identifier hs-var">zipTvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025106"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025105"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span class="hs-comment">-- | Type substitution, see 'zipTvSubst'</span><span>
</span><span id="line-609"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTysWithCoVars"><span class="hs-identifier hs-type">substTysWithCoVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-610"></span><span id="substTysWithCoVars"><span class="annot"><span class="annottext">substTysWithCoVars :: [Var] -&gt; [Coercion] -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Subst.html#substTysWithCoVars"><span class="hs-identifier hs-var hs-var">substTysWithCoVars</span></a></span></span><span> </span><span id="local-6989586621681025104"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025104"><span class="hs-identifier hs-var">cvs</span></a></span></span><span> </span><span id="local-6989586621681025103"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681025103"><span class="hs-identifier hs-var">cos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">cvs</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">equalLength</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">cos</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>                             </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Subst.html#substTys"><span class="hs-identifier hs-var">substTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; [Var] -&gt; [Coercion] -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#zipCvSubst"><span class="hs-identifier hs-var">zipCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681025104"><span class="hs-identifier hs-var">cvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681025103"><span class="hs-identifier hs-var">cos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span class="hs-comment">-- | Substitute within a 'Type' after adding the free variables of the type</span><span>
</span><span id="line-614"></span><span class="hs-comment">-- to the in-scope set. This is useful for the case when the free variables</span><span>
</span><span id="line-615"></span><span class="hs-comment">-- aren't already in the in-scope set or easily available.</span><span>
</span><span id="line-616"></span><span class="hs-comment">-- See also Note [The substitution invariant].</span><span>
</span><span id="line-617"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyAddInScope"><span class="hs-identifier hs-type">substTyAddInScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-618"></span><span id="substTyAddInScope"><span class="annot"><span class="annottext">substTyAddInScope :: TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyAddInScope"><span class="hs-identifier hs-var hs-var">substTyAddInScope</span></a></span></span><span> </span><span id="local-6989586621681025102"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025102"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681025101"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025101"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-619"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; VarSet -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#extendTCvInScopeSet"><span class="hs-identifier hs-var">extendTCvInScopeSet</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025102"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#tyCoVarsOfType"><span class="hs-identifier hs-var">tyCoVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025101"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025101"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span class="hs-comment">-- | When calling `substTy` it should be the case that the in-scope set in</span><span>
</span><span id="line-622"></span><span class="hs-comment">-- the substitution is a superset of the free vars of the range of the</span><span>
</span><span id="line-623"></span><span class="hs-comment">-- substitution.</span><span>
</span><span id="line-624"></span><span class="hs-comment">-- See also Note [The substitution invariant].</span><span>
</span><span id="line-625"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#isValidTCvSubst"><span class="hs-identifier hs-type">isValidTCvSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-626"></span><span id="isValidTCvSubst"><span class="annot"><span class="annottext">isValidTCvSubst :: TCvSubst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#isValidTCvSubst"><span class="hs-identifier hs-var hs-var">isValidTCvSubst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025100"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025100"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681025099"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025099"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681025098"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025098"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-627"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681025097"><span class="hs-identifier hs-var">tenvFVs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; InScopeSet -&gt; Bool
</span><a href="GHC.Types.Var.Env.html#varSetInScope"><span class="hs-operator hs-var">`varSetInScope`</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025100"><span class="hs-identifier hs-var">in_scope</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-628"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681025095"><span class="hs-identifier hs-var">cenvFVs</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; InScopeSet -&gt; Bool
</span><a href="GHC.Types.Var.Env.html#varSetInScope"><span class="hs-operator hs-var">`varSetInScope`</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025100"><span class="hs-identifier hs-var">in_scope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-630"></span><span>  </span><span id="local-6989586621681025097"><span class="annot"><span class="annottext">tenvFVs :: VarSet
</span><a href="#local-6989586621681025097"><span class="hs-identifier hs-var hs-var">tenvFVs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TvSubstEnv -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfTyVarEnv"><span class="hs-identifier hs-var">shallowTyCoVarsOfTyVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025099"><span class="hs-identifier hs-var">tenv</span></a></span><span>
</span><span id="line-631"></span><span>  </span><span id="local-6989586621681025095"><span class="annot"><span class="annottext">cenvFVs :: VarSet
</span><a href="#local-6989586621681025095"><span class="hs-identifier hs-var hs-var">cenvFVs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CvSubstEnv -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfCoVarEnv"><span class="hs-identifier hs-var">shallowTyCoVarsOfCoVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025098"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span class="hs-comment">-- | This checks if the substitution satisfies the invariant from</span><span>
</span><span id="line-634"></span><span class="hs-comment">-- Note [The substitution invariant].</span><span>
</span><span id="line-635"></span><span id="local-6989586621681025561"><span class="annot"><a href="GHC.Core.TyCo.Subst.html#checkValidSubst"><span class="hs-identifier hs-type">checkValidSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Stack-Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681025561"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681025561"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-636"></span><span id="checkValidSubst"><span class="annot"><span class="annottext">checkValidSubst :: forall a.
HasCallStack =&gt;
TCvSubst -&gt; [Type] -&gt; [Coercion] -&gt; a -&gt; a
</span><a href="GHC.Core.TyCo.Subst.html#checkValidSubst"><span class="hs-identifier hs-var hs-var">checkValidSubst</span></a></span></span><span> </span><span id="local-6989586621681025074"><span class="annot"><span class="annottext">subst :: TCvSubst
</span><a href="#local-6989586621681025074"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681025073"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025073"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681025072"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025072"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681025071"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025071"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681025070"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025070"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span id="local-6989586621681025069"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681025069"><span class="hs-identifier hs-var">cos</span></a></span></span><span> </span><span id="local-6989586621681025068"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681025068"><span class="hs-identifier hs-var">a</span></a></span></span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isValidTCvSubst</span><span> </span><span class="hs-identifier">subst</span><span class="hs-special">,</span><span>
</span><span id="line-638"></span><span>             </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;in_scope&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">in_scope</span><span> </span><span class="hs-operator">$$</span><span>
</span><span id="line-639"></span><span>             </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;tenv&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tenv</span><span> </span><span class="hs-operator">$$</span><span>
</span><span id="line-640"></span><span>             </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;tenvFVs&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">shallowTyCoVarsOfTyVarEnv</span><span> </span><span class="hs-identifier">tenv</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$$</span><span>
</span><span id="line-641"></span><span>             </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;cenv&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">cenv</span><span> </span><span class="hs-operator">$$</span><span>
</span><span id="line-642"></span><span>             </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;cenvFVs&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">shallowTyCoVarsOfCoVarEnv</span><span> </span><span class="hs-identifier">cenv</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$$</span><span>
</span><span id="line-643"></span><span>             </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;tys&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-operator">$$</span><span>
</span><span id="line-644"></span><span>             </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;cos&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">cos</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span>    </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">tysCosFVsInScope</span><span class="hs-special">,</span><span>
</span><span id="line-646"></span><span>             </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;in_scope&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">in_scope</span><span> </span><span class="hs-operator">$$</span><span>
</span><span id="line-647"></span><span>             </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;tenv&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tenv</span><span> </span><span class="hs-operator">$$</span><span>
</span><span id="line-648"></span><span>             </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;cenv&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">cenv</span><span> </span><span class="hs-operator">$$</span><span>
</span><span id="line-649"></span><span>             </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;tys&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-operator">$$</span><span>
</span><span id="line-650"></span><span>             </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;cos&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">cos</span><span> </span><span class="hs-operator">$$</span><span>
</span><span id="line-651"></span><span>             </span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;needInScope&quot;</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">needInScope</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span>    </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681025068"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-653"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-654"></span><span>  </span><span id="local-6989586621681025065"><span class="annot"><span class="annottext">substDomain :: [Unique]
</span><a href="#local-6989586621681025065"><span class="hs-identifier hs-var hs-var">substDomain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall key elt. UniqFM key elt -&gt; [Unique]
</span><a href="GHC.Types.Unique.FM.html#nonDetKeysUFM"><span class="hs-identifier hs-var">nonDetKeysUFM</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681025072"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall key elt. UniqFM key elt -&gt; [Unique]
</span><a href="GHC.Types.Unique.FM.html#nonDetKeysUFM"><span class="hs-identifier hs-var">nonDetKeysUFM</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681025071"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-655"></span><span>    </span><span class="hs-comment">-- It's OK to use nonDetKeysUFM here, because we only use this list to</span><span>
</span><span id="line-656"></span><span>    </span><span class="hs-comment">-- remove some elements from a set</span><span>
</span><span id="line-657"></span><span>  </span><span id="local-6989586621681025066"><span class="annot"><span class="annottext">needInScope :: VarSet
</span><a href="#local-6989586621681025066"><span class="hs-identifier hs-var hs-var">needInScope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfTypes"><span class="hs-identifier hs-var">shallowTyCoVarsOfTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025070"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
</span><a href="GHC.Types.Var.Set.html#unionVarSet"><span class="hs-operator hs-var">`unionVarSet`</span></a></span><span>
</span><span id="line-658"></span><span>                 </span><span class="annot"><span class="annottext">[Coercion] -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfCos"><span class="hs-identifier hs-var">shallowTyCoVarsOfCos</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681025069"><span class="hs-identifier hs-var">cos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-659"></span><span>                </span><span class="annot"><span class="annottext">forall a. UniqSet a -&gt; [Unique] -&gt; UniqSet a
</span><a href="GHC.Types.Unique.Set.html#delListFromUniqSet_Directly"><span class="hs-operator hs-var">`delListFromUniqSet_Directly`</span></a></span><span> </span><span class="annot"><span class="annottext">[Unique]
</span><a href="#local-6989586621681025065"><span class="hs-identifier hs-var">substDomain</span></a></span><span>
</span><span id="line-660"></span><span>  </span><span id="local-6989586621681025067"><span class="annot"><span class="annottext">tysCosFVsInScope :: Bool
</span><a href="#local-6989586621681025067"><span class="hs-identifier hs-var hs-var">tysCosFVsInScope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681025066"><span class="hs-identifier hs-var">needInScope</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; InScopeSet -&gt; Bool
</span><a href="GHC.Types.Var.Env.html#varSetInScope"><span class="hs-operator hs-var">`varSetInScope`</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681025073"><span class="hs-identifier hs-var">in_scope</span></a></span><span>
</span><span id="line-661"></span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span class="hs-comment">-- | Substitute within a 'Type'</span><span>
</span><span id="line-664"></span><span class="hs-comment">-- The substitution has to satisfy the invariants described in</span><span>
</span><span id="line-665"></span><span class="hs-comment">-- Note [The substitution invariant].</span><span>
</span><span id="line-666"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-type">substTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Stack-Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-667"></span><span id="substTy"><span class="annot"><span class="annottext">substTy :: HasCallStack =&gt; TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var hs-var">substTy</span></a></span></span><span> </span><span id="local-6989586621681025059"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025059"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681025058"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025058"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-668"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#isEmptyTCvSubst"><span class="hs-identifier hs-var">isEmptyTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025059"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025058"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-669"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
HasCallStack =&gt;
TCvSubst -&gt; [Type] -&gt; [Coercion] -&gt; a -&gt; a
</span><a href="GHC.Core.TyCo.Subst.html#checkValidSubst"><span class="hs-identifier hs-var">checkValidSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025059"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025058"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-670"></span><span>                            </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#subst_ty"><span class="hs-identifier hs-var">subst_ty</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025059"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025058"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span class="hs-comment">-- | Substitute within a 'Type' disabling the sanity checks.</span><span>
</span><span id="line-673"></span><span class="hs-comment">-- The problems that the sanity checks in substTy catch are described in</span><span>
</span><span id="line-674"></span><span class="hs-comment">-- Note [The substitution invariant].</span><span>
</span><span id="line-675"></span><span class="hs-comment">-- The goal of #11371 is to migrate all the calls of substTyUnchecked to</span><span>
</span><span id="line-676"></span><span class="hs-comment">-- substTy and remove this function. Please don't use in new code.</span><span>
</span><span id="line-677"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyUnchecked"><span class="hs-identifier hs-type">substTyUnchecked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-678"></span><span id="substTyUnchecked"><span class="annot"><span class="annottext">substTyUnchecked :: TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyUnchecked"><span class="hs-identifier hs-var hs-var">substTyUnchecked</span></a></span></span><span> </span><span id="local-6989586621681025056"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025056"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681025055"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025055"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-679"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#isEmptyTCvSubst"><span class="hs-identifier hs-var">isEmptyTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025056"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025055"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-680"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#subst_ty"><span class="hs-identifier hs-var">subst_ty</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025056"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025055"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-681"></span><span>
</span><span id="line-682"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTy"><span class="hs-identifier hs-type">substScaledTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Stack-Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-683"></span><span id="substScaledTy"><span class="annot"><span class="annottext">substScaledTy :: HasCallStack =&gt; TCvSubst -&gt; Scaled Type -&gt; Scaled Type
</span><a href="GHC.Core.TyCo.Subst.html#substScaledTy"><span class="hs-identifier hs-var hs-var">substScaledTy</span></a></span></span><span> </span><span id="local-6989586621681025051"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025051"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681025050"><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621681025050"><span class="hs-identifier hs-var">scaled_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Scaled Type -&gt; Scaled Type
</span><a href="GHC.Core.TyCo.Rep.html#mapScaledType"><span class="hs-identifier hs-var">mapScaledType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025051"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621681025050"><span class="hs-identifier hs-var">scaled_ty</span></a></span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTyUnchecked"><span class="hs-identifier hs-type">substScaledTyUnchecked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Stack-Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-686"></span><span id="substScaledTyUnchecked"><span class="annot"><span class="annottext">substScaledTyUnchecked :: HasCallStack =&gt; TCvSubst -&gt; Scaled Type -&gt; Scaled Type
</span><a href="GHC.Core.TyCo.Subst.html#substScaledTyUnchecked"><span class="hs-identifier hs-var hs-var">substScaledTyUnchecked</span></a></span></span><span> </span><span id="local-6989586621681025047"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025047"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681025046"><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621681025046"><span class="hs-identifier hs-var">scaled_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Scaled Type -&gt; Scaled Type
</span><a href="GHC.Core.TyCo.Rep.html#mapScaledType"><span class="hs-identifier hs-var">mapScaledType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyUnchecked"><span class="hs-identifier hs-var">substTyUnchecked</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025047"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621681025046"><span class="hs-identifier hs-var">scaled_ty</span></a></span><span>
</span><span id="line-687"></span><span>
</span><span id="line-688"></span><span class="hs-comment">-- | Substitute within several 'Type's</span><span>
</span><span id="line-689"></span><span class="hs-comment">-- The substitution has to satisfy the invariants described in</span><span>
</span><span id="line-690"></span><span class="hs-comment">-- Note [The substitution invariant].</span><span>
</span><span id="line-691"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTys"><span class="hs-identifier hs-type">substTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Stack-Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-692"></span><span id="substTys"><span class="annot"><span class="annottext">substTys :: HasCallStack =&gt; TCvSubst -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Subst.html#substTys"><span class="hs-identifier hs-var hs-var">substTys</span></a></span></span><span> </span><span id="local-6989586621681025042"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025042"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681025041"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025041"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-693"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#isEmptyTCvSubst"><span class="hs-identifier hs-var">isEmptyTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025042"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025041"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-694"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
HasCallStack =&gt;
TCvSubst -&gt; [Type] -&gt; [Coercion] -&gt; a -&gt; a
</span><a href="GHC.Core.TyCo.Subst.html#checkValidSubst"><span class="hs-identifier hs-var">checkValidSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025042"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025041"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#subst_ty"><span class="hs-identifier hs-var">subst_ty</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025042"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025041"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-695"></span><span>
</span><span id="line-696"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTys"><span class="hs-identifier hs-type">substScaledTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Stack-Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-697"></span><span id="substScaledTys"><span class="annot"><span class="annottext">substScaledTys :: HasCallStack =&gt; TCvSubst -&gt; [Scaled Type] -&gt; [Scaled Type]
</span><a href="GHC.Core.TyCo.Subst.html#substScaledTys"><span class="hs-identifier hs-var hs-var">substScaledTys</span></a></span></span><span> </span><span id="local-6989586621681025037"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025037"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681025036"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621681025036"><span class="hs-identifier hs-var">scaled_tys</span></a></span></span><span>
</span><span id="line-698"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#isEmptyTCvSubst"><span class="hs-identifier hs-var">isEmptyTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025037"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621681025036"><span class="hs-identifier hs-var">scaled_tys</span></a></span><span>
</span><span id="line-699"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
HasCallStack =&gt;
TCvSubst -&gt; [Type] -&gt; [Coercion] -&gt; a -&gt; a
</span><a href="GHC.Core.TyCo.Subst.html#checkValidSubst"><span class="hs-identifier hs-var">checkValidSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025037"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Scaled a -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#scaledMult"><span class="hs-identifier hs-var">scaledMult</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621681025036"><span class="hs-identifier hs-var">scaled_tys</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Scaled a -&gt; a
</span><a href="GHC.Core.TyCo.Rep.html#scaledThing"><span class="hs-identifier hs-var">scaledThing</span></a></span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621681025036"><span class="hs-identifier hs-var">scaled_tys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-700"></span><span>                </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Scaled Type -&gt; Scaled Type
</span><a href="GHC.Core.TyCo.Rep.html#mapScaledType"><span class="hs-identifier hs-var">mapScaledType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#subst_ty"><span class="hs-identifier hs-var">subst_ty</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025037"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621681025036"><span class="hs-identifier hs-var">scaled_tys</span></a></span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span class="hs-comment">-- | Substitute within several 'Type's disabling the sanity checks.</span><span>
</span><span id="line-703"></span><span class="hs-comment">-- The problems that the sanity checks in substTys catch are described in</span><span>
</span><span id="line-704"></span><span class="hs-comment">-- Note [The substitution invariant].</span><span>
</span><span id="line-705"></span><span class="hs-comment">-- The goal of #11371 is to migrate all the calls of substTysUnchecked to</span><span>
</span><span id="line-706"></span><span class="hs-comment">-- substTys and remove this function. Please don't use in new code.</span><span>
</span><span id="line-707"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTysUnchecked"><span class="hs-identifier hs-type">substTysUnchecked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-708"></span><span id="substTysUnchecked"><span class="annot"><span class="annottext">substTysUnchecked :: TCvSubst -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Subst.html#substTysUnchecked"><span class="hs-identifier hs-var hs-var">substTysUnchecked</span></a></span></span><span> </span><span id="local-6989586621681025033"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025033"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681025032"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025032"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-709"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#isEmptyTCvSubst"><span class="hs-identifier hs-var">isEmptyTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025033"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025032"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-710"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#subst_ty"><span class="hs-identifier hs-var">subst_ty</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025033"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025032"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-711"></span><span>
</span><span id="line-712"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substScaledTysUnchecked"><span class="hs-identifier hs-type">substScaledTysUnchecked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Scaled"><span class="hs-identifier hs-type">Scaled</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-713"></span><span id="substScaledTysUnchecked"><span class="annot"><span class="annottext">substScaledTysUnchecked :: TCvSubst -&gt; [Scaled Type] -&gt; [Scaled Type]
</span><a href="GHC.Core.TyCo.Subst.html#substScaledTysUnchecked"><span class="hs-identifier hs-var hs-var">substScaledTysUnchecked</span></a></span></span><span> </span><span id="local-6989586621681025031"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025031"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681025030"><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621681025030"><span class="hs-identifier hs-var">tys</span></a></span></span><span>
</span><span id="line-714"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#isEmptyTCvSubst"><span class="hs-identifier hs-var">isEmptyTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025031"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621681025030"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-715"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Scaled Type -&gt; Scaled Type
</span><a href="GHC.Core.TyCo.Rep.html#mapScaledType"><span class="hs-identifier hs-var">mapScaledType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#subst_ty"><span class="hs-identifier hs-var">subst_ty</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025031"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Scaled Type]
</span><a href="#local-6989586621681025030"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-716"></span><span>
</span><span id="line-717"></span><span class="hs-comment">-- | Substitute within a 'ThetaType'</span><span>
</span><span id="line-718"></span><span class="hs-comment">-- The substitution has to satisfy the invariants described in</span><span>
</span><span id="line-719"></span><span class="hs-comment">-- Note [The substitution invariant].</span><span>
</span><span id="line-720"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTheta"><span class="hs-identifier hs-type">substTheta</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Stack-Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a></span><span>
</span><span id="line-721"></span><span id="substTheta"><span class="annot"><span class="annottext">substTheta :: HasCallStack =&gt; TCvSubst -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Subst.html#substTheta"><span class="hs-identifier hs-var hs-var">substTheta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Subst.html#substTys"><span class="hs-identifier hs-var">substTys</span></a></span><span>
</span><span id="line-722"></span><span>
</span><span id="line-723"></span><span class="hs-comment">-- | Substitute within a 'ThetaType' disabling the sanity checks.</span><span>
</span><span id="line-724"></span><span class="hs-comment">-- The problems that the sanity checks in substTys catch are described in</span><span>
</span><span id="line-725"></span><span class="hs-comment">-- Note [The substitution invariant].</span><span>
</span><span id="line-726"></span><span class="hs-comment">-- The goal of #11371 is to migrate all the calls of substThetaUnchecked to</span><span>
</span><span id="line-727"></span><span class="hs-comment">-- substTheta and remove this function. Please don't use in new code.</span><span>
</span><span id="line-728"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substThetaUnchecked"><span class="hs-identifier hs-type">substThetaUnchecked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ThetaType"><span class="hs-identifier hs-type">ThetaType</span></a></span><span>
</span><span id="line-729"></span><span id="substThetaUnchecked"><span class="annot"><span class="annottext">substThetaUnchecked :: TCvSubst -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Subst.html#substThetaUnchecked"><span class="hs-identifier hs-var hs-var">substThetaUnchecked</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; [Type] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Subst.html#substTysUnchecked"><span class="hs-identifier hs-var">substTysUnchecked</span></a></span><span>
</span><span id="line-730"></span><span>
</span><span id="line-731"></span><span>
</span><span id="line-732"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#subst_ty"><span class="hs-identifier hs-type">subst_ty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-733"></span><span class="hs-comment">-- subst_ty is the main workhorse for type substitution</span><span>
</span><span id="line-734"></span><span class="hs-comment">--</span><span>
</span><span id="line-735"></span><span class="hs-comment">-- Note that the in_scope set is poked only if we hit a forall</span><span>
</span><span id="line-736"></span><span class="hs-comment">-- so it may often never be fully computed</span><span>
</span><span id="line-737"></span><span id="subst_ty"><span class="annot"><span class="annottext">subst_ty :: TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#subst_ty"><span class="hs-identifier hs-var hs-var">subst_ty</span></a></span></span><span> </span><span id="local-6989586621681025025"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025025"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681025024"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025024"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-738"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621681025023"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025024"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-739"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-740"></span><span>    </span><span id="local-6989586621681025023"><span class="annot"><span class="annottext">go :: Type -&gt; Type
</span><a href="#local-6989586621681025023"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-type">TyVarTy</span></a></span><span> </span><span id="local-6989586621681025021"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025021"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyVar"><span class="hs-identifier hs-var">substTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025025"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681025021"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-741"></span><span>    </span><span class="annot"><a href="#local-6989586621681025023"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppTy"><span class="hs-identifier hs-type">AppTy</span></a></span><span> </span><span id="local-6989586621681025019"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025019"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681025018"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025018"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.Type.html#mkAppTy"><span class="hs-identifier hs-var">mkAppTy</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621681025023"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025019"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621681025023"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025018"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-742"></span><span>                </span><span class="hs-comment">-- The mkAppTy smart constructor is important</span><span>
</span><span id="line-743"></span><span>                </span><span class="hs-comment">-- we might be replacing (a Int), represented with App</span><span>
</span><span id="line-744"></span><span>                </span><span class="hs-comment">-- by [Int], represented with TyConApp</span><span>
</span><span id="line-745"></span><span>    </span><span class="annot"><a href="#local-6989586621681025023"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681025016"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621681025016"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621681025014"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681025014"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681025014"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">seq :: forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-type">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025016"><span class="hs-identifier hs-var">ty</span></a></span><span>  </span><span class="hs-comment">-- avoid allocation in this common case</span><span>
</span><span id="line-746"></span><span>    </span><span class="annot"><a href="#local-6989586621681025023"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConApp"><span class="hs-identifier hs-type">TyConApp</span></a></span><span> </span><span id="local-6989586621681025013"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681025013"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621681025012"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025012"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [Type] -&gt; Type
</span><a href="GHC.Core.Type.html#mkTyConApp"><span class="hs-identifier hs-var">mkTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681025013"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="GHC.Utils.Misc.html#strictMap"><span class="hs-identifier hs-var">strictMap</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621681025023"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681025012"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-747"></span><span>                               </span><span class="hs-comment">-- NB: mkTyConApp, not TyConApp.</span><span>
</span><span id="line-748"></span><span>                               </span><span class="hs-comment">-- mkTyConApp has optimizations.</span><span>
</span><span id="line-749"></span><span>                               </span><span class="hs-comment">-- See Note [Prefer Type over TYPE 'LiftedRep]</span><span>
</span><span id="line-750"></span><span>                               </span><span class="hs-comment">-- in GHC.Core.TyCo.Rep</span><span>
</span><span id="line-751"></span><span>    </span><span class="annot"><a href="#local-6989586621681025023"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621681025010"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621681025010"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunTy"><span class="hs-identifier hs-type">FunTy</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681025007"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025007"><span class="hs-identifier hs-var">mult</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681025005"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025005"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681025003"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025003"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-752"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681025002"><span class="annot"><span class="annottext">mult' :: Type
</span><a href="#local-6989586621681025002"><span class="hs-identifier hs-var hs-var">mult'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621681025023"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025007"><span class="hs-identifier hs-var">mult</span></a></span><span>
</span><span id="line-753"></span><span>            </span><span class="hs-glyph">!</span><span id="local-6989586621681025001"><span class="annot"><span class="annottext">arg' :: Type
</span><a href="#local-6989586621681025001"><span class="hs-identifier hs-var hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621681025023"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025005"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-754"></span><span>            </span><span class="hs-glyph">!</span><span id="local-6989586621681025000"><span class="annot"><span class="annottext">res' :: Type
</span><a href="#local-6989586621681025000"><span class="hs-identifier hs-var hs-var">res'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621681025023"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025003"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-755"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025010"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_mult :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_mult"><span class="hs-identifier hs-var">ft_mult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025002"><span class="hs-identifier hs-var">mult'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_arg :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_arg"><span class="hs-identifier hs-var">ft_arg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025001"><span class="hs-identifier hs-var">arg'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_res :: Type
</span><a href="GHC.Core.TyCo.Rep.html#ft_res"><span class="hs-identifier hs-var">ft_res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681025000"><span class="hs-identifier hs-var">res'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-756"></span><span>    </span><span class="annot"><a href="#local-6989586621681025023"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-type">ForAllTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621681024998"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024998"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621681024997"><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621681024997"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681024996"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024996"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-757"></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substVarBndrUnchecked"><span class="hs-identifier hs-var">substVarBndrUnchecked</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025025"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024998"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-758"></span><span>                             </span><span class="hs-special">(</span><span id="local-6989586621681024994"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024994"><span class="hs-identifier hs-var">subst'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681024993"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024993"><span class="hs-identifier hs-var">tv'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-759"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarBndr Var ArgFlag -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#ForAllTy"><span class="hs-identifier hs-var">ForAllTy</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024993"><span class="hs-identifier hs-var">tv'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621681024997"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span>
</span><span id="line-760"></span><span>                                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#subst_ty"><span class="hs-identifier hs-var">subst_ty</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024994"><span class="hs-identifier hs-var">subst'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024996"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-761"></span><span>    </span><span class="annot"><a href="#local-6989586621681025023"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-type">LitTy</span></a></span><span> </span><span id="local-6989586621681024991"><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621681024991"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#LitTy"><span class="hs-identifier hs-var">LitTy</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621681024991"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-762"></span><span>    </span><span class="annot"><a href="#local-6989586621681025023"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-identifier hs-type">CastTy</span></a></span><span> </span><span id="local-6989586621681024989"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024989"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681024988"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024988"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Coercion -&gt; Type
</span><a href="GHC.Core.Type.html#mkCastTy"><span class="hs-identifier hs-var">mkCastTy</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621681025023"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024989"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#subst_co"><span class="hs-identifier hs-var">subst_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025025"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024988"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>    </span><span class="annot"><a href="#local-6989586621681025023"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-type">CoercionTy</span></a></span><span> </span><span id="local-6989586621681024986"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024986"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#subst_co"><span class="hs-identifier hs-var">subst_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681025025"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024986"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-764"></span><span>
</span><span id="line-765"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVar"><span class="hs-identifier hs-type">substTyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-766"></span><span id="substTyVar"><span class="annot"><span class="annottext">substTyVar :: TCvSubst -&gt; Var -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyVar"><span class="hs-identifier hs-var hs-var">substTyVar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681024985"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024985"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681024984"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024984"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-767"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">tv</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-768"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; Maybe a
</span><a href="GHC.Types.Var.Env.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024985"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024984"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-769"></span><span>      </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681024982"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024982"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024982"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-770"></span><span>      </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024984"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-771"></span><span>
</span><span id="line-772"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVars"><span class="hs-identifier hs-type">substTyVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-773"></span><span id="substTyVars"><span class="annot"><span class="annottext">substTyVars :: TCvSubst -&gt; [Var] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Subst.html#substTyVars"><span class="hs-identifier hs-var hs-var">substTyVars</span></a></span></span><span> </span><span id="local-6989586621681024981"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024981"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyVar"><span class="hs-identifier hs-var">substTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024981"><span class="hs-identifier hs-var">subst</span></a></span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyCoVars"><span class="hs-identifier hs-type">substTyCoVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-776"></span><span id="substTyCoVars"><span class="annot"><span class="annottext">substTyCoVars :: TCvSubst -&gt; [Var] -&gt; [Type]
</span><a href="GHC.Core.TyCo.Subst.html#substTyCoVars"><span class="hs-identifier hs-var hs-var">substTyCoVars</span></a></span></span><span> </span><span id="local-6989586621681024980"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024980"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyCoVar"><span class="hs-identifier hs-var">substTyCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024980"><span class="hs-identifier hs-var">subst</span></a></span><span>
</span><span id="line-777"></span><span>
</span><span id="line-778"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyCoVar"><span class="hs-identifier hs-type">substTyCoVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-779"></span><span id="substTyCoVar"><span class="annot"><span class="annottext">substTyCoVar :: TCvSubst -&gt; Var -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyCoVar"><span class="hs-identifier hs-var hs-var">substTyCoVar</span></a></span></span><span> </span><span id="local-6989586621681024978"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024978"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681024977"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024977"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-780"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024977"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyVar"><span class="hs-identifier hs-var">substTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024978"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024977"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-781"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#CoercionTy"><span class="hs-identifier hs-var">CoercionTy</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#substCoVar"><span class="hs-identifier hs-var">substCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024978"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024977"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-782"></span><span>
</span><span id="line-783"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#lookupTyVar"><span class="hs-identifier hs-type">lookupTyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-784"></span><span>        </span><span class="hs-comment">-- See Note [Extending the TCvSubst]</span><span>
</span><span id="line-785"></span><span id="lookupTyVar"><span class="annot"><span class="annottext">lookupTyVar :: TCvSubst -&gt; Var -&gt; Maybe Type
</span><a href="GHC.Core.TyCo.Subst.html#lookupTyVar"><span class="hs-identifier hs-var hs-var">lookupTyVar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681024976"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024976"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681024975"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024975"><span class="hs-identifier hs-var">tv</span></a></span></span><span>
</span><span id="line-786"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">tv</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-787"></span><span>    </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; Maybe a
</span><a href="GHC.Types.Var.Env.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024976"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024975"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-788"></span><span>
</span><span id="line-789"></span><span class="hs-comment">-- | Substitute within a 'Coercion'</span><span>
</span><span id="line-790"></span><span class="hs-comment">-- The substitution has to satisfy the invariants described in</span><span>
</span><span id="line-791"></span><span class="hs-comment">-- Note [The substitution invariant].</span><span>
</span><span id="line-792"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCo"><span class="hs-identifier hs-type">substCo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Stack-Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-793"></span><span id="substCo"><span class="annot"><span class="annottext">substCo :: HasCallStack =&gt; TCvSubst -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#substCo"><span class="hs-identifier hs-var hs-var">substCo</span></a></span></span><span> </span><span id="local-6989586621681024971"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024971"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681024970"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024970"><span class="hs-identifier hs-var">co</span></a></span></span><span>
</span><span id="line-794"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#isEmptyTCvSubst"><span class="hs-identifier hs-var">isEmptyTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024971"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024970"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-795"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
HasCallStack =&gt;
TCvSubst -&gt; [Type] -&gt; [Coercion] -&gt; a -&gt; a
</span><a href="GHC.Core.TyCo.Subst.html#checkValidSubst"><span class="hs-identifier hs-var">checkValidSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024971"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024970"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#subst_co"><span class="hs-identifier hs-var">subst_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024971"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024970"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-796"></span><span>
</span><span id="line-797"></span><span class="hs-comment">-- | Substitute within a 'Coercion' disabling sanity checks.</span><span>
</span><span id="line-798"></span><span class="hs-comment">-- The problems that the sanity checks in substCo catch are described in</span><span>
</span><span id="line-799"></span><span class="hs-comment">-- Note [The substitution invariant].</span><span>
</span><span id="line-800"></span><span class="hs-comment">-- The goal of #11371 is to migrate all the calls of substCoUnchecked to</span><span>
</span><span id="line-801"></span><span class="hs-comment">-- substCo and remove this function. Please don't use in new code.</span><span>
</span><span id="line-802"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoUnchecked"><span class="hs-identifier hs-type">substCoUnchecked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-803"></span><span id="substCoUnchecked"><span class="annot"><span class="annottext">substCoUnchecked :: TCvSubst -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#substCoUnchecked"><span class="hs-identifier hs-var hs-var">substCoUnchecked</span></a></span></span><span> </span><span id="local-6989586621681024969"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024969"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681024968"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024968"><span class="hs-identifier hs-var">co</span></a></span></span><span>
</span><span id="line-804"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#isEmptyTCvSubst"><span class="hs-identifier hs-var">isEmptyTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024969"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024968"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-805"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#subst_co"><span class="hs-identifier hs-var">subst_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024969"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024968"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-806"></span><span>
</span><span id="line-807"></span><span class="hs-comment">-- | Substitute within several 'Coercion's</span><span>
</span><span id="line-808"></span><span class="hs-comment">-- The substitution has to satisfy the invariants described in</span><span>
</span><span id="line-809"></span><span class="hs-comment">-- Note [The substitution invariant].</span><span>
</span><span id="line-810"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCos"><span class="hs-identifier hs-type">substCos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Stack-Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-811"></span><span id="substCos"><span class="annot"><span class="annottext">substCos :: HasCallStack =&gt; TCvSubst -&gt; [Coercion] -&gt; [Coercion]
</span><a href="GHC.Core.TyCo.Subst.html#substCos"><span class="hs-identifier hs-var hs-var">substCos</span></a></span></span><span> </span><span id="local-6989586621681024964"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024964"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681024963"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681024963"><span class="hs-identifier hs-var">cos</span></a></span></span><span>
</span><span id="line-812"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Bool
</span><a href="GHC.Core.TyCo.Subst.html#isEmptyTCvSubst"><span class="hs-identifier hs-var">isEmptyTCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024964"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681024963"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-813"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
HasCallStack =&gt;
TCvSubst -&gt; [Type] -&gt; [Coercion] -&gt; a -&gt; a
</span><a href="GHC.Core.TyCo.Subst.html#checkValidSubst"><span class="hs-identifier hs-var">checkValidSubst</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024964"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681024963"><span class="hs-identifier hs-var">cos</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#subst_co"><span class="hs-identifier hs-var">subst_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024964"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681024963"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-814"></span><span>
</span><span id="line-815"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#subst_co"><span class="hs-identifier hs-type">subst_co</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-816"></span><span id="subst_co"><span class="annot"><span class="annottext">subst_co :: TCvSubst -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#subst_co"><span class="hs-identifier hs-var hs-var">subst_co</span></a></span></span><span> </span><span id="local-6989586621681024962"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024962"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681024961"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024961"><span class="hs-identifier hs-var">co</span></a></span></span><span>
</span><span id="line-817"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024961"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-818"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-819"></span><span>    </span><span class="annot"><a href="#local-6989586621681024959"><span class="hs-identifier hs-type">go_ty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-820"></span><span>    </span><span id="local-6989586621681024959"><span class="annot"><span class="annottext">go_ty :: Type -&gt; Type
</span><a href="#local-6989586621681024959"><span class="hs-identifier hs-var hs-var">go_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#subst_ty"><span class="hs-identifier hs-var">subst_ty</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024962"><span class="hs-identifier hs-var">subst</span></a></span><span>
</span><span id="line-821"></span><span>
</span><span id="line-822"></span><span>    </span><span class="annot"><a href="#local-6989586621681024958"><span class="hs-identifier hs-type">go_mco</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCoercion"><span class="hs-identifier hs-type">MCoercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCoercion"><span class="hs-identifier hs-type">MCoercion</span></a></span><span>
</span><span id="line-823"></span><span>    </span><span id="local-6989586621681024958"><span class="annot"><span class="annottext">go_mco :: MCoercion -&gt; MCoercion
</span><a href="#local-6989586621681024958"><span class="hs-identifier hs-var hs-var">go_mco</span></a></span></span><span> </span><span class="annot"><span class="annottext">MCoercion
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MCoercion
</span><a href="GHC.Core.TyCo.Rep.html#MRefl"><span class="hs-identifier hs-var">MRefl</span></a></span><span>
</span><span id="line-824"></span><span>    </span><span class="annot"><a href="#local-6989586621681024958"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-type">MCo</span></a></span><span> </span><span id="local-6989586621681024955"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024955"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; MCoercion
</span><a href="GHC.Core.TyCo.Rep.html#MCo"><span class="hs-identifier hs-var">MCo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024955"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-825"></span><span>
</span><span id="line-826"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-827"></span><span>    </span><span id="local-6989586621681024960"><span class="annot"><span class="annottext">go :: Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Refl"><span class="hs-identifier hs-type">Refl</span></a></span><span> </span><span id="local-6989586621681024953"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024953"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkNomReflCo"><span class="hs-identifier hs-var">mkNomReflCo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621681024959"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024953"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-828"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#GRefl"><span class="hs-identifier hs-type">GRefl</span></a></span><span> </span><span id="local-6989586621681024951"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681024951"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681024950"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024950"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681024949"><span class="annot"><span class="annottext">MCoercion
</span><a href="#local-6989586621681024949"><span class="hs-identifier hs-var">mco</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role -&gt; Type -&gt; MCoercion -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkGReflCo"><span class="hs-identifier hs-var">mkGReflCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681024951"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621681024959"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024950"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MCoercion -&gt; MCoercion
</span><a href="#local-6989586621681024958"><span class="hs-identifier hs-var">go_mco</span></a></span><span> </span><span class="annot"><span class="annottext">MCoercion
</span><a href="#local-6989586621681024949"><span class="hs-identifier hs-var">mco</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-829"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyConAppCo"><span class="hs-identifier hs-type">TyConAppCo</span></a></span><span> </span><span id="local-6989586621681024947"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681024947"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681024946"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681024946"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621681024945"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681024945"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681024944"><span class="annot"><span class="annottext">args' :: [Coercion]
</span><a href="#local-6989586621681024944"><span class="hs-identifier hs-var hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681024945"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-830"></span><span>                               </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681024944"><span class="hs-identifier hs-var">args'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; b -&gt; b
</span><a href="GHC.Utils.Misc.html#seqList"><span class="hs-operator hs-var">`seqList`</span></a></span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Role -&gt; TyCon -&gt; [Coercion] -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkTyConAppCo"><span class="hs-identifier hs-var">mkTyConAppCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681024947"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681024946"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681024944"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-831"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AppCo"><span class="hs-identifier hs-type">AppCo</span></a></span><span> </span><span id="local-6989586621681024941"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024941"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621681024940"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024940"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkAppCo"><span class="hs-identifier hs-var">mkAppCo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024941"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024940"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-832"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ForAllCo"><span class="hs-identifier hs-type">ForAllCo</span></a></span><span> </span><span id="local-6989586621681024938"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024938"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621681024937"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024937"><span class="hs-identifier hs-var">kind_co</span></a></span></span><span> </span><span id="local-6989586621681024936"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024936"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-833"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Coercion -&gt; (TCvSubst, Var, Coercion)
</span><a href="GHC.Core.TyCo.Subst.html#substForAllCoBndrUnchecked"><span class="hs-identifier hs-var">substForAllCoBndrUnchecked</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024962"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024938"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024937"><span class="hs-identifier hs-var">kind_co</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-834"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621681024934"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024934"><span class="hs-identifier hs-var">subst'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681024933"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024933"><span class="hs-identifier hs-var">tv'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681024932"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024932"><span class="hs-identifier hs-var">kind_co'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-835"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Coercion -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkForAllCo"><span class="hs-identifier hs-var">mkForAllCo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024933"><span class="hs-identifier hs-var">tv'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024932"><span class="hs-identifier hs-var">kind_co'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#subst_co"><span class="hs-identifier hs-var">subst_co</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024934"><span class="hs-identifier hs-var">subst'</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024936"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-836"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#FunCo"><span class="hs-identifier hs-type">FunCo</span></a></span><span> </span><span id="local-6989586621681024930"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681024930"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681024929"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024929"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621681024928"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024928"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621681024927"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024927"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role -&gt; Coercion -&gt; Coercion -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkFunCo"><span class="hs-identifier hs-var">mkFunCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681024930"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024929"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024928"><span class="hs-identifier hs-var">co1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024927"><span class="hs-identifier hs-var">co2</span></a></span><span>
</span><span id="line-837"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-type">CoVarCo</span></a></span><span> </span><span id="local-6989586621681024925"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024925"><span class="hs-identifier hs-var">cv</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#substCoVar"><span class="hs-identifier hs-var">substCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024962"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024925"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-838"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomInstCo"><span class="hs-identifier hs-type">AxiomInstCo</span></a></span><span> </span><span id="local-6989586621681024923"><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621681024923"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621681024922"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681024922"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621681024921"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681024921"><span class="hs-identifier hs-var">cos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched -&gt; Int -&gt; [Coercion] -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkAxiomInstCo"><span class="hs-identifier hs-var">mkAxiomInstCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiom Branched
</span><a href="#local-6989586621681024923"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681024922"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681024921"><span class="hs-identifier hs-var">cos</span></a></span><span>
</span><span id="line-839"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#UnivCo"><span class="hs-identifier hs-type">UnivCo</span></a></span><span> </span><span id="local-6989586621681024919"><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621681024919"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681024918"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681024918"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681024917"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024917"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621681024916"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024916"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnivCoProvenance -&gt; Role -&gt; Type -&gt; Type -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkUnivCo"><span class="hs-identifier hs-var">mkUnivCo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance -&gt; UnivCoProvenance
</span><a href="#local-6989586621681024915"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621681024919"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681024918"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span>
</span><span id="line-840"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621681024959"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024917"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621681024959"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024916"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-841"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SymCo"><span class="hs-identifier hs-type">SymCo</span></a></span><span> </span><span id="local-6989586621681024913"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024913"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkSymCo"><span class="hs-identifier hs-var">mkSymCo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024913"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-842"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TransCo"><span class="hs-identifier hs-type">TransCo</span></a></span><span> </span><span id="local-6989586621681024911"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024911"><span class="hs-identifier hs-var">co1</span></a></span></span><span> </span><span id="local-6989586621681024910"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024910"><span class="hs-identifier hs-var">co2</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkTransCo"><span class="hs-identifier hs-var">mkTransCo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024911"><span class="hs-identifier hs-var">co1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024910"><span class="hs-identifier hs-var">co2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-843"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#NthCo"><span class="hs-identifier hs-type">NthCo</span></a></span><span> </span><span id="local-6989586621681024908"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681024908"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681024907"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681024907"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621681024906"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024906"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Role -&gt; Int -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkNthCo"><span class="hs-identifier hs-var">mkNthCo</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681024908"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681024907"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024906"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-844"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#LRCo"><span class="hs-identifier hs-type">LRCo</span></a></span><span> </span><span id="local-6989586621681024904"><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621681024904"><span class="hs-identifier hs-var">lr</span></a></span></span><span> </span><span id="local-6989586621681024903"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024903"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LeftOrRight -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkLRCo"><span class="hs-identifier hs-var">mkLRCo</span></a></span><span> </span><span class="annot"><span class="annottext">LeftOrRight
</span><a href="#local-6989586621681024904"><span class="hs-identifier hs-var">lr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024903"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-845"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#InstCo"><span class="hs-identifier hs-type">InstCo</span></a></span><span> </span><span id="local-6989586621681024901"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024901"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621681024900"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024900"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkInstCo"><span class="hs-identifier hs-var">mkInstCo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024901"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024900"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-846"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCo"><span class="hs-identifier hs-type">KindCo</span></a></span><span> </span><span id="local-6989586621681024898"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024898"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkKindCo"><span class="hs-identifier hs-var">mkKindCo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024898"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-847"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#SubCo"><span class="hs-identifier hs-type">SubCo</span></a></span><span> </span><span id="local-6989586621681024896"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024896"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkSubCo"><span class="hs-identifier hs-var">mkSubCo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024896"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-848"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#AxiomRuleCo"><span class="hs-identifier hs-type">AxiomRuleCo</span></a></span><span> </span><span id="local-6989586621681024894"><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621681024894"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621681024893"><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681024893"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681024892"><span class="annot"><span class="annottext">cs1 :: [Coercion]
</span><a href="#local-6989586621681024892"><span class="hs-identifier hs-var hs-var">cs1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681024893"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-849"></span><span>                                </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681024892"><span class="hs-identifier hs-var">cs1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; b -&gt; b
</span><a href="GHC.Utils.Misc.html#seqList"><span class="hs-operator hs-var">`seqList`</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiomRule -&gt; [Coercion] -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#AxiomRuleCo"><span class="hs-identifier hs-var">AxiomRuleCo</span></a></span><span> </span><span class="annot"><span class="annottext">CoAxiomRule
</span><a href="#local-6989586621681024894"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[Coercion]
</span><a href="#local-6989586621681024892"><span class="hs-identifier hs-var">cs1</span></a></span><span>
</span><span id="line-850"></span><span>    </span><span class="annot"><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#HoleCo"><span class="hs-identifier hs-type">HoleCo</span></a></span><span> </span><span id="local-6989586621681024890"><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621681024890"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoercionHole -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#HoleCo"><span class="hs-identifier hs-var">HoleCo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole -&gt; CoercionHole
</span><a href="#local-6989586621681024889"><span class="hs-identifier hs-var">go_hole</span></a></span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621681024890"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-851"></span><span>
</span><span id="line-852"></span><span>    </span><span id="local-6989586621681024915"><span class="annot"><span class="annottext">go_prov :: UnivCoProvenance -&gt; UnivCoProvenance
</span><a href="#local-6989586621681024915"><span class="hs-identifier hs-var hs-var">go_prov</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PhantomProv"><span class="hs-identifier hs-type">PhantomProv</span></a></span><span> </span><span id="local-6989586621681024887"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024887"><span class="hs-identifier hs-var">kco</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#PhantomProv"><span class="hs-identifier hs-var">PhantomProv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024887"><span class="hs-identifier hs-var">kco</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-853"></span><span>    </span><span class="annot"><a href="#local-6989586621681024915"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#ProofIrrelProv"><span class="hs-identifier hs-type">ProofIrrelProv</span></a></span><span> </span><span id="local-6989586621681024885"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024885"><span class="hs-identifier hs-var">kco</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; UnivCoProvenance
</span><a href="GHC.Core.TyCo.Rep.html#ProofIrrelProv"><span class="hs-identifier hs-var">ProofIrrelProv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024960"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024885"><span class="hs-identifier hs-var">kco</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-854"></span><span>    </span><span class="annot"><a href="#local-6989586621681024915"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span id="local-6989586621681024884"><span class="annot"><span class="annottext">p :: UnivCoProvenance
</span><a href="#local-6989586621681024884"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#PluginProv"><span class="hs-identifier hs-type">PluginProv</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621681024884"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-855"></span><span>    </span><span class="annot"><a href="#local-6989586621681024915"><span class="hs-identifier hs-var">go_prov</span></a></span><span> </span><span id="local-6989586621681024882"><span class="annot"><span class="annottext">p :: UnivCoProvenance
</span><a href="#local-6989586621681024882"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CorePrepProv"><span class="hs-identifier hs-type">CorePrepProv</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnivCoProvenance
</span><a href="#local-6989586621681024882"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-856"></span><span>
</span><span id="line-857"></span><span>    </span><span class="hs-comment">-- See Note [Substituting in a coercion hole]</span><span>
</span><span id="line-858"></span><span>    </span><span id="local-6989586621681024889"><span class="annot"><span class="annottext">go_hole :: CoercionHole -&gt; CoercionHole
</span><a href="#local-6989586621681024889"><span class="hs-identifier hs-var hs-var">go_hole</span></a></span></span><span> </span><span id="local-6989586621681024880"><span class="annot"><span class="annottext">h :: CoercionHole
</span><a href="#local-6989586621681024880"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#CoercionHole"><span class="hs-identifier hs-type">CoercionHole</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ch_co_var :: CoercionHole -&gt; Var
</span><a href="GHC.Core.TyCo.Rep.html#ch_co_var"><span class="hs-identifier hs-var">ch_co_var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681024877"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024877"><span class="hs-identifier hs-var">cv</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-859"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoercionHole
</span><a href="#local-6989586621681024880"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ch_co_var :: Var
</span><a href="GHC.Core.TyCo.Rep.html#ch_co_var"><span class="hs-identifier hs-var">ch_co_var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Var -&gt; Var
</span><a href="GHC.Types.Var.html#updateVarType"><span class="hs-identifier hs-var">updateVarType</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621681024959"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024877"><span class="hs-identifier hs-var">cv</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-860"></span><span>
</span><span id="line-861"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substForAllCoBndr"><span class="hs-identifier hs-type">substForAllCoBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCoercion"><span class="hs-identifier hs-type">KindCoercion</span></a></span><span>
</span><span id="line-862"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-863"></span><span id="substForAllCoBndr"><span class="annot"><span class="annottext">substForAllCoBndr :: TCvSubst -&gt; Var -&gt; Coercion -&gt; (TCvSubst, Var, Coercion)
</span><a href="GHC.Core.TyCo.Subst.html#substForAllCoBndr"><span class="hs-identifier hs-var hs-var">substForAllCoBndr</span></a></span></span><span> </span><span id="local-6989586621681024874"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024874"><span class="hs-identifier hs-var">subst</span></a></span></span><span>
</span><span id="line-864"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (Coercion -&gt; Coercion)
-&gt; TCvSubst
-&gt; Var
-&gt; Coercion
-&gt; (TCvSubst, Var, Coercion)
</span><a href="GHC.Core.TyCo.Subst.html#substForAllCoBndrUsing"><span class="hs-identifier hs-var">substForAllCoBndrUsing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#substCo"><span class="hs-identifier hs-var">substCo</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024874"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024874"><span class="hs-identifier hs-var">subst</span></a></span><span>
</span><span id="line-865"></span><span>
</span><span id="line-866"></span><span class="hs-comment">-- | Like 'substForAllCoBndr', but disables sanity checks.</span><span>
</span><span id="line-867"></span><span class="hs-comment">-- The problems that the sanity checks in substCo catch are described in</span><span>
</span><span id="line-868"></span><span class="hs-comment">-- Note [The substitution invariant].</span><span>
</span><span id="line-869"></span><span class="hs-comment">-- The goal of #11371 is to migrate all the calls of substCoUnchecked to</span><span>
</span><span id="line-870"></span><span class="hs-comment">-- substCo and remove this function. Please don't use in new code.</span><span>
</span><span id="line-871"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substForAllCoBndrUnchecked"><span class="hs-identifier hs-type">substForAllCoBndrUnchecked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCoercion"><span class="hs-identifier hs-type">KindCoercion</span></a></span><span>
</span><span id="line-872"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-873"></span><span id="substForAllCoBndrUnchecked"><span class="annot"><span class="annottext">substForAllCoBndrUnchecked :: TCvSubst -&gt; Var -&gt; Coercion -&gt; (TCvSubst, Var, Coercion)
</span><a href="GHC.Core.TyCo.Subst.html#substForAllCoBndrUnchecked"><span class="hs-identifier hs-var hs-var">substForAllCoBndrUnchecked</span></a></span></span><span> </span><span id="local-6989586621681024873"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024873"><span class="hs-identifier hs-var">subst</span></a></span></span><span>
</span><span id="line-874"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (Coercion -&gt; Coercion)
-&gt; TCvSubst
-&gt; Var
-&gt; Coercion
-&gt; (TCvSubst, Var, Coercion)
</span><a href="GHC.Core.TyCo.Subst.html#substForAllCoBndrUsing"><span class="hs-identifier hs-var">substForAllCoBndrUsing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Coercion -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#substCoUnchecked"><span class="hs-identifier hs-var">substCoUnchecked</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024873"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024873"><span class="hs-identifier hs-var">subst</span></a></span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span class="hs-comment">-- See Note [Sym and ForAllCo]</span><span>
</span><span id="line-877"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substForAllCoBndrUsing"><span class="hs-identifier hs-type">substForAllCoBndrUsing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="hs-comment">-- apply sym to binder?</span><span>
</span><span id="line-878"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- transformation to kind co</span><span>
</span><span id="line-879"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCoercion"><span class="hs-identifier hs-type">KindCoercion</span></a></span><span>
</span><span id="line-880"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCoercion"><span class="hs-identifier hs-type">KindCoercion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-881"></span><span id="substForAllCoBndrUsing"><span class="annot"><span class="annottext">substForAllCoBndrUsing :: Bool
-&gt; (Coercion -&gt; Coercion)
-&gt; TCvSubst
-&gt; Var
-&gt; Coercion
-&gt; (TCvSubst, Var, Coercion)
</span><a href="GHC.Core.TyCo.Subst.html#substForAllCoBndrUsing"><span class="hs-identifier hs-var hs-var">substForAllCoBndrUsing</span></a></span></span><span> </span><span id="local-6989586621681024872"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024872"><span class="hs-identifier hs-var">sym</span></a></span></span><span> </span><span id="local-6989586621681024871"><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024871"><span class="hs-identifier hs-var">sco</span></a></span></span><span> </span><span id="local-6989586621681024870"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024870"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681024869"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024869"><span class="hs-identifier hs-var">old_var</span></a></span></span><span>
</span><span id="line-882"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024869"><span class="hs-identifier hs-var">old_var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (Coercion -&gt; Coercion)
-&gt; TCvSubst
-&gt; Var
-&gt; Coercion
-&gt; (TCvSubst, Var, Coercion)
</span><a href="GHC.Core.TyCo.Subst.html#substForAllCoTyVarBndrUsing"><span class="hs-identifier hs-var">substForAllCoTyVarBndrUsing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024872"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024871"><span class="hs-identifier hs-var">sco</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024870"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024869"><span class="hs-identifier hs-var">old_var</span></a></span><span>
</span><span id="line-883"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (Coercion -&gt; Coercion)
-&gt; TCvSubst
-&gt; Var
-&gt; Coercion
-&gt; (TCvSubst, Var, Coercion)
</span><a href="GHC.Core.TyCo.Subst.html#substForAllCoCoVarBndrUsing"><span class="hs-identifier hs-var">substForAllCoCoVarBndrUsing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024872"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024871"><span class="hs-identifier hs-var">sco</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024870"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024869"><span class="hs-identifier hs-var">old_var</span></a></span><span>
</span><span id="line-884"></span><span>
</span><span id="line-885"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substForAllCoTyVarBndrUsing"><span class="hs-identifier hs-type">substForAllCoTyVarBndrUsing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="hs-comment">-- apply sym to binder?</span><span>
</span><span id="line-886"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- transformation to kind co</span><span>
</span><span id="line-887"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCoercion"><span class="hs-identifier hs-type">KindCoercion</span></a></span><span>
</span><span id="line-888"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCoercion"><span class="hs-identifier hs-type">KindCoercion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-889"></span><span id="substForAllCoTyVarBndrUsing"><span class="annot"><span class="annottext">substForAllCoTyVarBndrUsing :: Bool
-&gt; (Coercion -&gt; Coercion)
-&gt; TCvSubst
-&gt; Var
-&gt; Coercion
-&gt; (TCvSubst, Var, Coercion)
</span><a href="GHC.Core.TyCo.Subst.html#substForAllCoTyVarBndrUsing"><span class="hs-identifier hs-var hs-var">substForAllCoTyVarBndrUsing</span></a></span></span><span> </span><span id="local-6989586621681024866"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024866"><span class="hs-identifier hs-var">sym</span></a></span></span><span> </span><span id="local-6989586621681024865"><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024865"><span class="hs-identifier hs-var">sco</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681024864"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681024864"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681024863"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024863"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681024862"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024862"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681024861"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024861"><span class="hs-identifier hs-var">old_var</span></a></span></span><span> </span><span id="local-6989586621681024860"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024860"><span class="hs-identifier hs-var">old_kind_co</span></a></span></span><span>
</span><span id="line-890"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">old_var</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-891"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681024864"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; Var -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#extendInScopeSet"><span class="hs-operator hs-var">`extendInScopeSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024859"><span class="hs-identifier hs-var">new_var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024858"><span class="hs-identifier hs-var">new_env</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024862"><span class="hs-identifier hs-var">cenv</span></a></span><span>
</span><span id="line-892"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024859"><span class="hs-identifier hs-var">new_var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024857"><span class="hs-identifier hs-var">new_kind_co</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-893"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-894"></span><span>    </span><span id="local-6989586621681024858"><span class="annot"><span class="annottext">new_env :: TvSubstEnv
</span><a href="#local-6989586621681024858"><span class="hs-identifier hs-var hs-var">new_env</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024856"><span class="hs-identifier hs-var">no_change</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024866"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#delVarEnv"><span class="hs-identifier hs-var">delVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024863"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024861"><span class="hs-identifier hs-var">old_var</span></a></span><span>
</span><span id="line-895"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024866"><span class="hs-identifier hs-var">sym</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024863"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024861"><span class="hs-identifier hs-var">old_var</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-896"></span><span>                          </span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024859"><span class="hs-identifier hs-var">new_var</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Coercion -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#CastTy"><span class="hs-operator hs-var">`CastTy`</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024857"><span class="hs-identifier hs-var">new_kind_co</span></a></span><span>
</span><span id="line-897"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024863"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024861"><span class="hs-identifier hs-var">old_var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024859"><span class="hs-identifier hs-var">new_var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span>    </span><span id="local-6989586621681024854"><span class="annot"><span class="annottext">no_kind_change :: Bool
</span><a href="#local-6989586621681024854"><span class="hs-identifier hs-var hs-var">no_kind_change</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Bool
</span><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfCo"><span class="hs-identifier hs-var">noFreeVarsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024860"><span class="hs-identifier hs-var">old_kind_co</span></a></span><span>
</span><span id="line-900"></span><span>    </span><span id="local-6989586621681024856"><span class="annot"><span class="annottext">no_change :: Bool
</span><a href="#local-6989586621681024856"><span class="hs-identifier hs-var hs-var">no_change</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024854"><span class="hs-identifier hs-var">no_kind_change</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024859"><span class="hs-identifier hs-var">new_var</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024861"><span class="hs-identifier hs-var">old_var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-901"></span><span>
</span><span id="line-902"></span><span>    </span><span id="local-6989586621681024857"><span class="annot"><span class="annottext">new_kind_co :: Coercion
</span><a href="#local-6989586621681024857"><span class="hs-identifier hs-var hs-var">new_kind_co</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024854"><span class="hs-identifier hs-var">no_kind_change</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024860"><span class="hs-identifier hs-var">old_kind_co</span></a></span><span>
</span><span id="line-903"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024865"><span class="hs-identifier hs-var">sco</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024860"><span class="hs-identifier hs-var">old_kind_co</span></a></span><span>
</span><span id="line-904"></span><span>
</span><span id="line-905"></span><span>    </span><span id="local-6989586621681024852"><span class="annot"><span class="annottext">new_ki1 :: Type
</span><a href="#local-6989586621681024852"><span class="hs-identifier hs-var hs-var">new_ki1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Type
</span><a href="GHC.Core.Coercion.html#coercionLKind"><span class="hs-identifier hs-var">coercionLKind</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024857"><span class="hs-identifier hs-var">new_kind_co</span></a></span><span>
</span><span id="line-906"></span><span>    </span><span class="hs-comment">-- We could do substitution to (tyVarKind old_var). We don't do so because</span><span>
</span><span id="line-907"></span><span>    </span><span class="hs-comment">-- we already substituted new_kind_co, which contains the kind information</span><span>
</span><span id="line-908"></span><span>    </span><span class="hs-comment">-- we want. We don't want to do substitution once more. Also, in most cases,</span><span>
</span><span id="line-909"></span><span>    </span><span class="hs-comment">-- new_kind_co is a Refl, in which case coercionKind is really fast.</span><span>
</span><span id="line-910"></span><span>
</span><span id="line-911"></span><span>    </span><span id="local-6989586621681024859"><span class="annot"><span class="annottext">new_var :: Var
</span><a href="#local-6989586621681024859"><span class="hs-identifier hs-var hs-var">new_var</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; Var -&gt; Var
</span><a href="GHC.Types.Var.Env.html#uniqAway"><span class="hs-identifier hs-var">uniqAway</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681024864"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type -&gt; Var
</span><a href="GHC.Types.Var.html#setTyVarKind"><span class="hs-identifier hs-var">setTyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024861"><span class="hs-identifier hs-var">old_var</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024852"><span class="hs-identifier hs-var">new_ki1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-912"></span><span>
</span><span id="line-913"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substForAllCoCoVarBndrUsing"><span class="hs-identifier hs-type">substForAllCoCoVarBndrUsing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="hs-comment">-- apply sym to binder?</span><span>
</span><span id="line-914"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- transformation to kind co</span><span>
</span><span id="line-915"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCoercion"><span class="hs-identifier hs-type">KindCoercion</span></a></span><span>
</span><span id="line-916"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#KindCoercion"><span class="hs-identifier hs-type">KindCoercion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-917"></span><span id="substForAllCoCoVarBndrUsing"><span class="annot"><span class="annottext">substForAllCoCoVarBndrUsing :: Bool
-&gt; (Coercion -&gt; Coercion)
-&gt; TCvSubst
-&gt; Var
-&gt; Coercion
-&gt; (TCvSubst, Var, Coercion)
</span><a href="GHC.Core.TyCo.Subst.html#substForAllCoCoVarBndrUsing"><span class="hs-identifier hs-var hs-var">substForAllCoCoVarBndrUsing</span></a></span></span><span> </span><span id="local-6989586621681024849"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024849"><span class="hs-identifier hs-var">sym</span></a></span></span><span> </span><span id="local-6989586621681024848"><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024848"><span class="hs-identifier hs-var">sco</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681024847"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681024847"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681024846"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024846"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681024845"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024845"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-918"></span><span>                            </span><span id="local-6989586621681024844"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024844"><span class="hs-identifier hs-var">old_var</span></a></span></span><span> </span><span id="local-6989586621681024843"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024843"><span class="hs-identifier hs-var">old_kind_co</span></a></span></span><span>
</span><span id="line-919"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isCoVar</span><span> </span><span class="hs-identifier">old_var</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-920"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681024847"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; Var -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#extendInScopeSet"><span class="hs-operator hs-var">`extendInScopeSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024842"><span class="hs-identifier hs-var">new_var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024846"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024841"><span class="hs-identifier hs-var">new_cenv</span></a></span><span>
</span><span id="line-921"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024842"><span class="hs-identifier hs-var">new_var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024840"><span class="hs-identifier hs-var">new_kind_co</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-922"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-923"></span><span>    </span><span id="local-6989586621681024841"><span class="annot"><span class="annottext">new_cenv :: CvSubstEnv
</span><a href="#local-6989586621681024841"><span class="hs-identifier hs-var hs-var">new_cenv</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024839"><span class="hs-identifier hs-var">no_change</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024849"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#delVarEnv"><span class="hs-identifier hs-var">delVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024845"><span class="hs-identifier hs-var">cenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024844"><span class="hs-identifier hs-var">old_var</span></a></span><span>
</span><span id="line-924"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024845"><span class="hs-identifier hs-var">cenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024844"><span class="hs-identifier hs-var">old_var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkCoVarCo"><span class="hs-identifier hs-var">mkCoVarCo</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024842"><span class="hs-identifier hs-var">new_var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-925"></span><span>
</span><span id="line-926"></span><span>    </span><span id="local-6989586621681024838"><span class="annot"><span class="annottext">no_kind_change :: Bool
</span><a href="#local-6989586621681024838"><span class="hs-identifier hs-var hs-var">no_kind_change</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Bool
</span><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfCo"><span class="hs-identifier hs-var">noFreeVarsOfCo</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024843"><span class="hs-identifier hs-var">old_kind_co</span></a></span><span>
</span><span id="line-927"></span><span>    </span><span id="local-6989586621681024839"><span class="annot"><span class="annottext">no_change :: Bool
</span><a href="#local-6989586621681024839"><span class="hs-identifier hs-var hs-var">no_change</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024838"><span class="hs-identifier hs-var">no_kind_change</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024842"><span class="hs-identifier hs-var">new_var</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024844"><span class="hs-identifier hs-var">old_var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-928"></span><span>
</span><span id="line-929"></span><span>    </span><span id="local-6989586621681024840"><span class="annot"><span class="annottext">new_kind_co :: Coercion
</span><a href="#local-6989586621681024840"><span class="hs-identifier hs-var hs-var">new_kind_co</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024838"><span class="hs-identifier hs-var">no_kind_change</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024843"><span class="hs-identifier hs-var">old_kind_co</span></a></span><span>
</span><span id="line-930"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Coercion
</span><a href="#local-6989586621681024848"><span class="hs-identifier hs-var">sco</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024843"><span class="hs-identifier hs-var">old_kind_co</span></a></span><span>
</span><span id="line-931"></span><span>
</span><span id="line-932"></span><span>    </span><span class="annot"><a href="GHC.Data.Pair.html#Pair"><span class="hs-identifier hs-type">Pair</span></a></span><span> </span><span id="local-6989586621681024836"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024836"><span class="hs-identifier hs-var">h1</span></a></span></span><span> </span><span id="local-6989586621681024835"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024835"><span class="hs-identifier hs-var">h2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coercion -&gt; Pair Type
</span><a href="GHC.Core.Coercion.html#coercionKind"><span class="hs-identifier hs-var">coercionKind</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024840"><span class="hs-identifier hs-var">new_kind_co</span></a></span><span>
</span><span id="line-933"></span><span>
</span><span id="line-934"></span><span>    </span><span id="local-6989586621681024842"><span class="annot"><span class="annottext">new_var :: Var
</span><a href="#local-6989586621681024842"><span class="hs-identifier hs-var hs-var">new_var</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; Var -&gt; Var
</span><a href="GHC.Types.Var.Env.html#uniqAway"><span class="hs-identifier hs-var">uniqAway</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681024847"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Var
</span><a href="GHC.Types.Var.html#mkCoVar"><span class="hs-identifier hs-var">mkCoVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Name
</span><a href="GHC.Types.Var.html#varName"><span class="hs-identifier hs-var">varName</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024844"><span class="hs-identifier hs-var">old_var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024832"><span class="hs-identifier hs-var">new_var_type</span></a></span><span>
</span><span id="line-935"></span><span>    </span><span id="local-6989586621681024832"><span class="annot"><span class="annottext">new_var_type :: Type
</span><a href="#local-6989586621681024832"><span class="hs-identifier hs-var hs-var">new_var_type</span></a></span></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024849"><span class="hs-identifier hs-var">sym</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024835"><span class="hs-identifier hs-var">h2</span></a></span><span>
</span><span id="line-936"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024836"><span class="hs-identifier hs-var">h1</span></a></span><span>
</span><span id="line-937"></span><span>
</span><span id="line-938"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoVar"><span class="hs-identifier hs-type">substCoVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-939"></span><span id="substCoVar"><span class="annot"><span class="annottext">substCoVar :: TCvSubst -&gt; Var -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#substCoVar"><span class="hs-identifier hs-var hs-var">substCoVar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681024831"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024831"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681024830"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024830"><span class="hs-identifier hs-var">cv</span></a></span></span><span>
</span><span id="line-940"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; Maybe a
</span><a href="GHC.Types.Var.Env.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024831"><span class="hs-identifier hs-var">cenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024830"><span class="hs-identifier hs-var">cv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-941"></span><span>      </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681024829"><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024829"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024829"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-942"></span><span>      </span><span class="annot"><span class="annottext">Maybe Coercion
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Coercion
</span><a href="GHC.Core.TyCo.Rep.html#CoVarCo"><span class="hs-identifier hs-var">CoVarCo</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024830"><span class="hs-identifier hs-var">cv</span></a></span><span>
</span><span id="line-943"></span><span>
</span><span id="line-944"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoVars"><span class="hs-identifier hs-type">substCoVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-945"></span><span id="substCoVars"><span class="annot"><span class="annottext">substCoVars :: TCvSubst -&gt; [Var] -&gt; [Coercion]
</span><a href="GHC.Core.TyCo.Subst.html#substCoVars"><span class="hs-identifier hs-var hs-var">substCoVars</span></a></span></span><span> </span><span id="local-6989586621681024828"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024828"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681024827"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681024827"><span class="hs-identifier hs-var">cvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Coercion
</span><a href="GHC.Core.TyCo.Subst.html#substCoVar"><span class="hs-identifier hs-var">substCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024828"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681024827"><span class="hs-identifier hs-var">cvs</span></a></span><span>
</span><span id="line-946"></span><span>
</span><span id="line-947"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#lookupCoVar"><span class="hs-identifier hs-type">lookupCoVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Coercion"><span class="hs-identifier hs-type">Coercion</span></a></span><span>
</span><span id="line-948"></span><span id="lookupCoVar"><span class="annot"><span class="annottext">lookupCoVar :: TCvSubst -&gt; Var -&gt; Maybe Coercion
</span><a href="GHC.Core.TyCo.Subst.html#lookupCoVar"><span class="hs-identifier hs-var hs-var">lookupCoVar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681024826"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024826"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681024825"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024825"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; Maybe a
</span><a href="GHC.Types.Var.Env.html#lookupVarEnv"><span class="hs-identifier hs-var">lookupVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024826"><span class="hs-identifier hs-var">cenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024825"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-949"></span><span>
</span><span id="line-950"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVarBndr"><span class="hs-identifier hs-type">substTyVarBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Stack-Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-951"></span><span id="substTyVarBndr"><span class="annot"><span class="annottext">substTyVarBndr :: HasCallStack =&gt; TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substTyVarBndr"><span class="hs-identifier hs-var hs-var">substTyVarBndr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCvSubst -&gt; Type -&gt; Type) -&gt; TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substTyVarBndrUsing"><span class="hs-identifier hs-var">substTyVarBndrUsing</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span>
</span><span id="line-952"></span><span>
</span><span id="line-953"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVarBndrs"><span class="hs-identifier hs-type">substTyVarBndrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Stack-Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-954"></span><span id="substTyVarBndrs"><span class="annot"><span class="annottext">substTyVarBndrs :: HasCallStack =&gt; TCvSubst -&gt; [Var] -&gt; (TCvSubst, [Var])
</span><a href="GHC.Core.TyCo.Subst.html#substTyVarBndrs"><span class="hs-identifier hs-var hs-var">substTyVarBndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) s a b.
Traversable t =&gt;
(s -&gt; a -&gt; (s, b)) -&gt; s -&gt; t a -&gt; (s, t b)
</span><a href="../../base-4.16.4.0/src/Data-Traversable.html#mapAccumL"><span class="hs-identifier hs-var">mapAccumL</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substTyVarBndr"><span class="hs-identifier hs-var">substTyVarBndr</span></a></span><span>
</span><span id="line-955"></span><span>
</span><span id="line-956"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substVarBndr"><span class="hs-identifier hs-type">substVarBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Stack-Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-957"></span><span id="substVarBndr"><span class="annot"><span class="annottext">substVarBndr :: HasCallStack =&gt; TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substVarBndr"><span class="hs-identifier hs-var hs-var">substVarBndr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCvSubst -&gt; Type -&gt; Type) -&gt; TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substVarBndrUsing"><span class="hs-identifier hs-var">substVarBndrUsing</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span>
</span><span id="line-958"></span><span>
</span><span id="line-959"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substVarBndrs"><span class="hs-identifier hs-type">substVarBndrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Stack-Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-960"></span><span id="substVarBndrs"><span class="annot"><span class="annottext">substVarBndrs :: HasCallStack =&gt; TCvSubst -&gt; [Var] -&gt; (TCvSubst, [Var])
</span><a href="GHC.Core.TyCo.Subst.html#substVarBndrs"><span class="hs-identifier hs-var hs-var">substVarBndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) s a b.
Traversable t =&gt;
(s -&gt; a -&gt; (s, b)) -&gt; s -&gt; t a -&gt; (s, t b)
</span><a href="../../base-4.16.4.0/src/Data-Traversable.html#mapAccumL"><span class="hs-identifier hs-var">mapAccumL</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substVarBndr"><span class="hs-identifier hs-var">substVarBndr</span></a></span><span>
</span><span id="line-961"></span><span>
</span><span id="line-962"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoVarBndr"><span class="hs-identifier hs-type">substCoVarBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Stack-Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-963"></span><span id="substCoVarBndr"><span class="annot"><span class="annottext">substCoVarBndr :: HasCallStack =&gt; TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substCoVarBndr"><span class="hs-identifier hs-var hs-var">substCoVarBndr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCvSubst -&gt; Type -&gt; Type) -&gt; TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substCoVarBndrUsing"><span class="hs-identifier hs-var">substCoVarBndrUsing</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span>
</span><span id="line-964"></span><span>
</span><span id="line-965"></span><span class="hs-comment">-- | Like 'substVarBndr', but disables sanity checks.</span><span>
</span><span id="line-966"></span><span class="hs-comment">-- The problems that the sanity checks in substTy catch are described in</span><span>
</span><span id="line-967"></span><span class="hs-comment">-- Note [The substitution invariant].</span><span>
</span><span id="line-968"></span><span class="hs-comment">-- The goal of #11371 is to migrate all the calls of substTyUnchecked to</span><span>
</span><span id="line-969"></span><span class="hs-comment">-- substTy and remove this function. Please don't use in new code.</span><span>
</span><span id="line-970"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substVarBndrUnchecked"><span class="hs-identifier hs-type">substVarBndrUnchecked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-971"></span><span id="substVarBndrUnchecked"><span class="annot"><span class="annottext">substVarBndrUnchecked :: TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substVarBndrUnchecked"><span class="hs-identifier hs-var hs-var">substVarBndrUnchecked</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCvSubst -&gt; Type -&gt; Type) -&gt; TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substVarBndrUsing"><span class="hs-identifier hs-var">substVarBndrUsing</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTyUnchecked"><span class="hs-identifier hs-var">substTyUnchecked</span></a></span><span>
</span><span id="line-972"></span><span>
</span><span id="line-973"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substVarBndrUsing"><span class="hs-identifier hs-type">substVarBndrUsing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-974"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyCoVar"><span class="hs-identifier hs-type">TyCoVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-975"></span><span id="substVarBndrUsing"><span class="annot"><span class="annottext">substVarBndrUsing :: (TCvSubst -&gt; Type -&gt; Type) -&gt; TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substVarBndrUsing"><span class="hs-identifier hs-var hs-var">substVarBndrUsing</span></a></span></span><span> </span><span id="local-6989586621681024804"><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621681024804"><span class="hs-identifier hs-var">subst_fn</span></a></span></span><span> </span><span id="local-6989586621681024803"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024803"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span id="local-6989586621681024802"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024802"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-976"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="GHC.Types.Var.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024802"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCvSubst -&gt; Type -&gt; Type) -&gt; TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substTyVarBndrUsing"><span class="hs-identifier hs-var">substTyVarBndrUsing</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621681024804"><span class="hs-identifier hs-var">subst_fn</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024803"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024802"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-977"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCvSubst -&gt; Type -&gt; Type) -&gt; TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substCoVarBndrUsing"><span class="hs-identifier hs-var">substCoVarBndrUsing</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621681024804"><span class="hs-identifier hs-var">subst_fn</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024803"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024802"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-978"></span><span>
</span><span id="line-979"></span><span class="hs-comment">-- | Substitute a tyvar in a binding position, returning an</span><span>
</span><span id="line-980"></span><span class="hs-comment">-- extended subst and a new tyvar.</span><span>
</span><span id="line-981"></span><span class="hs-comment">-- Use the supplied function to substitute in the kind</span><span>
</span><span id="line-982"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyVarBndrUsing"><span class="hs-identifier hs-type">substTyVarBndrUsing</span></a></span><span>
</span><span id="line-983"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Use this to substitute in the kind</span><span>
</span><span id="line-984"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-985"></span><span id="substTyVarBndrUsing"><span class="annot"><span class="annottext">substTyVarBndrUsing :: (TCvSubst -&gt; Type -&gt; Type) -&gt; TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substTyVarBndrUsing"><span class="hs-identifier hs-var hs-var">substTyVarBndrUsing</span></a></span></span><span> </span><span id="local-6989586621681024801"><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621681024801"><span class="hs-identifier hs-var">subst_fn</span></a></span></span><span> </span><span id="local-6989586621681024800"><span class="annot"><span class="annottext">subst :: TCvSubst
</span><a href="#local-6989586621681024800"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681024799"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681024799"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681024798"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024798"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681024797"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024797"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681024796"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024796"><span class="hs-identifier hs-var">old_var</span></a></span></span><span>
</span><span id="line-986"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">_no_capture</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pprTyVar</span><span> </span><span class="hs-identifier">old_var</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">pprTyVar</span><span> </span><span class="hs-identifier">new_var</span><span> </span><span class="hs-operator">$$</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">subst</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-987"></span><span>    </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">old_var</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-988"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681024799"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; Var -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#extendInScopeSet"><span class="hs-operator hs-var">`extendInScopeSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024794"><span class="hs-identifier hs-var">new_var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024793"><span class="hs-identifier hs-var">new_env</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024797"><span class="hs-identifier hs-var">cenv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024794"><span class="hs-identifier hs-var">new_var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-989"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-990"></span><span>    </span><span id="local-6989586621681024793"><span class="annot"><span class="annottext">new_env :: TvSubstEnv
</span><a href="#local-6989586621681024793"><span class="hs-identifier hs-var hs-var">new_env</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024792"><span class="hs-identifier hs-var">no_change</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#delVarEnv"><span class="hs-identifier hs-var">delVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024798"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024796"><span class="hs-identifier hs-var">old_var</span></a></span><span>
</span><span id="line-991"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024798"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024796"><span class="hs-identifier hs-var">old_var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#TyVarTy"><span class="hs-identifier hs-var">TyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024794"><span class="hs-identifier hs-var">new_var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-992"></span><span>
</span><span id="line-993"></span><span>    </span><span id="local-6989586621681024795"><span class="annot"><span class="annottext">_no_capture :: Bool
</span><a href="#local-6989586621681024795"><span class="hs-identifier hs-var hs-var">_no_capture</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024794"><span class="hs-identifier hs-var">new_var</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; VarSet -&gt; Bool
</span><a href="GHC.Types.Var.Set.html#elemVarSet"><span class="hs-operator hs-var">`elemVarSet`</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv -&gt; VarSet
</span><a href="GHC.Core.TyCo.FVs.html#shallowTyCoVarsOfTyVarEnv"><span class="hs-identifier hs-var">shallowTyCoVarsOfTyVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024798"><span class="hs-identifier hs-var">tenv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-994"></span><span>    </span><span class="hs-comment">-- Assertion check that we are not capturing something in the substitution</span><span>
</span><span id="line-995"></span><span>
</span><span id="line-996"></span><span>    </span><span id="local-6989586621681024790"><span class="annot"><span class="annottext">old_ki :: Type
</span><a href="#local-6989586621681024790"><span class="hs-identifier hs-var hs-var">old_ki</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024796"><span class="hs-identifier hs-var">old_var</span></a></span><span>
</span><span id="line-997"></span><span>    </span><span id="local-6989586621681024789"><span class="annot"><span class="annottext">no_kind_change :: Bool
</span><a href="#local-6989586621681024789"><span class="hs-identifier hs-var hs-var">no_kind_change</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfType"><span class="hs-identifier hs-var">noFreeVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024790"><span class="hs-identifier hs-var">old_ki</span></a></span><span> </span><span class="hs-comment">-- verify that kind is closed</span><span>
</span><span id="line-998"></span><span>    </span><span id="local-6989586621681024792"><span class="annot"><span class="annottext">no_change :: Bool
</span><a href="#local-6989586621681024792"><span class="hs-identifier hs-var hs-var">no_change</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024789"><span class="hs-identifier hs-var">no_kind_change</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024794"><span class="hs-identifier hs-var">new_var</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024796"><span class="hs-identifier hs-var">old_var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-999"></span><span>        </span><span class="hs-comment">-- no_change means that the new_var is identical in</span><span>
</span><span id="line-1000"></span><span>        </span><span class="hs-comment">-- all respects to the old_var (same unique, same kind)</span><span>
</span><span id="line-1001"></span><span>        </span><span class="hs-comment">-- See Note [Extending the TCvSubst]</span><span>
</span><span id="line-1002"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-1003"></span><span>        </span><span class="hs-comment">-- In that case we don't need to extend the substitution</span><span>
</span><span id="line-1004"></span><span>        </span><span class="hs-comment">-- to map old to new.  But instead we must zap any</span><span>
</span><span id="line-1005"></span><span>        </span><span class="hs-comment">-- current substitution for the variable. For example:</span><span>
</span><span id="line-1006"></span><span>        </span><span class="hs-comment">--      (\x.e) with id_subst = [x |-&gt; e']</span><span>
</span><span id="line-1007"></span><span>        </span><span class="hs-comment">-- Here we must simply zap the substitution for x</span><span>
</span><span id="line-1008"></span><span>
</span><span id="line-1009"></span><span>    </span><span id="local-6989586621681024794"><span class="annot"><span class="annottext">new_var :: Var
</span><a href="#local-6989586621681024794"><span class="hs-identifier hs-var hs-var">new_var</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024789"><span class="hs-identifier hs-var">no_kind_change</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; Var -&gt; Var
</span><a href="GHC.Types.Var.Env.html#uniqAway"><span class="hs-identifier hs-var">uniqAway</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681024799"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024796"><span class="hs-identifier hs-var">old_var</span></a></span><span>
</span><span id="line-1010"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; Var -&gt; Var
</span><a href="GHC.Types.Var.Env.html#uniqAway"><span class="hs-identifier hs-var">uniqAway</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681024799"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1011"></span><span>                          </span><span class="annot"><span class="annottext">Var -&gt; Type -&gt; Var
</span><a href="GHC.Types.Var.html#setTyVarKind"><span class="hs-identifier hs-var">setTyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024796"><span class="hs-identifier hs-var">old_var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621681024801"><span class="hs-identifier hs-var">subst_fn</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024800"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024790"><span class="hs-identifier hs-var">old_ki</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1012"></span><span>        </span><span class="hs-comment">-- The uniqAway part makes sure the new variable is not already in scope</span><span>
</span><span id="line-1013"></span><span>
</span><span id="line-1014"></span><span class="hs-comment">-- | Substitute a covar in a binding position, returning an</span><span>
</span><span id="line-1015"></span><span class="hs-comment">-- extended subst and a new covar.</span><span>
</span><span id="line-1016"></span><span class="hs-comment">-- Use the supplied function to substitute in the kind</span><span>
</span><span id="line-1017"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substCoVarBndrUsing"><span class="hs-identifier hs-type">substCoVarBndrUsing</span></a></span><span>
</span><span id="line-1018"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1019"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#CoVar"><span class="hs-identifier hs-type">CoVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1020"></span><span id="substCoVarBndrUsing"><span class="annot"><span class="annottext">substCoVarBndrUsing :: (TCvSubst -&gt; Type -&gt; Type) -&gt; TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substCoVarBndrUsing"><span class="hs-identifier hs-var hs-var">substCoVarBndrUsing</span></a></span></span><span> </span><span id="local-6989586621681024787"><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621681024787"><span class="hs-identifier hs-var">subst_fn</span></a></span></span><span> </span><span id="local-6989586621681024786"><span class="annot"><span class="annottext">subst :: TCvSubst
</span><a href="#local-6989586621681024786"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681024785"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681024785"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681024784"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024784"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span id="local-6989586621681024783"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024783"><span class="hs-identifier hs-var">cenv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681024782"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024782"><span class="hs-identifier hs-var">old_var</span></a></span></span><span>
</span><span id="line-1021"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isCoVar</span><span> </span><span class="hs-identifier">old_var</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1022"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681024785"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; Var -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#extendInScopeSet"><span class="hs-operator hs-var">`extendInScopeSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024781"><span class="hs-identifier hs-var">new_var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024784"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024780"><span class="hs-identifier hs-var">new_cenv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024781"><span class="hs-identifier hs-var">new_var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1023"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1024"></span><span>    </span><span id="local-6989586621681024779"><span class="annot"><span class="annottext">new_co :: Coercion
</span><a href="#local-6989586621681024779"><span class="hs-identifier hs-var hs-var">new_co</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Coercion
</span><a href="GHC.Core.Coercion.html#mkCoVarCo"><span class="hs-identifier hs-var">mkCoVarCo</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024781"><span class="hs-identifier hs-var">new_var</span></a></span><span>
</span><span id="line-1025"></span><span>    </span><span id="local-6989586621681024778"><span class="annot"><span class="annottext">no_kind_change :: Bool
</span><a href="#local-6989586621681024778"><span class="hs-identifier hs-var hs-var">no_kind_change</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Bool
</span><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfTypes"><span class="hs-identifier hs-var">noFreeVarsOfTypes</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024776"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024775"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1026"></span><span>    </span><span id="local-6989586621681024774"><span class="annot"><span class="annottext">no_change :: Bool
</span><a href="#local-6989586621681024774"><span class="hs-identifier hs-var hs-var">no_change</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024781"><span class="hs-identifier hs-var">new_var</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024782"><span class="hs-identifier hs-var">old_var</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024778"><span class="hs-identifier hs-var">no_kind_change</span></a></span><span>
</span><span id="line-1027"></span><span>
</span><span id="line-1028"></span><span>    </span><span id="local-6989586621681024780"><span class="annot"><span class="annottext">new_cenv :: CvSubstEnv
</span><a href="#local-6989586621681024780"><span class="hs-identifier hs-var hs-var">new_cenv</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024774"><span class="hs-identifier hs-var">no_change</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#delVarEnv"><span class="hs-identifier hs-var">delVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024783"><span class="hs-identifier hs-var">cenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024782"><span class="hs-identifier hs-var">old_var</span></a></span><span>
</span><span id="line-1029"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024783"><span class="hs-identifier hs-var">cenv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024782"><span class="hs-identifier hs-var">old_var</span></a></span><span> </span><span class="annot"><span class="annottext">Coercion
</span><a href="#local-6989586621681024779"><span class="hs-identifier hs-var">new_co</span></a></span><span>
</span><span id="line-1030"></span><span>
</span><span id="line-1031"></span><span>    </span><span id="local-6989586621681024781"><span class="annot"><span class="annottext">new_var :: Var
</span><a href="#local-6989586621681024781"><span class="hs-identifier hs-var hs-var">new_var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InScopeSet -&gt; Var -&gt; Var
</span><a href="GHC.Types.Var.Env.html#uniqAway"><span class="hs-identifier hs-var">uniqAway</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681024785"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024773"><span class="hs-identifier hs-var">subst_old_var</span></a></span><span>
</span><span id="line-1032"></span><span>    </span><span id="local-6989586621681024773"><span class="annot"><span class="annottext">subst_old_var :: Var
</span><a href="#local-6989586621681024773"><span class="hs-identifier hs-var hs-var">subst_old_var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Var
</span><a href="GHC.Types.Var.html#mkCoVar"><span class="hs-identifier hs-var">mkCoVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Name
</span><a href="GHC.Types.Var.html#varName"><span class="hs-identifier hs-var">varName</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024782"><span class="hs-identifier hs-var">old_var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024772"><span class="hs-identifier hs-var">new_var_type</span></a></span><span>
</span><span id="line-1033"></span><span>
</span><span id="line-1034"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681024776"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024776"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681024775"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024775"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681024771"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681024771"><span class="hs-keyword hs-var">role</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Var -&gt; (Type, Type, Type, Type, Role)
</span><a href="GHC.Core.Coercion.html#coVarKindsTypesRole"><span class="hs-identifier hs-var">coVarKindsTypesRole</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024782"><span class="hs-identifier hs-var">old_var</span></a></span><span>
</span><span id="line-1035"></span><span>    </span><span id="local-6989586621681024770"><span class="annot"><span class="annottext">t1' :: Type
</span><a href="#local-6989586621681024770"><span class="hs-identifier hs-var hs-var">t1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621681024787"><span class="hs-identifier hs-var">subst_fn</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024786"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024776"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-1036"></span><span>    </span><span id="local-6989586621681024769"><span class="annot"><span class="annottext">t2' :: Type
</span><a href="#local-6989586621681024769"><span class="hs-identifier hs-var hs-var">t2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Type -&gt; Type
</span><a href="#local-6989586621681024787"><span class="hs-identifier hs-var">subst_fn</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024786"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024775"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1037"></span><span>    </span><span id="local-6989586621681024772"><span class="annot"><span class="annottext">new_var_type :: Type
</span><a href="#local-6989586621681024772"><span class="hs-identifier hs-var hs-var">new_var_type</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Role -&gt; Type -&gt; Type -&gt; Type
</span><a href="GHC.Core.Coercion.html#mkCoercionType"><span class="hs-identifier hs-var">mkCoercionType</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621681024771"><span class="hs-keyword hs-var">role</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024770"><span class="hs-identifier hs-var">t1'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024769"><span class="hs-identifier hs-var">t2'</span></a></span><span>
</span><span id="line-1038"></span><span>                  </span><span class="hs-comment">-- It's important to do the substitution for coercions,</span><span>
</span><span id="line-1039"></span><span>                  </span><span class="hs-comment">-- because they can have free type variables</span><span>
</span><span id="line-1040"></span><span>
</span><span id="line-1041"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#cloneTyVarBndr"><span class="hs-identifier hs-type">cloneTyVarBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1042"></span><span id="cloneTyVarBndr"><span class="annot"><span class="annottext">cloneTyVarBndr :: TCvSubst -&gt; Var -&gt; Unique -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#cloneTyVarBndr"><span class="hs-identifier hs-var hs-var">cloneTyVarBndr</span></a></span></span><span> </span><span id="local-6989586621681024768"><span class="annot"><span class="annottext">subst :: TCvSubst
</span><a href="#local-6989586621681024768"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span id="local-6989586621681024767"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681024767"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621681024766"><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024766"><span class="hs-identifier hs-var">tv_env</span></a></span></span><span> </span><span id="local-6989586621681024765"><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024765"><span class="hs-identifier hs-var">cv_env</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681024764"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024764"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621681024763"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681024763"><span class="hs-identifier hs-var">uniq</span></a></span></span><span>
</span><span id="line-1043"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">isTyVar</span><span> </span><span class="hs-identifier">tv</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">tv</span><span> </span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- I think it's only called on TyVars</span><span>
</span><span id="line-1044"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet -&gt; TvSubstEnv -&gt; CvSubstEnv -&gt; TCvSubst
</span><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-var">TCvSubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InScopeSet -&gt; Var -&gt; InScopeSet
</span><a href="GHC.Types.Var.Env.html#extendInScopeSet"><span class="hs-identifier hs-var">extendInScopeSet</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621681024767"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024762"><span class="hs-identifier hs-var">tv'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1045"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. VarEnv a -&gt; Var -&gt; a -&gt; VarEnv a
</span><a href="GHC.Types.Var.Env.html#extendVarEnv"><span class="hs-identifier hs-var">extendVarEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TvSubstEnv
</span><a href="#local-6989586621681024766"><span class="hs-identifier hs-var">tv_env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024764"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Core.TyCo.Rep.html#mkTyVarTy"><span class="hs-identifier hs-var">mkTyVarTy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024762"><span class="hs-identifier hs-var">tv'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CvSubstEnv
</span><a href="#local-6989586621681024765"><span class="hs-identifier hs-var">cv_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024762"><span class="hs-identifier hs-var">tv'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1046"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1047"></span><span>    </span><span id="local-6989586621681024761"><span class="annot"><span class="annottext">old_ki :: Type
</span><a href="#local-6989586621681024761"><span class="hs-identifier hs-var hs-var">old_ki</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Type
</span><a href="GHC.Types.Var.html#tyVarKind"><span class="hs-identifier hs-var">tyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024764"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1048"></span><span>    </span><span id="local-6989586621681024760"><span class="annot"><span class="annottext">no_kind_change :: Bool
</span><a href="#local-6989586621681024760"><span class="hs-identifier hs-var hs-var">no_kind_change</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Core.TyCo.FVs.html#noFreeVarsOfType"><span class="hs-identifier hs-var">noFreeVarsOfType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024761"><span class="hs-identifier hs-var">old_ki</span></a></span><span> </span><span class="hs-comment">-- verify that kind is closed</span><span>
</span><span id="line-1049"></span><span>
</span><span id="line-1050"></span><span>    </span><span id="local-6989586621681024759"><span class="annot"><span class="annottext">tv1 :: Var
</span><a href="#local-6989586621681024759"><span class="hs-identifier hs-var hs-var">tv1</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681024760"><span class="hs-identifier hs-var">no_kind_change</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024764"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1051"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Type -&gt; Var
</span><a href="GHC.Types.Var.html#setTyVarKind"><span class="hs-identifier hs-var">setTyVarKind</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024764"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Type -&gt; Type
</span><a href="GHC.Core.TyCo.Subst.html#substTy"><span class="hs-identifier hs-var">substTy</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024768"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681024761"><span class="hs-identifier hs-var">old_ki</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1052"></span><span>
</span><span id="line-1053"></span><span>    </span><span id="local-6989586621681024762"><span class="annot"><span class="annottext">tv' :: Var
</span><a href="#local-6989586621681024762"><span class="hs-identifier hs-var hs-var">tv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Unique -&gt; Var
</span><a href="GHC.Types.Var.html#setVarUnique"><span class="hs-identifier hs-var">setVarUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024759"><span class="hs-identifier hs-var">tv1</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681024763"><span class="hs-identifier hs-var">uniq</span></a></span><span>
</span><span id="line-1054"></span><span>
</span><span id="line-1055"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#cloneTyVarBndrs"><span class="hs-identifier hs-type">cloneTyVarBndrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.Supply.html#UniqSupply"><span class="hs-identifier hs-type">UniqSupply</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Var.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1056"></span><span id="cloneTyVarBndrs"><span class="annot"><span class="annottext">cloneTyVarBndrs :: TCvSubst -&gt; [Var] -&gt; UniqSupply -&gt; (TCvSubst, [Var])
</span><a href="GHC.Core.TyCo.Subst.html#cloneTyVarBndrs"><span class="hs-identifier hs-var hs-var">cloneTyVarBndrs</span></a></span></span><span> </span><span id="local-6989586621681024757"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024757"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span id="local-6989586621681024756"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681024756"><span class="hs-identifier hs-var">_usupply</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024757"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1057"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#cloneTyVarBndrs"><span class="hs-identifier hs-var">cloneTyVarBndrs</span></a></span><span> </span><span id="local-6989586621681024755"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024755"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681024754"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024754"><span class="hs-identifier hs-var">t</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681024753"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681024753"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span>  </span><span id="local-6989586621681024752"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681024752"><span class="hs-identifier hs-var">usupply</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024751"><span class="hs-identifier hs-var">subst''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024750"><span class="hs-identifier hs-var">tv</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681024749"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1058"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1059"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681024748"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681024748"><span class="hs-identifier hs-var">uniq</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681024747"><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681024747"><span class="hs-identifier hs-var">usupply'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqSupply -&gt; (Unique, UniqSupply)
</span><a href="GHC.Types.Unique.Supply.html#takeUniqFromSupply"><span class="hs-identifier hs-var">takeUniqFromSupply</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681024752"><span class="hs-identifier hs-var">usupply</span></a></span><span>
</span><span id="line-1060"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681024745"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024745"><span class="hs-identifier hs-var">subst'</span></a></span></span><span> </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681024750"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024750"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; Var -&gt; Unique -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#cloneTyVarBndr"><span class="hs-identifier hs-var">cloneTyVarBndr</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024755"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024754"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621681024748"><span class="hs-identifier hs-var">uniq</span></a></span><span>
</span><span id="line-1061"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681024751"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024751"><span class="hs-identifier hs-var">subst''</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681024749"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681024749"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCvSubst -&gt; [Var] -&gt; UniqSupply -&gt; (TCvSubst, [Var])
</span><a href="GHC.Core.TyCo.Subst.html#cloneTyVarBndrs"><span class="hs-identifier hs-var">cloneTyVarBndrs</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024745"><span class="hs-identifier hs-var">subst'</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621681024753"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">UniqSupply
</span><a href="#local-6989586621681024747"><span class="hs-identifier hs-var">usupply'</span></a></span><span>
</span><span id="line-1062"></span><span>
</span><span id="line-1063"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyCoBndr"><span class="hs-identifier hs-type">substTyCoBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoBinder"><span class="hs-identifier hs-type">TyCoBinder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#TCvSubst"><span class="hs-identifier hs-type">TCvSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#TyCoBinder"><span class="hs-identifier hs-type">TyCoBinder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1064"></span><span id="substTyCoBndr"><span class="annot"><span class="annottext">substTyCoBndr :: TCvSubst -&gt; TyCoBinder -&gt; (TCvSubst, TyCoBinder)
</span><a href="GHC.Core.TyCo.Subst.html#substTyCoBndr"><span class="hs-identifier hs-var hs-var">substTyCoBndr</span></a></span></span><span> </span><span id="local-6989586621681024744"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024744"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Anon"><span class="hs-identifier hs-type">Anon</span></a></span><span> </span><span id="local-6989586621681024743"><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="#local-6989586621681024743"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span id="local-6989586621681024742"><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621681024742"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024744"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AnonArgFlag -&gt; Scaled Type -&gt; TyCoBinder
</span><a href="GHC.Core.TyCo.Rep.html#Anon"><span class="hs-identifier hs-var">Anon</span></a></span><span> </span><span class="annot"><span class="annottext">AnonArgFlag
</span><a href="#local-6989586621681024743"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Scaled Type -&gt; Scaled Type
</span><a href="GHC.Core.TyCo.Subst.html#substScaledTy"><span class="hs-identifier hs-var">substScaledTy</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024744"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Scaled Type
</span><a href="#local-6989586621681024742"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1065"></span><span class="annot"><a href="GHC.Core.TyCo.Subst.html#substTyCoBndr"><span class="hs-identifier hs-var">substTyCoBndr</span></a></span><span> </span><span id="local-6989586621681024741"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024741"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-type">Bndr</span></a></span><span> </span><span id="local-6989586621681024740"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024740"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span id="local-6989586621681024739"><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621681024739"><span class="hs-identifier hs-var">vis</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024738"><span class="hs-identifier hs-var">subst'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VarBndr Var ArgFlag -&gt; TyCoBinder
</span><a href="GHC.Core.TyCo.Rep.html#Named"><span class="hs-identifier hs-var">Named</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall var argf. var -&gt; argf -&gt; VarBndr var argf
</span><a href="GHC.Types.Var.html#Bndr"><span class="hs-identifier hs-var">Bndr</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024737"><span class="hs-identifier hs-var">tv'</span></a></span><span> </span><span class="annot"><span class="annottext">ArgFlag
</span><a href="#local-6989586621681024739"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1066"></span><span>                                          </span><span class="hs-keyword">where</span><span>
</span><span id="line-1067"></span><span>                                            </span><span class="hs-special">(</span><span id="local-6989586621681024738"><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024738"><span class="hs-identifier hs-var">subst'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681024737"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024737"><span class="hs-identifier hs-var">tv'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; TCvSubst -&gt; Var -&gt; (TCvSubst, Var)
</span><a href="GHC.Core.TyCo.Subst.html#substVarBndr"><span class="hs-identifier hs-var">substVarBndr</span></a></span><span> </span><span class="annot"><span class="annottext">TCvSubst
</span><a href="#local-6989586621681024741"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621681024740"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1068"></span><span>
</span><span id="line-1069"></span></pre></body></html>