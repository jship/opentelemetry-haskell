<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>GHC/Iface/Type.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-
<a name="line-2"></a>(c) The University of Glasgow 2006
<a name="line-3"></a>(c) The GRASP/AQUA Project, Glasgow University, 1993-1998
<a name="line-4"></a>
<a name="line-5"></a>
<a name="line-6"></a>This module defines interface types and binders
<a name="line-7"></a>-}</span>
<a name="line-8"></a>
<a name="line-9"></a><span class='hs-comment'>{-# LANGUAGE CPP #-}</span>
<a name="line-10"></a><span class='hs-comment'>{-# LANGUAGE FlexibleInstances #-}</span>
<a name="line-11"></a>  <span class='hs-comment'>-- FlexibleInstances for Binary (DefMethSpec IfaceType)</span>
<a name="line-12"></a><span class='hs-comment'>{-# LANGUAGE BangPatterns #-}</span>
<a name="line-13"></a><span class='hs-comment'>{-# LANGUAGE MultiWayIf #-}</span>
<a name="line-14"></a><span class='hs-comment'>{-# LANGUAGE TupleSections #-}</span>
<a name="line-15"></a><span class='hs-comment'>{-# LANGUAGE LambdaCase #-}</span>
<a name="line-16"></a>
<a name="line-17"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>GHC.Iface.Type</span> <span class='hs-layout'>(</span>
<a name="line-18"></a>        <span class='hs-conid'>IfExtName</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfLclName</span><span class='hs-layout'>,</span>
<a name="line-19"></a>
<a name="line-20"></a>        <span class='hs-conid'>IfaceType</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfacePredType</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceKind</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceCoercion</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-21"></a>        <span class='hs-conid'>IfaceMCoercion</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-22"></a>        <span class='hs-conid'>IfaceUnivCoProv</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-23"></a>        <span class='hs-conid'>IfaceMult</span><span class='hs-layout'>,</span>
<a name="line-24"></a>        <span class='hs-conid'>IfaceTyCon</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-25"></a>        <span class='hs-conid'>IfaceTyConInfo</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>mkIfaceTyConInfo</span><span class='hs-layout'>,</span>
<a name="line-26"></a>        <span class='hs-conid'>IfaceTyConSort</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-27"></a>        <span class='hs-conid'>IfaceTyLit</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceAppArgs</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-28"></a>        <span class='hs-conid'>IfaceContext</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceBndr</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceOneShot</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceLamBndr</span><span class='hs-layout'>,</span>
<a name="line-29"></a>        <span class='hs-conid'>IfaceTvBndr</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceIdBndr</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceTyConBinder</span><span class='hs-layout'>,</span>
<a name="line-30"></a>        <span class='hs-conid'>IfaceForAllSpecBndr</span><span class='hs-layout'>,</span>
<a name="line-31"></a>        <span class='hs-conid'>IfaceForAllBndr</span><span class='hs-layout'>,</span> <span class='hs-conid'>ArgFlag</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>AnonArgFlag</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>ShowForAllFlag</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-32"></a>        <span class='hs-varid'>mkIfaceForAllTvBndr</span><span class='hs-layout'>,</span>
<a name="line-33"></a>        <span class='hs-varid'>mkIfaceTyConKind</span><span class='hs-layout'>,</span>
<a name="line-34"></a>        <span class='hs-varid'>ifaceForAllSpecToBndrs</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifaceForAllSpecToBndr</span><span class='hs-layout'>,</span>
<a name="line-35"></a>
<a name="line-36"></a>        <span class='hs-varid'>ifForAllBndrVar</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifForAllBndrName</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifaceBndrName</span><span class='hs-layout'>,</span>
<a name="line-37"></a>        <span class='hs-varid'>ifTyConBinderVar</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifTyConBinderName</span><span class='hs-layout'>,</span>
<a name="line-38"></a>
<a name="line-39"></a>        <span class='hs-comment'>-- Equality testing</span>
<a name="line-40"></a>        <span class='hs-varid'>isIfaceLiftedTypeKind</span><span class='hs-layout'>,</span>
<a name="line-41"></a>
<a name="line-42"></a>        <span class='hs-comment'>-- Conversion from IfaceAppArgs to IfaceTypes/ArgFlags</span>
<a name="line-43"></a>        <span class='hs-varid'>appArgsIfaceTypes</span><span class='hs-layout'>,</span> <span class='hs-varid'>appArgsIfaceTypesArgFlags</span><span class='hs-layout'>,</span>
<a name="line-44"></a>
<a name="line-45"></a>        <span class='hs-comment'>-- Printing</span>
<a name="line-46"></a>        <span class='hs-conid'>SuppressBndrSig</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-47"></a>        <span class='hs-conid'>UseBndrParens</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-48"></a>        <span class='hs-conid'>PrintExplicitKinds</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-49"></a>        <span class='hs-varid'>pprIfaceType</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprParendIfaceType</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprPrecIfaceType</span><span class='hs-layout'>,</span>
<a name="line-50"></a>        <span class='hs-varid'>pprIfaceContext</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprIfaceContextArr</span><span class='hs-layout'>,</span>
<a name="line-51"></a>        <span class='hs-varid'>pprIfaceIdBndr</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprIfaceLamBndr</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprIfaceTvBndr</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprIfaceTyConBinders</span><span class='hs-layout'>,</span>
<a name="line-52"></a>        <span class='hs-varid'>pprIfaceBndrs</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprIfaceAppArgs</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprParendIfaceAppArgs</span><span class='hs-layout'>,</span>
<a name="line-53"></a>        <span class='hs-varid'>pprIfaceForAllPart</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprIfaceForAllPartMust</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprIfaceForAll</span><span class='hs-layout'>,</span>
<a name="line-54"></a>        <span class='hs-varid'>pprIfaceSigmaType</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprIfaceTyLit</span><span class='hs-layout'>,</span>
<a name="line-55"></a>        <span class='hs-varid'>pprIfaceCoercion</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprParendIfaceCoercion</span><span class='hs-layout'>,</span>
<a name="line-56"></a>        <span class='hs-varid'>splitIfaceSigmaTy</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprIfaceTypeApp</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprUserIfaceForAll</span><span class='hs-layout'>,</span>
<a name="line-57"></a>        <span class='hs-varid'>pprIfaceCoTcApp</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprTyTcApp</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprIfacePrefixApp</span><span class='hs-layout'>,</span>
<a name="line-58"></a>        <span class='hs-varid'>ppr_fun_arrow</span><span class='hs-layout'>,</span>
<a name="line-59"></a>        <span class='hs-varid'>isIfaceTauType</span><span class='hs-layout'>,</span>
<a name="line-60"></a>
<a name="line-61"></a>        <span class='hs-varid'>suppressIfaceInvisibles</span><span class='hs-layout'>,</span>
<a name="line-62"></a>        <span class='hs-varid'>stripIfaceInvisVars</span><span class='hs-layout'>,</span>
<a name="line-63"></a>        <span class='hs-varid'>stripInvisArgs</span><span class='hs-layout'>,</span>
<a name="line-64"></a>
<a name="line-65"></a>        <span class='hs-varid'>mkIfaceTySubst</span><span class='hs-layout'>,</span> <span class='hs-varid'>substIfaceTyVar</span><span class='hs-layout'>,</span> <span class='hs-varid'>substIfaceAppArgs</span><span class='hs-layout'>,</span> <span class='hs-varid'>inDomIfaceTySubst</span><span class='hs-layout'>,</span>
<a name="line-66"></a>
<a name="line-67"></a>        <span class='hs-varid'>many_ty</span>
<a name="line-68"></a>    <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-69"></a>
<a name="line-70"></a><span class='hs-cpp'>#include "HsVersions.h"</span>
<a name="line-71"></a>
<a name="line-72"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Prelude</span>
<a name="line-73"></a>
<a name="line-74"></a><span class='hs-keyword'>import</span> <span class='hs-comment'>{-# SOURCE #-}</span> <span class='hs-conid'>GHC.Builtin.Types</span>
<a name="line-75"></a>                                 <span class='hs-layout'>(</span> <span class='hs-varid'>coercibleTyCon</span><span class='hs-layout'>,</span> <span class='hs-varid'>heqTyCon</span>
<a name="line-76"></a>                                 <span class='hs-layout'>,</span> <span class='hs-varid'>tupleTyConName</span>
<a name="line-77"></a>                                 <span class='hs-layout'>,</span> <span class='hs-varid'>manyDataConTyCon</span><span class='hs-layout'>,</span> <span class='hs-varid'>oneDataConTyCon</span>
<a name="line-78"></a>                                 <span class='hs-layout'>,</span> <span class='hs-varid'>liftedRepTyCon</span> <span class='hs-layout'>)</span>
<a name="line-79"></a><span class='hs-keyword'>import</span> <span class='hs-comment'>{-# SOURCE #-}</span> <span class='hs-conid'>GHC.Core.Type</span> <span class='hs-layout'>(</span> <span class='hs-varid'>isRuntimeRepTy</span><span class='hs-layout'>,</span> <span class='hs-varid'>isMultiplicityTy</span> <span class='hs-layout'>)</span>
<a name="line-80"></a>
<a name="line-81"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Core.TyCon</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span> <span class='hs-varid'>pprPromotionQuote</span> <span class='hs-layout'>)</span>
<a name="line-82"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Core.Coercion.Axiom</span>
<a name="line-83"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Var</span>
<a name="line-84"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Builtin.Names</span>
<a name="line-85"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Name</span>
<a name="line-86"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Basic</span>
<a name="line-87"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Utils.Binary</span>
<a name="line-88"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Utils.Outputable</span>
<a name="line-89"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Data.FastString</span>
<a name="line-90"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Utils.Misc</span>
<a name="line-91"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Utils.Panic</span>
<a name="line-92"></a><span class='hs-keyword'>import</span> <span class='hs-comment'>{-# SOURCE #-}</span> <span class='hs-conid'>GHC.Tc.Utils.TcType</span> <span class='hs-layout'>(</span> <span class='hs-varid'>isMetaTyVar</span><span class='hs-layout'>,</span> <span class='hs-varid'>isTyConableTyVar</span> <span class='hs-layout'>)</span>
<a name="line-93"></a>
<a name="line-94"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Maybe</span><span class='hs-layout'>(</span> <span class='hs-varid'>isJust</span> <span class='hs-layout'>)</span>
<a name="line-95"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Semigroup</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Semi</span>
<a name="line-96"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.DeepSeq</span>
<a name="line-97"></a>
<a name="line-98"></a><span class='hs-comment'>{-
<a name="line-99"></a>************************************************************************
<a name="line-100"></a>*                                                                      *
<a name="line-101"></a>                Local (nested) binders
<a name="line-102"></a>*                                                                      *
<a name="line-103"></a>************************************************************************
<a name="line-104"></a>-}</span>
<a name="line-105"></a>
<a name="line-106"></a><a name="IfLclName"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>IfLclName</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>FastString</span>     <span class='hs-comment'>-- A local name in iface syntax</span>
<a name="line-107"></a>
<a name="line-108"></a><a name="IfExtName"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>IfExtName</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Name</span>   <span class='hs-comment'>-- An External or WiredIn Name can appear in Iface syntax</span>
<a name="line-109"></a>                        <span class='hs-comment'>-- (However Internal or System Names never should)</span>
<a name="line-110"></a>
<a name="line-111"></a><a name="IfaceBndr"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceBndr</span>          <span class='hs-comment'>-- Local (non-top-level) binders</span>
<a name="line-112"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceIdBndr</span> <span class='hs-comment'>{-# UNPACK #-}</span> <span class='hs-varop'>!</span><span class='hs-conid'>IfaceIdBndr</span>
<a name="line-113"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceTvBndr</span> <span class='hs-comment'>{-# UNPACK #-}</span> <span class='hs-varop'>!</span><span class='hs-conid'>IfaceTvBndr</span>
<a name="line-114"></a>
<a name="line-115"></a><a name="IfaceIdBndr"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>IfaceIdBndr</span>  <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceType</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfLclName</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceType</span><span class='hs-layout'>)</span>
<a name="line-116"></a><a name="IfaceTvBndr"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>IfaceTvBndr</span>  <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfLclName</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceKind</span><span class='hs-layout'>)</span>
<a name="line-117"></a>
<a name="line-118"></a><a name="ifaceTvBndrName"></a><span class='hs-definition'>ifaceTvBndrName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTvBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfLclName</span>
<a name="line-119"></a><span class='hs-definition'>ifaceTvBndrName</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span><span class='hs-layout'>,</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>n</span>
<a name="line-120"></a>
<a name="line-121"></a><a name="ifaceIdBndrName"></a><span class='hs-definition'>ifaceIdBndrName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceIdBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfLclName</span>
<a name="line-122"></a><span class='hs-definition'>ifaceIdBndrName</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span><span class='hs-varid'>n</span><span class='hs-layout'>,</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>n</span>
<a name="line-123"></a>
<a name="line-124"></a><a name="ifaceBndrName"></a><span class='hs-definition'>ifaceBndrName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfLclName</span>
<a name="line-125"></a><span class='hs-definition'>ifaceBndrName</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTvBndr</span> <span class='hs-varid'>bndr</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ifaceTvBndrName</span> <span class='hs-varid'>bndr</span>
<a name="line-126"></a><span class='hs-definition'>ifaceBndrName</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceIdBndr</span> <span class='hs-varid'>bndr</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ifaceIdBndrName</span> <span class='hs-varid'>bndr</span>
<a name="line-127"></a>
<a name="line-128"></a><a name="ifaceBndrType"></a><span class='hs-definition'>ifaceBndrType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span>
<a name="line-129"></a><span class='hs-definition'>ifaceBndrType</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceIdBndr</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>t</span>
<a name="line-130"></a><span class='hs-definition'>ifaceBndrType</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTvBndr</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>t</span>
<a name="line-131"></a>
<a name="line-132"></a><a name="IfaceLamBndr"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>IfaceLamBndr</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceBndr</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceOneShot</span><span class='hs-layout'>)</span>
<a name="line-133"></a>
<a name="line-134"></a><a name="IfaceOneShot"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceOneShot</span>    <span class='hs-comment'>-- See Note [Preserve OneShotInfo] in "GHC.Core.Tidy"</span>
<a name="line-135"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceNoOneShot</span>   <span class='hs-comment'>-- and Note [The oneShot function] in "GHC.Types.Id.Make"</span>
<a name="line-136"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceOneShot</span>
<a name="line-137"></a>
<a name="line-138"></a><a name="instance%20Outputable%20IfaceOneShot"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceOneShot</span> <span class='hs-keyword'>where</span>
<a name="line-139"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>IfaceNoOneShot</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"NoOneShotInfo"</span>
<a name="line-140"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>IfaceOneShot</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"OneShot"</span>
<a name="line-141"></a>
<a name="line-142"></a><span class='hs-comment'>{-
<a name="line-143"></a>%************************************************************************
<a name="line-144"></a>%*                                                                      *
<a name="line-145"></a>                IfaceType
<a name="line-146"></a>%*                                                                      *
<a name="line-147"></a>%************************************************************************
<a name="line-148"></a>-}</span>
<a name="line-149"></a>
<a name="line-150"></a><a name="IfaceKind"></a><span class='hs-comment'>-------------------------------</span>
<a name="line-151"></a><a name="IfaceKind"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>IfaceKind</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceType</span>
<a name="line-152"></a>
<a name="line-153"></a><a name="IfaceType"></a><span class='hs-comment'>-- | A kind of universal type, used for types and kinds.</span>
<a name="line-154"></a><a name="IfaceType"></a><span class='hs-comment'>--</span>
<a name="line-155"></a><a name="IfaceType"></a><span class='hs-comment'>-- Any time a 'Type' is pretty-printed, it is first converted to an 'IfaceType'</span>
<a name="line-156"></a><a name="IfaceType"></a><span class='hs-comment'>-- before being printed. See Note [Pretty printing via Iface syntax] in "GHC.Types.TyThing.Ppr"</span>
<a name="line-157"></a><a name="IfaceType"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceType</span>
<a name="line-158"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceFreeTyVar</span> <span class='hs-conid'>TyVar</span>                <span class='hs-comment'>-- See Note [Free tyvars in IfaceType]</span>
<a name="line-159"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceTyVar</span>     <span class='hs-conid'>IfLclName</span>            <span class='hs-comment'>-- Type/coercion variable only, not tycon</span>
<a name="line-160"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceLitTy</span>     <span class='hs-conid'>IfaceTyLit</span>
<a name="line-161"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceAppTy</span>     <span class='hs-conid'>IfaceType</span> <span class='hs-conid'>IfaceAppArgs</span>
<a name="line-162"></a>                             <span class='hs-comment'>-- See Note [Suppressing invisible arguments] for</span>
<a name="line-163"></a>                             <span class='hs-comment'>-- an explanation of why the second field isn't</span>
<a name="line-164"></a>                             <span class='hs-comment'>-- IfaceType, analogous to AppTy.</span>
<a name="line-165"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceFunTy</span>     <span class='hs-conid'>AnonArgFlag</span> <span class='hs-conid'>IfaceMult</span> <span class='hs-conid'>IfaceType</span> <span class='hs-conid'>IfaceType</span>
<a name="line-166"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceForAllTy</span>  <span class='hs-conid'>IfaceForAllBndr</span> <span class='hs-conid'>IfaceType</span>
<a name="line-167"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceTyConApp</span>  <span class='hs-conid'>IfaceTyCon</span> <span class='hs-conid'>IfaceAppArgs</span>  <span class='hs-comment'>-- Not necessarily saturated</span>
<a name="line-168"></a>                                            <span class='hs-comment'>-- Includes newtypes, synonyms, tuples</span>
<a name="line-169"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceCastTy</span>     <span class='hs-conid'>IfaceType</span> <span class='hs-conid'>IfaceCoercion</span>
<a name="line-170"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceCoercionTy</span> <span class='hs-conid'>IfaceCoercion</span>
<a name="line-171"></a>
<a name="line-172"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceTupleTy</span>                  <span class='hs-comment'>-- Saturated tuples (unsaturated ones use IfaceTyConApp)</span>
<a name="line-173"></a>       <span class='hs-conid'>TupleSort</span>                  <span class='hs-comment'>-- What sort of tuple?</span>
<a name="line-174"></a>       <span class='hs-conid'>PromotionFlag</span>                 <span class='hs-comment'>-- A bit like IfaceTyCon</span>
<a name="line-175"></a>       <span class='hs-conid'>IfaceAppArgs</span>               <span class='hs-comment'>-- arity = length args</span>
<a name="line-176"></a>          <span class='hs-comment'>-- For promoted data cons, the kind args are omitted</span>
<a name="line-177"></a>          <span class='hs-comment'>-- Why have this? Only for efficiency: IfaceTupleTy can omit the</span>
<a name="line-178"></a>          <span class='hs-comment'>-- type arguments, as they can be recreated when deserializing.</span>
<a name="line-179"></a>          <span class='hs-comment'>-- In an experiment, removing IfaceTupleTy resulted in a 0.75% regression</span>
<a name="line-180"></a>          <span class='hs-comment'>-- in interface file size (in GHC's boot libraries).</span>
<a name="line-181"></a>          <span class='hs-comment'>-- See !3987.</span>
<a name="line-182"></a>
<a name="line-183"></a><a name="IfaceMult"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>IfaceMult</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceType</span>
<a name="line-184"></a>
<a name="line-185"></a><a name="IfacePredType"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>IfacePredType</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceType</span>
<a name="line-186"></a><a name="IfaceContext"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>IfaceContext</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfacePredType</span><span class='hs-keyglyph'>]</span>
<a name="line-187"></a>
<a name="line-188"></a><a name="IfaceTyLit"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceTyLit</span>
<a name="line-189"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceNumTyLit</span> <span class='hs-conid'>Integer</span>
<a name="line-190"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceStrTyLit</span> <span class='hs-conid'>FastString</span>
<a name="line-191"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceCharTyLit</span> <span class='hs-conid'>Char</span>
<a name="line-192"></a>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span><span class='hs-layout'>)</span>
<a name="line-193"></a>
<a name="line-194"></a><a name="IfaceTyConBinder"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>IfaceTyConBinder</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>VarBndr</span> <span class='hs-conid'>IfaceBndr</span> <span class='hs-conid'>TyConBndrVis</span>
<a name="line-195"></a><a name="IfaceForAllBndr"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>IfaceForAllBndr</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>VarBndr</span> <span class='hs-conid'>IfaceBndr</span> <span class='hs-conid'>ArgFlag</span>
<a name="line-196"></a><a name="IfaceForAllSpecBndr"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>IfaceForAllSpecBndr</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>VarBndr</span> <span class='hs-conid'>IfaceBndr</span> <span class='hs-conid'>Specificity</span>
<a name="line-197"></a>
<a name="line-198"></a><a name="mkIfaceForAllTvBndr"></a><span class='hs-comment'>-- | Make an 'IfaceForAllBndr' from an 'IfaceTvBndr'.</span>
<a name="line-199"></a><span class='hs-definition'>mkIfaceForAllTvBndr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ArgFlag</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceTvBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceForAllBndr</span>
<a name="line-200"></a><span class='hs-definition'>mkIfaceForAllTvBndr</span> <span class='hs-varid'>vis</span> <span class='hs-varid'>var</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTvBndr</span> <span class='hs-varid'>var</span><span class='hs-layout'>)</span> <span class='hs-varid'>vis</span>
<a name="line-201"></a>
<a name="line-202"></a><a name="mkIfaceTyConKind"></a><span class='hs-comment'>-- | Build the 'tyConKind' from the binders and the result kind.</span>
<a name="line-203"></a><span class='hs-comment'>-- Keep in sync with 'mkTyConKind' in "GHC.Core.TyCon".</span>
<a name="line-204"></a><span class='hs-definition'>mkIfaceTyConKind</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceTyConBinder</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceKind</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceKind</span>
<a name="line-205"></a><span class='hs-definition'>mkIfaceTyConKind</span> <span class='hs-varid'>bndrs</span> <span class='hs-varid'>res_kind</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>foldr</span> <span class='hs-varid'>mk</span> <span class='hs-varid'>res_kind</span> <span class='hs-varid'>bndrs</span>
<a name="line-206"></a>  <span class='hs-keyword'>where</span>
<a name="line-207"></a>    <span class='hs-varid'>mk</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTyConBinder</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceKind</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceKind</span>
<a name="line-208"></a>    <span class='hs-varid'>mk</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bndr</span> <span class='hs-varid'>tv</span> <span class='hs-layout'>(</span><span class='hs-conid'>AnonTCB</span> <span class='hs-varid'>af</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>   <span class='hs-varid'>k</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceFunTy</span> <span class='hs-varid'>af</span> <span class='hs-varid'>many_ty</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifaceBndrType</span> <span class='hs-varid'>tv</span><span class='hs-layout'>)</span> <span class='hs-varid'>k</span>
<a name="line-209"></a>    <span class='hs-varid'>mk</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bndr</span> <span class='hs-varid'>tv</span> <span class='hs-layout'>(</span><span class='hs-conid'>NamedTCB</span> <span class='hs-varid'>vis</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceForAllTy</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bndr</span> <span class='hs-varid'>tv</span> <span class='hs-varid'>vis</span><span class='hs-layout'>)</span> <span class='hs-varid'>k</span>
<a name="line-210"></a>
<a name="line-211"></a><a name="ifaceForAllSpecToBndrs"></a><span class='hs-definition'>ifaceForAllSpecToBndrs</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceForAllSpecBndr</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceForAllBndr</span><span class='hs-keyglyph'>]</span>
<a name="line-212"></a><span class='hs-definition'>ifaceForAllSpecToBndrs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-varid'>ifaceForAllSpecToBndr</span>
<a name="line-213"></a>
<a name="line-214"></a><a name="ifaceForAllSpecToBndr"></a><span class='hs-definition'>ifaceForAllSpecToBndr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceForAllSpecBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceForAllBndr</span>
<a name="line-215"></a><span class='hs-definition'>ifaceForAllSpecToBndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bndr</span> <span class='hs-varid'>tv</span> <span class='hs-varid'>spec</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Bndr</span> <span class='hs-varid'>tv</span> <span class='hs-layout'>(</span><span class='hs-conid'>Invisible</span> <span class='hs-varid'>spec</span><span class='hs-layout'>)</span>
<a name="line-216"></a>
<a name="line-217"></a><a name="IfaceAppArgs"></a><span class='hs-comment'>-- | Stores the arguments in a type application as a list.</span>
<a name="line-218"></a><a name="IfaceAppArgs"></a><span class='hs-comment'>-- See @Note [Suppressing invisible arguments]@.</span>
<a name="line-219"></a><a name="IfaceAppArgs"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceAppArgs</span>
<a name="line-220"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IA_Nil</span>
<a name="line-221"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IA_Arg</span> <span class='hs-conid'>IfaceType</span>    <span class='hs-comment'>-- The type argument</span>
<a name="line-222"></a>
<a name="line-223"></a>           <span class='hs-conid'>ArgFlag</span>      <span class='hs-comment'>-- The argument's visibility. We store this here so</span>
<a name="line-224"></a>                        <span class='hs-comment'>-- that we can:</span>
<a name="line-225"></a>                        <span class='hs-comment'>--</span>
<a name="line-226"></a>                        <span class='hs-comment'>-- 1. Avoid pretty-printing invisible (i.e., specified</span>
<a name="line-227"></a>                        <span class='hs-comment'>--    or inferred) arguments when</span>
<a name="line-228"></a>                        <span class='hs-comment'>--    -fprint-explicit-kinds isn't enabled, or</span>
<a name="line-229"></a>                        <span class='hs-comment'>-- 2. When -fprint-explicit-kinds *is*, enabled, print</span>
<a name="line-230"></a>                        <span class='hs-comment'>--    specified arguments in @(...) and inferred</span>
<a name="line-231"></a>                        <span class='hs-comment'>--    arguments in @{...}.</span>
<a name="line-232"></a>
<a name="line-233"></a>           <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-comment'>-- The rest of the arguments</span>
<a name="line-234"></a>
<a name="line-235"></a><a name="instance%20Semi.Semigroup%20IfaceAppArgs"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Semi.Semigroup</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyword'>where</span>
<a name="line-236"></a>  <span class='hs-conid'>IA_Nil</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>xs</span>              <span class='hs-keyglyph'>=</span> <span class='hs-varid'>xs</span>
<a name="line-237"></a>  <span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>ty</span> <span class='hs-varid'>argf</span> <span class='hs-varid'>rest</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>ty</span> <span class='hs-varid'>argf</span> <span class='hs-layout'>(</span><span class='hs-varid'>rest</span> <span class='hs-conid'>Semi</span><span class='hs-varop'>.&lt;&gt;</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span>
<a name="line-238"></a>
<a name="line-239"></a><a name="instance%20Monoid%20IfaceAppArgs"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Monoid</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyword'>where</span>
<a name="line-240"></a>  <span class='hs-varid'>mempty</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IA_Nil</span>
<a name="line-241"></a>  <span class='hs-varid'>mappend</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Semi</span><span class='hs-varop'>.&lt;&gt;</span><span class='hs-layout'>)</span>
<a name="line-242"></a>
<a name="line-243"></a><a name="IfaceTyCon"></a><span class='hs-comment'>-- Encodes type constructors, kind constructors,</span>
<a name="line-244"></a><a name="IfaceTyCon"></a><span class='hs-comment'>-- coercion constructors, the lot.</span>
<a name="line-245"></a><a name="IfaceTyCon"></a><span class='hs-comment'>-- We have to tag them in order to pretty print them</span>
<a name="line-246"></a><a name="IfaceTyCon"></a><span class='hs-comment'>-- properly.</span>
<a name="line-247"></a><a name="IfaceTyCon"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-layout'>{</span> <span class='hs-varid'>ifaceTyConName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfExtName</span>
<a name="line-248"></a>                             <span class='hs-layout'>,</span> <span class='hs-varid'>ifaceTyConInfo</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTyConInfo</span> <span class='hs-layout'>}</span>
<a name="line-249"></a>    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span><span class='hs-layout'>)</span>
<a name="line-250"></a>
<a name="line-251"></a><a name="IfaceTyConSort"></a><span class='hs-comment'>-- | The various types of TyCons which have special, built-in syntax.</span>
<a name="line-252"></a><a name="IfaceTyConSort"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceTyConSort</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceNormalTyCon</span>          <span class='hs-comment'>-- ^ a regular tycon</span>
<a name="line-253"></a>
<a name="line-254"></a>                    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceTupleTyCon</span> <span class='hs-varop'>!</span><span class='hs-conid'>Arity</span> <span class='hs-varop'>!</span><span class='hs-conid'>TupleSort</span>
<a name="line-255"></a>                      <span class='hs-comment'>-- ^ e.g. @(a, b, c)@ or @(#a, b, c#)@.</span>
<a name="line-256"></a>                      <span class='hs-comment'>-- The arity is the tuple width, not the tycon arity</span>
<a name="line-257"></a>                      <span class='hs-comment'>-- (which is twice the width in the case of unboxed</span>
<a name="line-258"></a>                      <span class='hs-comment'>-- tuples).</span>
<a name="line-259"></a>
<a name="line-260"></a>                    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceSumTyCon</span> <span class='hs-varop'>!</span><span class='hs-conid'>Arity</span>
<a name="line-261"></a>                      <span class='hs-comment'>-- ^ e.g. @(a | b | c)@</span>
<a name="line-262"></a>
<a name="line-263"></a>                    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceEqualityTyCon</span>
<a name="line-264"></a>                      <span class='hs-comment'>-- ^ A heterogeneous equality TyCon</span>
<a name="line-265"></a>                      <span class='hs-comment'>--   (i.e. eqPrimTyCon, eqReprPrimTyCon, heqTyCon)</span>
<a name="line-266"></a>                      <span class='hs-comment'>-- that is actually being applied to two types</span>
<a name="line-267"></a>                      <span class='hs-comment'>-- of the same kind.  This affects pretty-printing</span>
<a name="line-268"></a>                      <span class='hs-comment'>-- only: see Note [Equality predicates in IfaceType]</span>
<a name="line-269"></a>                    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span><span class='hs-layout'>)</span>
<a name="line-270"></a>
<a name="line-271"></a><a name="instance%20Outputable%20IfaceTyConSort"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceTyConSort</span> <span class='hs-keyword'>where</span>
<a name="line-272"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>IfaceNormalTyCon</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"normal"</span>
<a name="line-273"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTupleTyCon</span> <span class='hs-varid'>n</span> <span class='hs-varid'>sort</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>sort</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>colon</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span>
<a name="line-274"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceSumTyCon</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"sum:"</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span>
<a name="line-275"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>IfaceEqualityTyCon</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"equality"</span>
<a name="line-276"></a>
<a name="line-277"></a><span class='hs-comment'>{- Note [Free tyvars in IfaceType]
<a name="line-278"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-279"></a>Nowadays (since Nov 16, 2016) we pretty-print a Type by converting to
<a name="line-280"></a>an IfaceType and pretty printing that.  This eliminates a lot of
<a name="line-281"></a>pretty-print duplication, and it matches what we do with pretty-
<a name="line-282"></a>printing TyThings. See Note [Pretty printing via Iface syntax] in GHC.Types.TyThing.Ppr.
<a name="line-283"></a>
<a name="line-284"></a>It works fine for closed types, but when printing debug traces (e.g.
<a name="line-285"></a>when using -ddump-tc-trace) we print a lot of /open/ types.  These
<a name="line-286"></a>types are full of TcTyVars, and it's absolutely crucial to print them
<a name="line-287"></a>in their full glory, with their unique, TcTyVarDetails etc.
<a name="line-288"></a>
<a name="line-289"></a>So we simply embed a TyVar in IfaceType with the IfaceFreeTyVar constructor.
<a name="line-290"></a>Note that:
<a name="line-291"></a>
<a name="line-292"></a>* We never expect to serialise an IfaceFreeTyVar into an interface file, nor
<a name="line-293"></a>  to deserialise one.  IfaceFreeTyVar is used only in the "convert to IfaceType
<a name="line-294"></a>  and then pretty-print" pipeline.
<a name="line-295"></a>
<a name="line-296"></a>We do the same for covars, naturally.
<a name="line-297"></a>
<a name="line-298"></a>Note [Equality predicates in IfaceType]
<a name="line-299"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-300"></a>GHC has several varieties of type equality (see Note [The equality types story]
<a name="line-301"></a>in GHC.Builtin.Types.Prim for details).  In an effort to avoid confusing users, we suppress
<a name="line-302"></a>the differences during pretty printing unless certain flags are enabled.
<a name="line-303"></a>Here is how each equality predicate* is printed in homogeneous and
<a name="line-304"></a>heterogeneous contexts, depending on which combination of the
<a name="line-305"></a>-fprint-explicit-kinds and -fprint-equality-relations flags is used:
<a name="line-306"></a>
<a name="line-307"></a>--------------------------------------------------------------------------------------------
<a name="line-308"></a>|         Predicate             |        Neither flag        |    -fprint-explicit-kinds   |
<a name="line-309"></a>|-------------------------------|----------------------------|-----------------------------|
<a name="line-310"></a>| a ~ b         (homogeneous)   |        a ~ b               | (a :: Type) ~  (b :: Type)  |
<a name="line-311"></a>| a ~~ b,       homogeneously   |        a ~ b               | (a :: Type) ~  (b :: Type)  |
<a name="line-312"></a>| a ~~ b,       heterogeneously |        a ~~ c              | (a :: Type) ~~ (c :: k)     |
<a name="line-313"></a>| a ~# b,       homogeneously   |        a ~ b               | (a :: Type) ~  (b :: Type)  |
<a name="line-314"></a>| a ~# b,       heterogeneously |        a ~~ c              | (a :: Type) ~~ (c :: k)     |
<a name="line-315"></a>| Coercible a b (homogeneous)   |        Coercible a b       | Coercible @Type a b         |
<a name="line-316"></a>| a ~R# b,      homogeneously   |        Coercible a b       | Coercible @Type a b         |
<a name="line-317"></a>| a ~R# b,      heterogeneously |        a ~R# b             | (a :: Type) ~R# (c :: k)    |
<a name="line-318"></a>|-------------------------------|----------------------------|-----------------------------|
<a name="line-319"></a>|         Predicate             | -fprint-equality-relations |          Both flags         |
<a name="line-320"></a>|-------------------------------|----------------------------|-----------------------------|
<a name="line-321"></a>| a ~ b         (homogeneous)   |        a ~  b              | (a :: Type) ~  (b :: Type)  |
<a name="line-322"></a>| a ~~ b,       homogeneously   |        a ~~ b              | (a :: Type) ~~ (b :: Type)  |
<a name="line-323"></a>| a ~~ b,       heterogeneously |        a ~~ c              | (a :: Type) ~~ (c :: k)     |
<a name="line-324"></a>| a ~# b,       homogeneously   |        a ~# b              | (a :: Type) ~# (b :: Type)  |
<a name="line-325"></a>| a ~# b,       heterogeneously |        a ~# c              | (a :: Type) ~# (c :: k)     |
<a name="line-326"></a>| Coercible a b (homogeneous)   |        Coercible a b       | Coercible @Type a b         |
<a name="line-327"></a>| a ~R# b,      homogeneously   |        a ~R# b             | (a :: Type) ~R# (b :: Type) |
<a name="line-328"></a>| a ~R# b,      heterogeneously |        a ~R# b             | (a :: Type) ~R# (c :: k)    |
<a name="line-329"></a>--------------------------------------------------------------------------------------------
<a name="line-330"></a>
<a name="line-331"></a>(* There is no heterogeneous, representational, lifted equality counterpart
<a name="line-332"></a>to (~~). There could be, but there seems to be no use for it.)
<a name="line-333"></a>
<a name="line-334"></a>This table adheres to the following rules:
<a name="line-335"></a>
<a name="line-336"></a>A. With -fprint-equality-relations, print the true equality relation.
<a name="line-337"></a>B. Without -fprint-equality-relations:
<a name="line-338"></a>     i. If the equality is representational and homogeneous, use Coercible.
<a name="line-339"></a>    ii. Otherwise, if the equality is representational, use ~R#.
<a name="line-340"></a>   iii. If the equality is nominal and homogeneous, use ~.
<a name="line-341"></a>    iv. Otherwise, if the equality is nominal, use ~~.
<a name="line-342"></a>C. With -fprint-explicit-kinds, print kinds on both sides of an infix operator,
<a name="line-343"></a>   as above; or print the kind with Coercible.
<a name="line-344"></a>D. Without -fprint-explicit-kinds, don't print kinds.
<a name="line-345"></a>
<a name="line-346"></a>A hetero-kinded equality is used homogeneously when it is applied to two
<a name="line-347"></a>identical kinds. Unfortunately, determining this from an IfaceType isn't
<a name="line-348"></a>possible since we can't see through type synonyms. Consequently, we need to
<a name="line-349"></a>record whether this particular application is homogeneous in IfaceTyConSort
<a name="line-350"></a>for the purposes of pretty-printing.
<a name="line-351"></a>
<a name="line-352"></a>See Note [The equality types story] in GHC.Builtin.Types.Prim.
<a name="line-353"></a>-}</span>
<a name="line-354"></a>
<a name="line-355"></a><a name="IfaceTyConInfo"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceTyConInfo</span>   <span class='hs-comment'>-- Used to guide pretty-printing</span>
<a name="line-356"></a>                      <span class='hs-comment'>-- and to disambiguate D from 'D (they share a name)</span>
<a name="line-357"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceTyConInfo</span> <span class='hs-layout'>{</span> <span class='hs-varid'>ifaceTyConIsPromoted</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PromotionFlag</span>
<a name="line-358"></a>                   <span class='hs-layout'>,</span> <span class='hs-varid'>ifaceTyConSort</span>       <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTyConSort</span> <span class='hs-layout'>}</span>
<a name="line-359"></a>    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span><span class='hs-layout'>)</span>
<a name="line-360"></a>
<a name="line-361"></a><a name="mkIfaceTyConInfo"></a><span class='hs-comment'>-- This smart constructor allows sharing of the two most common</span>
<a name="line-362"></a><span class='hs-comment'>-- cases. See #19194</span>
<a name="line-363"></a><span class='hs-definition'>mkIfaceTyConInfo</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PromotionFlag</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceTyConSort</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceTyConInfo</span>
<a name="line-364"></a><span class='hs-definition'>mkIfaceTyConInfo</span> <span class='hs-conid'>IsPromoted</span>  <span class='hs-conid'>IfaceNormalTyCon</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceTyConInfo</span> <span class='hs-conid'>IsPromoted</span>  <span class='hs-conid'>IfaceNormalTyCon</span>
<a name="line-365"></a><span class='hs-definition'>mkIfaceTyConInfo</span> <span class='hs-conid'>NotPromoted</span> <span class='hs-conid'>IfaceNormalTyCon</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceTyConInfo</span> <span class='hs-conid'>NotPromoted</span> <span class='hs-conid'>IfaceNormalTyCon</span>
<a name="line-366"></a><span class='hs-definition'>mkIfaceTyConInfo</span> <span class='hs-varid'>prom</span>        <span class='hs-varid'>sort</span>             <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceTyConInfo</span> <span class='hs-varid'>prom</span>        <span class='hs-varid'>sort</span>
<a name="line-367"></a>
<a name="line-368"></a><a name="IfaceMCoercion"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceMCoercion</span>
<a name="line-369"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceMRefl</span>
<a name="line-370"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceMCo</span> <span class='hs-conid'>IfaceCoercion</span>
<a name="line-371"></a>
<a name="line-372"></a><a name="IfaceCoercion"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceCoercion</span>
<a name="line-373"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceReflCo</span>       <span class='hs-conid'>IfaceType</span>
<a name="line-374"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceGReflCo</span>      <span class='hs-conid'>Role</span> <span class='hs-conid'>IfaceType</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceMCoercion</span><span class='hs-layout'>)</span>
<a name="line-375"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceFunCo</span>        <span class='hs-conid'>Role</span> <span class='hs-conid'>IfaceCoercion</span> <span class='hs-conid'>IfaceCoercion</span> <span class='hs-conid'>IfaceCoercion</span>
<a name="line-376"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceTyConAppCo</span>   <span class='hs-conid'>Role</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceCoercion</span><span class='hs-keyglyph'>]</span>
<a name="line-377"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceAppCo</span>        <span class='hs-conid'>IfaceCoercion</span> <span class='hs-conid'>IfaceCoercion</span>
<a name="line-378"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceForAllCo</span>     <span class='hs-conid'>IfaceBndr</span> <span class='hs-conid'>IfaceCoercion</span> <span class='hs-conid'>IfaceCoercion</span>
<a name="line-379"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceCoVarCo</span>      <span class='hs-conid'>IfLclName</span>
<a name="line-380"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceAxiomInstCo</span>  <span class='hs-conid'>IfExtName</span> <span class='hs-conid'>BranchIndex</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceCoercion</span><span class='hs-keyglyph'>]</span>
<a name="line-381"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceAxiomRuleCo</span>  <span class='hs-conid'>IfLclName</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceCoercion</span><span class='hs-keyglyph'>]</span>
<a name="line-382"></a>       <span class='hs-comment'>-- There are only a fixed number of CoAxiomRules, so it suffices</span>
<a name="line-383"></a>       <span class='hs-comment'>-- to use an IfaceLclName to distinguish them.</span>
<a name="line-384"></a>       <span class='hs-comment'>-- See Note [Adding built-in type families] in GHC.Builtin.Types.Literals</span>
<a name="line-385"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceUnivCo</span>       <span class='hs-conid'>IfaceUnivCoProv</span> <span class='hs-conid'>Role</span> <span class='hs-conid'>IfaceType</span> <span class='hs-conid'>IfaceType</span>
<a name="line-386"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceSymCo</span>        <span class='hs-conid'>IfaceCoercion</span>
<a name="line-387"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceTransCo</span>      <span class='hs-conid'>IfaceCoercion</span> <span class='hs-conid'>IfaceCoercion</span>
<a name="line-388"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceNthCo</span>        <span class='hs-conid'>Int</span> <span class='hs-conid'>IfaceCoercion</span>
<a name="line-389"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceLRCo</span>         <span class='hs-conid'>LeftOrRight</span> <span class='hs-conid'>IfaceCoercion</span>
<a name="line-390"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceInstCo</span>       <span class='hs-conid'>IfaceCoercion</span> <span class='hs-conid'>IfaceCoercion</span>
<a name="line-391"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceKindCo</span>       <span class='hs-conid'>IfaceCoercion</span>
<a name="line-392"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceSubCo</span>        <span class='hs-conid'>IfaceCoercion</span>
<a name="line-393"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceFreeCoVar</span>    <span class='hs-conid'>CoVar</span>    <span class='hs-comment'>-- See Note [Free tyvars in IfaceType]</span>
<a name="line-394"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceHoleCo</span>       <span class='hs-conid'>CoVar</span>    <span class='hs-comment'>-- ^ See Note [Holes in IfaceCoercion]</span>
<a name="line-395"></a>
<a name="line-396"></a><a name="IfaceUnivCoProv"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>IfaceUnivCoProv</span>
<a name="line-397"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfacePhantomProv</span> <span class='hs-conid'>IfaceCoercion</span>
<a name="line-398"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceProofIrrelProv</span> <span class='hs-conid'>IfaceCoercion</span>
<a name="line-399"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfacePluginProv</span> <span class='hs-conid'>String</span>
<a name="line-400"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceCorePrepProv</span> <span class='hs-conid'>Bool</span>  <span class='hs-comment'>-- See defn of CorePrepProv</span>
<a name="line-401"></a>
<a name="line-402"></a><span class='hs-comment'>{- Note [Holes in IfaceCoercion]
<a name="line-403"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-404"></a>When typechecking fails the typechecker will produce a HoleCo to stand
<a name="line-405"></a>in place of the unproven assertion. While we generally don't want to
<a name="line-406"></a>let these unproven assertions leak into interface files, we still need
<a name="line-407"></a>to be able to pretty-print them as we use IfaceType's pretty-printer
<a name="line-408"></a>to render Types. For this reason IfaceCoercion has a IfaceHoleCo
<a name="line-409"></a>constructor; however, we fails when asked to serialize to a
<a name="line-410"></a>IfaceHoleCo to ensure that they don't end up in an interface file.
<a name="line-411"></a>
<a name="line-412"></a>
<a name="line-413"></a>%************************************************************************
<a name="line-414"></a>%*                                                                      *
<a name="line-415"></a>                Functions over IFaceTypes
<a name="line-416"></a>*                                                                      *
<a name="line-417"></a>************************************************************************
<a name="line-418"></a>-}</span>
<a name="line-419"></a>
<a name="line-420"></a><a name="ifaceTyConHasKey"></a><span class='hs-definition'>ifaceTyConHasKey</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Unique</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-421"></a><span class='hs-definition'>ifaceTyConHasKey</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>key</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ifaceTyConName</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>`hasKey`</span> <span class='hs-varid'>key</span>
<a name="line-422"></a>
<a name="line-423"></a><a name="isIfaceLiftedTypeKind"></a><span class='hs-comment'>-- | Given a kind K, is K of the form (TYPE ('BoxedRep 'LiftedRep))?</span>
<a name="line-424"></a><span class='hs-definition'>isIfaceLiftedTypeKind</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceKind</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-425"></a><span class='hs-definition'>isIfaceLiftedTypeKind</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tc</span> <span class='hs-conid'>IA_Nil</span><span class='hs-layout'>)</span>
<a name="line-426"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isLiftedTypeKindTyConName</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifaceTyConName</span> <span class='hs-varid'>tc</span><span class='hs-layout'>)</span>
<a name="line-427"></a><span class='hs-definition'>isIfaceLiftedTypeKind</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tc1</span> <span class='hs-varid'>args1</span><span class='hs-layout'>)</span>
<a name="line-428"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isIfaceTyConAppLiftedTypeKind</span> <span class='hs-varid'>tc1</span> <span class='hs-varid'>args1</span>
<a name="line-429"></a><span class='hs-definition'>isIfaceLiftedTypeKind</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-430"></a>
<a name="line-431"></a><a name="isIfaceTyConAppLiftedTypeKind"></a><span class='hs-comment'>-- | Given a kind constructor K and arguments A, returns true if</span>
<a name="line-432"></a><span class='hs-comment'>-- both of the following statements are true:</span>
<a name="line-433"></a><span class='hs-comment'>--</span>
<a name="line-434"></a><span class='hs-comment'>-- * K is TYPE</span>
<a name="line-435"></a><span class='hs-comment'>-- * A is a singleton IfaceAppArgs of the form ('BoxedRep 'Lifted)</span>
<a name="line-436"></a><span class='hs-comment'>--</span>
<a name="line-437"></a><span class='hs-comment'>-- For the second condition, we must also check for the type</span>
<a name="line-438"></a><span class='hs-comment'>-- synonym LiftedRep.</span>
<a name="line-439"></a><span class='hs-definition'>isIfaceTyConAppLiftedTypeKind</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-440"></a><span class='hs-definition'>isIfaceTyConAppLiftedTypeKind</span> <span class='hs-varid'>tc1</span> <span class='hs-varid'>args1</span>
<a name="line-441"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>tc1</span> <span class='hs-varop'>`ifaceTyConHasKey`</span> <span class='hs-varid'>tYPETyConKey</span>
<a name="line-442"></a>  <span class='hs-layout'>,</span> <span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>soleArg1</span> <span class='hs-conid'>Required</span> <span class='hs-conid'>IA_Nil</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>args1</span>
<a name="line-443"></a>  <span class='hs-layout'>,</span> <span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>rep</span> <span class='hs-varid'>args2</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>soleArg1</span> <span class='hs-keyglyph'>=</span>
<a name="line-444"></a>    <span class='hs-keyword'>if</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>rep</span> <span class='hs-varop'>`ifaceTyConHasKey`</span> <span class='hs-varid'>boxedRepDataConKey</span>
<a name="line-445"></a>       <span class='hs-layout'>,</span> <span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>soleArg2</span> <span class='hs-conid'>Required</span> <span class='hs-conid'>IA_Nil</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>args2</span>
<a name="line-446"></a>       <span class='hs-layout'>,</span> <span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>lev</span> <span class='hs-conid'>IA_Nil</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>soleArg2</span>
<a name="line-447"></a>       <span class='hs-layout'>,</span> <span class='hs-varid'>lev</span> <span class='hs-varop'>`ifaceTyConHasKey`</span> <span class='hs-varid'>liftedDataConKey</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>True</span>
<a name="line-448"></a>       <span class='hs-keyglyph'>|</span> <span class='hs-varid'>rep</span> <span class='hs-varop'>`ifaceTyConHasKey`</span> <span class='hs-varid'>liftedRepTyConKey</span>
<a name="line-449"></a>       <span class='hs-layout'>,</span> <span class='hs-conid'>IA_Nil</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>args2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>True</span>
<a name="line-450"></a>       <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>False</span>
<a name="line-451"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-452"></a>
<a name="line-453"></a><a name="splitIfaceSigmaTy"></a><span class='hs-definition'>splitIfaceSigmaTy</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceForAllBndr</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfacePredType</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceType</span><span class='hs-layout'>)</span>
<a name="line-454"></a><span class='hs-comment'>-- Mainly for printing purposes</span>
<a name="line-455"></a><span class='hs-comment'>--</span>
<a name="line-456"></a><span class='hs-comment'>-- Here we split nested IfaceSigmaTy properly.</span>
<a name="line-457"></a><span class='hs-comment'>--</span>
<a name="line-458"></a><span class='hs-comment'>-- @</span>
<a name="line-459"></a><span class='hs-comment'>-- forall t. T t =&gt; forall m a b. M m =&gt; (a -&gt; m b) -&gt; t a -&gt; m (t b)</span>
<a name="line-460"></a><span class='hs-comment'>-- @</span>
<a name="line-461"></a><span class='hs-comment'>--</span>
<a name="line-462"></a><span class='hs-comment'>-- If you called @splitIfaceSigmaTy@ on this type:</span>
<a name="line-463"></a><span class='hs-comment'>--</span>
<a name="line-464"></a><span class='hs-comment'>-- @</span>
<a name="line-465"></a><span class='hs-comment'>-- ([t, m, a, b], [T t, M m], (a -&gt; m b) -&gt; t a -&gt; m (t b))</span>
<a name="line-466"></a><span class='hs-comment'>-- @</span>
<a name="line-467"></a><span class='hs-definition'>splitIfaceSigmaTy</span> <span class='hs-varid'>ty</span>
<a name="line-468"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-layout'>(</span><span class='hs-varid'>bndrs</span><span class='hs-layout'>,</span> <span class='hs-varid'>theta</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-469"></a>      <span class='hs-layout'>(</span><span class='hs-conid'>[]</span><span class='hs-layout'>,</span> <span class='hs-conid'>[]</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>bndrs</span><span class='hs-layout'>,</span> <span class='hs-varid'>theta</span><span class='hs-layout'>,</span> <span class='hs-varid'>tau</span><span class='hs-layout'>)</span>
<a name="line-470"></a>      <span class='hs-keyword'>_</span>        <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>bndrs'</span><span class='hs-layout'>,</span> <span class='hs-varid'>theta'</span><span class='hs-layout'>,</span> <span class='hs-varid'>tau'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitIfaceSigmaTy</span> <span class='hs-varid'>tau</span>
<a name="line-471"></a>                   <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-varid'>bndrs</span> <span class='hs-varop'>++</span> <span class='hs-varid'>bndrs'</span><span class='hs-layout'>,</span> <span class='hs-varid'>theta</span> <span class='hs-varop'>++</span> <span class='hs-varid'>theta'</span><span class='hs-layout'>,</span> <span class='hs-varid'>tau'</span><span class='hs-layout'>)</span>
<a name="line-472"></a>  <span class='hs-keyword'>where</span>
<a name="line-473"></a>    <span class='hs-layout'>(</span><span class='hs-varid'>bndrs</span><span class='hs-layout'>,</span> <span class='hs-varid'>rho</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>split_foralls</span> <span class='hs-varid'>ty</span>
<a name="line-474"></a>    <span class='hs-layout'>(</span><span class='hs-varid'>theta</span><span class='hs-layout'>,</span> <span class='hs-varid'>tau</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>split_rho</span> <span class='hs-varid'>rho</span>
<a name="line-475"></a>
<a name="line-476"></a>    <span class='hs-varid'>split_foralls</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceForAllTy</span> <span class='hs-varid'>bndr</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-477"></a>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isInvisibleArgFlag</span> <span class='hs-layout'>(</span><span class='hs-varid'>binderArgFlag</span> <span class='hs-varid'>bndr</span><span class='hs-layout'>)</span>
<a name="line-478"></a>        <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>split_foralls</span> <span class='hs-varid'>ty</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-varid'>bndrs</span><span class='hs-layout'>,</span> <span class='hs-varid'>rho</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>bndr</span><span class='hs-conop'>:</span><span class='hs-varid'>bndrs</span><span class='hs-layout'>,</span> <span class='hs-varid'>rho</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span>
<a name="line-479"></a>    <span class='hs-varid'>split_foralls</span> <span class='hs-varid'>rho</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>[]</span><span class='hs-layout'>,</span> <span class='hs-varid'>rho</span><span class='hs-layout'>)</span>
<a name="line-480"></a>
<a name="line-481"></a>    <span class='hs-varid'>split_rho</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFunTy</span> <span class='hs-conid'>InvisArg</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>ty1</span> <span class='hs-varid'>ty2</span><span class='hs-layout'>)</span>
<a name="line-482"></a>        <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>split_rho</span> <span class='hs-varid'>ty2</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-varid'>ps</span><span class='hs-layout'>,</span> <span class='hs-varid'>tau</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>ty1</span><span class='hs-conop'>:</span><span class='hs-varid'>ps</span><span class='hs-layout'>,</span> <span class='hs-varid'>tau</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span>
<a name="line-483"></a>    <span class='hs-varid'>split_rho</span> <span class='hs-varid'>tau</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>[]</span><span class='hs-layout'>,</span> <span class='hs-varid'>tau</span><span class='hs-layout'>)</span>
<a name="line-484"></a>
<a name="line-485"></a><a name="splitIfaceReqForallTy"></a><span class='hs-definition'>splitIfaceReqForallTy</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceForAllBndr</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceType</span><span class='hs-layout'>)</span>
<a name="line-486"></a><span class='hs-definition'>splitIfaceReqForallTy</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceForAllTy</span> <span class='hs-varid'>bndr</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-487"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isVisibleArgFlag</span> <span class='hs-layout'>(</span><span class='hs-varid'>binderArgFlag</span> <span class='hs-varid'>bndr</span><span class='hs-layout'>)</span>
<a name="line-488"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>splitIfaceReqForallTy</span> <span class='hs-varid'>ty</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-varid'>bndrs</span><span class='hs-layout'>,</span> <span class='hs-varid'>rho</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>bndr</span><span class='hs-conop'>:</span><span class='hs-varid'>bndrs</span><span class='hs-layout'>,</span> <span class='hs-varid'>rho</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span>
<a name="line-489"></a><span class='hs-definition'>splitIfaceReqForallTy</span> <span class='hs-varid'>rho</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>[]</span><span class='hs-layout'>,</span> <span class='hs-varid'>rho</span><span class='hs-layout'>)</span>
<a name="line-490"></a>
<a name="line-491"></a><a name="suppressIfaceInvisibles"></a><span class='hs-definition'>suppressIfaceInvisibles</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PrintExplicitKinds</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceTyConBinder</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<a name="line-492"></a><span class='hs-definition'>suppressIfaceInvisibles</span> <span class='hs-layout'>(</span><span class='hs-conid'>PrintExplicitKinds</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span> <span class='hs-sel'>_tys</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>xs</span>
<a name="line-493"></a><span class='hs-definition'>suppressIfaceInvisibles</span> <span class='hs-layout'>(</span><span class='hs-conid'>PrintExplicitKinds</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span> <span class='hs-varid'>tys</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>suppress</span> <span class='hs-varid'>tys</span> <span class='hs-varid'>xs</span>
<a name="line-494"></a>    <span class='hs-keyword'>where</span>
<a name="line-495"></a>      <span class='hs-varid'>suppress</span> <span class='hs-keyword'>_</span>       <span class='hs-conid'>[]</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-496"></a>      <span class='hs-varid'>suppress</span> <span class='hs-conid'>[]</span>      <span class='hs-varid'>a</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span>
<a name="line-497"></a>      <span class='hs-varid'>suppress</span> <span class='hs-layout'>(</span><span class='hs-varid'>k</span><span class='hs-conop'>:</span><span class='hs-varid'>ks</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span>
<a name="line-498"></a>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isInvisibleTyConBinder</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>=</span>     <span class='hs-varid'>suppress</span> <span class='hs-varid'>ks</span> <span class='hs-varid'>xs</span>
<a name="line-499"></a>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>                <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span> <span class='hs-conop'>:</span> <span class='hs-varid'>suppress</span> <span class='hs-varid'>ks</span> <span class='hs-varid'>xs</span>
<a name="line-500"></a>
<a name="line-501"></a><a name="stripIfaceInvisVars"></a><span class='hs-definition'>stripIfaceInvisVars</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PrintExplicitKinds</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceTyConBinder</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceTyConBinder</span><span class='hs-keyglyph'>]</span>
<a name="line-502"></a><span class='hs-definition'>stripIfaceInvisVars</span> <span class='hs-layout'>(</span><span class='hs-conid'>PrintExplicitKinds</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span>  <span class='hs-varid'>tyvars</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tyvars</span>
<a name="line-503"></a><span class='hs-definition'>stripIfaceInvisVars</span> <span class='hs-layout'>(</span><span class='hs-conid'>PrintExplicitKinds</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span> <span class='hs-varid'>tyvars</span>
<a name="line-504"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>filterOut</span> <span class='hs-varid'>isInvisibleTyConBinder</span> <span class='hs-varid'>tyvars</span>
<a name="line-505"></a>
<a name="line-506"></a><a name="ifForAllBndrVar"></a><span class='hs-comment'>-- | Extract an 'IfaceBndr' from an 'IfaceForAllBndr'.</span>
<a name="line-507"></a><span class='hs-definition'>ifForAllBndrVar</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceForAllBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceBndr</span>
<a name="line-508"></a><span class='hs-definition'>ifForAllBndrVar</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>binderVar</span>
<a name="line-509"></a>
<a name="line-510"></a><a name="ifForAllBndrName"></a><span class='hs-comment'>-- | Extract the variable name from an 'IfaceForAllBndr'.</span>
<a name="line-511"></a><span class='hs-definition'>ifForAllBndrName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceForAllBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfLclName</span>
<a name="line-512"></a><span class='hs-definition'>ifForAllBndrName</span> <span class='hs-varid'>fab</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ifaceBndrName</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifForAllBndrVar</span> <span class='hs-varid'>fab</span><span class='hs-layout'>)</span>
<a name="line-513"></a>
<a name="line-514"></a><a name="ifTyConBinderVar"></a><span class='hs-comment'>-- | Extract an 'IfaceBndr' from an 'IfaceTyConBinder'.</span>
<a name="line-515"></a><span class='hs-definition'>ifTyConBinderVar</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTyConBinder</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceBndr</span>
<a name="line-516"></a><span class='hs-definition'>ifTyConBinderVar</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>binderVar</span>
<a name="line-517"></a>
<a name="line-518"></a><a name="ifTyConBinderName"></a><span class='hs-comment'>-- | Extract the variable name from an 'IfaceTyConBinder'.</span>
<a name="line-519"></a><span class='hs-definition'>ifTyConBinderName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTyConBinder</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfLclName</span>
<a name="line-520"></a><span class='hs-definition'>ifTyConBinderName</span> <span class='hs-varid'>tcb</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ifaceBndrName</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifTyConBinderVar</span> <span class='hs-varid'>tcb</span><span class='hs-layout'>)</span>
<a name="line-521"></a>
<a name="line-522"></a><a name="ifTypeIsVarFree"></a><span class='hs-definition'>ifTypeIsVarFree</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-523"></a><span class='hs-comment'>-- Returns True if the type definitely has no variables at all</span>
<a name="line-524"></a><span class='hs-comment'>-- Just used to control pretty printing</span>
<a name="line-525"></a><span class='hs-definition'>ifTypeIsVarFree</span> <span class='hs-varid'>ty</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>ty</span>
<a name="line-526"></a>  <span class='hs-keyword'>where</span>
<a name="line-527"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyVar</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-528"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFreeTyVar</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-529"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAppTy</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>fun</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>go_args</span> <span class='hs-varid'>args</span>
<a name="line-530"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFunTy</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>w</span> <span class='hs-varid'>arg</span> <span class='hs-varid'>res</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>w</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>go</span> <span class='hs-varid'>arg</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>go</span> <span class='hs-varid'>res</span>
<a name="line-531"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceForAllTy</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-532"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConApp</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go_args</span> <span class='hs-varid'>args</span>
<a name="line-533"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTupleTy</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go_args</span> <span class='hs-varid'>args</span>
<a name="line-534"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLitTy</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-535"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCastTy</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span> <span class='hs-comment'>-- Safe</span>
<a name="line-536"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCoercionTy</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span> <span class='hs-comment'>-- Safe</span>
<a name="line-537"></a>
<a name="line-538"></a>    <span class='hs-varid'>go_args</span> <span class='hs-conid'>IA_Nil</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-539"></a>    <span class='hs-varid'>go_args</span> <span class='hs-layout'>(</span><span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>arg</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>arg</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>go_args</span> <span class='hs-varid'>args</span>
<a name="line-540"></a>
<a name="line-541"></a><span class='hs-comment'>{- Note [Substitution on IfaceType]
<a name="line-542"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-543"></a>Substitutions on IfaceType are done only during pretty-printing to
<a name="line-544"></a>construct the result type of a GADT, and does not deal with binders
<a name="line-545"></a>(eg IfaceForAll), so it doesn't need fancy capture stuff.  -}</span>
<a name="line-546"></a>
<a name="line-547"></a><a name="IfaceTySubst"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>IfaceTySubst</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>FastStringEnv</span> <span class='hs-conid'>IfaceType</span> <span class='hs-comment'>-- Note [Substitution on IfaceType]</span>
<a name="line-548"></a>
<a name="line-549"></a><a name="mkIfaceTySubst"></a><span class='hs-definition'>mkIfaceTySubst</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>IfLclName</span><span class='hs-layout'>,</span><span class='hs-conid'>IfaceType</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceTySubst</span>
<a name="line-550"></a><span class='hs-comment'>-- See Note [Substitution on IfaceType]</span>
<a name="line-551"></a><span class='hs-definition'>mkIfaceTySubst</span> <span class='hs-varid'>eq_spec</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkFsEnv</span> <span class='hs-varid'>eq_spec</span>
<a name="line-552"></a>
<a name="line-553"></a><a name="inDomIfaceTySubst"></a><span class='hs-definition'>inDomIfaceTySubst</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTySubst</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceTvBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-554"></a><span class='hs-comment'>-- See Note [Substitution on IfaceType]</span>
<a name="line-555"></a><span class='hs-definition'>inDomIfaceTySubst</span> <span class='hs-varid'>subst</span> <span class='hs-layout'>(</span><span class='hs-varid'>fs</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isJust</span> <span class='hs-layout'>(</span><span class='hs-varid'>lookupFsEnv</span> <span class='hs-varid'>subst</span> <span class='hs-varid'>fs</span><span class='hs-layout'>)</span>
<a name="line-556"></a>
<a name="line-557"></a><a name="substIfaceType"></a><span class='hs-definition'>substIfaceType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTySubst</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span>
<a name="line-558"></a><span class='hs-comment'>-- See Note [Substitution on IfaceType]</span>
<a name="line-559"></a><span class='hs-definition'>substIfaceType</span> <span class='hs-varid'>env</span> <span class='hs-varid'>ty</span>
<a name="line-560"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>ty</span>
<a name="line-561"></a>  <span class='hs-keyword'>where</span>
<a name="line-562"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFreeTyVar</span> <span class='hs-varid'>tv</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceFreeTyVar</span> <span class='hs-varid'>tv</span>
<a name="line-563"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyVar</span> <span class='hs-varid'>tv</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>substIfaceTyVar</span> <span class='hs-varid'>env</span> <span class='hs-varid'>tv</span>
<a name="line-564"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAppTy</span>  <span class='hs-varid'>t</span> <span class='hs-varid'>ts</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceAppTy</span>  <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>substIfaceAppArgs</span> <span class='hs-varid'>env</span> <span class='hs-varid'>ts</span><span class='hs-layout'>)</span>
<a name="line-565"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFunTy</span> <span class='hs-varid'>af</span> <span class='hs-varid'>w</span> <span class='hs-varid'>t1</span> <span class='hs-varid'>t2</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceFunTy</span> <span class='hs-varid'>af</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>t1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>t2</span><span class='hs-layout'>)</span>
<a name="line-566"></a>    <span class='hs-varid'>go</span> <span class='hs-varid'>ty</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>IfaceLitTy</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ty</span>
<a name="line-567"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tc</span> <span class='hs-layout'>(</span><span class='hs-varid'>substIfaceAppArgs</span> <span class='hs-varid'>env</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span>
<a name="line-568"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTupleTy</span> <span class='hs-varid'>s</span> <span class='hs-varid'>i</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceTupleTy</span> <span class='hs-varid'>s</span> <span class='hs-varid'>i</span> <span class='hs-layout'>(</span><span class='hs-varid'>substIfaceAppArgs</span> <span class='hs-varid'>env</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span>
<a name="line-569"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceForAllTy</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPanic</span> <span class='hs-str'>"substIfaceType"</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-570"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCastTy</span> <span class='hs-varid'>ty</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceCastTy</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-571"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCoercionTy</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceCoercionTy</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-572"></a>
<a name="line-573"></a>    <span class='hs-varid'>go_mco</span> <span class='hs-conid'>IfaceMRefl</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceMRefl</span>
<a name="line-574"></a>    <span class='hs-varid'>go_mco</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceMCo</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceMCo</span> <span class='hs-varop'>$</span> <span class='hs-varid'>go_co</span> <span class='hs-varid'>co</span>
<a name="line-575"></a>
<a name="line-576"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceReflCo</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>           <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceReflCo</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-577"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceGReflCo</span> <span class='hs-varid'>r</span> <span class='hs-varid'>ty</span> <span class='hs-varid'>mco</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceGReflCo</span> <span class='hs-varid'>r</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_mco</span> <span class='hs-varid'>mco</span><span class='hs-layout'>)</span>
<a name="line-578"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFunCo</span> <span class='hs-varid'>r</span> <span class='hs-varid'>w</span> <span class='hs-varid'>c1</span> <span class='hs-varid'>c2</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceFunCo</span> <span class='hs-varid'>r</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>c1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>c2</span><span class='hs-layout'>)</span>
<a name="line-579"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConAppCo</span> <span class='hs-varid'>r</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>cos</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceTyConAppCo</span> <span class='hs-varid'>r</span> <span class='hs-varid'>tc</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_cos</span> <span class='hs-varid'>cos</span><span class='hs-layout'>)</span>
<a name="line-580"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAppCo</span> <span class='hs-varid'>c1</span> <span class='hs-varid'>c2</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceAppCo</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>c1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>c2</span><span class='hs-layout'>)</span>
<a name="line-581"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceForAllCo</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPanic</span> <span class='hs-str'>"substIfaceCoercion"</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-582"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFreeCoVar</span> <span class='hs-varid'>cv</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceFreeCoVar</span> <span class='hs-varid'>cv</span>
<a name="line-583"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCoVarCo</span> <span class='hs-varid'>cv</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceCoVarCo</span> <span class='hs-varid'>cv</span>
<a name="line-584"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceHoleCo</span> <span class='hs-varid'>cv</span><span class='hs-layout'>)</span>           <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceHoleCo</span> <span class='hs-varid'>cv</span>
<a name="line-585"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAxiomInstCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>i</span> <span class='hs-varid'>cos</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceAxiomInstCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>i</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_cos</span> <span class='hs-varid'>cos</span><span class='hs-layout'>)</span>
<a name="line-586"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceUnivCo</span> <span class='hs-varid'>prov</span> <span class='hs-varid'>r</span> <span class='hs-varid'>t1</span> <span class='hs-varid'>t2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceUnivCo</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_prov</span> <span class='hs-varid'>prov</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>t1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>t2</span><span class='hs-layout'>)</span>
<a name="line-587"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceSymCo</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>            <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceSymCo</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-588"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTransCo</span> <span class='hs-varid'>co1</span> <span class='hs-varid'>co2</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceTransCo</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>co1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>co2</span><span class='hs-layout'>)</span>
<a name="line-589"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceNthCo</span> <span class='hs-varid'>n</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceNthCo</span> <span class='hs-varid'>n</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-590"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLRCo</span> <span class='hs-varid'>lr</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceLRCo</span> <span class='hs-varid'>lr</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-591"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceInstCo</span> <span class='hs-varid'>c1</span> <span class='hs-varid'>c2</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceInstCo</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>c1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>c2</span><span class='hs-layout'>)</span>
<a name="line-592"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceKindCo</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>           <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceKindCo</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-593"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceSubCo</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>            <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceSubCo</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-594"></a>    <span class='hs-varid'>go_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAxiomRuleCo</span> <span class='hs-varid'>n</span> <span class='hs-varid'>cos</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceAxiomRuleCo</span> <span class='hs-varid'>n</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_cos</span> <span class='hs-varid'>cos</span><span class='hs-layout'>)</span>
<a name="line-595"></a>
<a name="line-596"></a>    <span class='hs-varid'>go_cos</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-varid'>go_co</span>
<a name="line-597"></a>
<a name="line-598"></a>    <span class='hs-varid'>go_prov</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfacePhantomProv</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfacePhantomProv</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-599"></a>    <span class='hs-varid'>go_prov</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceProofIrrelProv</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceProofIrrelProv</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_co</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-600"></a>    <span class='hs-varid'>go_prov</span> <span class='hs-varid'>co</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>IfacePluginProv</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>co</span>
<a name="line-601"></a>    <span class='hs-varid'>go_prov</span> <span class='hs-varid'>co</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>IfaceCorePrepProv</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>co</span>
<a name="line-602"></a>
<a name="line-603"></a><a name="substIfaceAppArgs"></a><span class='hs-definition'>substIfaceAppArgs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTySubst</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceAppArgs</span>
<a name="line-604"></a><span class='hs-definition'>substIfaceAppArgs</span> <span class='hs-varid'>env</span> <span class='hs-varid'>args</span>
<a name="line-605"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>args</span>
<a name="line-606"></a>  <span class='hs-keyword'>where</span>
<a name="line-607"></a>    <span class='hs-varid'>go</span> <span class='hs-conid'>IA_Nil</span>              <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IA_Nil</span>
<a name="line-608"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>ty</span> <span class='hs-varid'>arg</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IA_Arg</span> <span class='hs-layout'>(</span><span class='hs-varid'>substIfaceType</span> <span class='hs-varid'>env</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-varid'>arg</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span>
<a name="line-609"></a>
<a name="line-610"></a><a name="substIfaceTyVar"></a><span class='hs-definition'>substIfaceTyVar</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTySubst</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfLclName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span>
<a name="line-611"></a><span class='hs-definition'>substIfaceTyVar</span> <span class='hs-varid'>env</span> <span class='hs-varid'>tv</span>
<a name="line-612"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>ty</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>lookupFsEnv</span> <span class='hs-varid'>env</span> <span class='hs-varid'>tv</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ty</span>
<a name="line-613"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>                     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceTyVar</span> <span class='hs-varid'>tv</span>
<a name="line-614"></a>
<a name="line-615"></a>
<a name="line-616"></a><span class='hs-comment'>{-
<a name="line-617"></a>************************************************************************
<a name="line-618"></a>*                                                                      *
<a name="line-619"></a>                Functions over IfaceAppArgs
<a name="line-620"></a>*                                                                      *
<a name="line-621"></a>************************************************************************
<a name="line-622"></a>-}</span>
<a name="line-623"></a>
<a name="line-624"></a><a name="stripInvisArgs"></a><span class='hs-definition'>stripInvisArgs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PrintExplicitKinds</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceAppArgs</span>
<a name="line-625"></a><span class='hs-definition'>stripInvisArgs</span> <span class='hs-layout'>(</span><span class='hs-conid'>PrintExplicitKinds</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span>  <span class='hs-varid'>tys</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tys</span>
<a name="line-626"></a><span class='hs-definition'>stripInvisArgs</span> <span class='hs-layout'>(</span><span class='hs-conid'>PrintExplicitKinds</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span> <span class='hs-varid'>tys</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>suppress_invis</span> <span class='hs-varid'>tys</span>
<a name="line-627"></a>    <span class='hs-keyword'>where</span>
<a name="line-628"></a>      <span class='hs-varid'>suppress_invis</span> <span class='hs-varid'>c</span>
<a name="line-629"></a>        <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-630"></a>            <span class='hs-conid'>IA_Nil</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IA_Nil</span>
<a name="line-631"></a>            <span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>t</span> <span class='hs-varid'>argf</span> <span class='hs-varid'>ts</span>
<a name="line-632"></a>              <span class='hs-keyglyph'>|</span>  <span class='hs-varid'>isVisibleArgFlag</span> <span class='hs-varid'>argf</span>
<a name="line-633"></a>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>t</span> <span class='hs-varid'>argf</span> <span class='hs-varop'>$</span> <span class='hs-varid'>suppress_invis</span> <span class='hs-varid'>ts</span>
<a name="line-634"></a>              <span class='hs-comment'>-- Keep recursing through the remainder of the arguments, as it's</span>
<a name="line-635"></a>              <span class='hs-comment'>-- possible that there are remaining invisible ones.</span>
<a name="line-636"></a>              <span class='hs-comment'>-- See the "In type declarations" section of Note [VarBndrs,</span>
<a name="line-637"></a>              <span class='hs-comment'>-- TyCoVarBinders, TyConBinders, and visibility] in GHC.Core.TyCo.Rep.</span>
<a name="line-638"></a>              <span class='hs-keyglyph'>|</span>  <span class='hs-varid'>otherwise</span>
<a name="line-639"></a>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>suppress_invis</span> <span class='hs-varid'>ts</span>
<a name="line-640"></a>
<a name="line-641"></a><a name="appArgsIfaceTypes"></a><span class='hs-definition'>appArgsIfaceTypes</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceType</span><span class='hs-keyglyph'>]</span>
<a name="line-642"></a><span class='hs-definition'>appArgsIfaceTypes</span> <span class='hs-conid'>IA_Nil</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-643"></a><span class='hs-definition'>appArgsIfaceTypes</span> <span class='hs-layout'>(</span><span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>t</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>ts</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>t</span> <span class='hs-conop'>:</span> <span class='hs-varid'>appArgsIfaceTypes</span> <span class='hs-varid'>ts</span>
<a name="line-644"></a>
<a name="line-645"></a><a name="appArgsIfaceTypesArgFlags"></a><span class='hs-definition'>appArgsIfaceTypesArgFlags</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>IfaceType</span><span class='hs-layout'>,</span> <span class='hs-conid'>ArgFlag</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-646"></a><span class='hs-definition'>appArgsIfaceTypesArgFlags</span> <span class='hs-conid'>IA_Nil</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-647"></a><span class='hs-definition'>appArgsIfaceTypesArgFlags</span> <span class='hs-layout'>(</span><span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>t</span> <span class='hs-varid'>a</span> <span class='hs-varid'>ts</span><span class='hs-layout'>)</span>
<a name="line-648"></a>                                 <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>t</span><span class='hs-layout'>,</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-varid'>appArgsIfaceTypesArgFlags</span> <span class='hs-varid'>ts</span>
<a name="line-649"></a>
<a name="line-650"></a><a name="ifaceVisAppArgsLength"></a><span class='hs-definition'>ifaceVisAppArgsLength</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<a name="line-651"></a><span class='hs-definition'>ifaceVisAppArgsLength</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-num'>0</span>
<a name="line-652"></a>  <span class='hs-keyword'>where</span>
<a name="line-653"></a>    <span class='hs-varid'>go</span> <span class='hs-varop'>!</span><span class='hs-varid'>n</span> <span class='hs-conid'>IA_Nil</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>n</span>
<a name="line-654"></a>    <span class='hs-varid'>go</span> <span class='hs-varid'>n</span>  <span class='hs-layout'>(</span><span class='hs-conid'>IA_Arg</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>argf</span> <span class='hs-varid'>rest</span><span class='hs-layout'>)</span>
<a name="line-655"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isVisibleArgFlag</span> <span class='hs-varid'>argf</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>rest</span>
<a name="line-656"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>             <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>n</span> <span class='hs-varid'>rest</span>
<a name="line-657"></a>
<a name="line-658"></a><span class='hs-comment'>{-
<a name="line-659"></a>Note [Suppressing invisible arguments]
<a name="line-660"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-661"></a>We use the IfaceAppArgs data type to specify which of the arguments to a type
<a name="line-662"></a>should be displayed when pretty-printing, under the control of
<a name="line-663"></a>-fprint-explicit-kinds.
<a name="line-664"></a>See also Type.filterOutInvisibleTypes.
<a name="line-665"></a>For example, given
<a name="line-666"></a>
<a name="line-667"></a>    T :: forall k. (k-&gt;*) -&gt; k -&gt; *    -- Ordinary kind polymorphism
<a name="line-668"></a>    'Just :: forall k. k -&gt; 'Maybe k   -- Promoted
<a name="line-669"></a>
<a name="line-670"></a>we want
<a name="line-671"></a>
<a name="line-672"></a>    T * Tree Int    prints as    T Tree Int
<a name="line-673"></a>    'Just *         prints as    Just *
<a name="line-674"></a>
<a name="line-675"></a>For type constructors (IfaceTyConApp), IfaceAppArgs is a quite natural fit,
<a name="line-676"></a>since the corresponding Core constructor:
<a name="line-677"></a>
<a name="line-678"></a>    data Type
<a name="line-679"></a>      = ...
<a name="line-680"></a>      | TyConApp TyCon [Type]
<a name="line-681"></a>
<a name="line-682"></a>Already puts all of its arguments into a list. So when converting a Type to an
<a name="line-683"></a>IfaceType (see toIfaceAppArgsX in GHC.Core.ToIface), we simply use the kind of
<a name="line-684"></a>the TyCon (which is cached) to guide the process of converting the argument
<a name="line-685"></a>Types into an IfaceAppArgs list.
<a name="line-686"></a>
<a name="line-687"></a>We also want this behavior for IfaceAppTy, since given:
<a name="line-688"></a>
<a name="line-689"></a>    data Proxy (a :: k)
<a name="line-690"></a>    f :: forall (t :: forall a. a -&gt; Type). Proxy Type (t Bool True)
<a name="line-691"></a>
<a name="line-692"></a>We want to print the return type as `Proxy (t True)` without the use of
<a name="line-693"></a>-fprint-explicit-kinds (#15330). Accomplishing this is trickier than in the
<a name="line-694"></a>tycon case, because the corresponding Core constructor for IfaceAppTy:
<a name="line-695"></a>
<a name="line-696"></a>    data Type
<a name="line-697"></a>      = ...
<a name="line-698"></a>      | AppTy Type Type
<a name="line-699"></a>
<a name="line-700"></a>Only stores one argument at a time. Therefore, when converting an AppTy to an
<a name="line-701"></a>IfaceAppTy (in toIfaceTypeX in GHC.CoreToIface), we:
<a name="line-702"></a>
<a name="line-703"></a>1. Flatten the chain of AppTys down as much as possible
<a name="line-704"></a>2. Use typeKind to determine the function Type's kind
<a name="line-705"></a>3. Use this kind to guide the process of converting the argument Types into an
<a name="line-706"></a>   IfaceAppArgs list.
<a name="line-707"></a>
<a name="line-708"></a>By flattening the arguments like this, we obtain two benefits:
<a name="line-709"></a>
<a name="line-710"></a>(a) We can reuse the same machinery to pretty-print IfaceTyConApp arguments as
<a name="line-711"></a>    we do IfaceTyApp arguments, which means that we only need to implement the
<a name="line-712"></a>    logic to filter out invisible arguments once.
<a name="line-713"></a>(b) Unlike for tycons, finding the kind of a type in general (through typeKind)
<a name="line-714"></a>    is not a constant-time operation, so by flattening the arguments first, we
<a name="line-715"></a>    decrease the number of times we have to call typeKind.
<a name="line-716"></a>
<a name="line-717"></a>Note [Pretty-printing invisible arguments]
<a name="line-718"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-719"></a>Note [Suppressing invisible arguments] is all about how to avoid printing
<a name="line-720"></a>invisible arguments when the -fprint-explicit-kinds flag is disables. Well,
<a name="line-721"></a>what about when it's enabled? Then we can and should print invisible kind
<a name="line-722"></a>arguments, and this Note explains how we do it.
<a name="line-723"></a>
<a name="line-724"></a>As two running examples, consider the following code:
<a name="line-725"></a>
<a name="line-726"></a>  {-# LANGUAGE PolyKinds #-}
<a name="line-727"></a>  data T1 a
<a name="line-728"></a>  data T2 (a :: k)
<a name="line-729"></a>
<a name="line-730"></a>When displaying these types (with -fprint-explicit-kinds on), we could just
<a name="line-731"></a>do the following:
<a name="line-732"></a>
<a name="line-733"></a>  T1 k a
<a name="line-734"></a>  T2 k a
<a name="line-735"></a>
<a name="line-736"></a>That certainly gets the job done. But it lacks a crucial piece of information:
<a name="line-737"></a>is the `k` argument inferred or specified? To communicate this, we use visible
<a name="line-738"></a>kind application syntax to distinguish the two cases:
<a name="line-739"></a>
<a name="line-740"></a>  T1 @{k} a
<a name="line-741"></a>  T2 @k   a
<a name="line-742"></a>
<a name="line-743"></a>Here, @{k} indicates that `k` is an inferred argument, and @k indicates that
<a name="line-744"></a>`k` is a specified argument. (See
<a name="line-745"></a>Note [VarBndrs, TyCoVarBinders, TyConBinders, and visibility] in GHC.Core.TyCo.Rep for
<a name="line-746"></a>a lengthier explanation on what "inferred" and "specified" mean.)
<a name="line-747"></a>
<a name="line-748"></a>************************************************************************
<a name="line-749"></a>*                                                                      *
<a name="line-750"></a>                Pretty-printing
<a name="line-751"></a>*                                                                      *
<a name="line-752"></a>************************************************************************
<a name="line-753"></a>-}</span>
<a name="line-754"></a>
<a name="line-755"></a><a name="if_print_coercions"></a><span class='hs-definition'>if_print_coercions</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SDoc</span>  <span class='hs-comment'>-- ^ if printing coercions</span>
<a name="line-756"></a>                   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>  <span class='hs-comment'>-- ^ otherwise</span>
<a name="line-757"></a>                   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-758"></a><span class='hs-definition'>if_print_coercions</span> <span class='hs-varid'>yes</span> <span class='hs-varid'>no</span>
<a name="line-759"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sdocOption</span> <span class='hs-varid'>sdocPrintExplicitCoercions</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>print_co</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-760"></a>    <span class='hs-varid'>getPprStyle</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>style</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-761"></a>    <span class='hs-varid'>getPprDebug</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>debug</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-762"></a>    <span class='hs-keyword'>if</span> <span class='hs-varid'>print_co</span> <span class='hs-varop'>||</span> <span class='hs-varid'>dumpStyle</span> <span class='hs-varid'>style</span> <span class='hs-varop'>||</span> <span class='hs-varid'>debug</span>
<a name="line-763"></a>    <span class='hs-keyword'>then</span> <span class='hs-varid'>yes</span>
<a name="line-764"></a>    <span class='hs-keyword'>else</span> <span class='hs-varid'>no</span>
<a name="line-765"></a>
<a name="line-766"></a><a name="pprIfaceInfixApp"></a><span class='hs-definition'>pprIfaceInfixApp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-767"></a><span class='hs-definition'>pprIfaceInfixApp</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>pp_tc</span> <span class='hs-varid'>pp_ty1</span> <span class='hs-varid'>pp_ty2</span>
<a name="line-768"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybeParen</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>opPrec</span> <span class='hs-varop'>$</span>
<a name="line-769"></a>    <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pp_ty1</span><span class='hs-layout'>,</span> <span class='hs-varid'>pp_tc</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pp_ty2</span><span class='hs-keyglyph'>]</span>
<a name="line-770"></a>
<a name="line-771"></a><a name="pprIfacePrefixApp"></a><span class='hs-definition'>pprIfacePrefixApp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>SDoc</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-772"></a><span class='hs-definition'>pprIfacePrefixApp</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>pp_fun</span> <span class='hs-varid'>pp_tys</span>
<a name="line-773"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>null</span> <span class='hs-varid'>pp_tys</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pp_fun</span>
<a name="line-774"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybeParen</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>appPrec</span> <span class='hs-varop'>$</span>
<a name="line-775"></a>                  <span class='hs-varid'>hang</span> <span class='hs-varid'>pp_fun</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-varid'>pp_tys</span><span class='hs-layout'>)</span>
<a name="line-776"></a>
<a name="line-777"></a><a name="isIfaceTauType"></a><span class='hs-definition'>isIfaceTauType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-778"></a><span class='hs-definition'>isIfaceTauType</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceForAllTy</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-779"></a><span class='hs-definition'>isIfaceTauType</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFunTy</span> <span class='hs-conid'>InvisArg</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-780"></a><span class='hs-definition'>isIfaceTauType</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-781"></a>
<a name="line-782"></a><span class='hs-comment'>-- ----------------------------- Printing binders ------------------------------------</span>
<a name="line-783"></a>
<a name="line-784"></a><a name="instance%20Outputable%20IfaceBndr"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceBndr</span> <span class='hs-keyword'>where</span>
<a name="line-785"></a>    <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceIdBndr</span> <span class='hs-varid'>bndr</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprIfaceIdBndr</span> <span class='hs-varid'>bndr</span>
<a name="line-786"></a>    <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTvBndr</span> <span class='hs-varid'>bndr</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'@'</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>pprIfaceTvBndr</span> <span class='hs-varid'>bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>SuppressBndrSig</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span>
<a name="line-787"></a>                                                             <span class='hs-layout'>(</span><span class='hs-conid'>UseBndrParens</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span>
<a name="line-788"></a>
<a name="line-789"></a><a name="pprIfaceBndrs"></a><span class='hs-definition'>pprIfaceBndrs</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceBndr</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-790"></a><span class='hs-definition'>pprIfaceBndrs</span> <span class='hs-varid'>bs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>bs</span><span class='hs-layout'>)</span>
<a name="line-791"></a>
<a name="line-792"></a><a name="pprIfaceLamBndr"></a><span class='hs-definition'>pprIfaceLamBndr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceLamBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-793"></a><span class='hs-definition'>pprIfaceLamBndr</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceNoOneShot</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>b</span>
<a name="line-794"></a><span class='hs-definition'>pprIfaceLamBndr</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceOneShot</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>b</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"[OneShot]"</span>
<a name="line-795"></a>
<a name="line-796"></a><a name="pprIfaceIdBndr"></a><span class='hs-definition'>pprIfaceIdBndr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceIdBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-797"></a><span class='hs-definition'>pprIfaceIdBndr</span> <span class='hs-layout'>(</span><span class='hs-varid'>w</span><span class='hs-layout'>,</span> <span class='hs-varid'>name</span><span class='hs-layout'>,</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>name</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>brackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>dcolon</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-798"></a>
<a name="line-799"></a><span class='hs-comment'>{- Note [Suppressing binder signatures]
<a name="line-800"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-801"></a>When printing the binders in a 'forall', we want to keep the kind annotations:
<a name="line-802"></a>
<a name="line-803"></a>    forall (a :: k). blah
<a name="line-804"></a>              ^^^^
<a name="line-805"></a>              good
<a name="line-806"></a>
<a name="line-807"></a>On the other hand, when we print the binders of a data declaration in :info,
<a name="line-808"></a>the kind information would be redundant due to the standalone kind signature:
<a name="line-809"></a>
<a name="line-810"></a>   type F :: Symbol -&gt; Type
<a name="line-811"></a>   type F (s :: Symbol) = blah
<a name="line-812"></a>             ^^^^^^^^^
<a name="line-813"></a>             redundant
<a name="line-814"></a>
<a name="line-815"></a>Here we'd like to omit the kind annotation:
<a name="line-816"></a>
<a name="line-817"></a>   type F :: Symbol -&gt; Type
<a name="line-818"></a>   type F s = blah
<a name="line-819"></a>
<a name="line-820"></a>Note [Printing type abbreviations]
<a name="line-821"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-822"></a>Normally, we pretty-print `TYPE 'LiftedRep` as `Type` (or `*`) and
<a name="line-823"></a>`FUN 'Many` as `(-&gt;)`.
<a name="line-824"></a>This way, error messages don't refer to levity polymorphism or linearity
<a name="line-825"></a>if it is not necessary.
<a name="line-826"></a>
<a name="line-827"></a>However, when printing the definition of Type or (-&gt;) with :info,
<a name="line-828"></a>this would give confusing output: `type (-&gt;) = (-&gt;)` (#18594).
<a name="line-829"></a>Solution: detect when we are in :info and disable displaying the synonym
<a name="line-830"></a>with the SDoc option sdocPrintTypeAbbreviations.
<a name="line-831"></a>
<a name="line-832"></a>If there will be a need, in the future we could expose it as a flag
<a name="line-833"></a>-fprint-type-abbreviations or even two separate flags controlling
<a name="line-834"></a>TYPE 'LiftedRep and FUN 'Many.
<a name="line-835"></a>-}</span>
<a name="line-836"></a>
<a name="line-837"></a><a name="SuppressBndrSig"></a><span class='hs-comment'>-- | Do we want to suppress kind annotations on binders?</span>
<a name="line-838"></a><a name="SuppressBndrSig"></a><span class='hs-comment'>-- See Note [Suppressing binder signatures]</span>
<a name="line-839"></a><a name="SuppressBndrSig"></a><span class='hs-keyword'>newtype</span> <span class='hs-conid'>SuppressBndrSig</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SuppressBndrSig</span> <span class='hs-conid'>Bool</span>
<a name="line-840"></a>
<a name="line-841"></a><a name="UseBndrParens"></a><span class='hs-keyword'>newtype</span> <span class='hs-conid'>UseBndrParens</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>UseBndrParens</span> <span class='hs-conid'>Bool</span>
<a name="line-842"></a><a name="PrintExplicitKinds"></a><span class='hs-keyword'>newtype</span> <span class='hs-conid'>PrintExplicitKinds</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PrintExplicitKinds</span> <span class='hs-conid'>Bool</span>
<a name="line-843"></a>
<a name="line-844"></a><a name="pprIfaceTvBndr"></a><span class='hs-definition'>pprIfaceTvBndr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTvBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SuppressBndrSig</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>UseBndrParens</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-845"></a><span class='hs-definition'>pprIfaceTvBndr</span> <span class='hs-layout'>(</span><span class='hs-varid'>tv</span><span class='hs-layout'>,</span> <span class='hs-varid'>ki</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>SuppressBndrSig</span> <span class='hs-varid'>suppress_sig</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>UseBndrParens</span> <span class='hs-varid'>use_parens</span><span class='hs-layout'>)</span>
<a name="line-846"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>suppress_sig</span>             <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>tv</span>
<a name="line-847"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isIfaceLiftedTypeKind</span> <span class='hs-varid'>ki</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>tv</span>
<a name="line-848"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>                <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybe_parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>tv</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>dcolon</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ki</span><span class='hs-layout'>)</span>
<a name="line-849"></a>  <span class='hs-keyword'>where</span>
<a name="line-850"></a>    <span class='hs-varid'>maybe_parens</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>use_parens</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parens</span>
<a name="line-851"></a>                 <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>id</span>
<a name="line-852"></a>
<a name="line-853"></a><a name="pprIfaceTyConBinders"></a><span class='hs-definition'>pprIfaceTyConBinders</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SuppressBndrSig</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceTyConBinder</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-854"></a><span class='hs-definition'>pprIfaceTyConBinders</span> <span class='hs-varid'>suppress_sig</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-varop'>.</span> <span class='hs-varid'>map</span> <span class='hs-varid'>go</span>
<a name="line-855"></a>  <span class='hs-keyword'>where</span>
<a name="line-856"></a>    <span class='hs-varid'>go</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTyConBinder</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-857"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceIdBndr</span> <span class='hs-varid'>bndr</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprIfaceIdBndr</span> <span class='hs-varid'>bndr</span>
<a name="line-858"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTvBndr</span> <span class='hs-varid'>bndr</span><span class='hs-layout'>)</span> <span class='hs-varid'>vis</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-859"></a>      <span class='hs-comment'>-- See Note [Pretty-printing invisible arguments]</span>
<a name="line-860"></a>      <span class='hs-keyword'>case</span> <span class='hs-varid'>vis</span> <span class='hs-keyword'>of</span>
<a name="line-861"></a>        <span class='hs-conid'>AnonTCB</span>  <span class='hs-conid'>VisArg</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr_bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>UseBndrParens</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span>
<a name="line-862"></a>        <span class='hs-conid'>AnonTCB</span>  <span class='hs-conid'>InvisArg</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'@'</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>braces</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>UseBndrParens</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-863"></a>          <span class='hs-comment'>-- The above case is rare. (See Note [AnonTCB InvisArg] in GHC.Core.TyCon.)</span>
<a name="line-864"></a>          <span class='hs-comment'>-- Should we print these differently?</span>
<a name="line-865"></a>        <span class='hs-conid'>NamedTCB</span> <span class='hs-conid'>Required</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr_bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>UseBndrParens</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span>
<a name="line-866"></a>        <span class='hs-comment'>-- See Note [Explicit Case Statement for Specificity]</span>
<a name="line-867"></a>        <span class='hs-conid'>NamedTCB</span> <span class='hs-layout'>(</span><span class='hs-conid'>Invisible</span> <span class='hs-varid'>spec</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>spec</span> <span class='hs-keyword'>of</span>
<a name="line-868"></a>          <span class='hs-conid'>SpecifiedSpec</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'@'</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr_bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>UseBndrParens</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span>
<a name="line-869"></a>          <span class='hs-conid'>InferredSpec</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'@'</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>braces</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>UseBndrParens</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-870"></a>      <span class='hs-keyword'>where</span>
<a name="line-871"></a>        <span class='hs-varid'>ppr_bndr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprIfaceTvBndr</span> <span class='hs-varid'>bndr</span> <span class='hs-varid'>suppress_sig</span>
<a name="line-872"></a>
<a name="line-873"></a><a name="instance%20Binary%20IfaceBndr"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span> <span class='hs-conid'>IfaceBndr</span> <span class='hs-keyword'>where</span>
<a name="line-874"></a>    <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceIdBndr</span> <span class='hs-varid'>aa</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-875"></a>            <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>0</span>
<a name="line-876"></a>            <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>aa</span>
<a name="line-877"></a>    <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTvBndr</span> <span class='hs-varid'>ab</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-878"></a>            <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>1</span>
<a name="line-879"></a>            <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>ab</span>
<a name="line-880"></a>    <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-881"></a>            <span class='hs-varid'>h</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getByte</span> <span class='hs-varid'>bh</span>
<a name="line-882"></a>            <span class='hs-keyword'>case</span> <span class='hs-varid'>h</span> <span class='hs-keyword'>of</span>
<a name="line-883"></a>              <span class='hs-num'>0</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>aa</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-884"></a>                      <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceIdBndr</span> <span class='hs-varid'>aa</span><span class='hs-layout'>)</span>
<a name="line-885"></a>              <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>ab</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-886"></a>                      <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTvBndr</span> <span class='hs-varid'>ab</span><span class='hs-layout'>)</span>
<a name="line-887"></a>
<a name="line-888"></a><a name="instance%20Binary%20IfaceOneShot"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span> <span class='hs-conid'>IfaceOneShot</span> <span class='hs-keyword'>where</span>
<a name="line-889"></a>    <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-conid'>IfaceNoOneShot</span> <span class='hs-keyglyph'>=</span>
<a name="line-890"></a>            <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>0</span>
<a name="line-891"></a>    <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-conid'>IfaceOneShot</span> <span class='hs-keyglyph'>=</span>
<a name="line-892"></a>            <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>1</span>
<a name="line-893"></a>    <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-894"></a>            <span class='hs-varid'>h</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getByte</span> <span class='hs-varid'>bh</span>
<a name="line-895"></a>            <span class='hs-keyword'>case</span> <span class='hs-varid'>h</span> <span class='hs-keyword'>of</span>
<a name="line-896"></a>              <span class='hs-num'>0</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>IfaceNoOneShot</span>
<a name="line-897"></a>              <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>IfaceOneShot</span>
<a name="line-898"></a>
<a name="line-899"></a><span class='hs-comment'>-- ----------------------------- Printing IfaceType ------------------------------------</span>
<a name="line-900"></a>
<a name="line-901"></a><a name="instance%20Outputable%20IfaceType"></a><span class='hs-comment'>---------------------------------</span>
<a name="line-902"></a><a name="instance%20Outputable%20IfaceType"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyword'>where</span>
<a name="line-903"></a>  <span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprIfaceType</span> <span class='hs-varid'>ty</span>
<a name="line-904"></a>
<a name="line-905"></a><a name="pprIfaceType"></a><span class='hs-definition'>pprIfaceType</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprParendIfaceType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-906"></a><span class='hs-definition'>pprIfaceType</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPrecIfaceType</span> <span class='hs-varid'>topPrec</span>
<a name="line-907"></a><a name="pprParendIfaceType"></a><span class='hs-definition'>pprParendIfaceType</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPrecIfaceType</span> <span class='hs-varid'>appPrec</span>
<a name="line-908"></a>
<a name="line-909"></a><a name="pprPrecIfaceType"></a><span class='hs-definition'>pprPrecIfaceType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-910"></a><span class='hs-comment'>-- We still need `hideNonStandardTypes`, since the `pprPrecIfaceType` may be</span>
<a name="line-911"></a><span class='hs-comment'>-- called from other places, besides `:type` and `:info`.</span>
<a name="line-912"></a><span class='hs-definition'>pprPrecIfaceType</span> <span class='hs-varid'>prec</span> <span class='hs-varid'>ty</span> <span class='hs-keyglyph'>=</span>
<a name="line-913"></a>  <span class='hs-varid'>hideNonStandardTypes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>prec</span><span class='hs-layout'>)</span> <span class='hs-varid'>ty</span>
<a name="line-914"></a>
<a name="line-915"></a><a name="ppr_fun_arrow"></a><span class='hs-definition'>ppr_fun_arrow</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceMult</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-916"></a><span class='hs-definition'>ppr_fun_arrow</span> <span class='hs-varid'>w</span>
<a name="line-917"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tc</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>w</span>
<a name="line-918"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>`ifaceTyConHasKey`</span> <span class='hs-layout'>(</span><span class='hs-varid'>getUnique</span> <span class='hs-varid'>manyDataConTyCon</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>arrow</span>
<a name="line-919"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tc</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>w</span>
<a name="line-920"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>`ifaceTyConHasKey`</span> <span class='hs-layout'>(</span><span class='hs-varid'>getUnique</span> <span class='hs-varid'>oneDataConTyCon</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lollipop</span>
<a name="line-921"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mulArrow</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprIfaceType</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span>
<a name="line-922"></a>
<a name="line-923"></a><a name="ppr_sigma"></a><span class='hs-definition'>ppr_sigma</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-924"></a><span class='hs-definition'>ppr_sigma</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>ty</span>
<a name="line-925"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybeParen</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>funPrec</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprIfaceSigmaType</span> <span class='hs-conid'>ShowForAllMust</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-926"></a>
<a name="line-927"></a><a name="ppr_ty"></a><span class='hs-definition'>ppr_ty</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-928"></a><span class='hs-definition'>ppr_ty</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>ty</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>IfaceForAllTy</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_sigma</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>ty</span>
<a name="line-929"></a><span class='hs-definition'>ppr_ty</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>ty</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>IfaceFunTy</span> <span class='hs-conid'>InvisArg</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_sigma</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>ty</span>
<a name="line-930"></a>
<a name="line-931"></a><span class='hs-definition'>ppr_ty</span> <span class='hs-keyword'>_</span>         <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFreeTyVar</span> <span class='hs-varid'>tyvar</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>tyvar</span>  <span class='hs-comment'>-- This is the main reason for IfaceFreeTyVar!</span>
<a name="line-932"></a><span class='hs-definition'>ppr_ty</span> <span class='hs-keyword'>_</span>         <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyVar</span> <span class='hs-varid'>tyvar</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>tyvar</span>  <span class='hs-comment'>-- See Note [TcTyVars in IfaceType]</span>
<a name="line-933"></a><span class='hs-definition'>ppr_ty</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprTyTcApp</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>tys</span>
<a name="line-934"></a><span class='hs-definition'>ppr_ty</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTupleTy</span> <span class='hs-varid'>i</span> <span class='hs-varid'>p</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprTuple</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>i</span> <span class='hs-varid'>p</span> <span class='hs-varid'>tys</span>
<a name="line-935"></a><span class='hs-definition'>ppr_ty</span> <span class='hs-keyword'>_</span>         <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLitTy</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprIfaceTyLit</span> <span class='hs-varid'>n</span>
<a name="line-936"></a>        <span class='hs-comment'>-- Function types</span>
<a name="line-937"></a><span class='hs-definition'>ppr_ty</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFunTy</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>w</span> <span class='hs-varid'>ty1</span> <span class='hs-varid'>ty2</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- Should be VisArg</span>
<a name="line-938"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-comment'>-- We don't want to lose synonyms, so we mustn't use splitFunTys here.</span>
<a name="line-939"></a>    <span class='hs-varid'>maybeParen</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>funPrec</span> <span class='hs-varop'>$</span>
<a name="line-940"></a>    <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>funPrec</span> <span class='hs-varid'>ty1</span><span class='hs-layout'>,</span> <span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_fun_tail</span> <span class='hs-varid'>w</span> <span class='hs-varid'>ty2</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-941"></a>  <span class='hs-keyword'>where</span>
<a name="line-942"></a>    <span class='hs-varid'>ppr_fun_tail</span> <span class='hs-varid'>wthis</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFunTy</span> <span class='hs-conid'>VisArg</span> <span class='hs-varid'>wnext</span> <span class='hs-varid'>ty1</span> <span class='hs-varid'>ty2</span><span class='hs-layout'>)</span>
<a name="line-943"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_fun_arrow</span> <span class='hs-varid'>wthis</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>funPrec</span> <span class='hs-varid'>ty1</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-varid'>ppr_fun_tail</span> <span class='hs-varid'>wnext</span> <span class='hs-varid'>ty2</span>
<a name="line-944"></a>    <span class='hs-varid'>ppr_fun_tail</span> <span class='hs-varid'>wthis</span> <span class='hs-varid'>other_ty</span>
<a name="line-945"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr_fun_arrow</span> <span class='hs-varid'>wthis</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceType</span> <span class='hs-varid'>other_ty</span><span class='hs-keyglyph'>]</span>
<a name="line-946"></a>
<a name="line-947"></a><span class='hs-definition'>ppr_ty</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAppTy</span> <span class='hs-varid'>t</span> <span class='hs-varid'>ts</span><span class='hs-layout'>)</span>
<a name="line-948"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>if_print_coercions</span>
<a name="line-949"></a>      <span class='hs-varid'>ppr_app_ty</span>
<a name="line-950"></a>      <span class='hs-varid'>ppr_app_ty_no_casts</span>
<a name="line-951"></a>  <span class='hs-keyword'>where</span>
<a name="line-952"></a>    <span class='hs-varid'>ppr_app_ty</span> <span class='hs-keyglyph'>=</span>
<a name="line-953"></a>        <span class='hs-varid'>sdocOption</span> <span class='hs-varid'>sdocPrintExplicitKinds</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>print_kinds</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-954"></a>        <span class='hs-keyword'>let</span> <span class='hs-varid'>tys_wo_kinds</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>appArgsIfaceTypesArgFlags</span> <span class='hs-varop'>$</span> <span class='hs-varid'>stripInvisArgs</span>
<a name="line-955"></a>                              <span class='hs-layout'>(</span><span class='hs-conid'>PrintExplicitKinds</span> <span class='hs-varid'>print_kinds</span><span class='hs-layout'>)</span> <span class='hs-varid'>ts</span>
<a name="line-956"></a>        <span class='hs-keyword'>in</span> <span class='hs-varid'>pprIfacePrefixApp</span> <span class='hs-varid'>ctxt_prec</span>
<a name="line-957"></a>                             <span class='hs-layout'>(</span><span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>funPrec</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>
<a name="line-958"></a>                             <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_app_arg</span> <span class='hs-varid'>appPrec</span><span class='hs-layout'>)</span> <span class='hs-varid'>tys_wo_kinds</span><span class='hs-layout'>)</span>
<a name="line-959"></a>
<a name="line-960"></a>
<a name="line-961"></a>    <span class='hs-comment'>-- Strip any casts from the head of the application</span>
<a name="line-962"></a>    <span class='hs-varid'>ppr_app_ty_no_casts</span> <span class='hs-keyglyph'>=</span>
<a name="line-963"></a>        <span class='hs-keyword'>case</span> <span class='hs-varid'>t</span> <span class='hs-keyword'>of</span>
<a name="line-964"></a>          <span class='hs-conid'>IfaceCastTy</span> <span class='hs-varid'>head</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-varid'>mk_app_tys</span> <span class='hs-varid'>head</span> <span class='hs-varid'>ts</span><span class='hs-layout'>)</span>
<a name="line-965"></a>          <span class='hs-keyword'>_</span>                  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr_app_ty</span>
<a name="line-966"></a>
<a name="line-967"></a>    <span class='hs-varid'>mk_app_tys</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span>
<a name="line-968"></a>    <span class='hs-varid'>mk_app_tys</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>tys1</span><span class='hs-layout'>)</span> <span class='hs-varid'>tys2</span> <span class='hs-keyglyph'>=</span>
<a name="line-969"></a>        <span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tc</span> <span class='hs-layout'>(</span><span class='hs-varid'>tys1</span> <span class='hs-varop'>`mappend`</span> <span class='hs-varid'>tys2</span><span class='hs-layout'>)</span>
<a name="line-970"></a>    <span class='hs-varid'>mk_app_tys</span> <span class='hs-varid'>t1</span> <span class='hs-varid'>tys2</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceAppTy</span> <span class='hs-varid'>t1</span> <span class='hs-varid'>tys2</span>
<a name="line-971"></a>
<a name="line-972"></a><span class='hs-definition'>ppr_ty</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCastTy</span> <span class='hs-varid'>ty</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-973"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>if_print_coercions</span>
<a name="line-974"></a>      <span class='hs-layout'>(</span><span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>topPrec</span> <span class='hs-varid'>ty</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"|&gt;"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-975"></a>      <span class='hs-layout'>(</span><span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-976"></a>
<a name="line-977"></a><span class='hs-definition'>ppr_ty</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCoercionTy</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-978"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>if_print_coercions</span>
<a name="line-979"></a>      <span class='hs-layout'>(</span><span class='hs-varid'>ppr_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-980"></a>      <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"&lt;&gt;"</span><span class='hs-layout'>)</span>
<a name="line-981"></a>
<a name="line-982"></a><span class='hs-comment'>{- Note [Defaulting RuntimeRep variables]
<a name="line-983"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-984"></a>RuntimeRep variables are considered by many (most?) users to be little
<a name="line-985"></a>more than syntactic noise. When the notion was introduced there was a
<a name="line-986"></a>significant and understandable push-back from those with pedagogy in
<a name="line-987"></a>mind, which argued that RuntimeRep variables would throw a wrench into
<a name="line-988"></a>nearly any teach approach since they appear in even the lowly ($)
<a name="line-989"></a>function's type,
<a name="line-990"></a>
<a name="line-991"></a>    ($) :: forall (w :: RuntimeRep) a (b :: TYPE w). (a -&gt; b) -&gt; a -&gt; b
<a name="line-992"></a>
<a name="line-993"></a>which is significantly less readable than its non RuntimeRep-polymorphic type of
<a name="line-994"></a>
<a name="line-995"></a>    ($) :: (a -&gt; b) -&gt; a -&gt; b
<a name="line-996"></a>
<a name="line-997"></a>Moreover, unboxed types don't appear all that often in run-of-the-mill
<a name="line-998"></a>Haskell programs, so it makes little sense to make all users pay this
<a name="line-999"></a>syntactic overhead.
<a name="line-1000"></a>
<a name="line-1001"></a>For this reason it was decided that we would hide RuntimeRep variables
<a name="line-1002"></a>for now (see #11549). We do this by defaulting all type variables of
<a name="line-1003"></a>kind RuntimeRep to LiftedRep.
<a name="line-1004"></a>Likewise, we default all Multiplicity variables to Many.
<a name="line-1005"></a>
<a name="line-1006"></a>This is done in a pass right before pretty-printing
<a name="line-1007"></a>(defaultNonStandardVars, controlled by
<a name="line-1008"></a>-fprint-explicit-runtime-reps and -XLinearTypes)
<a name="line-1009"></a>
<a name="line-1010"></a>This applies to /quantified/ variables like 'w' above.  What about
<a name="line-1011"></a>variables that are /free/ in the type being printed, which certainly
<a name="line-1012"></a>happens in error messages.  Suppose (#16074, #19361) we are reporting a
<a name="line-1013"></a>mismatch between skolems
<a name="line-1014"></a>          (a :: RuntimeRep) ~ (b :: RuntimeRep)
<a name="line-1015"></a>        or
<a name="line-1016"></a>          (m :: Multiplicity) ~ Many
<a name="line-1017"></a>We certainly don't want to say "Can't match LiftedRep with LiftedRep" or
<a name="line-1018"></a>"Can't match Many with Many"!
<a name="line-1019"></a>
<a name="line-1020"></a>But if we are printing the type
<a name="line-1021"></a>    (forall (a :: TYPE r). blah)
<a name="line-1022"></a>we do want to turn that (free) r into LiftedRep, so it prints as
<a name="line-1023"></a>    (forall a. blah)
<a name="line-1024"></a>
<a name="line-1025"></a>We use isMetaTyVar to distinguish between those two situations:
<a name="line-1026"></a>metavariables are converted, skolem variables are not.
<a name="line-1027"></a>
<a name="line-1028"></a>There's one exception though: TyVarTv metavariables should not be defaulted,
<a name="line-1029"></a>as they appear during kind-checking of "newtype T :: TYPE r where..."
<a name="line-1030"></a>(test T18357a). Therefore, we additionally test for isTyConableTyVar.
<a name="line-1031"></a>-}</span>
<a name="line-1032"></a>
<a name="line-1033"></a><a name="defaultNonStandardVars"></a><span class='hs-comment'>-- | Default 'RuntimeRep' variables to 'LiftedRep', and 'Multiplicity'</span>
<a name="line-1034"></a><span class='hs-comment'>--   variables to 'Many'. For example:</span>
<a name="line-1035"></a><span class='hs-comment'>--</span>
<a name="line-1036"></a><span class='hs-comment'>-- @</span>
<a name="line-1037"></a><span class='hs-comment'>-- ($) :: forall (r :: GHC.Types.RuntimeRep) a (b :: TYPE r).</span>
<a name="line-1038"></a><span class='hs-comment'>--        (a -&gt; b) -&gt; a -&gt; b</span>
<a name="line-1039"></a><span class='hs-comment'>-- Just :: forall (k :: Multiplicity) a. a # k -&gt; Maybe a</span>
<a name="line-1040"></a><span class='hs-comment'>-- @</span>
<a name="line-1041"></a><span class='hs-comment'>--</span>
<a name="line-1042"></a><span class='hs-comment'>-- turns in to,</span>
<a name="line-1043"></a><span class='hs-comment'>--</span>
<a name="line-1044"></a><span class='hs-comment'>-- @ ($) :: forall a (b :: *). (a -&gt; b) -&gt; a -&gt; b @</span>
<a name="line-1045"></a><span class='hs-comment'>-- @ Just :: forall a . a -&gt; Maybe a @</span>
<a name="line-1046"></a><span class='hs-comment'>--</span>
<a name="line-1047"></a><span class='hs-comment'>-- We do this to prevent RuntimeRep and Multiplicity variables from</span>
<a name="line-1048"></a><span class='hs-comment'>-- incurring a significant syntactic overhead in otherwise simple</span>
<a name="line-1049"></a><span class='hs-comment'>-- type signatures (e.g. ($)). See Note [Defaulting RuntimeRep variables]</span>
<a name="line-1050"></a><span class='hs-comment'>-- and #11549 for further discussion.</span>
<a name="line-1051"></a><span class='hs-definition'>defaultNonStandardVars</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span>
<a name="line-1052"></a><span class='hs-definition'>defaultNonStandardVars</span> <span class='hs-varid'>do_runtimereps</span> <span class='hs-varid'>do_multiplicities</span> <span class='hs-varid'>ty</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>emptyFsEnv</span> <span class='hs-varid'>ty</span>
<a name="line-1053"></a>  <span class='hs-keyword'>where</span>
<a name="line-1054"></a>    <span class='hs-varid'>go</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FastStringEnv</span> <span class='hs-conid'>IfaceType</span> <span class='hs-comment'>-- Set of enclosing forall-ed RuntimeRep/Multiplicity variables</span>
<a name="line-1055"></a>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span>
<a name="line-1056"></a>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span>
<a name="line-1057"></a>    <span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceForAllTy</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTvBndr</span> <span class='hs-layout'>(</span><span class='hs-varid'>var</span><span class='hs-layout'>,</span> <span class='hs-varid'>var_kind</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>argf</span><span class='hs-layout'>)</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-1058"></a>     <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isInvisibleArgFlag</span> <span class='hs-varid'>argf</span>  <span class='hs-comment'>-- Don't default *visible* quantification</span>
<a name="line-1059"></a>                                <span class='hs-comment'>-- or we get the mess in #13963</span>
<a name="line-1060"></a>     <span class='hs-layout'>,</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>substituted_ty</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>check_substitution</span> <span class='hs-varid'>var_kind</span>
<a name="line-1061"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>subs'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>extendFsEnv</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>var</span> <span class='hs-varid'>substituted_ty</span>
<a name="line-1062"></a>            <span class='hs-comment'>-- Record that we should replace it with LiftedRep,</span>
<a name="line-1063"></a>            <span class='hs-comment'>-- and recurse, discarding the forall</span>
<a name="line-1064"></a>        <span class='hs-keyword'>in</span> <span class='hs-varid'>go</span> <span class='hs-varid'>subs'</span> <span class='hs-varid'>ty</span>
<a name="line-1065"></a>
<a name="line-1066"></a>    <span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceForAllTy</span> <span class='hs-varid'>bndr</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-1067"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceForAllTy</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_ifacebndr</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>bndr</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-1068"></a>
<a name="line-1069"></a>    <span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>ty</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyVar</span> <span class='hs-varid'>tv</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>lookupFsEnv</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>tv</span> <span class='hs-keyword'>of</span>
<a name="line-1070"></a>      <span class='hs-conid'>Just</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>s</span>
<a name="line-1071"></a>      <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ty</span>
<a name="line-1072"></a>
<a name="line-1073"></a>    <span class='hs-varid'>go</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>ty</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>IfaceFreeTyVar</span> <span class='hs-varid'>tv</span><span class='hs-layout'>)</span>
<a name="line-1074"></a>      <span class='hs-comment'>-- See Note [Defaulting RuntimeRep variables], about free vars</span>
<a name="line-1075"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>do_runtimereps</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-conid'>GHC.Core.Type.isRuntimeRepTy</span> <span class='hs-layout'>(</span><span class='hs-varid'>tyVarKind</span> <span class='hs-varid'>tv</span><span class='hs-layout'>)</span>
<a name="line-1076"></a>      <span class='hs-layout'>,</span> <span class='hs-varid'>isMetaTyVar</span> <span class='hs-varid'>tv</span>
<a name="line-1077"></a>      <span class='hs-layout'>,</span> <span class='hs-varid'>isTyConableTyVar</span> <span class='hs-varid'>tv</span>
<a name="line-1078"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>liftedRep_ty</span>
<a name="line-1079"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>do_multiplicities</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-conid'>GHC.Core.Type.isMultiplicityTy</span> <span class='hs-layout'>(</span><span class='hs-varid'>tyVarKind</span> <span class='hs-varid'>tv</span><span class='hs-layout'>)</span>
<a name="line-1080"></a>      <span class='hs-layout'>,</span> <span class='hs-varid'>isMetaTyVar</span> <span class='hs-varid'>tv</span>
<a name="line-1081"></a>      <span class='hs-layout'>,</span> <span class='hs-varid'>isTyConableTyVar</span> <span class='hs-varid'>tv</span>
<a name="line-1082"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>many_ty</span>
<a name="line-1083"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-1084"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ty</span>
<a name="line-1085"></a>
<a name="line-1086"></a>    <span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>tc_args</span><span class='hs-layout'>)</span>
<a name="line-1087"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tc</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_args</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>tc_args</span><span class='hs-layout'>)</span>
<a name="line-1088"></a>
<a name="line-1089"></a>    <span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTupleTy</span> <span class='hs-varid'>sort</span> <span class='hs-varid'>is_prom</span> <span class='hs-varid'>tc_args</span><span class='hs-layout'>)</span>
<a name="line-1090"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceTupleTy</span> <span class='hs-varid'>sort</span> <span class='hs-varid'>is_prom</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_args</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>tc_args</span><span class='hs-layout'>)</span>
<a name="line-1091"></a>
<a name="line-1092"></a>    <span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFunTy</span> <span class='hs-varid'>af</span> <span class='hs-varid'>w</span> <span class='hs-varid'>arg</span> <span class='hs-varid'>res</span><span class='hs-layout'>)</span>
<a name="line-1093"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceFunTy</span> <span class='hs-varid'>af</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>arg</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>res</span><span class='hs-layout'>)</span>
<a name="line-1094"></a>
<a name="line-1095"></a>    <span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAppTy</span> <span class='hs-varid'>t</span> <span class='hs-varid'>ts</span><span class='hs-layout'>)</span>
<a name="line-1096"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceAppTy</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_args</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>ts</span><span class='hs-layout'>)</span>
<a name="line-1097"></a>
<a name="line-1098"></a>    <span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCastTy</span> <span class='hs-varid'>x</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-1099"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceCastTy</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>co</span>
<a name="line-1100"></a>
<a name="line-1101"></a>    <span class='hs-varid'>go</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>ty</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>IfaceLitTy</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ty</span>
<a name="line-1102"></a>    <span class='hs-varid'>go</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>ty</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>IfaceCoercionTy</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ty</span>
<a name="line-1103"></a>
<a name="line-1104"></a>    <span class='hs-varid'>go_ifacebndr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FastStringEnv</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceForAllBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceForAllBndr</span>
<a name="line-1105"></a>    <span class='hs-varid'>go_ifacebndr</span> <span class='hs-varid'>subs</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceIdBndr</span> <span class='hs-layout'>(</span><span class='hs-varid'>w</span><span class='hs-layout'>,</span> <span class='hs-varid'>n</span><span class='hs-layout'>,</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>argf</span><span class='hs-layout'>)</span>
<a name="line-1106"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceIdBndr</span> <span class='hs-layout'>(</span><span class='hs-varid'>w</span><span class='hs-layout'>,</span> <span class='hs-varid'>n</span><span class='hs-layout'>,</span> <span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>argf</span>
<a name="line-1107"></a>    <span class='hs-varid'>go_ifacebndr</span> <span class='hs-varid'>subs</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTvBndr</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span><span class='hs-layout'>,</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>argf</span><span class='hs-layout'>)</span>
<a name="line-1108"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTvBndr</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span><span class='hs-layout'>,</span> <span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>argf</span>
<a name="line-1109"></a>
<a name="line-1110"></a>    <span class='hs-varid'>go_args</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FastStringEnv</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceAppArgs</span>
<a name="line-1111"></a>    <span class='hs-varid'>go_args</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>IA_Nil</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IA_Nil</span>
<a name="line-1112"></a>    <span class='hs-varid'>go_args</span> <span class='hs-varid'>subs</span> <span class='hs-layout'>(</span><span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>ty</span> <span class='hs-varid'>argf</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span>
<a name="line-1113"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IA_Arg</span> <span class='hs-layout'>(</span><span class='hs-varid'>go</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-varid'>argf</span> <span class='hs-layout'>(</span><span class='hs-varid'>go_args</span> <span class='hs-varid'>subs</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span>
<a name="line-1114"></a>
<a name="line-1115"></a>    <span class='hs-varid'>check_substitution</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>IfaceType</span>
<a name="line-1116"></a>    <span class='hs-varid'>check_substitution</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tc</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>
<a name="line-1117"></a>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>do_runtimereps</span><span class='hs-layout'>,</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>`ifaceTyConHasKey`</span> <span class='hs-varid'>runtimeRepTyConKey</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>liftedRep_ty</span>
<a name="line-1118"></a>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>do_multiplicities</span><span class='hs-layout'>,</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>`ifaceTyConHasKey`</span> <span class='hs-varid'>multiplicityTyConKey</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>many_ty</span>
<a name="line-1119"></a>    <span class='hs-varid'>check_substitution</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span>
<a name="line-1120"></a>
<a name="line-1121"></a><a name="liftedRep_ty"></a><span class='hs-comment'>-- | The type ('BoxedRep 'Lifted), also known as LiftedRep.</span>
<a name="line-1122"></a><span class='hs-definition'>liftedRep_ty</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceType</span>
<a name="line-1123"></a><span class='hs-definition'>liftedRep_ty</span> <span class='hs-keyglyph'>=</span>
<a name="line-1124"></a>  <span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>liftedRep</span> <span class='hs-conid'>IA_Nil</span>
<a name="line-1125"></a>  <span class='hs-keyword'>where</span>
<a name="line-1126"></a>    <span class='hs-varid'>liftedRep</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTyCon</span>
<a name="line-1127"></a>    <span class='hs-varid'>liftedRep</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-varid'>tc_name</span> <span class='hs-layout'>(</span><span class='hs-varid'>mkIfaceTyConInfo</span> <span class='hs-conid'>NotPromoted</span> <span class='hs-conid'>IfaceNormalTyCon</span><span class='hs-layout'>)</span>
<a name="line-1128"></a>      <span class='hs-keyword'>where</span> <span class='hs-varid'>tc_name</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>getName</span> <span class='hs-varid'>liftedRepTyCon</span>
<a name="line-1129"></a>
<a name="line-1130"></a><a name="many_ty"></a><span class='hs-definition'>many_ty</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceType</span>
<a name="line-1131"></a><span class='hs-definition'>many_ty</span> <span class='hs-keyglyph'>=</span>
<a name="line-1132"></a>    <span class='hs-conid'>IfaceTyConApp</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyCon</span> <span class='hs-varid'>dc_name</span> <span class='hs-layout'>(</span><span class='hs-varid'>mkIfaceTyConInfo</span> <span class='hs-conid'>IsPromoted</span> <span class='hs-conid'>IfaceNormalTyCon</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1133"></a>                  <span class='hs-conid'>IA_Nil</span>
<a name="line-1134"></a>  <span class='hs-keyword'>where</span> <span class='hs-varid'>dc_name</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>getName</span> <span class='hs-varid'>manyDataConTyCon</span>
<a name="line-1135"></a>
<a name="line-1136"></a><a name="hideNonStandardTypes"></a><span class='hs-definition'>hideNonStandardTypes</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1137"></a><span class='hs-definition'>hideNonStandardTypes</span> <span class='hs-varid'>f</span> <span class='hs-varid'>ty</span>
<a name="line-1138"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sdocOption</span> <span class='hs-varid'>sdocPrintExplicitRuntimeReps</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>printExplicitRuntimeReps</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-1139"></a>    <span class='hs-varid'>sdocOption</span> <span class='hs-varid'>sdocLinearTypes</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>linearTypes</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-1140"></a>    <span class='hs-varid'>getPprStyle</span>      <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>sty</span>    <span class='hs-keyglyph'>-&gt;</span>
<a name="line-1141"></a>    <span class='hs-keyword'>let</span> <span class='hs-varid'>do_runtimerep</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>not</span> <span class='hs-varid'>printExplicitRuntimeReps</span>
<a name="line-1142"></a>        <span class='hs-varid'>do_multiplicity</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>not</span> <span class='hs-varid'>linearTypes</span>
<a name="line-1143"></a>    <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>userStyle</span> <span class='hs-varid'>sty</span>
<a name="line-1144"></a>       <span class='hs-keyword'>then</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>defaultNonStandardVars</span> <span class='hs-varid'>do_runtimerep</span> <span class='hs-varid'>do_multiplicity</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-1145"></a>       <span class='hs-keyword'>else</span> <span class='hs-varid'>f</span> <span class='hs-varid'>ty</span>
<a name="line-1146"></a>
<a name="line-1147"></a><a name="instance%20Outputable%20IfaceAppArgs"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyword'>where</span>
<a name="line-1148"></a>  <span class='hs-varid'>ppr</span> <span class='hs-varid'>tca</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprIfaceAppArgs</span> <span class='hs-varid'>tca</span>
<a name="line-1149"></a>
<a name="line-1150"></a><a name="pprIfaceAppArgs"></a><span class='hs-definition'>pprIfaceAppArgs</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprParendIfaceAppArgs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1151"></a><span class='hs-definition'>pprIfaceAppArgs</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_app_args</span> <span class='hs-varid'>topPrec</span>
<a name="line-1152"></a><a name="pprParendIfaceAppArgs"></a><span class='hs-definition'>pprParendIfaceAppArgs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_app_args</span> <span class='hs-varid'>appPrec</span>
<a name="line-1153"></a>
<a name="line-1154"></a><a name="ppr_app_args"></a><span class='hs-definition'>ppr_app_args</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1155"></a><span class='hs-definition'>ppr_app_args</span> <span class='hs-varid'>ctx_prec</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span>
<a name="line-1156"></a>  <span class='hs-keyword'>where</span>
<a name="line-1157"></a>    <span class='hs-varid'>go</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1158"></a>    <span class='hs-varid'>go</span> <span class='hs-conid'>IA_Nil</span>             <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
<a name="line-1159"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>t</span> <span class='hs-varid'>argf</span> <span class='hs-varid'>ts</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_app_arg</span> <span class='hs-varid'>ctx_prec</span> <span class='hs-layout'>(</span><span class='hs-varid'>t</span><span class='hs-layout'>,</span> <span class='hs-varid'>argf</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>go</span> <span class='hs-varid'>ts</span>
<a name="line-1160"></a>
<a name="line-1161"></a><a name="ppr_app_arg"></a><span class='hs-comment'>-- See Note [Pretty-printing invisible arguments]</span>
<a name="line-1162"></a><span class='hs-definition'>ppr_app_arg</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceType</span><span class='hs-layout'>,</span> <span class='hs-conid'>ArgFlag</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1163"></a><span class='hs-definition'>ppr_app_arg</span> <span class='hs-varid'>ctx_prec</span> <span class='hs-layout'>(</span><span class='hs-varid'>t</span><span class='hs-layout'>,</span> <span class='hs-varid'>argf</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-1164"></a>  <span class='hs-varid'>sdocOption</span> <span class='hs-varid'>sdocPrintExplicitKinds</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>print_kinds</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-1165"></a>  <span class='hs-keyword'>case</span> <span class='hs-varid'>argf</span> <span class='hs-keyword'>of</span>
<a name="line-1166"></a>       <span class='hs-conid'>Required</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>ctx_prec</span> <span class='hs-varid'>t</span>
<a name="line-1167"></a>       <span class='hs-conid'>Specified</span> <span class='hs-keyglyph'>|</span>  <span class='hs-varid'>print_kinds</span>
<a name="line-1168"></a>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'@'</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>appPrec</span> <span class='hs-varid'>t</span>
<a name="line-1169"></a>       <span class='hs-conid'>Inferred</span>  <span class='hs-keyglyph'>|</span>  <span class='hs-varid'>print_kinds</span>
<a name="line-1170"></a>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'@'</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>braces</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>topPrec</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>
<a name="line-1171"></a>       <span class='hs-keyword'>_</span>         <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>empty</span>
<a name="line-1172"></a>
<a name="line-1173"></a><a name="pprIfaceForAllPart"></a><span class='hs-comment'>-------------------</span>
<a name="line-1174"></a><span class='hs-definition'>pprIfaceForAllPart</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceForAllBndr</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfacePredType</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1175"></a><span class='hs-definition'>pprIfaceForAllPart</span> <span class='hs-varid'>tvs</span> <span class='hs-varid'>ctxt</span> <span class='hs-varid'>sdoc</span>
<a name="line-1176"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_iface_forall_part</span> <span class='hs-conid'>ShowForAllWhen</span> <span class='hs-varid'>tvs</span> <span class='hs-varid'>ctxt</span> <span class='hs-varid'>sdoc</span>
<a name="line-1177"></a>
<a name="line-1178"></a><a name="pprIfaceForAllPartMust"></a><span class='hs-comment'>-- | Like 'pprIfaceForAllPart', but always uses an explicit @forall@.</span>
<a name="line-1179"></a><span class='hs-definition'>pprIfaceForAllPartMust</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceForAllBndr</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfacePredType</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1180"></a><span class='hs-definition'>pprIfaceForAllPartMust</span> <span class='hs-varid'>tvs</span> <span class='hs-varid'>ctxt</span> <span class='hs-varid'>sdoc</span>
<a name="line-1181"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_iface_forall_part</span> <span class='hs-conid'>ShowForAllMust</span> <span class='hs-varid'>tvs</span> <span class='hs-varid'>ctxt</span> <span class='hs-varid'>sdoc</span>
<a name="line-1182"></a>
<a name="line-1183"></a><a name="pprIfaceForAllCoPart"></a><span class='hs-definition'>pprIfaceForAllCoPart</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>IfLclName</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceCoercion</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1184"></a><span class='hs-definition'>pprIfaceForAllCoPart</span> <span class='hs-varid'>tvs</span> <span class='hs-varid'>sdoc</span>
<a name="line-1185"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>pprIfaceForAllCo</span> <span class='hs-varid'>tvs</span><span class='hs-layout'>,</span> <span class='hs-varid'>sdoc</span> <span class='hs-keyglyph'>]</span>
<a name="line-1186"></a>
<a name="line-1187"></a><a name="ppr_iface_forall_part"></a><span class='hs-definition'>ppr_iface_forall_part</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ShowForAllFlag</span>
<a name="line-1188"></a>                      <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceForAllBndr</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfacePredType</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1189"></a><span class='hs-definition'>ppr_iface_forall_part</span> <span class='hs-varid'>show_forall</span> <span class='hs-varid'>tvs</span> <span class='hs-varid'>ctxt</span> <span class='hs-varid'>sdoc</span>
<a name="line-1190"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>show_forall</span> <span class='hs-keyword'>of</span>
<a name="line-1191"></a>            <span class='hs-conid'>ShowForAllMust</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>pprIfaceForAll</span> <span class='hs-varid'>tvs</span>
<a name="line-1192"></a>            <span class='hs-conid'>ShowForAllWhen</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>pprUserIfaceForAll</span> <span class='hs-varid'>tvs</span>
<a name="line-1193"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>pprIfaceContextArr</span> <span class='hs-varid'>ctxt</span>
<a name="line-1194"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>sdoc</span><span class='hs-keyglyph'>]</span>
<a name="line-1195"></a>
<a name="line-1196"></a><a name="pprIfaceForAll"></a><span class='hs-comment'>-- | Render the "forall ... ." or "forall ... -&gt;" bit of a type.</span>
<a name="line-1197"></a><span class='hs-definition'>pprIfaceForAll</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceForAllBndr</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1198"></a><span class='hs-definition'>pprIfaceForAll</span> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
<a name="line-1199"></a><span class='hs-definition'>pprIfaceForAll</span> <span class='hs-varid'>bndrs</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Bndr</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>vis</span> <span class='hs-conop'>:</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>
<a name="line-1200"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>add_separator</span> <span class='hs-layout'>(</span><span class='hs-varid'>forAllLit</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>fsep</span> <span class='hs-varid'>docs</span><span class='hs-layout'>)</span>
<a name="line-1201"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>pprIfaceForAll</span> <span class='hs-varid'>bndrs'</span> <span class='hs-keyglyph'>]</span>
<a name="line-1202"></a>  <span class='hs-keyword'>where</span>
<a name="line-1203"></a>    <span class='hs-layout'>(</span><span class='hs-varid'>bndrs'</span><span class='hs-layout'>,</span> <span class='hs-varid'>docs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_itv_bndrs</span> <span class='hs-varid'>bndrs</span> <span class='hs-varid'>vis</span>
<a name="line-1204"></a>
<a name="line-1205"></a>    <span class='hs-varid'>add_separator</span> <span class='hs-varid'>stuff</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>vis</span> <span class='hs-keyword'>of</span>
<a name="line-1206"></a>                            <span class='hs-conid'>Required</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>stuff</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>arrow</span>
<a name="line-1207"></a>                            <span class='hs-sel'>_inv</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>stuff</span> <span class='hs-varop'>&lt;&gt;</span>  <span class='hs-varid'>dot</span>
<a name="line-1208"></a>
<a name="line-1209"></a>
<a name="line-1210"></a><a name="ppr_itv_bndrs"></a><span class='hs-comment'>-- | Render the ... in @(forall ... .)@ or @(forall ... -&gt;)@.</span>
<a name="line-1211"></a><span class='hs-comment'>-- Returns both the list of not-yet-rendered binders and the doc.</span>
<a name="line-1212"></a><span class='hs-comment'>-- No anonymous binders here!</span>
<a name="line-1213"></a><span class='hs-definition'>ppr_itv_bndrs</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceForAllBndr</span><span class='hs-keyglyph'>]</span>
<a name="line-1214"></a>             <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ArgFlag</span>  <span class='hs-comment'>-- ^ visibility of the first binder in the list</span>
<a name="line-1215"></a>             <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceForAllBndr</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>SDoc</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1216"></a><span class='hs-definition'>ppr_itv_bndrs</span> <span class='hs-varid'>all_bndrs</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-varid'>bndr</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Bndr</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>vis</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-varid'>bndrs</span><span class='hs-layout'>)</span> <span class='hs-varid'>vis1</span>
<a name="line-1217"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>vis</span> <span class='hs-varop'>`sameVis`</span> <span class='hs-varid'>vis1</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>bndrs'</span><span class='hs-layout'>,</span> <span class='hs-varid'>doc</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_itv_bndrs</span> <span class='hs-varid'>bndrs</span> <span class='hs-varid'>vis1</span> <span class='hs-keyword'>in</span>
<a name="line-1218"></a>                         <span class='hs-layout'>(</span><span class='hs-varid'>bndrs'</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprIfaceForAllBndr</span> <span class='hs-varid'>bndr</span> <span class='hs-conop'>:</span> <span class='hs-varid'>doc</span><span class='hs-layout'>)</span>
<a name="line-1219"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>all_bndrs</span><span class='hs-layout'>,</span> <span class='hs-conid'>[]</span><span class='hs-layout'>)</span>
<a name="line-1220"></a><span class='hs-definition'>ppr_itv_bndrs</span> <span class='hs-conid'>[]</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>[]</span><span class='hs-layout'>,</span> <span class='hs-conid'>[]</span><span class='hs-layout'>)</span>
<a name="line-1221"></a>
<a name="line-1222"></a><a name="pprIfaceForAllCo"></a><span class='hs-definition'>pprIfaceForAllCo</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>IfLclName</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceCoercion</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1223"></a><span class='hs-definition'>pprIfaceForAllCo</span> <span class='hs-conid'>[]</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
<a name="line-1224"></a><span class='hs-definition'>pprIfaceForAllCo</span> <span class='hs-varid'>tvs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"forall"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceForAllCoBndrs</span> <span class='hs-varid'>tvs</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>dot</span>
<a name="line-1225"></a>
<a name="line-1226"></a><a name="pprIfaceForAllCoBndrs"></a><span class='hs-definition'>pprIfaceForAllCoBndrs</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>IfLclName</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceCoercion</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1227"></a><span class='hs-definition'>pprIfaceForAllCoBndrs</span> <span class='hs-varid'>bndrs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-varop'>$</span> <span class='hs-varid'>map</span> <span class='hs-varid'>pprIfaceForAllCoBndr</span> <span class='hs-varid'>bndrs</span>
<a name="line-1228"></a>
<a name="line-1229"></a><a name="pprIfaceForAllBndr"></a><span class='hs-definition'>pprIfaceForAllBndr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceForAllBndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1230"></a><span class='hs-definition'>pprIfaceForAllBndr</span> <span class='hs-varid'>bndr</span> <span class='hs-keyglyph'>=</span>
<a name="line-1231"></a>  <span class='hs-keyword'>case</span> <span class='hs-varid'>bndr</span> <span class='hs-keyword'>of</span>
<a name="line-1232"></a>    <span class='hs-conid'>Bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTvBndr</span> <span class='hs-varid'>tv</span><span class='hs-layout'>)</span> <span class='hs-conid'>Inferred</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-1233"></a>      <span class='hs-varid'>braces</span> <span class='hs-varop'>$</span> <span class='hs-varid'>pprIfaceTvBndr</span> <span class='hs-varid'>tv</span> <span class='hs-varid'>suppress_sig</span> <span class='hs-layout'>(</span><span class='hs-conid'>UseBndrParens</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span>
<a name="line-1234"></a>    <span class='hs-conid'>Bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTvBndr</span> <span class='hs-varid'>tv</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-1235"></a>      <span class='hs-varid'>pprIfaceTvBndr</span> <span class='hs-varid'>tv</span> <span class='hs-varid'>suppress_sig</span> <span class='hs-layout'>(</span><span class='hs-conid'>UseBndrParens</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span>
<a name="line-1236"></a>    <span class='hs-conid'>Bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceIdBndr</span> <span class='hs-varid'>idv</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>pprIfaceIdBndr</span> <span class='hs-varid'>idv</span>
<a name="line-1237"></a>  <span class='hs-keyword'>where</span>
<a name="line-1238"></a>    <span class='hs-comment'>-- See Note [Suppressing binder signatures]</span>
<a name="line-1239"></a>    <span class='hs-varid'>suppress_sig</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SuppressBndrSig</span> <span class='hs-conid'>False</span>
<a name="line-1240"></a>
<a name="line-1241"></a><a name="pprIfaceForAllCoBndr"></a><span class='hs-definition'>pprIfaceForAllCoBndr</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfLclName</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceCoercion</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1242"></a><span class='hs-definition'>pprIfaceForAllCoBndr</span> <span class='hs-layout'>(</span><span class='hs-varid'>tv</span><span class='hs-layout'>,</span> <span class='hs-varid'>kind_co</span><span class='hs-layout'>)</span>
<a name="line-1243"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>tv</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>dcolon</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceCoercion</span> <span class='hs-varid'>kind_co</span><span class='hs-layout'>)</span>
<a name="line-1244"></a>
<a name="line-1245"></a><a name="ShowForAllFlag"></a><span class='hs-comment'>-- | Show forall flag</span>
<a name="line-1246"></a><a name="ShowForAllFlag"></a><span class='hs-comment'>--</span>
<a name="line-1247"></a><a name="ShowForAllFlag"></a><span class='hs-comment'>-- Unconditionally show the forall quantifier with ('ShowForAllMust')</span>
<a name="line-1248"></a><a name="ShowForAllFlag"></a><span class='hs-comment'>-- or when ('ShowForAllWhen') the names used are free in the binder</span>
<a name="line-1249"></a><a name="ShowForAllFlag"></a><span class='hs-comment'>-- or when compiling with -fprint-explicit-foralls.</span>
<a name="line-1250"></a><a name="ShowForAllFlag"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>ShowForAllFlag</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ShowForAllMust</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ShowForAllWhen</span>
<a name="line-1251"></a>
<a name="line-1252"></a><a name="pprIfaceSigmaType"></a><span class='hs-definition'>pprIfaceSigmaType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ShowForAllFlag</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1253"></a><span class='hs-definition'>pprIfaceSigmaType</span> <span class='hs-varid'>show_forall</span> <span class='hs-varid'>ty</span>
<a name="line-1254"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hideNonStandardTypes</span> <span class='hs-varid'>ppr_fn</span> <span class='hs-varid'>ty</span>
<a name="line-1255"></a>  <span class='hs-keyword'>where</span>
<a name="line-1256"></a>    <span class='hs-varid'>ppr_fn</span> <span class='hs-varid'>iface_ty</span> <span class='hs-keyglyph'>=</span>
<a name="line-1257"></a>      <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>invis_tvs</span><span class='hs-layout'>,</span> <span class='hs-varid'>theta</span><span class='hs-layout'>,</span> <span class='hs-varid'>tau</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitIfaceSigmaTy</span> <span class='hs-varid'>iface_ty</span>
<a name="line-1258"></a>          <span class='hs-layout'>(</span><span class='hs-varid'>req_tvs</span><span class='hs-layout'>,</span> <span class='hs-varid'>tau'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>splitIfaceReqForallTy</span> <span class='hs-varid'>tau</span>
<a name="line-1259"></a>          <span class='hs-comment'>-- splitIfaceSigmaTy is recursive, so it will gather the binders after</span>
<a name="line-1260"></a>          <span class='hs-comment'>-- the theta, i.e.  forall a. theta =&gt; forall b. tau</span>
<a name="line-1261"></a>          <span class='hs-comment'>-- will give you    ([a,b], theta, tau).</span>
<a name="line-1262"></a>          <span class='hs-comment'>--</span>
<a name="line-1263"></a>          <span class='hs-comment'>-- This isn't right when it comes to visible forall (see</span>
<a name="line-1264"></a>          <span class='hs-comment'>--  testsuite/tests/polykinds/T18522-ppr),</span>
<a name="line-1265"></a>          <span class='hs-comment'>-- so we split off required binders separately,</span>
<a name="line-1266"></a>          <span class='hs-comment'>-- using splitIfaceReqForallTy.</span>
<a name="line-1267"></a>          <span class='hs-comment'>--</span>
<a name="line-1268"></a>          <span class='hs-comment'>-- An alternative solution would be to make splitIfaceSigmaTy</span>
<a name="line-1269"></a>          <span class='hs-comment'>-- non-recursive (see #18458).</span>
<a name="line-1270"></a>          <span class='hs-comment'>-- Then it could handle both invisible and required binders, and</span>
<a name="line-1271"></a>          <span class='hs-comment'>-- splitIfaceReqForallTy wouldn't be necessary here.</span>
<a name="line-1272"></a>       <span class='hs-keyword'>in</span> <span class='hs-varid'>ppr_iface_forall_part</span> <span class='hs-varid'>show_forall</span> <span class='hs-varid'>invis_tvs</span> <span class='hs-varid'>theta</span> <span class='hs-varop'>$</span>
<a name="line-1273"></a>          <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pprIfaceForAll</span> <span class='hs-varid'>req_tvs</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>tau'</span><span class='hs-keyglyph'>]</span>
<a name="line-1274"></a>
<a name="line-1275"></a><a name="pprUserIfaceForAll"></a><span class='hs-definition'>pprUserIfaceForAll</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceForAllBndr</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1276"></a><span class='hs-definition'>pprUserIfaceForAll</span> <span class='hs-varid'>tvs</span>
<a name="line-1277"></a>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sdocOption</span> <span class='hs-varid'>sdocPrintExplicitForalls</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>print_foralls</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-1278"></a>     <span class='hs-comment'>-- See Note [When to print foralls] in this module.</span>
<a name="line-1279"></a>     <span class='hs-varid'>ppWhen</span> <span class='hs-layout'>(</span><span class='hs-varid'>any</span> <span class='hs-varid'>tv_has_kind_var</span> <span class='hs-varid'>tvs</span>
<a name="line-1280"></a>             <span class='hs-varop'>||</span> <span class='hs-varid'>any</span> <span class='hs-varid'>tv_is_required</span> <span class='hs-varid'>tvs</span>
<a name="line-1281"></a>             <span class='hs-varop'>||</span> <span class='hs-varid'>print_foralls</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span>
<a name="line-1282"></a>     <span class='hs-varid'>pprIfaceForAll</span> <span class='hs-varid'>tvs</span>
<a name="line-1283"></a>   <span class='hs-keyword'>where</span>
<a name="line-1284"></a>     <span class='hs-varid'>tv_has_kind_var</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bndr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTvBndr</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span><span class='hs-varid'>kind</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>
<a name="line-1285"></a>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifTypeIsVarFree</span> <span class='hs-varid'>kind</span><span class='hs-layout'>)</span>
<a name="line-1286"></a>     <span class='hs-varid'>tv_has_kind_var</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-1287"></a>
<a name="line-1288"></a>     <span class='hs-varid'>tv_is_required</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isVisibleArgFlag</span> <span class='hs-varop'>.</span> <span class='hs-varid'>binderArgFlag</span>
<a name="line-1289"></a>
<a name="line-1290"></a><span class='hs-comment'>{-
<a name="line-1291"></a>Note [When to print foralls]
<a name="line-1292"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-1293"></a>We opt to explicitly pretty-print `forall`s if any of the following
<a name="line-1294"></a>criteria are met:
<a name="line-1295"></a>
<a name="line-1296"></a>1. -fprint-explicit-foralls is on.
<a name="line-1297"></a>
<a name="line-1298"></a>2. A bound type variable has a polymorphic kind. E.g.,
<a name="line-1299"></a>
<a name="line-1300"></a>     forall k (a::k). Proxy a -&gt; Proxy a
<a name="line-1301"></a>
<a name="line-1302"></a>   Since a's kind mentions a variable k, we print the foralls.
<a name="line-1303"></a>
<a name="line-1304"></a>3. A bound type variable is a visible argument (#14238).
<a name="line-1305"></a>   Suppose we are printing the kind of:
<a name="line-1306"></a>
<a name="line-1307"></a>     T :: forall k -&gt; k -&gt; Type
<a name="line-1308"></a>
<a name="line-1309"></a>   The "forall k -&gt;" notation means that this kind argument is required.
<a name="line-1310"></a>   That is, it must be supplied at uses of T. E.g.,
<a name="line-1311"></a>
<a name="line-1312"></a>     f :: T (Type-&gt;Type)  Monad -&gt; Int
<a name="line-1313"></a>
<a name="line-1314"></a>   So we print an explicit "T :: forall k -&gt; k -&gt; Type",
<a name="line-1315"></a>   because omitting it and printing "T :: k -&gt; Type" would be
<a name="line-1316"></a>   utterly misleading.
<a name="line-1317"></a>
<a name="line-1318"></a>   See Note [VarBndrs, TyCoVarBinders, TyConBinders, and visibility]
<a name="line-1319"></a>   in GHC.Core.TyCo.Rep.
<a name="line-1320"></a>
<a name="line-1321"></a>N.B. Until now (Aug 2018) we didn't check anything for coercion variables.
<a name="line-1322"></a>
<a name="line-1323"></a>Note [Printing foralls in type family instances]
<a name="line-1324"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-1325"></a>We use the same criteria as in Note [When to print foralls] to determine
<a name="line-1326"></a>whether a type family instance should be pretty-printed with an explicit
<a name="line-1327"></a>`forall`. Example:
<a name="line-1328"></a>
<a name="line-1329"></a>  type family Foo (a :: k) :: k where
<a name="line-1330"></a>    Foo Maybe       = []
<a name="line-1331"></a>    Foo (a :: Type) = Int
<a name="line-1332"></a>    Foo a           = a
<a name="line-1333"></a>
<a name="line-1334"></a>Without -fprint-explicit-foralls enabled, this will be pretty-printed as:
<a name="line-1335"></a>
<a name="line-1336"></a>type family Foo (a :: k) :: k where
<a name="line-1337"></a>  Foo Maybe = []
<a name="line-1338"></a>  Foo a = Int
<a name="line-1339"></a>  forall k (a :: k). Foo a = a
<a name="line-1340"></a>
<a name="line-1341"></a>Note that only the third equation has an explicit forall, since it has a type
<a name="line-1342"></a>variable with a non-Type kind. (If -fprint-explicit-foralls were enabled, then
<a name="line-1343"></a>the second equation would be preceded with `forall a.`.)
<a name="line-1344"></a>
<a name="line-1345"></a>There is one tricky point in the implementation: what visibility
<a name="line-1346"></a>do we give the type variables in a type family instance? Type family instances
<a name="line-1347"></a>only store type *variables*, not type variable *binders*, and only the latter
<a name="line-1348"></a>has visibility information. We opt to default the visibility of each of these
<a name="line-1349"></a>type variables to Specified because users can't ever instantiate these
<a name="line-1350"></a>variables manually, so the choice of visibility is only relevant to
<a name="line-1351"></a>pretty-printing. (This is why the `k` in `forall k (a :: k). ...` above is
<a name="line-1352"></a>printed the way it is, even though it wasn't written explicitly in the
<a name="line-1353"></a>original source code.)
<a name="line-1354"></a>
<a name="line-1355"></a>We adopt the same strategy for data family instances. Example:
<a name="line-1356"></a>
<a name="line-1357"></a>  data family DF (a :: k)
<a name="line-1358"></a>  data instance DF '[a, b] = DFList
<a name="line-1359"></a>
<a name="line-1360"></a>That data family instance is pretty-printed as:
<a name="line-1361"></a>
<a name="line-1362"></a>  data instance forall j (a :: j) (b :: j). DF '[a, b] = DFList
<a name="line-1363"></a>
<a name="line-1364"></a>This is despite that the representation tycon for this data instance (call it
<a name="line-1365"></a>$DF:List) actually has different visibilities for its binders.
<a name="line-1366"></a>However, the visibilities of these binders are utterly irrelevant to the
<a name="line-1367"></a>programmer, who cares only about the specificity of variables in `DF`'s type,
<a name="line-1368"></a>not $DF:List's type. Therefore, we opt to pretty-print all variables in data
<a name="line-1369"></a>family instances as Specified.
<a name="line-1370"></a>
<a name="line-1371"></a>Note [Printing promoted type constructors]
<a name="line-1372"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-1373"></a>Consider this GHCi session (#14343)
<a name="line-1374"></a>    &gt; _ :: Proxy '[ 'True ]
<a name="line-1375"></a>    error:
<a name="line-1376"></a>      Found hole: _ :: Proxy '['True]
<a name="line-1377"></a>
<a name="line-1378"></a>This would be bad, because the '[' looks like a character literal.
<a name="line-1379"></a>Solution: in type-level lists and tuples, add a leading space
<a name="line-1380"></a>if the first type is itself promoted.  See pprSpaceIfPromotedTyCon.
<a name="line-1381"></a>-}</span>
<a name="line-1382"></a>
<a name="line-1383"></a>
<a name="line-1384"></a><span class='hs-comment'>-------------------</span>
<a name="line-1385"></a>
<a name="line-1386"></a><a name="pprSpaceIfPromotedTyCon"></a><span class='hs-comment'>-- | Prefix a space if the given 'IfaceType' is a promoted 'TyCon'.</span>
<a name="line-1387"></a><span class='hs-comment'>-- See Note [Printing promoted type constructors]</span>
<a name="line-1388"></a><span class='hs-definition'>pprSpaceIfPromotedTyCon</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1389"></a><span class='hs-definition'>pprSpaceIfPromotedTyCon</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tyCon</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>
<a name="line-1390"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ifaceTyConIsPromoted</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifaceTyConInfo</span> <span class='hs-varid'>tyCon</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-1391"></a>      <span class='hs-conid'>IsPromoted</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>space</span> <span class='hs-varop'>&lt;&gt;</span><span class='hs-layout'>)</span>
<a name="line-1392"></a>      <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>id</span>
<a name="line-1393"></a><span class='hs-definition'>pprSpaceIfPromotedTyCon</span> <span class='hs-keyword'>_</span>
<a name="line-1394"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>id</span>
<a name="line-1395"></a>
<a name="line-1396"></a><a name="pprIfaceTyList"></a><span class='hs-comment'>-- See equivalent function in "GHC.Core.TyCo.Rep"</span>
<a name="line-1397"></a><span class='hs-definition'>pprIfaceTyList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1398"></a><span class='hs-comment'>-- Given a type-level list (t1 ': t2), see if we can print</span>
<a name="line-1399"></a><span class='hs-comment'>-- it in list notation [t1, ...].</span>
<a name="line-1400"></a><span class='hs-comment'>-- Precondition: Opt_PrintExplicitKinds is off</span>
<a name="line-1401"></a><span class='hs-definition'>pprIfaceTyList</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>ty1</span> <span class='hs-varid'>ty2</span>
<a name="line-1402"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>gather</span> <span class='hs-varid'>ty2</span> <span class='hs-keyword'>of</span>
<a name="line-1403"></a>      <span class='hs-layout'>(</span><span class='hs-varid'>arg_tys</span><span class='hs-layout'>,</span> <span class='hs-conid'>Nothing</span><span class='hs-layout'>)</span>
<a name="line-1404"></a>        <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'\''</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>brackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprSpaceIfPromotedTyCon</span> <span class='hs-varid'>ty1</span> <span class='hs-layout'>(</span><span class='hs-varid'>fsep</span>
<a name="line-1405"></a>                        <span class='hs-layout'>(</span><span class='hs-varid'>punctuate</span> <span class='hs-varid'>comma</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>topPrec</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>ty1</span><span class='hs-conop'>:</span><span class='hs-varid'>arg_tys</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1406"></a>      <span class='hs-layout'>(</span><span class='hs-varid'>arg_tys</span><span class='hs-layout'>,</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>tl</span><span class='hs-layout'>)</span>
<a name="line-1407"></a>        <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>maybeParen</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>funPrec</span> <span class='hs-varop'>$</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>funPrec</span> <span class='hs-varid'>ty1</span><span class='hs-layout'>)</span>
<a name="line-1408"></a>           <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>fsep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>colon</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>funPrec</span> <span class='hs-varid'>ty</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>ty</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>arg_tys</span> <span class='hs-varop'>++</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>tl</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1409"></a>  <span class='hs-keyword'>where</span>
<a name="line-1410"></a>    <span class='hs-varid'>gather</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceType</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>IfaceType</span><span class='hs-layout'>)</span>
<a name="line-1411"></a>     <span class='hs-comment'>-- (gather ty) = (tys, Nothing) means ty is a list [t1, .., tn]</span>
<a name="line-1412"></a>     <span class='hs-comment'>--             = (tys, Just tl) means ty is of form t1:t2:...tn:tl</span>
<a name="line-1413"></a>    <span class='hs-varid'>gather</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span>
<a name="line-1414"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>`ifaceTyConHasKey`</span> <span class='hs-varid'>consDataConKey</span>
<a name="line-1415"></a>      <span class='hs-layout'>,</span> <span class='hs-conid'>IA_Arg</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>argf</span> <span class='hs-layout'>(</span><span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>ty1</span> <span class='hs-conid'>Required</span> <span class='hs-layout'>(</span><span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>ty2</span> <span class='hs-conid'>Required</span> <span class='hs-conid'>IA_Nil</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>tys</span>
<a name="line-1416"></a>      <span class='hs-layout'>,</span> <span class='hs-varid'>isInvisibleArgFlag</span> <span class='hs-varid'>argf</span>
<a name="line-1417"></a>      <span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>args</span><span class='hs-layout'>,</span> <span class='hs-varid'>tl</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>gather</span> <span class='hs-varid'>ty2</span>
<a name="line-1418"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>ty1</span><span class='hs-conop'>:</span><span class='hs-varid'>args</span><span class='hs-layout'>,</span> <span class='hs-varid'>tl</span><span class='hs-layout'>)</span>
<a name="line-1419"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>`ifaceTyConHasKey`</span> <span class='hs-varid'>nilDataConKey</span>
<a name="line-1420"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>[]</span><span class='hs-layout'>,</span> <span class='hs-conid'>Nothing</span><span class='hs-layout'>)</span>
<a name="line-1421"></a>    <span class='hs-varid'>gather</span> <span class='hs-varid'>ty</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>[]</span><span class='hs-layout'>,</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-1422"></a>
<a name="line-1423"></a><a name="pprIfaceTypeApp"></a><span class='hs-definition'>pprIfaceTypeApp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1424"></a><span class='hs-definition'>pprIfaceTypeApp</span> <span class='hs-varid'>prec</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>args</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprTyTcApp</span> <span class='hs-varid'>prec</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>args</span>
<a name="line-1425"></a>
<a name="line-1426"></a><a name="pprTyTcApp"></a><span class='hs-definition'>pprTyTcApp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1427"></a><span class='hs-definition'>pprTyTcApp</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>tys</span> <span class='hs-keyglyph'>=</span>
<a name="line-1428"></a>    <span class='hs-varid'>sdocOption</span> <span class='hs-varid'>sdocPrintExplicitKinds</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>print_kinds</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-1429"></a>    <span class='hs-varid'>sdocOption</span> <span class='hs-varid'>sdocPrintTypeAbbreviations</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>print_type_abbreviations</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-1430"></a>    <span class='hs-varid'>getPprDebug</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>debug</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-1431"></a>
<a name="line-1432"></a>    <span class='hs-keyword'>if</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>ifaceTyConName</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>`hasKey`</span> <span class='hs-varid'>ipClassKey</span>
<a name="line-1433"></a>       <span class='hs-layout'>,</span> <span class='hs-conid'>IA_Arg</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLitTy</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceStrTyLit</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1434"></a>                <span class='hs-conid'>Required</span> <span class='hs-layout'>(</span><span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>ty</span> <span class='hs-conid'>Required</span> <span class='hs-conid'>IA_Nil</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>tys</span>
<a name="line-1435"></a>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>maybeParen</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>funPrec</span>
<a name="line-1436"></a>         <span class='hs-varop'>$</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'?'</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ftext</span> <span class='hs-varid'>n</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"::"</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>topPrec</span> <span class='hs-varid'>ty</span>
<a name="line-1437"></a>
<a name="line-1438"></a>       <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceTupleTyCon</span> <span class='hs-varid'>arity</span> <span class='hs-varid'>sort</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>ifaceTyConSort</span> <span class='hs-varid'>info</span>
<a name="line-1439"></a>       <span class='hs-layout'>,</span> <span class='hs-varid'>not</span> <span class='hs-varid'>debug</span>
<a name="line-1440"></a>       <span class='hs-layout'>,</span> <span class='hs-varid'>arity</span> <span class='hs-varop'>==</span> <span class='hs-varid'>ifaceVisAppArgsLength</span> <span class='hs-varid'>tys</span>
<a name="line-1441"></a>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>pprTuple</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>sort</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifaceTyConIsPromoted</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-varid'>tys</span>
<a name="line-1442"></a>
<a name="line-1443"></a>       <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfaceSumTyCon</span> <span class='hs-varid'>arity</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>ifaceTyConSort</span> <span class='hs-varid'>info</span>
<a name="line-1444"></a>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>pprSum</span> <span class='hs-varid'>arity</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifaceTyConIsPromoted</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-varid'>tys</span>
<a name="line-1445"></a>
<a name="line-1446"></a>       <span class='hs-keyglyph'>|</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>`ifaceTyConHasKey`</span> <span class='hs-varid'>consDataConKey</span>
<a name="line-1447"></a>       <span class='hs-layout'>,</span> <span class='hs-conid'>False</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>print_kinds</span>
<a name="line-1448"></a>       <span class='hs-layout'>,</span> <span class='hs-conid'>IA_Arg</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>argf</span> <span class='hs-layout'>(</span><span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>ty1</span> <span class='hs-conid'>Required</span> <span class='hs-layout'>(</span><span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>ty2</span> <span class='hs-conid'>Required</span> <span class='hs-conid'>IA_Nil</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>tys</span>
<a name="line-1449"></a>       <span class='hs-layout'>,</span> <span class='hs-varid'>isInvisibleArgFlag</span> <span class='hs-varid'>argf</span>
<a name="line-1450"></a>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>pprIfaceTyList</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>ty1</span> <span class='hs-varid'>ty2</span>
<a name="line-1451"></a>
<a name="line-1452"></a>       <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isIfaceTyConAppLiftedTypeKind</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>tys</span>
<a name="line-1453"></a>       <span class='hs-layout'>,</span> <span class='hs-varid'>print_type_abbreviations</span>  <span class='hs-comment'>-- See Note [Printing type abbreviations]</span>
<a name="line-1454"></a>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr_kind_type</span> <span class='hs-varid'>ctxt_prec</span>
<a name="line-1455"></a>
<a name="line-1456"></a>       <span class='hs-keyglyph'>|</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>`ifaceTyConHasKey`</span> <span class='hs-varid'>funTyConKey</span>
<a name="line-1457"></a>       <span class='hs-layout'>,</span> <span class='hs-conid'>IA_Arg</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>rep</span> <span class='hs-conid'>IA_Nil</span><span class='hs-layout'>)</span> <span class='hs-conid'>Required</span> <span class='hs-varid'>args</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>tys</span>
<a name="line-1458"></a>       <span class='hs-layout'>,</span> <span class='hs-varid'>rep</span> <span class='hs-varop'>`ifaceTyConHasKey`</span> <span class='hs-varid'>manyDataConKey</span>
<a name="line-1459"></a>       <span class='hs-layout'>,</span> <span class='hs-varid'>print_type_abbreviations</span>  <span class='hs-comment'>-- See Note [Printing type abbreviations]</span>
<a name="line-1460"></a>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>pprIfacePrefixApp</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-varid'>parens</span> <span class='hs-varid'>arrow</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_app_arg</span> <span class='hs-varid'>appPrec</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span>
<a name="line-1461"></a>          <span class='hs-varid'>appArgsIfaceTypesArgFlags</span> <span class='hs-varop'>$</span> <span class='hs-varid'>stripInvisArgs</span> <span class='hs-layout'>(</span><span class='hs-conid'>PrintExplicitKinds</span> <span class='hs-varid'>print_kinds</span><span class='hs-layout'>)</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span>
<a name="line-1462"></a>          <span class='hs-comment'>-- Use appArgsIfaceTypesArgFlags to print invisible arguments</span>
<a name="line-1463"></a>          <span class='hs-comment'>-- correctly (#19310)</span>
<a name="line-1464"></a>
<a name="line-1465"></a>       <span class='hs-keyglyph'>|</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>`ifaceTyConHasKey`</span> <span class='hs-varid'>errorMessageTypeErrorFamKey</span>
<a name="line-1466"></a>       <span class='hs-layout'>,</span> <span class='hs-varid'>not</span> <span class='hs-varid'>debug</span>
<a name="line-1467"></a>         <span class='hs-comment'>-- Suppress detail unless you _really_ want to see</span>
<a name="line-1468"></a>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"(TypeError ...)"</span>
<a name="line-1469"></a>
<a name="line-1470"></a>       <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>doc</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>ppr_equality</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>tc</span> <span class='hs-layout'>(</span><span class='hs-varid'>appArgsIfaceTypes</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span>
<a name="line-1471"></a>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>doc</span>
<a name="line-1472"></a>
<a name="line-1473"></a>       <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-1474"></a>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr_iface_tc_app</span> <span class='hs-varid'>ppr_app_arg</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>$</span>
<a name="line-1475"></a>          <span class='hs-varid'>appArgsIfaceTypesArgFlags</span> <span class='hs-varop'>$</span> <span class='hs-varid'>stripInvisArgs</span> <span class='hs-layout'>(</span><span class='hs-conid'>PrintExplicitKinds</span> <span class='hs-varid'>print_kinds</span><span class='hs-layout'>)</span> <span class='hs-varid'>tys</span>
<a name="line-1476"></a>  <span class='hs-keyword'>where</span>
<a name="line-1477"></a>    <span class='hs-varid'>info</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ifaceTyConInfo</span> <span class='hs-varid'>tc</span>
<a name="line-1478"></a>
<a name="line-1479"></a><a name="ppr_kind_type"></a><span class='hs-definition'>ppr_kind_type</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1480"></a><span class='hs-definition'>ppr_kind_type</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sdocOption</span> <span class='hs-varid'>sdocStarIsType</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-keyword'>case</span>
<a name="line-1481"></a>   <span class='hs-conid'>False</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"Type"</span>
<a name="line-1482"></a>   <span class='hs-conid'>True</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>maybeParen</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>starPrec</span> <span class='hs-varop'>$</span>
<a name="line-1483"></a>              <span class='hs-varid'>unicodeSyntax</span> <span class='hs-layout'>(</span><span class='hs-varid'>char</span> <span class='hs-chr'>'★'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>char</span> <span class='hs-chr'>'*'</span><span class='hs-layout'>)</span>
<a name="line-1484"></a>
<a name="line-1485"></a><a name="ppr_equality"></a><span class='hs-comment'>-- | Pretty-print a type-level equality.</span>
<a name="line-1486"></a><span class='hs-comment'>-- Returns (Just doc) if the argument is a /saturated/ application</span>
<a name="line-1487"></a><span class='hs-comment'>-- of   eqTyCon          (~)</span>
<a name="line-1488"></a><span class='hs-comment'>--      eqPrimTyCon      (~#)</span>
<a name="line-1489"></a><span class='hs-comment'>--      eqReprPrimTyCon  (~R#)</span>
<a name="line-1490"></a><span class='hs-comment'>--      heqTyCon         (~~)</span>
<a name="line-1491"></a><span class='hs-comment'>--</span>
<a name="line-1492"></a><span class='hs-comment'>-- See Note [Equality predicates in IfaceType]</span>
<a name="line-1493"></a><span class='hs-comment'>-- and Note [The equality types story] in GHC.Builtin.Types.Prim</span>
<a name="line-1494"></a><span class='hs-definition'>ppr_equality</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceType</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>SDoc</span>
<a name="line-1495"></a><span class='hs-definition'>ppr_equality</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>args</span>
<a name="line-1496"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>hetero_eq_tc</span>
<a name="line-1497"></a>  <span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>k1</span><span class='hs-layout'>,</span> <span class='hs-varid'>k2</span><span class='hs-layout'>,</span> <span class='hs-varid'>t1</span><span class='hs-layout'>,</span> <span class='hs-varid'>t2</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>args</span>
<a name="line-1498"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varop'>$</span> <span class='hs-varid'>print_equality</span> <span class='hs-layout'>(</span><span class='hs-varid'>k1</span><span class='hs-layout'>,</span> <span class='hs-varid'>k2</span><span class='hs-layout'>,</span> <span class='hs-varid'>t1</span><span class='hs-layout'>,</span> <span class='hs-varid'>t2</span><span class='hs-layout'>)</span>
<a name="line-1499"></a>
<a name="line-1500"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>hom_eq_tc</span>
<a name="line-1501"></a>  <span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>k</span><span class='hs-layout'>,</span> <span class='hs-varid'>t1</span><span class='hs-layout'>,</span> <span class='hs-varid'>t2</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>args</span>
<a name="line-1502"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varop'>$</span> <span class='hs-varid'>print_equality</span> <span class='hs-layout'>(</span><span class='hs-varid'>k</span><span class='hs-layout'>,</span> <span class='hs-varid'>k</span><span class='hs-layout'>,</span> <span class='hs-varid'>t1</span><span class='hs-layout'>,</span> <span class='hs-varid'>t2</span><span class='hs-layout'>)</span>
<a name="line-1503"></a>
<a name="line-1504"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-1505"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span>
<a name="line-1506"></a>  <span class='hs-keyword'>where</span>
<a name="line-1507"></a>    <span class='hs-varid'>homogeneous</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tc_name</span> <span class='hs-varop'>`hasKey`</span> <span class='hs-varid'>eqTyConKey</span> <span class='hs-comment'>-- (~)</span>
<a name="line-1508"></a>               <span class='hs-varop'>||</span> <span class='hs-varid'>hetero_tc_used_homogeneously</span>
<a name="line-1509"></a>      <span class='hs-keyword'>where</span>
<a name="line-1510"></a>        <span class='hs-varid'>hetero_tc_used_homogeneously</span>
<a name="line-1511"></a>          <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ifaceTyConSort</span> <span class='hs-varop'>$</span> <span class='hs-varid'>ifaceTyConInfo</span> <span class='hs-varid'>tc</span> <span class='hs-keyword'>of</span>
<a name="line-1512"></a>                          <span class='hs-conid'>IfaceEqualityTyCon</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>True</span>
<a name="line-1513"></a>                          <span class='hs-sel'>_other</span>             <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>False</span>
<a name="line-1514"></a>             <span class='hs-comment'>-- True &lt;=&gt; a heterogeneous equality whose arguments</span>
<a name="line-1515"></a>             <span class='hs-comment'>--          are (in this case) of the same kind</span>
<a name="line-1516"></a>
<a name="line-1517"></a>    <span class='hs-varid'>tc_name</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ifaceTyConName</span> <span class='hs-varid'>tc</span>
<a name="line-1518"></a>    <span class='hs-varid'>pp</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_ty</span>
<a name="line-1519"></a>    <span class='hs-varid'>hom_eq_tc</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tc_name</span> <span class='hs-varop'>`hasKey`</span> <span class='hs-varid'>eqTyConKey</span>            <span class='hs-comment'>-- (~)</span>
<a name="line-1520"></a>    <span class='hs-varid'>hetero_eq_tc</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tc_name</span> <span class='hs-varop'>`hasKey`</span> <span class='hs-varid'>eqPrimTyConKey</span>     <span class='hs-comment'>-- (~#)</span>
<a name="line-1521"></a>                <span class='hs-varop'>||</span> <span class='hs-varid'>tc_name</span> <span class='hs-varop'>`hasKey`</span> <span class='hs-varid'>eqReprPrimTyConKey</span> <span class='hs-comment'>-- (~R#)</span>
<a name="line-1522"></a>                <span class='hs-varop'>||</span> <span class='hs-varid'>tc_name</span> <span class='hs-varop'>`hasKey`</span> <span class='hs-varid'>heqTyConKey</span>        <span class='hs-comment'>-- (~~)</span>
<a name="line-1523"></a>    <span class='hs-varid'>nominal_eq_tc</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tc_name</span> <span class='hs-varop'>`hasKey`</span> <span class='hs-varid'>heqTyConKey</span>       <span class='hs-comment'>-- (~~)</span>
<a name="line-1524"></a>                 <span class='hs-varop'>||</span> <span class='hs-varid'>tc_name</span> <span class='hs-varop'>`hasKey`</span> <span class='hs-varid'>eqPrimTyConKey</span>    <span class='hs-comment'>-- (~#)</span>
<a name="line-1525"></a>    <span class='hs-varid'>print_equality</span> <span class='hs-varid'>args</span> <span class='hs-keyglyph'>=</span>
<a name="line-1526"></a>        <span class='hs-varid'>sdocOption</span> <span class='hs-varid'>sdocPrintExplicitKinds</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>print_kinds</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-1527"></a>        <span class='hs-varid'>sdocOption</span> <span class='hs-varid'>sdocPrintEqualityRelations</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>print_eqs</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-1528"></a>        <span class='hs-varid'>getPprStyle</span>      <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>style</span>  <span class='hs-keyglyph'>-&gt;</span>
<a name="line-1529"></a>        <span class='hs-varid'>getPprDebug</span>      <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>debug</span>  <span class='hs-keyglyph'>-&gt;</span>
<a name="line-1530"></a>        <span class='hs-varid'>print_equality'</span> <span class='hs-varid'>args</span> <span class='hs-varid'>print_kinds</span>
<a name="line-1531"></a>          <span class='hs-layout'>(</span><span class='hs-varid'>print_eqs</span> <span class='hs-varop'>||</span> <span class='hs-varid'>dumpStyle</span> <span class='hs-varid'>style</span> <span class='hs-varop'>||</span> <span class='hs-varid'>debug</span><span class='hs-layout'>)</span>
<a name="line-1532"></a>
<a name="line-1533"></a>    <span class='hs-varid'>print_equality'</span> <span class='hs-layout'>(</span><span class='hs-varid'>ki1</span><span class='hs-layout'>,</span> <span class='hs-varid'>ki2</span><span class='hs-layout'>,</span> <span class='hs-varid'>ty1</span><span class='hs-layout'>,</span> <span class='hs-varid'>ty2</span><span class='hs-layout'>)</span> <span class='hs-varid'>print_kinds</span> <span class='hs-varid'>print_eqs</span>
<a name="line-1534"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-comment'>-- If -fprint-equality-relations is on, just print the original TyCon</span>
<a name="line-1535"></a>        <span class='hs-varid'>print_eqs</span>
<a name="line-1536"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_infix_eq</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>tc</span><span class='hs-layout'>)</span>
<a name="line-1537"></a>
<a name="line-1538"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-comment'>-- Homogeneous use of heterogeneous equality (ty1 ~~ ty2)</span>
<a name="line-1539"></a>        <span class='hs-comment'>--                 or unlifted equality      (ty1 ~# ty2)</span>
<a name="line-1540"></a>        <span class='hs-varid'>nominal_eq_tc</span><span class='hs-layout'>,</span> <span class='hs-varid'>homogeneous</span>
<a name="line-1541"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_infix_eq</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"~"</span><span class='hs-layout'>)</span>
<a name="line-1542"></a>
<a name="line-1543"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-comment'>-- Heterogeneous use of unlifted equality (ty1 ~# ty2)</span>
<a name="line-1544"></a>        <span class='hs-varid'>not</span> <span class='hs-varid'>homogeneous</span>
<a name="line-1545"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_infix_eq</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>heqTyCon</span><span class='hs-layout'>)</span>
<a name="line-1546"></a>
<a name="line-1547"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-comment'>-- Homogeneous use of representational unlifted equality (ty1 ~R# ty2)</span>
<a name="line-1548"></a>        <span class='hs-varid'>tc_name</span> <span class='hs-varop'>`hasKey`</span> <span class='hs-varid'>eqReprPrimTyConKey</span><span class='hs-layout'>,</span> <span class='hs-varid'>homogeneous</span>
<a name="line-1549"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>ki</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>print_kinds</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pp</span> <span class='hs-varid'>appPrec</span> <span class='hs-varid'>ki1</span><span class='hs-keyglyph'>]</span>
<a name="line-1550"></a>               <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-1551"></a>        <span class='hs-keyword'>in</span> <span class='hs-varid'>pprIfacePrefixApp</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>coercibleTyCon</span><span class='hs-layout'>)</span>
<a name="line-1552"></a>                            <span class='hs-layout'>(</span><span class='hs-varid'>ki</span> <span class='hs-varop'>++</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pp</span> <span class='hs-varid'>appPrec</span> <span class='hs-varid'>ty1</span><span class='hs-layout'>,</span> <span class='hs-varid'>pp</span> <span class='hs-varid'>appPrec</span> <span class='hs-varid'>ty2</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1553"></a>
<a name="line-1554"></a>        <span class='hs-comment'>-- The other cases work as you'd expect</span>
<a name="line-1555"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-1556"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_infix_eq</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>tc</span><span class='hs-layout'>)</span>
<a name="line-1557"></a>      <span class='hs-keyword'>where</span>
<a name="line-1558"></a>        <span class='hs-varid'>ppr_infix_eq</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1559"></a>        <span class='hs-varid'>ppr_infix_eq</span> <span class='hs-varid'>eq_op</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprIfaceInfixApp</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>eq_op</span>
<a name="line-1560"></a>                               <span class='hs-layout'>(</span><span class='hs-varid'>pp_ty_ki</span> <span class='hs-varid'>ty1</span> <span class='hs-varid'>ki1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>pp_ty_ki</span> <span class='hs-varid'>ty2</span> <span class='hs-varid'>ki2</span><span class='hs-layout'>)</span>
<a name="line-1561"></a>          <span class='hs-keyword'>where</span>
<a name="line-1562"></a>            <span class='hs-varid'>pp_ty_ki</span> <span class='hs-varid'>ty</span> <span class='hs-varid'>ki</span>
<a name="line-1563"></a>              <span class='hs-keyglyph'>|</span> <span class='hs-varid'>print_kinds</span>
<a name="line-1564"></a>              <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>pp</span> <span class='hs-varid'>topPrec</span> <span class='hs-varid'>ty</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>dcolon</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pp</span> <span class='hs-varid'>opPrec</span> <span class='hs-varid'>ki</span><span class='hs-layout'>)</span>
<a name="line-1565"></a>              <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-1566"></a>              <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pp</span> <span class='hs-varid'>opPrec</span> <span class='hs-varid'>ty</span>
<a name="line-1567"></a>
<a name="line-1568"></a>
<a name="line-1569"></a><a name="pprIfaceCoTcApp"></a><span class='hs-definition'>pprIfaceCoTcApp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceCoercion</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1570"></a><span class='hs-definition'>pprIfaceCoTcApp</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>tys</span> <span class='hs-keyglyph'>=</span>
<a name="line-1571"></a>  <span class='hs-varid'>ppr_iface_tc_app</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>prec</span> <span class='hs-layout'>(</span><span class='hs-varid'>co</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr_co</span> <span class='hs-varid'>prec</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>tc</span>
<a name="line-1572"></a>    <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-layout'>,</span> <span class='hs-conid'>Required</span><span class='hs-layout'>)</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span>
<a name="line-1573"></a>    <span class='hs-comment'>-- We are trying to re-use ppr_iface_tc_app here, which requires its</span>
<a name="line-1574"></a>    <span class='hs-comment'>-- arguments to be accompanied by visibilities. But visibility is</span>
<a name="line-1575"></a>    <span class='hs-comment'>-- irrelevant when printing coercions, so just default everything to</span>
<a name="line-1576"></a>    <span class='hs-comment'>-- Required.</span>
<a name="line-1577"></a>
<a name="line-1578"></a><a name="ppr_iface_tc_app"></a><span class='hs-comment'>-- | Pretty-prints an application of a type constructor to some arguments</span>
<a name="line-1579"></a><span class='hs-comment'>-- (whose visibilities are known). This is polymorphic (over @a@) since we use</span>
<a name="line-1580"></a><span class='hs-comment'>-- this function to pretty-print two different things:</span>
<a name="line-1581"></a><span class='hs-comment'>--</span>
<a name="line-1582"></a><span class='hs-comment'>-- 1. Types (from `pprTyTcApp'`)</span>
<a name="line-1583"></a><span class='hs-comment'>--</span>
<a name="line-1584"></a><span class='hs-comment'>-- 2. Coercions (from 'pprIfaceCoTcApp')</span>
<a name="line-1585"></a><span class='hs-definition'>ppr_iface_tc_app</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>ArgFlag</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span><span class='hs-layout'>)</span>
<a name="line-1586"></a>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>ArgFlag</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1587"></a><span class='hs-definition'>ppr_iface_tc_app</span> <span class='hs-varid'>pp</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>tc</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ty</span><span class='hs-keyglyph'>]</span>
<a name="line-1588"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>`ifaceTyConHasKey`</span> <span class='hs-varid'>listTyConKey</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPromotionQuote</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>brackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>pp</span> <span class='hs-varid'>topPrec</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-1589"></a>
<a name="line-1590"></a><span class='hs-definition'>ppr_iface_tc_app</span> <span class='hs-varid'>pp</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>tys</span>
<a name="line-1591"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>`ifaceTyConHasKey`</span> <span class='hs-varid'>liftedTypeKindTyConKey</span>
<a name="line-1592"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_kind_type</span> <span class='hs-varid'>ctxt_prec</span>
<a name="line-1593"></a>
<a name="line-1594"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>isSymOcc</span> <span class='hs-layout'>(</span><span class='hs-varid'>nameOccName</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifaceTyConName</span> <span class='hs-varid'>tc</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1595"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprIfacePrefixApp</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>tc</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>pp</span> <span class='hs-varid'>appPrec</span><span class='hs-layout'>)</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span>
<a name="line-1596"></a>
<a name="line-1597"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>ty1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-conid'>Required</span><span class='hs-layout'>)</span>
<a name="line-1598"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>ty2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-conid'>Required</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>tys</span>
<a name="line-1599"></a>      <span class='hs-comment'>-- Infix, two visible arguments (we know nothing of precedence though).</span>
<a name="line-1600"></a>      <span class='hs-comment'>-- Don't apply this special case if one of the arguments is invisible,</span>
<a name="line-1601"></a>      <span class='hs-comment'>-- lest we print something like (@LiftedRep -&gt; @LiftedRep) (#15941).</span>
<a name="line-1602"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprIfaceInfixApp</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>tc</span><span class='hs-layout'>)</span>
<a name="line-1603"></a>                     <span class='hs-layout'>(</span><span class='hs-varid'>pp</span> <span class='hs-varid'>opPrec</span> <span class='hs-varid'>ty1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>pp</span> <span class='hs-varid'>opPrec</span> <span class='hs-varid'>ty2</span><span class='hs-layout'>)</span>
<a name="line-1604"></a>
<a name="line-1605"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-1606"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprIfacePrefixApp</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>tc</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>pp</span> <span class='hs-varid'>appPrec</span><span class='hs-layout'>)</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span>
<a name="line-1607"></a>
<a name="line-1608"></a><a name="pprSum"></a><span class='hs-definition'>pprSum</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Arity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PromotionFlag</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1609"></a><span class='hs-definition'>pprSum</span> <span class='hs-sel'>_arity</span> <span class='hs-varid'>is_promoted</span> <span class='hs-varid'>args</span>
<a name="line-1610"></a>  <span class='hs-keyglyph'>=</span>   <span class='hs-comment'>-- drop the RuntimeRep vars.</span>
<a name="line-1611"></a>      <span class='hs-comment'>-- See Note [Unboxed tuple RuntimeRep vars] in GHC.Core.TyCon</span>
<a name="line-1612"></a>    <span class='hs-keyword'>let</span> <span class='hs-varid'>tys</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>appArgsIfaceTypes</span> <span class='hs-varid'>args</span>
<a name="line-1613"></a>        <span class='hs-varid'>args'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>drop</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varid'>tys</span> <span class='hs-varop'>`div`</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <span class='hs-varid'>tys</span>
<a name="line-1614"></a>    <span class='hs-keyword'>in</span> <span class='hs-varid'>pprPromotionQuoteI</span> <span class='hs-varid'>is_promoted</span>
<a name="line-1615"></a>       <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>sumParens</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprWithBars</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>topPrec</span><span class='hs-layout'>)</span> <span class='hs-varid'>args'</span><span class='hs-layout'>)</span>
<a name="line-1616"></a>
<a name="line-1617"></a><a name="pprTuple"></a><span class='hs-definition'>pprTuple</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TupleSort</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PromotionFlag</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1618"></a><span class='hs-definition'>pprTuple</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>sort</span> <span class='hs-varid'>promoted</span> <span class='hs-varid'>args</span> <span class='hs-keyglyph'>=</span>
<a name="line-1619"></a>  <span class='hs-keyword'>case</span> <span class='hs-varid'>promoted</span> <span class='hs-keyword'>of</span>
<a name="line-1620"></a>    <span class='hs-conid'>IsPromoted</span>
<a name="line-1621"></a>      <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>tys</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>appArgsIfaceTypes</span> <span class='hs-varid'>args</span>
<a name="line-1622"></a>             <span class='hs-varid'>args'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>drop</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varid'>tys</span> <span class='hs-varop'>`div`</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <span class='hs-varid'>tys</span>
<a name="line-1623"></a>             <span class='hs-varid'>spaceIfPromoted</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>args'</span> <span class='hs-keyword'>of</span>
<a name="line-1624"></a>               <span class='hs-varid'>arg0</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>pprSpaceIfPromotedTyCon</span> <span class='hs-varid'>arg0</span>
<a name="line-1625"></a>               <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>id</span>
<a name="line-1626"></a>         <span class='hs-keyword'>in</span> <span class='hs-varid'>ppr_tuple_app</span> <span class='hs-varid'>args'</span> <span class='hs-varop'>$</span>
<a name="line-1627"></a>            <span class='hs-varid'>pprPromotionQuoteI</span> <span class='hs-conid'>IsPromoted</span> <span class='hs-varop'>&lt;&gt;</span>
<a name="line-1628"></a>            <span class='hs-varid'>tupleParens</span> <span class='hs-varid'>sort</span> <span class='hs-layout'>(</span><span class='hs-varid'>spaceIfPromoted</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprWithCommas</span> <span class='hs-varid'>pprIfaceType</span> <span class='hs-varid'>args'</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1629"></a>
<a name="line-1630"></a>    <span class='hs-conid'>NotPromoted</span>
<a name="line-1631"></a>      <span class='hs-keyglyph'>|</span>  <span class='hs-conid'>ConstraintTuple</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>sort</span>
<a name="line-1632"></a>      <span class='hs-layout'>,</span>  <span class='hs-conid'>IA_Nil</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>args</span>
<a name="line-1633"></a>      <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>maybeParen</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>sigPrec</span> <span class='hs-varop'>$</span>
<a name="line-1634"></a>         <span class='hs-varid'>text</span> <span class='hs-str'>"() :: Constraint"</span>
<a name="line-1635"></a>
<a name="line-1636"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-1637"></a>      <span class='hs-keyglyph'>-&gt;</span>   <span class='hs-comment'>-- drop the RuntimeRep vars.</span>
<a name="line-1638"></a>           <span class='hs-comment'>-- See Note [Unboxed tuple RuntimeRep vars] in GHC.Core.TyCon</span>
<a name="line-1639"></a>         <span class='hs-keyword'>let</span> <span class='hs-varid'>tys</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>appArgsIfaceTypes</span> <span class='hs-varid'>args</span>
<a name="line-1640"></a>             <span class='hs-varid'>args'</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>sort</span> <span class='hs-keyword'>of</span>
<a name="line-1641"></a>                       <span class='hs-conid'>UnboxedTuple</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>drop</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varid'>tys</span> <span class='hs-varop'>`div`</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <span class='hs-varid'>tys</span>
<a name="line-1642"></a>                       <span class='hs-keyword'>_</span>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>tys</span>
<a name="line-1643"></a>         <span class='hs-keyword'>in</span>
<a name="line-1644"></a>         <span class='hs-varid'>ppr_tuple_app</span> <span class='hs-varid'>args'</span> <span class='hs-varop'>$</span>
<a name="line-1645"></a>         <span class='hs-varid'>pprPromotionQuoteI</span> <span class='hs-varid'>promoted</span> <span class='hs-varop'>&lt;&gt;</span>
<a name="line-1646"></a>         <span class='hs-varid'>tupleParens</span> <span class='hs-varid'>sort</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprWithCommas</span> <span class='hs-varid'>pprIfaceType</span> <span class='hs-varid'>args'</span><span class='hs-layout'>)</span>
<a name="line-1647"></a>  <span class='hs-keyword'>where</span>
<a name="line-1648"></a>    <span class='hs-varid'>ppr_tuple_app</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceType</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1649"></a>    <span class='hs-varid'>ppr_tuple_app</span> <span class='hs-varid'>args_wo_runtime_reps</span> <span class='hs-varid'>ppr_args_w_parens</span>
<a name="line-1650"></a>        <span class='hs-comment'>-- Special-case unary boxed tuples so that they are pretty-printed as</span>
<a name="line-1651"></a>        <span class='hs-comment'>-- `Solo x`, not `(x)`</span>
<a name="line-1652"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-keyglyph'>[</span><span class='hs-keyword'>_</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>args_wo_runtime_reps</span>
<a name="line-1653"></a>      <span class='hs-layout'>,</span> <span class='hs-conid'>BoxedTuple</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>sort</span>
<a name="line-1654"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>unit_tc_info</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIfaceTyConInfo</span> <span class='hs-varid'>promoted</span> <span class='hs-conid'>IfaceNormalTyCon</span>
<a name="line-1655"></a>            <span class='hs-varid'>unit_tc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-layout'>(</span><span class='hs-varid'>tupleTyConName</span> <span class='hs-varid'>sort</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>unit_tc_info</span> <span class='hs-keyword'>in</span>
<a name="line-1656"></a>        <span class='hs-varid'>pprPrecIfaceType</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>unit_tc</span> <span class='hs-varid'>args</span>
<a name="line-1657"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-1658"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_args_w_parens</span>
<a name="line-1659"></a>
<a name="line-1660"></a><a name="pprIfaceTyLit"></a><span class='hs-definition'>pprIfaceTyLit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTyLit</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1661"></a><span class='hs-definition'>pprIfaceTyLit</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceNumTyLit</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integer</span> <span class='hs-varid'>n</span>
<a name="line-1662"></a><span class='hs-definition'>pprIfaceTyLit</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceStrTyLit</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-layout'>(</span><span class='hs-varid'>show</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-1663"></a><span class='hs-definition'>pprIfaceTyLit</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCharTyLit</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-layout'>(</span><span class='hs-varid'>show</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-1664"></a>
<a name="line-1665"></a><a name="pprIfaceCoercion"></a><span class='hs-definition'>pprIfaceCoercion</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprParendIfaceCoercion</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceCoercion</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1666"></a><span class='hs-definition'>pprIfaceCoercion</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_co</span> <span class='hs-varid'>topPrec</span>
<a name="line-1667"></a><a name="pprParendIfaceCoercion"></a><span class='hs-definition'>pprParendIfaceCoercion</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_co</span> <span class='hs-varid'>appPrec</span>
<a name="line-1668"></a>
<a name="line-1669"></a><a name="ppr_co"></a><span class='hs-definition'>ppr_co</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceCoercion</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1670"></a><span class='hs-definition'>ppr_co</span> <span class='hs-keyword'>_</span>         <span class='hs-layout'>(</span><span class='hs-conid'>IfaceReflCo</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>angleBrackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr_role</span> <span class='hs-conid'>Nominal</span>
<a name="line-1671"></a><span class='hs-definition'>ppr_co</span> <span class='hs-keyword'>_</span>         <span class='hs-layout'>(</span><span class='hs-conid'>IfaceGReflCo</span> <span class='hs-varid'>r</span> <span class='hs-varid'>ty</span> <span class='hs-conid'>IfaceMRefl</span><span class='hs-layout'>)</span>
<a name="line-1672"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>angleBrackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr_role</span> <span class='hs-varid'>r</span>
<a name="line-1673"></a><span class='hs-definition'>ppr_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceGReflCo</span> <span class='hs-varid'>r</span> <span class='hs-varid'>ty</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceMCo</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1674"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_special_co</span> <span class='hs-varid'>ctxt_prec</span>
<a name="line-1675"></a>    <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"GRefl"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>r</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprParendIfaceType</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>co</span><span class='hs-keyglyph'>]</span>
<a name="line-1676"></a><span class='hs-definition'>ppr_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFunCo</span> <span class='hs-varid'>r</span> <span class='hs-varid'>cow</span> <span class='hs-varid'>co1</span> <span class='hs-varid'>co2</span><span class='hs-layout'>)</span>
<a name="line-1677"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybeParen</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>funPrec</span> <span class='hs-varop'>$</span>
<a name="line-1678"></a>    <span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_co</span> <span class='hs-varid'>funPrec</span> <span class='hs-varid'>co1</span> <span class='hs-conop'>:</span> <span class='hs-varid'>ppr_fun_tail</span> <span class='hs-varid'>cow</span> <span class='hs-varid'>co2</span><span class='hs-layout'>)</span>
<a name="line-1679"></a>  <span class='hs-keyword'>where</span>
<a name="line-1680"></a>    <span class='hs-varid'>ppr_fun_tail</span> <span class='hs-varid'>cow'</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFunCo</span> <span class='hs-varid'>r</span> <span class='hs-varid'>cow</span> <span class='hs-varid'>co1</span> <span class='hs-varid'>co2</span><span class='hs-layout'>)</span>
<a name="line-1681"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>coercionArrow</span> <span class='hs-varid'>cow'</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr_role</span> <span class='hs-varid'>r</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr_co</span> <span class='hs-varid'>funPrec</span> <span class='hs-varid'>co1</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-varid'>ppr_fun_tail</span> <span class='hs-varid'>cow</span> <span class='hs-varid'>co2</span>
<a name="line-1682"></a>    <span class='hs-varid'>ppr_fun_tail</span> <span class='hs-varid'>cow'</span> <span class='hs-varid'>other_co</span>
<a name="line-1683"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>coercionArrow</span> <span class='hs-varid'>cow'</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr_role</span> <span class='hs-varid'>r</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceCoercion</span> <span class='hs-varid'>other_co</span><span class='hs-keyglyph'>]</span>
<a name="line-1684"></a>    <span class='hs-varid'>coercionArrow</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mulArrow</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_co</span> <span class='hs-varid'>topPrec</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span>
<a name="line-1685"></a>
<a name="line-1686"></a><span class='hs-definition'>ppr_co</span> <span class='hs-keyword'>_</span>         <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConAppCo</span> <span class='hs-varid'>r</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>cos</span><span class='hs-layout'>)</span>
<a name="line-1687"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprIfaceCoTcApp</span> <span class='hs-varid'>topPrec</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>cos</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr_role</span> <span class='hs-varid'>r</span>
<a name="line-1688"></a><span class='hs-definition'>ppr_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAppCo</span> <span class='hs-varid'>co1</span> <span class='hs-varid'>co2</span><span class='hs-layout'>)</span>
<a name="line-1689"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybeParen</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>appPrec</span> <span class='hs-varop'>$</span>
<a name="line-1690"></a>    <span class='hs-varid'>ppr_co</span> <span class='hs-varid'>funPrec</span> <span class='hs-varid'>co1</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprParendIfaceCoercion</span> <span class='hs-varid'>co2</span>
<a name="line-1691"></a><span class='hs-definition'>ppr_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>co</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>IfaceForAllCo</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-1692"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybeParen</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>funPrec</span> <span class='hs-varop'>$</span>
<a name="line-1693"></a>    <span class='hs-varid'>pprIfaceForAllCoPart</span> <span class='hs-varid'>tvs</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprIfaceCoercion</span> <span class='hs-varid'>inner_co</span><span class='hs-layout'>)</span>
<a name="line-1694"></a>  <span class='hs-keyword'>where</span>
<a name="line-1695"></a>    <span class='hs-layout'>(</span><span class='hs-varid'>tvs</span><span class='hs-layout'>,</span> <span class='hs-varid'>inner_co</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>split_co</span> <span class='hs-varid'>co</span>
<a name="line-1696"></a>
<a name="line-1697"></a>    <span class='hs-varid'>split_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceForAllCo</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTvBndr</span> <span class='hs-layout'>(</span><span class='hs-varid'>name</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>kind_co</span> <span class='hs-varid'>co'</span><span class='hs-layout'>)</span>
<a name="line-1698"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>tvs</span><span class='hs-layout'>,</span> <span class='hs-varid'>co''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>split_co</span> <span class='hs-varid'>co'</span> <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>name</span><span class='hs-layout'>,</span><span class='hs-varid'>kind_co</span><span class='hs-layout'>)</span><span class='hs-conop'>:</span><span class='hs-varid'>tvs</span><span class='hs-layout'>,</span><span class='hs-varid'>co''</span><span class='hs-layout'>)</span>
<a name="line-1699"></a>    <span class='hs-varid'>split_co</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceForAllCo</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceIdBndr</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>name</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>kind_co</span> <span class='hs-varid'>co'</span><span class='hs-layout'>)</span>
<a name="line-1700"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>tvs</span><span class='hs-layout'>,</span> <span class='hs-varid'>co''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>split_co</span> <span class='hs-varid'>co'</span> <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>name</span><span class='hs-layout'>,</span><span class='hs-varid'>kind_co</span><span class='hs-layout'>)</span><span class='hs-conop'>:</span><span class='hs-varid'>tvs</span><span class='hs-layout'>,</span><span class='hs-varid'>co''</span><span class='hs-layout'>)</span>
<a name="line-1701"></a>    <span class='hs-varid'>split_co</span> <span class='hs-varid'>co'</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>[]</span><span class='hs-layout'>,</span> <span class='hs-varid'>co'</span><span class='hs-layout'>)</span>
<a name="line-1702"></a>
<a name="line-1703"></a><span class='hs-comment'>-- Why these three? See Note [TcTyVars in IfaceType]</span>
<a name="line-1704"></a><span class='hs-definition'>ppr_co</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFreeCoVar</span> <span class='hs-varid'>covar</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>covar</span>
<a name="line-1705"></a><span class='hs-definition'>ppr_co</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCoVarCo</span> <span class='hs-varid'>covar</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>covar</span>
<a name="line-1706"></a><span class='hs-definition'>ppr_co</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceHoleCo</span> <span class='hs-varid'>covar</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>braces</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>covar</span><span class='hs-layout'>)</span>
<a name="line-1707"></a>
<a name="line-1708"></a><span class='hs-definition'>ppr_co</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceUnivCo</span> <span class='hs-varid'>prov</span> <span class='hs-varid'>role</span> <span class='hs-varid'>ty1</span> <span class='hs-varid'>ty2</span><span class='hs-layout'>)</span>
<a name="line-1709"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"Univ"</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>parens</span> <span class='hs-varop'>$</span>
<a name="line-1710"></a>      <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>role</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfaceUnivCoProv</span> <span class='hs-varid'>prov</span>
<a name="line-1711"></a>          <span class='hs-layout'>,</span> <span class='hs-varid'>dcolon</span> <span class='hs-varop'>&lt;+&gt;</span>  <span class='hs-varid'>ppr</span> <span class='hs-varid'>ty1</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>comma</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ty2</span> <span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1712"></a>
<a name="line-1713"></a><span class='hs-definition'>ppr_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceInstCo</span> <span class='hs-varid'>co</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>
<a name="line-1714"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybeParen</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>appPrec</span> <span class='hs-varop'>$</span>
<a name="line-1715"></a>    <span class='hs-varid'>text</span> <span class='hs-str'>"Inst"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprParendIfaceCoercion</span> <span class='hs-varid'>co</span>
<a name="line-1716"></a>                        <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprParendIfaceCoercion</span> <span class='hs-varid'>ty</span>
<a name="line-1717"></a>
<a name="line-1718"></a><span class='hs-definition'>ppr_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAxiomRuleCo</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>cos</span><span class='hs-layout'>)</span>
<a name="line-1719"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybeParen</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>appPrec</span> <span class='hs-varop'>$</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>interpp'SP</span> <span class='hs-varid'>cos</span><span class='hs-layout'>)</span>
<a name="line-1720"></a>
<a name="line-1721"></a><span class='hs-definition'>ppr_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAxiomInstCo</span> <span class='hs-varid'>n</span> <span class='hs-varid'>i</span> <span class='hs-varid'>cos</span><span class='hs-layout'>)</span>
<a name="line-1722"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_special_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>brackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>cos</span>
<a name="line-1723"></a><span class='hs-definition'>ppr_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceSymCo</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-1724"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_special_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"Sym"</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>co</span><span class='hs-keyglyph'>]</span>
<a name="line-1725"></a><span class='hs-definition'>ppr_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTransCo</span> <span class='hs-varid'>co1</span> <span class='hs-varid'>co2</span><span class='hs-layout'>)</span>
<a name="line-1726"></a>    <span class='hs-comment'>-- chain nested TransCo</span>
<a name="line-1727"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>ppr_trans</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTransCo</span> <span class='hs-varid'>c1</span> <span class='hs-varid'>c2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>semi</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr_co</span> <span class='hs-varid'>topPrec</span> <span class='hs-varid'>c1</span> <span class='hs-conop'>:</span> <span class='hs-varid'>ppr_trans</span> <span class='hs-varid'>c2</span>
<a name="line-1728"></a>        <span class='hs-varid'>ppr_trans</span> <span class='hs-varid'>c</span>                    <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>semi</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr_co</span> <span class='hs-varid'>opPrec</span> <span class='hs-varid'>c</span><span class='hs-keyglyph'>]</span>
<a name="line-1729"></a>    <span class='hs-keyword'>in</span> <span class='hs-varid'>maybeParen</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>opPrec</span> <span class='hs-varop'>$</span>
<a name="line-1730"></a>        <span class='hs-varid'>vcat</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_co</span> <span class='hs-varid'>topPrec</span> <span class='hs-varid'>co1</span> <span class='hs-conop'>:</span> <span class='hs-varid'>ppr_trans</span> <span class='hs-varid'>co2</span><span class='hs-layout'>)</span>
<a name="line-1731"></a><span class='hs-definition'>ppr_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceNthCo</span> <span class='hs-varid'>d</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-1732"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_special_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"Nth:"</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>int</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>co</span><span class='hs-keyglyph'>]</span>
<a name="line-1733"></a><span class='hs-definition'>ppr_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLRCo</span> <span class='hs-varid'>lr</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-1734"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_special_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>lr</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>co</span><span class='hs-keyglyph'>]</span>
<a name="line-1735"></a><span class='hs-definition'>ppr_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceSubCo</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-1736"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_special_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"Sub"</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>co</span><span class='hs-keyglyph'>]</span>
<a name="line-1737"></a><span class='hs-definition'>ppr_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceKindCo</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-1738"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_special_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"Kind"</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>co</span><span class='hs-keyglyph'>]</span>
<a name="line-1739"></a>
<a name="line-1740"></a><a name="ppr_special_co"></a><span class='hs-definition'>ppr_special_co</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceCoercion</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1741"></a><span class='hs-definition'>ppr_special_co</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>doc</span> <span class='hs-varid'>cos</span>
<a name="line-1742"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybeParen</span> <span class='hs-varid'>ctxt_prec</span> <span class='hs-varid'>appPrec</span>
<a name="line-1743"></a>               <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>doc</span><span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>pprParendIfaceCoercion</span> <span class='hs-varid'>cos</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1744"></a>
<a name="line-1745"></a><a name="ppr_role"></a><span class='hs-definition'>ppr_role</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Role</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1746"></a><span class='hs-definition'>ppr_role</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>underscore</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>pp_role</span>
<a name="line-1747"></a>  <span class='hs-keyword'>where</span> <span class='hs-varid'>pp_role</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>r</span> <span class='hs-keyword'>of</span>
<a name="line-1748"></a>                    <span class='hs-conid'>Nominal</span>          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'N'</span>
<a name="line-1749"></a>                    <span class='hs-conid'>Representational</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'R'</span>
<a name="line-1750"></a>                    <span class='hs-conid'>Phantom</span>          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'P'</span>
<a name="line-1751"></a>
<a name="line-1752"></a><a name="pprIfaceUnivCoProv"></a><span class='hs-comment'>------------------</span>
<a name="line-1753"></a><span class='hs-definition'>pprIfaceUnivCoProv</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceUnivCoProv</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1754"></a><span class='hs-definition'>pprIfaceUnivCoProv</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfacePhantomProv</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-1755"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"phantom"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprParendIfaceCoercion</span> <span class='hs-varid'>co</span>
<a name="line-1756"></a><span class='hs-definition'>pprIfaceUnivCoProv</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceProofIrrelProv</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span>
<a name="line-1757"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"irrel"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprParendIfaceCoercion</span> <span class='hs-varid'>co</span>
<a name="line-1758"></a><span class='hs-definition'>pprIfaceUnivCoProv</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfacePluginProv</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span>
<a name="line-1759"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"plugin"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>doubleQuotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span>
<a name="line-1760"></a><span class='hs-definition'>pprIfaceUnivCoProv</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCorePrepProv</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>
<a name="line-1761"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"CorePrep"</span>
<a name="line-1762"></a>
<a name="line-1763"></a><a name="instance%20Outputable%20IfaceTyCon"></a><span class='hs-comment'>-------------------</span>
<a name="line-1764"></a><a name="instance%20Outputable%20IfaceTyCon"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-keyword'>where</span>
<a name="line-1765"></a>  <span class='hs-varid'>ppr</span> <span class='hs-varid'>tc</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPromotionQuote</span> <span class='hs-varid'>tc</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifaceTyConName</span> <span class='hs-varid'>tc</span><span class='hs-layout'>)</span>
<a name="line-1766"></a>
<a name="line-1767"></a><a name="instance%20Outputable%20IfaceTyConInfo"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceTyConInfo</span> <span class='hs-keyword'>where</span>
<a name="line-1768"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConInfo</span> <span class='hs-layout'>{</span> <span class='hs-varid'>ifaceTyConIsPromoted</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>prom</span>
<a name="line-1769"></a>                      <span class='hs-layout'>,</span> <span class='hs-varid'>ifaceTyConSort</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sort</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-1770"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>angleBrackets</span> <span class='hs-varop'>$</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>prom</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>comma</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>sort</span>
<a name="line-1771"></a>
<a name="line-1772"></a><a name="pprPromotionQuote"></a><span class='hs-definition'>pprPromotionQuote</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1773"></a><span class='hs-definition'>pprPromotionQuote</span> <span class='hs-varid'>tc</span> <span class='hs-keyglyph'>=</span>
<a name="line-1774"></a>    <span class='hs-varid'>pprPromotionQuoteI</span> <span class='hs-varop'>$</span> <span class='hs-varid'>ifaceTyConIsPromoted</span> <span class='hs-varop'>$</span> <span class='hs-varid'>ifaceTyConInfo</span> <span class='hs-varid'>tc</span>
<a name="line-1775"></a>
<a name="line-1776"></a><a name="pprPromotionQuoteI"></a><span class='hs-definition'>pprPromotionQuoteI</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PromotionFlag</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1777"></a><span class='hs-definition'>pprPromotionQuoteI</span> <span class='hs-conid'>NotPromoted</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
<a name="line-1778"></a><span class='hs-definition'>pprPromotionQuoteI</span> <span class='hs-conid'>IsPromoted</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'\''</span>
<a name="line-1779"></a>
<a name="line-1780"></a><a name="instance%20Outputable%20IfaceCoercion"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceCoercion</span> <span class='hs-keyword'>where</span>
<a name="line-1781"></a>  <span class='hs-varid'>ppr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprIfaceCoercion</span>
<a name="line-1782"></a>
<a name="line-1783"></a><a name="instance%20Binary%20IfaceTyCon"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-keyword'>where</span>
<a name="line-1784"></a>   <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyCon</span> <span class='hs-varid'>n</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>n</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>i</span>
<a name="line-1785"></a>
<a name="line-1786"></a>   <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1787"></a>               <span class='hs-varid'>i</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1788"></a>               <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyCon</span> <span class='hs-varid'>n</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<a name="line-1789"></a>
<a name="line-1790"></a><a name="instance%20Binary%20IfaceTyConSort"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span> <span class='hs-conid'>IfaceTyConSort</span> <span class='hs-keyword'>where</span>
<a name="line-1791"></a>   <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-conid'>IfaceNormalTyCon</span>             <span class='hs-keyglyph'>=</span> <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>0</span>
<a name="line-1792"></a>   <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTupleTyCon</span> <span class='hs-varid'>arity</span> <span class='hs-varid'>sort</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>1</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>arity</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>sort</span>
<a name="line-1793"></a>   <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceSumTyCon</span> <span class='hs-varid'>arity</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>2</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>arity</span>
<a name="line-1794"></a>   <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-conid'>IfaceEqualityTyCon</span>           <span class='hs-keyglyph'>=</span> <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>3</span>
<a name="line-1795"></a>
<a name="line-1796"></a>   <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-1797"></a>       <span class='hs-varid'>n</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getByte</span> <span class='hs-varid'>bh</span>
<a name="line-1798"></a>       <span class='hs-keyword'>case</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>of</span>
<a name="line-1799"></a>         <span class='hs-num'>0</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>IfaceNormalTyCon</span>
<a name="line-1800"></a>         <span class='hs-num'>1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceTupleTyCon</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span> <span class='hs-varop'>&lt;*&gt;</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1801"></a>         <span class='hs-num'>2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IfaceSumTyCon</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1802"></a>         <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>IfaceEqualityTyCon</span>
<a name="line-1803"></a>
<a name="line-1804"></a><a name="instance%20Binary%20IfaceTyConInfo"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span> <span class='hs-conid'>IfaceTyConInfo</span> <span class='hs-keyword'>where</span>
<a name="line-1805"></a>   <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConInfo</span> <span class='hs-varid'>i</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>s</span>
<a name="line-1806"></a>
<a name="line-1807"></a>   <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIfaceTyConInfo</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span> <span class='hs-varop'>&lt;*&gt;</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1808"></a>
<a name="line-1809"></a><a name="instance%20Outputable%20IfaceTyLit"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>IfaceTyLit</span> <span class='hs-keyword'>where</span>
<a name="line-1810"></a>  <span class='hs-varid'>ppr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprIfaceTyLit</span>
<a name="line-1811"></a>
<a name="line-1812"></a><a name="instance%20Binary%20IfaceTyLit"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span> <span class='hs-conid'>IfaceTyLit</span> <span class='hs-keyword'>where</span>
<a name="line-1813"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceNumTyLit</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>1</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>n</span>
<a name="line-1814"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceStrTyLit</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>2</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>n</span>
<a name="line-1815"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCharTyLit</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>3</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>n</span>
<a name="line-1816"></a>
<a name="line-1817"></a>  <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span> <span class='hs-keyglyph'>=</span>
<a name="line-1818"></a>    <span class='hs-keyword'>do</span> <span class='hs-varid'>tag</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getByte</span> <span class='hs-varid'>bh</span>
<a name="line-1819"></a>       <span class='hs-keyword'>case</span> <span class='hs-varid'>tag</span> <span class='hs-keyword'>of</span>
<a name="line-1820"></a>         <span class='hs-num'>1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-layout'>{</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1821"></a>                 <span class='hs-layout'>;</span> <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceNumTyLit</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span>
<a name="line-1822"></a>         <span class='hs-num'>2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-layout'>{</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1823"></a>                 <span class='hs-layout'>;</span> <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceStrTyLit</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span>
<a name="line-1824"></a>         <span class='hs-num'>3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-layout'>{</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1825"></a>                 <span class='hs-layout'>;</span> <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCharTyLit</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span>
<a name="line-1826"></a>         <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>panic</span> <span class='hs-layout'>(</span><span class='hs-str'>"get IfaceTyLit "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>tag</span><span class='hs-layout'>)</span>
<a name="line-1827"></a>
<a name="line-1828"></a><a name="instance%20Binary%20IfaceAppArgs"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyword'>where</span>
<a name="line-1829"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>tk</span> <span class='hs-keyglyph'>=</span>
<a name="line-1830"></a>    <span class='hs-keyword'>case</span> <span class='hs-varid'>tk</span> <span class='hs-keyword'>of</span>
<a name="line-1831"></a>      <span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>t</span> <span class='hs-varid'>a</span> <span class='hs-varid'>ts</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>0</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>t</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>ts</span>
<a name="line-1832"></a>      <span class='hs-conid'>IA_Nil</span>        <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>1</span>
<a name="line-1833"></a>
<a name="line-1834"></a>  <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span> <span class='hs-keyglyph'>=</span>
<a name="line-1835"></a>    <span class='hs-keyword'>do</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getByte</span> <span class='hs-varid'>bh</span>
<a name="line-1836"></a>       <span class='hs-keyword'>case</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-1837"></a>         <span class='hs-num'>0</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-1838"></a>           <span class='hs-varid'>t</span>  <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1839"></a>           <span class='hs-varid'>a</span>  <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1840"></a>           <span class='hs-varid'>ts</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1841"></a>           <span class='hs-varid'>return</span> <span class='hs-varop'>$!</span> <span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>t</span> <span class='hs-varid'>a</span> <span class='hs-varid'>ts</span>
<a name="line-1842"></a>         <span class='hs-num'>1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>IA_Nil</span>
<a name="line-1843"></a>         <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>panic</span> <span class='hs-layout'>(</span><span class='hs-str'>"get IfaceAppArgs "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-1844"></a>
<a name="line-1845"></a><span class='hs-comment'>-------------------</span>
<a name="line-1846"></a>
<a name="line-1847"></a><span class='hs-comment'>-- Some notes about printing contexts</span>
<a name="line-1848"></a><span class='hs-comment'>--</span>
<a name="line-1849"></a><span class='hs-comment'>-- In the event that we are printing a singleton context (e.g. @Eq a@) we can</span>
<a name="line-1850"></a><span class='hs-comment'>-- omit parentheses. However, we must take care to set the precedence correctly</span>
<a name="line-1851"></a><span class='hs-comment'>-- to opPrec, since something like @a :~: b@ must be parenthesized (see</span>
<a name="line-1852"></a><span class='hs-comment'>-- #9658).</span>
<a name="line-1853"></a><span class='hs-comment'>--</span>
<a name="line-1854"></a><span class='hs-comment'>-- When printing a larger context we use 'fsep' instead of 'sep' so that</span>
<a name="line-1855"></a><span class='hs-comment'>-- the context doesn't get displayed as a giant column. Rather than,</span>
<a name="line-1856"></a><span class='hs-comment'>--  instance (Eq a,</span>
<a name="line-1857"></a><span class='hs-comment'>--            Eq b,</span>
<a name="line-1858"></a><span class='hs-comment'>--            Eq c,</span>
<a name="line-1859"></a><span class='hs-comment'>--            Eq d,</span>
<a name="line-1860"></a><span class='hs-comment'>--            Eq e,</span>
<a name="line-1861"></a><span class='hs-comment'>--            Eq f,</span>
<a name="line-1862"></a><span class='hs-comment'>--            Eq g,</span>
<a name="line-1863"></a><span class='hs-comment'>--            Eq h,</span>
<a name="line-1864"></a><span class='hs-comment'>--            Eq i,</span>
<a name="line-1865"></a><span class='hs-comment'>--            Eq j,</span>
<a name="line-1866"></a><span class='hs-comment'>--            Eq k,</span>
<a name="line-1867"></a><span class='hs-comment'>--            Eq l) =&gt;</span>
<a name="line-1868"></a><span class='hs-comment'>--           Eq (a, b, c, d, e, f, g, h, i, j, k, l)</span>
<a name="line-1869"></a><span class='hs-comment'>--</span>
<a name="line-1870"></a><span class='hs-comment'>-- we want</span>
<a name="line-1871"></a><span class='hs-comment'>--</span>
<a name="line-1872"></a><span class='hs-comment'>--  instance (Eq a, Eq b, Eq c, Eq d, Eq e, Eq f, Eq g, Eq h, Eq i,</span>
<a name="line-1873"></a><span class='hs-comment'>--            Eq j, Eq k, Eq l) =&gt;</span>
<a name="line-1874"></a><span class='hs-comment'>--           Eq (a, b, c, d, e, f, g, h, i, j, k, l)</span>
<a name="line-1875"></a>
<a name="line-1876"></a>
<a name="line-1877"></a>
<a name="line-1878"></a><a name="pprIfaceContextArr"></a><span class='hs-comment'>-- | Prints "(C a, D b) =&gt;", including the arrow.</span>
<a name="line-1879"></a><span class='hs-comment'>-- Used when we want to print a context in a type, so we</span>
<a name="line-1880"></a><span class='hs-comment'>-- use 'funPrec' to decide whether to parenthesise a singleton</span>
<a name="line-1881"></a><span class='hs-comment'>-- predicate; e.g.   Num a =&gt; a -&gt; a</span>
<a name="line-1882"></a><span class='hs-definition'>pprIfaceContextArr</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfacePredType</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1883"></a><span class='hs-definition'>pprIfaceContextArr</span> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
<a name="line-1884"></a><span class='hs-definition'>pprIfaceContextArr</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pred</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>funPrec</span> <span class='hs-varid'>pred</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>darrow</span>
<a name="line-1885"></a><span class='hs-definition'>pprIfaceContextArr</span> <span class='hs-varid'>preds</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_parend_preds</span> <span class='hs-varid'>preds</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>darrow</span>
<a name="line-1886"></a>
<a name="line-1887"></a><a name="pprIfaceContext"></a><span class='hs-comment'>-- | Prints a context or @()@ if empty</span>
<a name="line-1888"></a><span class='hs-comment'>-- You give it the context precedence</span>
<a name="line-1889"></a><span class='hs-definition'>pprIfaceContext</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfacePredType</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1890"></a><span class='hs-definition'>pprIfaceContext</span> <span class='hs-keyword'>_</span>    <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"()"</span>
<a name="line-1891"></a><span class='hs-definition'>pprIfaceContext</span> <span class='hs-varid'>prec</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pred</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_ty</span> <span class='hs-varid'>prec</span> <span class='hs-varid'>pred</span>
<a name="line-1892"></a><span class='hs-definition'>pprIfaceContext</span> <span class='hs-keyword'>_</span>    <span class='hs-varid'>preds</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_parend_preds</span> <span class='hs-varid'>preds</span>
<a name="line-1893"></a>
<a name="line-1894"></a><a name="ppr_parend_preds"></a><span class='hs-definition'>ppr_parend_preds</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfacePredType</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1895"></a><span class='hs-definition'>ppr_parend_preds</span> <span class='hs-varid'>preds</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>fsep</span> <span class='hs-layout'>(</span><span class='hs-varid'>punctuate</span> <span class='hs-varid'>comma</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>preds</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1896"></a>
<a name="line-1897"></a><a name="instance%20Binary%20IfaceType"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyword'>where</span>
<a name="line-1898"></a>    <span class='hs-varid'>put_</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFreeTyVar</span> <span class='hs-varid'>tv</span><span class='hs-layout'>)</span>
<a name="line-1899"></a>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPanic</span> <span class='hs-str'>"Can't serialise IfaceFreeTyVar"</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>tv</span><span class='hs-layout'>)</span>
<a name="line-1900"></a>
<a name="line-1901"></a>    <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceForAllTy</span> <span class='hs-varid'>aa</span> <span class='hs-varid'>ab</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-1902"></a>            <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>0</span>
<a name="line-1903"></a>            <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>aa</span>
<a name="line-1904"></a>            <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>ab</span>
<a name="line-1905"></a>    <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyVar</span> <span class='hs-varid'>ad</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-1906"></a>            <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>1</span>
<a name="line-1907"></a>            <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>ad</span>
<a name="line-1908"></a>    <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAppTy</span> <span class='hs-varid'>ae</span> <span class='hs-varid'>af</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-1909"></a>            <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>2</span>
<a name="line-1910"></a>            <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>ae</span>
<a name="line-1911"></a>            <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>af</span>
<a name="line-1912"></a>    <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFunTy</span> <span class='hs-varid'>af</span> <span class='hs-varid'>aw</span> <span class='hs-varid'>ag</span> <span class='hs-varid'>ah</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-1913"></a>            <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>3</span>
<a name="line-1914"></a>            <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>af</span>
<a name="line-1915"></a>            <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>aw</span>
<a name="line-1916"></a>            <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>ag</span>
<a name="line-1917"></a>            <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>ah</span>
<a name="line-1918"></a>    <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span>
<a name="line-1919"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span> <span class='hs-layout'>{</span> <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>5</span><span class='hs-layout'>;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>tc</span><span class='hs-layout'>;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>tys</span> <span class='hs-layout'>}</span>
<a name="line-1920"></a>    <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCastTy</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-1921"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span> <span class='hs-layout'>{</span> <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>6</span><span class='hs-layout'>;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span><span class='hs-layout'>;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>b</span> <span class='hs-layout'>}</span>
<a name="line-1922"></a>    <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCoercionTy</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-1923"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span> <span class='hs-layout'>{</span> <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>7</span><span class='hs-layout'>;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span> <span class='hs-layout'>}</span>
<a name="line-1924"></a>    <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTupleTy</span> <span class='hs-varid'>s</span> <span class='hs-varid'>i</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span>
<a name="line-1925"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span> <span class='hs-layout'>{</span> <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>8</span><span class='hs-layout'>;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>s</span><span class='hs-layout'>;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>i</span><span class='hs-layout'>;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>tys</span> <span class='hs-layout'>}</span>
<a name="line-1926"></a>    <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLitTy</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-1927"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span> <span class='hs-layout'>{</span> <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>9</span><span class='hs-layout'>;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>n</span> <span class='hs-layout'>}</span>
<a name="line-1928"></a>
<a name="line-1929"></a>    <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-1930"></a>            <span class='hs-varid'>h</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getByte</span> <span class='hs-varid'>bh</span>
<a name="line-1931"></a>            <span class='hs-keyword'>case</span> <span class='hs-varid'>h</span> <span class='hs-keyword'>of</span>
<a name="line-1932"></a>              <span class='hs-num'>0</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>aa</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1933"></a>                      <span class='hs-varid'>ab</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1934"></a>                      <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceForAllTy</span> <span class='hs-varid'>aa</span> <span class='hs-varid'>ab</span><span class='hs-layout'>)</span>
<a name="line-1935"></a>              <span class='hs-num'>1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>ad</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1936"></a>                      <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyVar</span> <span class='hs-varid'>ad</span><span class='hs-layout'>)</span>
<a name="line-1937"></a>              <span class='hs-num'>2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>ae</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1938"></a>                      <span class='hs-varid'>af</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1939"></a>                      <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAppTy</span> <span class='hs-varid'>ae</span> <span class='hs-varid'>af</span><span class='hs-layout'>)</span>
<a name="line-1940"></a>              <span class='hs-num'>3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>af</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1941"></a>                      <span class='hs-varid'>aw</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1942"></a>                      <span class='hs-varid'>ag</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1943"></a>                      <span class='hs-varid'>ah</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1944"></a>                      <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFunTy</span> <span class='hs-varid'>af</span> <span class='hs-varid'>aw</span> <span class='hs-varid'>ag</span> <span class='hs-varid'>ah</span><span class='hs-layout'>)</span>
<a name="line-1945"></a>              <span class='hs-num'>5</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-layout'>{</span> <span class='hs-varid'>tc</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span><span class='hs-layout'>;</span> <span class='hs-varid'>tys</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1946"></a>                      <span class='hs-layout'>;</span> <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>tc</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span>
<a name="line-1947"></a>              <span class='hs-num'>6</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-layout'>{</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span><span class='hs-layout'>;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1948"></a>                      <span class='hs-layout'>;</span> <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCastTy</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span>
<a name="line-1949"></a>              <span class='hs-num'>7</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-layout'>{</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1950"></a>                      <span class='hs-layout'>;</span> <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCoercionTy</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span>
<a name="line-1951"></a>
<a name="line-1952"></a>              <span class='hs-num'>8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-layout'>{</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span><span class='hs-layout'>;</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span><span class='hs-layout'>;</span> <span class='hs-varid'>tys</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1953"></a>                      <span class='hs-layout'>;</span> <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTupleTy</span> <span class='hs-varid'>s</span> <span class='hs-varid'>i</span> <span class='hs-varid'>tys</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span>
<a name="line-1954"></a>              <span class='hs-keyword'>_</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1955"></a>                       <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLitTy</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-1956"></a>
<a name="line-1957"></a><a name="instance%20Binary%20IfaceMCoercion"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span> <span class='hs-conid'>IfaceMCoercion</span> <span class='hs-keyword'>where</span>
<a name="line-1958"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-conid'>IfaceMRefl</span> <span class='hs-keyglyph'>=</span>
<a name="line-1959"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>1</span>
<a name="line-1960"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceMCo</span> <span class='hs-varid'>co</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-1961"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>2</span>
<a name="line-1962"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>co</span>
<a name="line-1963"></a>
<a name="line-1964"></a>  <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-1965"></a>    <span class='hs-varid'>tag</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getByte</span> <span class='hs-varid'>bh</span>
<a name="line-1966"></a>    <span class='hs-keyword'>case</span> <span class='hs-varid'>tag</span> <span class='hs-keyword'>of</span>
<a name="line-1967"></a>         <span class='hs-num'>1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>IfaceMRefl</span>
<a name="line-1968"></a>         <span class='hs-num'>2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-1969"></a>                 <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceMCo</span> <span class='hs-varid'>a</span>
<a name="line-1970"></a>         <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>panic</span> <span class='hs-layout'>(</span><span class='hs-str'>"get IfaceMCoercion "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>tag</span><span class='hs-layout'>)</span>
<a name="line-1971"></a>
<a name="line-1972"></a><a name="instance%20Binary%20IfaceCoercion"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span> <span class='hs-conid'>IfaceCoercion</span> <span class='hs-keyword'>where</span>
<a name="line-1973"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceReflCo</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-1974"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>1</span>
<a name="line-1975"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-1976"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceGReflCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-1977"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>2</span>
<a name="line-1978"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-1979"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>b</span>
<a name="line-1980"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>c</span>
<a name="line-1981"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFunCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>w</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-1982"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>3</span>
<a name="line-1983"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-1984"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>w</span>
<a name="line-1985"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>b</span>
<a name="line-1986"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>c</span>
<a name="line-1987"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConAppCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-1988"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>4</span>
<a name="line-1989"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-1990"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>b</span>
<a name="line-1991"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>c</span>
<a name="line-1992"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAppCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-1993"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>5</span>
<a name="line-1994"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-1995"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>b</span>
<a name="line-1996"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceForAllCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-1997"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>6</span>
<a name="line-1998"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-1999"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>b</span>
<a name="line-2000"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>c</span>
<a name="line-2001"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCoVarCo</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2002"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>7</span>
<a name="line-2003"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-2004"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAxiomInstCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2005"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>8</span>
<a name="line-2006"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-2007"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>b</span>
<a name="line-2008"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>c</span>
<a name="line-2009"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceUnivCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2010"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>9</span>
<a name="line-2011"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-2012"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>b</span>
<a name="line-2013"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>c</span>
<a name="line-2014"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>d</span>
<a name="line-2015"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceSymCo</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2016"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>10</span>
<a name="line-2017"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-2018"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTransCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2019"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>11</span>
<a name="line-2020"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-2021"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>b</span>
<a name="line-2022"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceNthCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2023"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>12</span>
<a name="line-2024"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-2025"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>b</span>
<a name="line-2026"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceLRCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2027"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>13</span>
<a name="line-2028"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-2029"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>b</span>
<a name="line-2030"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceInstCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2031"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>14</span>
<a name="line-2032"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-2033"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>b</span>
<a name="line-2034"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceKindCo</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2035"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>15</span>
<a name="line-2036"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-2037"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceSubCo</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2038"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>16</span>
<a name="line-2039"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-2040"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceAxiomRuleCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2041"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>17</span>
<a name="line-2042"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-2043"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>b</span>
<a name="line-2044"></a>  <span class='hs-varid'>put_</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceFreeCoVar</span> <span class='hs-varid'>cv</span><span class='hs-layout'>)</span>
<a name="line-2045"></a>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPanic</span> <span class='hs-str'>"Can't serialise IfaceFreeCoVar"</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>cv</span><span class='hs-layout'>)</span>
<a name="line-2046"></a>  <span class='hs-varid'>put_</span> <span class='hs-keyword'>_</span>  <span class='hs-layout'>(</span><span class='hs-conid'>IfaceHoleCo</span> <span class='hs-varid'>cv</span><span class='hs-layout'>)</span>
<a name="line-2047"></a>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPanic</span> <span class='hs-str'>"Can't serialise IfaceHoleCo"</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>cv</span><span class='hs-layout'>)</span>
<a name="line-2048"></a>          <span class='hs-comment'>-- See Note [Holes in IfaceCoercion]</span>
<a name="line-2049"></a>
<a name="line-2050"></a>  <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2051"></a>      <span class='hs-varid'>tag</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getByte</span> <span class='hs-varid'>bh</span>
<a name="line-2052"></a>      <span class='hs-keyword'>case</span> <span class='hs-varid'>tag</span> <span class='hs-keyword'>of</span>
<a name="line-2053"></a>           <span class='hs-num'>1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2054"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceReflCo</span> <span class='hs-varid'>a</span>
<a name="line-2055"></a>           <span class='hs-num'>2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2056"></a>                   <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2057"></a>                   <span class='hs-varid'>c</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2058"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceGReflCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<a name="line-2059"></a>           <span class='hs-num'>3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2060"></a>                   <span class='hs-varid'>w</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2061"></a>                   <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2062"></a>                   <span class='hs-varid'>c</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2063"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceFunCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>w</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<a name="line-2064"></a>           <span class='hs-num'>4</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2065"></a>                   <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2066"></a>                   <span class='hs-varid'>c</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2067"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceTyConAppCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<a name="line-2068"></a>           <span class='hs-num'>5</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2069"></a>                   <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2070"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceAppCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<a name="line-2071"></a>           <span class='hs-num'>6</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2072"></a>                   <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2073"></a>                   <span class='hs-varid'>c</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2074"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceForAllCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<a name="line-2075"></a>           <span class='hs-num'>7</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2076"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceCoVarCo</span> <span class='hs-varid'>a</span>
<a name="line-2077"></a>           <span class='hs-num'>8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2078"></a>                   <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2079"></a>                   <span class='hs-varid'>c</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2080"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceAxiomInstCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span>
<a name="line-2081"></a>           <span class='hs-num'>9</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2082"></a>                   <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2083"></a>                   <span class='hs-varid'>c</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2084"></a>                   <span class='hs-varid'>d</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2085"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceUnivCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span> <span class='hs-varid'>d</span>
<a name="line-2086"></a>           <span class='hs-num'>10</span><span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2087"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceSymCo</span> <span class='hs-varid'>a</span>
<a name="line-2088"></a>           <span class='hs-num'>11</span><span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2089"></a>                   <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2090"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceTransCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<a name="line-2091"></a>           <span class='hs-num'>12</span><span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2092"></a>                   <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2093"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceNthCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<a name="line-2094"></a>           <span class='hs-num'>13</span><span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2095"></a>                   <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2096"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceLRCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<a name="line-2097"></a>           <span class='hs-num'>14</span><span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2098"></a>                   <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2099"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceInstCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<a name="line-2100"></a>           <span class='hs-num'>15</span><span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2101"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceKindCo</span> <span class='hs-varid'>a</span>
<a name="line-2102"></a>           <span class='hs-num'>16</span><span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2103"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceSubCo</span> <span class='hs-varid'>a</span>
<a name="line-2104"></a>           <span class='hs-num'>17</span><span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2105"></a>                   <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2106"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceAxiomRuleCo</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<a name="line-2107"></a>           <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>panic</span> <span class='hs-layout'>(</span><span class='hs-str'>"get IfaceCoercion "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>tag</span><span class='hs-layout'>)</span>
<a name="line-2108"></a>
<a name="line-2109"></a><a name="instance%20Binary%20IfaceUnivCoProv"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span> <span class='hs-conid'>IfaceUnivCoProv</span> <span class='hs-keyword'>where</span>
<a name="line-2110"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfacePhantomProv</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2111"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>1</span>
<a name="line-2112"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-2113"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceProofIrrelProv</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2114"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>2</span>
<a name="line-2115"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-2116"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfacePluginProv</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2117"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>3</span>
<a name="line-2118"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-2119"></a>  <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCorePrepProv</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2120"></a>          <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>4</span>
<a name="line-2121"></a>          <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>a</span>
<a name="line-2122"></a>
<a name="line-2123"></a>  <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2124"></a>      <span class='hs-varid'>tag</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getByte</span> <span class='hs-varid'>bh</span>
<a name="line-2125"></a>      <span class='hs-keyword'>case</span> <span class='hs-varid'>tag</span> <span class='hs-keyword'>of</span>
<a name="line-2126"></a>           <span class='hs-num'>1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2127"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfacePhantomProv</span> <span class='hs-varid'>a</span>
<a name="line-2128"></a>           <span class='hs-num'>2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2129"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfaceProofIrrelProv</span> <span class='hs-varid'>a</span>
<a name="line-2130"></a>           <span class='hs-num'>3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2131"></a>                   <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>IfacePluginProv</span> <span class='hs-varid'>a</span>
<a name="line-2132"></a>           <span class='hs-num'>4</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-2133"></a>                   <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceCorePrepProv</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-2134"></a>           <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>panic</span> <span class='hs-layout'>(</span><span class='hs-str'>"get IfaceUnivCoProv "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>tag</span><span class='hs-layout'>)</span>
<a name="line-2135"></a>
<a name="line-2136"></a>
<a name="line-2137"></a><a name="instance%20Binary%20(DefMethSpec%20IfaceType)"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span> <span class='hs-layout'>(</span><span class='hs-conid'>DefMethSpec</span> <span class='hs-conid'>IfaceType</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-2138"></a>    <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-conid'>VanillaDM</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>0</span>
<a name="line-2139"></a>    <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>GenericDM</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>putByte</span> <span class='hs-varid'>bh</span> <span class='hs-num'>1</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>t</span>
<a name="line-2140"></a>    <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-2141"></a>            <span class='hs-varid'>h</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getByte</span> <span class='hs-varid'>bh</span>
<a name="line-2142"></a>            <span class='hs-keyword'>case</span> <span class='hs-varid'>h</span> <span class='hs-keyword'>of</span>
<a name="line-2143"></a>              <span class='hs-num'>0</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-conid'>VanillaDM</span>
<a name="line-2144"></a>              <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span> <span class='hs-layout'>{</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span><span class='hs-layout'>;</span> <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>GenericDM</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span>
<a name="line-2145"></a>
<a name="line-2146"></a><a name="instance%20NFData%20IfaceType"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>NFData</span> <span class='hs-conid'>IfaceType</span> <span class='hs-keyword'>where</span>
<a name="line-2147"></a>  <span class='hs-varid'>rnf</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>\</span><span class='hs-keyword'>case</span>
<a name="line-2148"></a>    <span class='hs-conid'>IfaceFreeTyVar</span> <span class='hs-varid'>f1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-conid'>()</span>
<a name="line-2149"></a>    <span class='hs-conid'>IfaceTyVar</span> <span class='hs-varid'>f1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span>
<a name="line-2150"></a>    <span class='hs-conid'>IfaceLitTy</span> <span class='hs-varid'>f1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span>
<a name="line-2151"></a>    <span class='hs-conid'>IfaceAppTy</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span>
<a name="line-2152"></a>    <span class='hs-conid'>IfaceFunTy</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-varid'>f3</span> <span class='hs-varid'>f4</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f3</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f4</span>
<a name="line-2153"></a>    <span class='hs-conid'>IfaceForAllTy</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span>
<a name="line-2154"></a>    <span class='hs-conid'>IfaceTyConApp</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span>
<a name="line-2155"></a>    <span class='hs-conid'>IfaceCastTy</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span>
<a name="line-2156"></a>    <span class='hs-conid'>IfaceCoercionTy</span> <span class='hs-varid'>f1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span>
<a name="line-2157"></a>    <span class='hs-conid'>IfaceTupleTy</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-varid'>f3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>f2</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f3</span>
<a name="line-2158"></a>
<a name="line-2159"></a><a name="instance%20NFData%20IfaceTyLit"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>NFData</span> <span class='hs-conid'>IfaceTyLit</span> <span class='hs-keyword'>where</span>
<a name="line-2160"></a>  <span class='hs-varid'>rnf</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>\</span><span class='hs-keyword'>case</span>
<a name="line-2161"></a>    <span class='hs-conid'>IfaceNumTyLit</span> <span class='hs-varid'>f1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span>
<a name="line-2162"></a>    <span class='hs-conid'>IfaceStrTyLit</span> <span class='hs-varid'>f1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span>
<a name="line-2163"></a>    <span class='hs-conid'>IfaceCharTyLit</span> <span class='hs-varid'>f1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span>
<a name="line-2164"></a>
<a name="line-2165"></a><a name="instance%20NFData%20IfaceCoercion"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>NFData</span> <span class='hs-conid'>IfaceCoercion</span> <span class='hs-keyword'>where</span>
<a name="line-2166"></a>  <span class='hs-varid'>rnf</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>\</span><span class='hs-keyword'>case</span>
<a name="line-2167"></a>    <span class='hs-conid'>IfaceReflCo</span> <span class='hs-varid'>f1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span>
<a name="line-2168"></a>    <span class='hs-conid'>IfaceGReflCo</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-varid'>f3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f3</span>
<a name="line-2169"></a>    <span class='hs-conid'>IfaceFunCo</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-varid'>f3</span> <span class='hs-varid'>f4</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f3</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f4</span>
<a name="line-2170"></a>    <span class='hs-conid'>IfaceTyConAppCo</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-varid'>f3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f3</span>
<a name="line-2171"></a>    <span class='hs-conid'>IfaceAppCo</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span>
<a name="line-2172"></a>    <span class='hs-conid'>IfaceForAllCo</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-varid'>f3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f3</span>
<a name="line-2173"></a>    <span class='hs-conid'>IfaceCoVarCo</span> <span class='hs-varid'>f1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span>
<a name="line-2174"></a>    <span class='hs-conid'>IfaceAxiomInstCo</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-varid'>f3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f3</span>
<a name="line-2175"></a>    <span class='hs-conid'>IfaceAxiomRuleCo</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span>
<a name="line-2176"></a>    <span class='hs-conid'>IfaceUnivCo</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-varid'>f3</span> <span class='hs-varid'>f4</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>f2</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f3</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f4</span>
<a name="line-2177"></a>    <span class='hs-conid'>IfaceSymCo</span> <span class='hs-varid'>f1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span>
<a name="line-2178"></a>    <span class='hs-conid'>IfaceTransCo</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span>
<a name="line-2179"></a>    <span class='hs-conid'>IfaceNthCo</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span>
<a name="line-2180"></a>    <span class='hs-conid'>IfaceLRCo</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span>
<a name="line-2181"></a>    <span class='hs-conid'>IfaceInstCo</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span>
<a name="line-2182"></a>    <span class='hs-conid'>IfaceKindCo</span> <span class='hs-varid'>f1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span>
<a name="line-2183"></a>    <span class='hs-conid'>IfaceSubCo</span> <span class='hs-varid'>f1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span>
<a name="line-2184"></a>    <span class='hs-conid'>IfaceFreeCoVar</span> <span class='hs-varid'>f1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-conid'>()</span>
<a name="line-2185"></a>    <span class='hs-conid'>IfaceHoleCo</span> <span class='hs-varid'>f1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-conid'>()</span>
<a name="line-2186"></a>
<a name="line-2187"></a><a name="instance%20NFData%20IfaceUnivCoProv"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>NFData</span> <span class='hs-conid'>IfaceUnivCoProv</span> <span class='hs-keyword'>where</span>
<a name="line-2188"></a>  <span class='hs-varid'>rnf</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>seq</span> <span class='hs-varid'>x</span> <span class='hs-conid'>()</span>
<a name="line-2189"></a>
<a name="line-2190"></a><a name="instance%20NFData%20IfaceMCoercion"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>NFData</span> <span class='hs-conid'>IfaceMCoercion</span> <span class='hs-keyword'>where</span>
<a name="line-2191"></a>  <span class='hs-varid'>rnf</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>seq</span> <span class='hs-varid'>x</span> <span class='hs-conid'>()</span>
<a name="line-2192"></a>
<a name="line-2193"></a><a name="instance%20NFData%20IfaceOneShot"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>NFData</span> <span class='hs-conid'>IfaceOneShot</span> <span class='hs-keyword'>where</span>
<a name="line-2194"></a>  <span class='hs-varid'>rnf</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>seq</span> <span class='hs-varid'>x</span> <span class='hs-conid'>()</span>
<a name="line-2195"></a>
<a name="line-2196"></a><a name="instance%20NFData%20IfaceTyConSort"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>NFData</span> <span class='hs-conid'>IfaceTyConSort</span> <span class='hs-keyword'>where</span>
<a name="line-2197"></a>  <span class='hs-varid'>rnf</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>\</span><span class='hs-keyword'>case</span>
<a name="line-2198"></a>    <span class='hs-conid'>IfaceNormalTyCon</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>()</span>
<a name="line-2199"></a>    <span class='hs-conid'>IfaceTupleTyCon</span> <span class='hs-varid'>arity</span> <span class='hs-varid'>sort</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>arity</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>sort</span> <span class='hs-varop'>`seq`</span> <span class='hs-conid'>()</span>
<a name="line-2200"></a>    <span class='hs-conid'>IfaceSumTyCon</span> <span class='hs-varid'>arity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>arity</span>
<a name="line-2201"></a>    <span class='hs-conid'>IfaceEqualityTyCon</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>()</span>
<a name="line-2202"></a>
<a name="line-2203"></a><a name="instance%20NFData%20IfaceTyConInfo"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>NFData</span> <span class='hs-conid'>IfaceTyConInfo</span> <span class='hs-keyword'>where</span>
<a name="line-2204"></a>  <span class='hs-varid'>rnf</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyConInfo</span> <span class='hs-varid'>f</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>s</span>
<a name="line-2205"></a>
<a name="line-2206"></a><a name="instance%20NFData%20IfaceTyCon"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>NFData</span> <span class='hs-conid'>IfaceTyCon</span> <span class='hs-keyword'>where</span>
<a name="line-2207"></a>  <span class='hs-varid'>rnf</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceTyCon</span> <span class='hs-varid'>nm</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>nm</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>info</span>
<a name="line-2208"></a>
<a name="line-2209"></a><a name="instance%20NFData%20IfaceBndr"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>NFData</span> <span class='hs-conid'>IfaceBndr</span> <span class='hs-keyword'>where</span>
<a name="line-2210"></a>  <span class='hs-varid'>rnf</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>\</span><span class='hs-keyword'>case</span>
<a name="line-2211"></a>    <span class='hs-conid'>IfaceIdBndr</span> <span class='hs-varid'>id_bndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>id_bndr</span>
<a name="line-2212"></a>    <span class='hs-conid'>IfaceTvBndr</span> <span class='hs-varid'>tv_bndr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>tv_bndr</span>
<a name="line-2213"></a>
<a name="line-2214"></a><a name="instance%20NFData%20IfaceAppArgs"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>NFData</span> <span class='hs-conid'>IfaceAppArgs</span> <span class='hs-keyword'>where</span>
<a name="line-2215"></a>  <span class='hs-varid'>rnf</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>\</span><span class='hs-keyword'>case</span>
<a name="line-2216"></a>    <span class='hs-conid'>IA_Nil</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>()</span>
<a name="line-2217"></a>    <span class='hs-conid'>IA_Arg</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-varid'>f3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>f2</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f3</span>
</pre></body>
</html>
