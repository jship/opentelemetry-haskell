<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998

Extracting imported and top-level names in scope
-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE CPP, NondecreasingIndentation #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-uni-patterns   #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-record-updates #-}</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Rename.Names</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-17"></span><span>        </span><span class="annot"><a href="GHC.Rename.Names.html#rnImports"><span class="hs-identifier">rnImports</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#getLocalNonValBinders"><span class="hs-identifier">getLocalNonValBinders</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#newRecordSelector"><span class="hs-identifier">newRecordSelector</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>        </span><span class="annot"><a href="GHC.Rename.Names.html#extendGlobalRdrEnvRn"><span class="hs-identifier">extendGlobalRdrEnvRn</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>        </span><span class="annot"><a href="GHC.Types.Name.Reader.html#gresFromAvails"><span class="hs-identifier">gresFromAvails</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>        </span><span class="annot"><a href="GHC.Rename.Names.html#calculateAvails"><span class="hs-identifier">calculateAvails</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>        </span><span class="annot"><a href="GHC.Rename.Names.html#reportUnusedNames"><span class="hs-identifier">reportUnusedNames</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>        </span><span class="annot"><a href="GHC.Rename.Names.html#checkConName"><span class="hs-identifier">checkConName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>        </span><span class="annot"><a href="GHC.Rename.Names.html#mkChildEnv"><span class="hs-identifier">mkChildEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><a href="GHC.Rename.Names.html#findChildren"><span class="hs-identifier">findChildren</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>        </span><span class="annot"><a href="GHC.Rename.Names.html#dodgyMsg"><span class="hs-identifier">dodgyMsg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>        </span><span class="annot"><a href="GHC.Rename.Names.html#dodgyMsgInsert"><span class="hs-identifier">dodgyMsgInsert</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><a href="GHC.Rename.Names.html#findImportUsage"><span class="hs-identifier">findImportUsage</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><a href="GHC.Rename.Names.html#getMinimalImports"><span class="hs-identifier">getMinimalImports</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>        </span><span class="annot"><a href="GHC.Rename.Names.html#printMinimalImports"><span class="hs-identifier">printMinimalImports</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>        </span><span class="annot"><a href="GHC.Rename.Names.html#ImportDeclUsage"><span class="hs-identifier">ImportDeclUsage</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#include &quot;HsVersions.h&quot;
</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Env.html"><span class="hs-identifier">GHC.Driver.Env</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html"><span class="hs-identifier">GHC.Driver.Session</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Ppr.html"><span class="hs-identifier">GHC.Driver.Ppr</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Env.html"><span class="hs-identifier">GHC.Rename.Env</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Fixity.html"><span class="hs-identifier">GHC.Rename.Fixity</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html"><span class="hs-identifier">GHC.Rename.Utils</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#warnUnusedTopBinds"><span class="hs-identifier">warnUnusedTopBinds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Rename.Utils.html#mkFieldEnv"><span class="hs-identifier">mkFieldEnv</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Env.html"><span class="hs-identifier">GHC.Tc.Utils.Env</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.Monad.html"><span class="hs-identifier">GHC.Tc.Utils.Monad</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Hs.html"><span class="hs-identifier">GHC.Hs</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Iface.Load.html"><span class="hs-identifier">GHC.Iface.Load</span></a></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Iface.Load.html#loadSrcInterface"><span class="hs-identifier">loadSrcInterface</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Parser.PostProcess.html"><span class="hs-identifier">GHC.Parser.PostProcess</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Parser.PostProcess.html#setRdrNameSpace"><span class="hs-identifier">setRdrNameSpace</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.PatSyn.html"><span class="hs-identifier">GHC.Core.PatSyn</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Ppr.html"><span class="hs-identifier">GHC.Core.TyCo.Ppr</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier">tyConName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#tyConKind"><span class="hs-identifier">tyConKind</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../ghc-boot-9.2.7/src/GHC-LanguageExtensions.html#"><span class="hs-identifier">GHC.LanguageExtensions</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LangExt</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Outputable</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Utils</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Fixity.Env.html"><span class="hs-identifier">GHC.Types.Fixity.Env</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SafeHaskell.html"><span class="hs-identifier">GHC.Types.SafeHaskell</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html"><span class="hs-identifier">GHC.Types.Name.Env</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html"><span class="hs-identifier">GHC.Types.Name.Set</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html"><span class="hs-identifier">GHC.Types.Name.Reader</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Avail.html"><span class="hs-identifier">GHC.Types.Avail</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html"><span class="hs-identifier">GHC.Types.FieldLabel</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SourceFile.html"><span class="hs-identifier">GHC.Types.SourceFile</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SrcLoc</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#TopLevelFlag"><span class="hs-identifier">TopLevelFlag</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SourceText.html"><span class="hs-identifier">GHC.Types.SourceText</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.html"><span class="hs-identifier">GHC.Types.Id</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.HpcInfo.html"><span class="hs-identifier">GHC.Types.HpcInfo</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.html"><span class="hs-identifier">GHC.Unit</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Warnings.html"><span class="hs-identifier">GHC.Unit.Module.Warnings</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModIface.html"><span class="hs-identifier">GHC.Unit.Module.ModIface</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Imported.html"><span class="hs-identifier">GHC.Unit.Module.Imported</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Deps.html"><span class="hs-identifier">GHC.Unit.Module.Deps</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html"><span class="hs-identifier">GHC.Data.Maybe</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.Env.html"><span class="hs-identifier">GHC.Data.FastString.Env</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Control-Monad.html#"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-Either.html#"><span class="hs-identifier">Data.Either</span></a></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-Either.html#partitionEithers"><span class="hs-identifier">partitionEithers</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../containers-0.6.5.1/src/Data-Map.html#"><span class="hs-identifier">Data.Map</span></a></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../containers-0.6.5.1/src/Data-Map-Internal.html#Map"><span class="hs-identifier">Map</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.6.5.1/src/Data-Map.html#"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-Ord.html#"><span class="hs-identifier">Data.Ord</span></a></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-Ord.html#comparing"><span class="hs-identifier">comparing</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-List.html#"><span class="hs-identifier">Data.List</span></a></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-OldList.html#partition"><span class="hs-identifier">partition</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-OldList.html#%5C%5C"><span class="hs-operator">(\\)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-Foldable.html#find"><span class="hs-identifier">find</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-OldList.html#sortBy"><span class="hs-identifier">sortBy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-OldList.html#groupBy"><span class="hs-identifier">groupBy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-OldList.html#sortOn"><span class="hs-identifier">sortOn</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-Function.html#"><span class="hs-identifier">Data.Function</span></a></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-Function.html#on"><span class="hs-identifier">on</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.6.5.1/src/Data-Set.html#"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../filepath-1.4.2.2/src/System-FilePath.html#"><span class="hs-identifier">System.FilePath</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../../filepath-1.4.2.2/src/System-FilePath-Posix.html#%3C%2F%3E"><span class="hs-operator">(&lt;/&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/System-IO.html#"><span class="hs-identifier">System.IO</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{rnImports}
*                                                                      *
************************************************************************

Note [Tracking Trust Transitively]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When we import a package as well as checking that the direct imports are safe
according to the rules outlined in the Note [Safe Haskell Trust Check] in GHC.Driver.Main
we must also check that these rules hold transitively for all dependent modules
and packages. Doing this without caching any trust information would be very
slow as we would need to touch all packages and interface files a module depends
on. To avoid this we make use of the property that if a modules Safe Haskell
mode changes, this triggers a recompilation from that module in the dependcy
graph. So we can just worry mostly about direct imports.

There is one trust property that can change for a package though without
recompilation being triggered: package trust. So we must check that all
packages a module transitively depends on to be trusted are still trusted when
we are compiling this module (as due to recompilation avoidance some modules
below may not be considered trusted any more without recompilation being
triggered).

We handle this by augmenting the existing transitive list of packages a module M
depends on with a bool for each package that says if it must be trusted when the
module M is being checked for trust. This list of trust required packages for a
single import is gathered in the rnImportDecl function and stored in an
ImportAvails data structure. The union of these trust required packages for all
imports is done by the rnImports function using the combine function which calls
the plusImportAvails function that is a union operation for the ImportAvails
type. This gives us in an ImportAvails structure all packages required to be
trusted for the module we are currently compiling. Checking that these packages
are still trusted (and that direct imports are trusted) is done in
GHC.Driver.Main.checkSafeImports.

See the note below, [Trust Own Package] for a corner case in this method and
how its handled.


Note [Trust Own Package]
~~~~~~~~~~~~~~~~~~~~~~~~
There is a corner case of package trust checking that the usual transitive check
doesn't cover. (For how the usual check operates see the Note [Tracking Trust
Transitively] below). The case is when you import a -XSafe module M and M
imports a -XTrustworthy module N. If N resides in a different package than M,
then the usual check works as M will record a package dependency on N's package
and mark it as required to be trusted. If N resides in the same package as M
though, then importing M should require its own package be trusted due to N
(since M is -XSafe so doesn't create this requirement by itself). The usual
check fails as a module doesn't record a package dependency of its own package.
So instead we now have a bool field in a modules interface file that simply
states if the module requires its own package to be trusted. This field avoids
us having to load all interface files that the module depends on to see if one
is trustworthy.


Note [Trust Transitive Property]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
So there is an interesting design question in regards to transitive trust
checking. Say I have a module B compiled with -XSafe. B is dependent on a bunch
of modules and packages, some packages it requires to be trusted as its using
-XTrustworthy modules from them. Now if I have a module A that doesn't use safe
haskell at all and simply imports B, should A inherit all the trust
requirements from B? Should A now also require that a package p is trusted since
B required it?

We currently say no but saying yes also makes sense. The difference is, if a
module M that doesn't use Safe Haskell imports a module N that does, should all
the trusted package requirements be dropped since M didn't declare that it cares
about Safe Haskell (so -XSafe is more strongly associated with the module doing
the importing) or should it be done still since the author of the module N that
uses Safe Haskell said they cared (so -XSafe is more strongly associated with
the module that was compiled that used it).

Going with yes is a simpler semantics we think and harder for the user to stuff
up but it does mean that Safe Haskell will affect users who don't care about
Safe Haskell as they might grab a package from Cabal which uses safe haskell (say
network) and that packages imports -XTrustworthy modules from another package
(say bytestring), so requires that package is trusted. The user may now get
compilation errors in code that doesn't do anything with Safe Haskell simply
because they are using the network package. They will have to call 'ghc-pkg
trust network' to get everything working. Due to this invasive nature of going
with yes we have gone with no for now.
-}</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- | Process Import Decls.  See 'rnImportDecl' for a description of what</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- the return types represent.</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- Note: Do the non SOURCE ones first, so that we get a helpful warning</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- for SOURCE ones that are unnecessary</span><span>
</span><span id="line-190"></span><span class="annot"><a href="GHC.Rename.Names.html#rnImports"><span class="hs-identifier hs-type">rnImports</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#ImportAvails"><span class="hs-identifier hs-type">ImportAvails</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.HpcInfo.html#AnyHpcUsage"><span class="hs-identifier hs-type">AnyHpcUsage</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span id="rnImports"><span class="annot"><span class="annottext">rnImports :: [LImportDecl GhcPs]
-&gt; RnM ([LImportDecl GhcRn], GlobalRdrEnv, ImportAvails, Bool)
</span><a href="GHC.Rename.Names.html#rnImports"><span class="hs-identifier hs-var hs-var">rnImports</span></a></span></span><span> </span><span id="local-6989586621681363605"><span class="annot"><span class="annottext">[LImportDecl GhcPs]
</span><a href="#local-6989586621681363605"><span class="hs-identifier hs-var">imports</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621681363604"><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681363604"><span class="hs-identifier hs-var">tcg_env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. TcRnIf gbl lcl gbl
</span><a href="GHC.Tc.Utils.Monad.html#getGblEnv"><span class="hs-identifier hs-var">getGblEnv</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-comment">-- NB: want an identity module here, because it's OK for a signature</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-comment">-- module to import from its implementor</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681363602"><span class="annot"><span class="annottext">this_mod :: Module
</span><a href="#local-6989586621681363602"><span class="hs-identifier hs-var hs-var">this_mod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcGblEnv -&gt; Module
</span><a href="GHC.Tc.Types.html#tcg_mod"><span class="hs-identifier hs-var">tcg_mod</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681363604"><span class="hs-identifier hs-var">tcg_env</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363600"><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (ImportDecl GhcPs)]
</span><a href="#local-6989586621681363600"><span class="hs-identifier hs-var">source</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363599"><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (ImportDecl GhcPs)]
</span><a href="#local-6989586621681363599"><span class="hs-identifier hs-var">ordinary</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="../../base-4.16.4.0/src/Data-OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a></span><span> </span><span class="annot"><span class="annottext">forall {l} {pass}. GenLocated l (ImportDecl pass) -&gt; Bool
</span><a href="#local-6989586621681363598"><span class="hs-identifier hs-var">is_source_import</span></a></span><span> </span><span class="annot"><span class="annottext">[LImportDecl GhcPs]
</span><a href="#local-6989586621681363605"><span class="hs-identifier hs-var">imports</span></a></span><span>
</span><span id="line-198"></span><span>        </span><span id="local-6989586621681363598"><span class="annot"><span class="annottext">is_source_import :: GenLocated l (ImportDecl pass) -&gt; Bool
</span><a href="#local-6989586621681363598"><span class="hs-identifier hs-var hs-var">is_source_import</span></a></span></span><span> </span><span id="local-6989586621681363596"><span class="annot"><span class="annottext">GenLocated l (ImportDecl pass)
</span><a href="#local-6989586621681363596"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; IsBootInterface
</span><a href="GHC.Hs.ImpExp.html#ideclSource"><span class="hs-identifier hs-var">ideclSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated l (ImportDecl pass)
</span><a href="#local-6989586621681363596"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IsBootInterface
</span><a href="GHC.Unit.Types.html#IsBoot"><span class="hs-identifier hs-var">IsBoot</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span id="local-6989586621681363592"><span class="annot"><span class="annottext">[(GenLocated SrcSpanAnnA (ImportDecl GhcRn), GlobalRdrEnv,
  ImportAvails, Bool)]
</span><a href="#local-6989586621681363592"><span class="hs-identifier hs-var">stuff1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; TcRn b) -&gt; [a] -&gt; TcRn [b]
</span><a href="GHC.Tc.Utils.Monad.html#mapAndReportM"><span class="hs-identifier hs-var">mapAndReportM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module
-&gt; LImportDecl GhcPs
-&gt; RnM (LImportDecl GhcRn, GlobalRdrEnv, ImportAvails, Bool)
</span><a href="GHC.Rename.Names.html#rnImportDecl"><span class="hs-identifier hs-var">rnImportDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681363602"><span class="hs-identifier hs-var">this_mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (ImportDecl GhcPs)]
</span><a href="#local-6989586621681363599"><span class="hs-identifier hs-var">ordinary</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621681363589"><span class="annot"><span class="annottext">[(GenLocated SrcSpanAnnA (ImportDecl GhcRn), GlobalRdrEnv,
  ImportAvails, Bool)]
</span><a href="#local-6989586621681363589"><span class="hs-identifier hs-var">stuff2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; TcRn b) -&gt; [a] -&gt; TcRn [b]
</span><a href="GHC.Tc.Utils.Monad.html#mapAndReportM"><span class="hs-identifier hs-var">mapAndReportM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module
-&gt; LImportDecl GhcPs
-&gt; RnM (LImportDecl GhcRn, GlobalRdrEnv, ImportAvails, Bool)
</span><a href="GHC.Rename.Names.html#rnImportDecl"><span class="hs-identifier hs-var">rnImportDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681363602"><span class="hs-identifier hs-var">this_mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (ImportDecl GhcPs)]
</span><a href="#local-6989586621681363600"><span class="hs-identifier hs-var">source</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-comment">-- Safe Haskell: See Note [Tracking Trust Transitively]</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363588"><span class="annot"><span class="annottext">[LImportDecl GhcRn]
</span><a href="#local-6989586621681363588"><span class="hs-identifier hs-var">decls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363587"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363587"><span class="hs-identifier hs-var">rdr_env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363586"><span class="annot"><span class="annottext">ImportAvails
</span><a href="#local-6989586621681363586"><span class="hs-identifier hs-var">imp_avails</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363585"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363585"><span class="hs-identifier hs-var">hpc_usage</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(LImportDecl GhcRn, GlobalRdrEnv, ImportAvails, Bool)]
-&gt; ([LImportDecl GhcRn], GlobalRdrEnv, ImportAvails, Bool)
</span><a href="#local-6989586621681363584"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(GenLocated SrcSpanAnnA (ImportDecl GhcRn), GlobalRdrEnv,
  ImportAvails, Bool)]
</span><a href="#local-6989586621681363592"><span class="hs-identifier hs-var">stuff1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[(GenLocated SrcSpanAnnA (ImportDecl GhcRn), GlobalRdrEnv,
  ImportAvails, Bool)]
</span><a href="#local-6989586621681363589"><span class="hs-identifier hs-var">stuff2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LImportDecl GhcRn]
</span><a href="#local-6989586621681363588"><span class="hs-identifier hs-var">decls</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363587"><span class="hs-identifier hs-var">rdr_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImportAvails
</span><a href="#local-6989586621681363586"><span class="hs-identifier hs-var">imp_avails</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363585"><span class="hs-identifier hs-var">hpc_usage</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-comment">-- See Note [Combining ImportAvails]</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><a href="#local-6989586621681363584"><span class="hs-identifier hs-type">combine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#ImportAvails"><span class="hs-identifier hs-type">ImportAvails</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.HpcInfo.html#AnyHpcUsage"><span class="hs-identifier hs-type">AnyHpcUsage</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#ImportAvails"><span class="hs-identifier hs-type">ImportAvails</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.HpcInfo.html#AnyHpcUsage"><span class="hs-identifier hs-type">AnyHpcUsage</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>    </span><span id="local-6989586621681363584"><span class="annot"><span class="annottext">combine :: [(LImportDecl GhcRn, GlobalRdrEnv, ImportAvails, Bool)]
-&gt; ([LImportDecl GhcRn], GlobalRdrEnv, ImportAvails, Bool)
</span><a href="#local-6989586621681363584"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621681363583"><span class="annot"><span class="annottext">[(LImportDecl GhcRn, GlobalRdrEnv, ImportAvails, Bool)]
</span><a href="#local-6989586621681363583"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-210"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363582"><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (ImportDecl GhcRn)]
</span><a href="#local-6989586621681363582"><span class="hs-identifier hs-var">decls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363581"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363581"><span class="hs-identifier hs-var">rdr_env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363580"><span class="annot"><span class="annottext">ImportAvails
</span><a href="#local-6989586621681363580"><span class="hs-identifier hs-var">imp_avails</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363579"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363579"><span class="hs-identifier hs-var">hpc_usage</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363578"><span class="annot"><span class="annottext">ModuleSet
</span><a href="#local-6989586621681363578"><span class="hs-identifier hs-var">finsts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span>
</span><span id="line-211"></span><span>            </span><span class="annot"><span class="annottext">forall {a}.
(a, GlobalRdrEnv, ImportAvails, Bool)
-&gt; ([a], GlobalRdrEnv, ImportAvails, Bool, ModuleSet)
-&gt; ([a], GlobalRdrEnv, ImportAvails, Bool, ModuleSet)
</span><a href="#local-6989586621681363576"><span class="hs-identifier hs-var">plus</span></a></span><span>
</span><span id="line-212"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="GHC.Types.Name.Reader.html#emptyGlobalRdrEnv"><span class="hs-identifier hs-var">emptyGlobalRdrEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImportAvails
</span><a href="GHC.Tc.Types.html#emptyImportAvails"><span class="hs-identifier hs-var">emptyImportAvails</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ModuleSet
</span><a href="GHC.Unit.Module.Env.html#emptyModuleSet"><span class="hs-identifier hs-var">emptyModuleSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>            </span><span class="annot"><span class="annottext">[(LImportDecl GhcRn, GlobalRdrEnv, ImportAvails, Bool)]
</span><a href="#local-6989586621681363583"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-214"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (ImportDecl GhcRn)]
</span><a href="#local-6989586621681363582"><span class="hs-identifier hs-var">decls</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363581"><span class="hs-identifier hs-var">rdr_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImportAvails
</span><a href="#local-6989586621681363580"><span class="hs-identifier hs-var">imp_avails</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">imp_finsts :: [Module]
</span><a href="GHC.Tc.Types.html#imp_finsts"><span class="hs-identifier hs-var">imp_finsts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleSet -&gt; [Module]
</span><a href="GHC.Unit.Module.Env.html#moduleSetElts"><span class="hs-identifier hs-var">moduleSetElts</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleSet
</span><a href="#local-6989586621681363578"><span class="hs-identifier hs-var">finsts</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-215"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363579"><span class="hs-identifier hs-var">hpc_usage</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span>    </span><span id="local-6989586621681363576"><span class="annot"><span class="annottext">plus :: (a, GlobalRdrEnv, ImportAvails, Bool)
-&gt; ([a], GlobalRdrEnv, ImportAvails, Bool, ModuleSet)
-&gt; ([a], GlobalRdrEnv, ImportAvails, Bool, ModuleSet)
</span><a href="#local-6989586621681363576"><span class="hs-identifier hs-var hs-var">plus</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363570"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681363570"><span class="hs-identifier hs-var">decl</span></a></span></span><span class="hs-special">,</span><span>  </span><span id="local-6989586621681363569"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363569"><span class="hs-identifier hs-var">gbl_env1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363568"><span class="annot"><span class="annottext">ImportAvails
</span><a href="#local-6989586621681363568"><span class="hs-identifier hs-var">imp_avails1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363567"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363567"><span class="hs-identifier hs-var">hpc_usage1</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621681363566"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681363566"><span class="hs-identifier hs-var">decls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363565"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363565"><span class="hs-identifier hs-var">gbl_env2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363564"><span class="annot"><span class="annottext">ImportAvails
</span><a href="#local-6989586621681363564"><span class="hs-identifier hs-var">imp_avails2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363563"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363563"><span class="hs-identifier hs-var">hpc_usage2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363562"><span class="annot"><span class="annottext">ModuleSet
</span><a href="#local-6989586621681363562"><span class="hs-identifier hs-var">finsts_set</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681363570"><span class="hs-identifier hs-var">decl</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621681363566"><span class="hs-identifier hs-var">decls</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-220"></span><span>          </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363569"><span class="hs-identifier hs-var">gbl_env1</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; GlobalRdrEnv -&gt; GlobalRdrEnv
</span><a href="GHC.Types.Name.Reader.html#plusGlobalRdrEnv"><span class="hs-operator hs-var">`plusGlobalRdrEnv`</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363565"><span class="hs-identifier hs-var">gbl_env2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-221"></span><span>          </span><span class="annot"><span class="annottext">ImportAvails
</span><a href="#local-6989586621681363560"><span class="hs-identifier hs-var">imp_avails1'</span></a></span><span> </span><span class="annot"><span class="annottext">ImportAvails -&gt; ImportAvails -&gt; ImportAvails
</span><a href="GHC.Tc.Types.html#plusImportAvails"><span class="hs-operator hs-var">`plusImportAvails`</span></a></span><span> </span><span class="annot"><span class="annottext">ImportAvails
</span><a href="#local-6989586621681363564"><span class="hs-identifier hs-var">imp_avails2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-222"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363567"><span class="hs-identifier hs-var">hpc_usage1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363563"><span class="hs-identifier hs-var">hpc_usage2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-223"></span><span>          </span><span class="annot"><span class="annottext">ModuleSet -&gt; [Module] -&gt; ModuleSet
</span><a href="GHC.Unit.Module.Env.html#extendModuleSetList"><span class="hs-identifier hs-var">extendModuleSetList</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleSet
</span><a href="#local-6989586621681363562"><span class="hs-identifier hs-var">finsts_set</span></a></span><span> </span><span class="annot"><span class="annottext">[Module]
</span><a href="#local-6989586621681363556"><span class="hs-identifier hs-var">new_finsts</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>      </span><span id="local-6989586621681363560"><span class="annot"><span class="annottext">imp_avails1' :: ImportAvails
</span><a href="#local-6989586621681363560"><span class="hs-identifier hs-var hs-var">imp_avails1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImportAvails
</span><a href="#local-6989586621681363568"><span class="hs-identifier hs-var">imp_avails1</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">imp_finsts :: [Module]
</span><a href="GHC.Tc.Types.html#imp_finsts"><span class="hs-identifier hs-var">imp_finsts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-226"></span><span>      </span><span id="local-6989586621681363556"><span class="annot"><span class="annottext">new_finsts :: [Module]
</span><a href="#local-6989586621681363556"><span class="hs-identifier hs-var hs-var">new_finsts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImportAvails -&gt; [Module]
</span><a href="GHC.Tc.Types.html#imp_finsts"><span class="hs-identifier hs-var">imp_finsts</span></a></span><span> </span><span class="annot"><span class="annottext">ImportAvails
</span><a href="#local-6989586621681363568"><span class="hs-identifier hs-var">imp_avails1</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">{-
Note [Combining ImportAvails]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
imp_finsts in ImportAvails is a list of family instance modules
transitively depended on by an import. imp_finsts for a currently
compiled module is a union of all the imp_finsts of imports.
Computing the union of two lists of size N is O(N^2) and if we
do it to M imports we end up with O(M*N^2). That can get very
expensive for bigger module hierarchies.

Union can be optimized to O(N log N) if we use a Set.
imp_finsts is converted back and forth between dep_finsts, so
changing a type of imp_finsts means either paying for the conversions
or changing the type of dep_finsts as well.

I've measured that the conversions would cost 20% of allocations on my
test case, so that can be ruled out.

Changing the type of dep_finsts forces checkFamInsts to
get the module lists in non-deterministic order. If we wanted to restore
the deterministic order, we'd have to sort there, which is an additional
cost. As far as I can tell, using a non-deterministic order is fine there,
but that's a brittle nonlocal property which I'd like to avoid.

Additionally, dep_finsts is read from an interface file, so its &quot;natural&quot;
type is a list. Which makes it a natural type for imp_finsts.

Since rnImports.combine is really the only place that would benefit from
it being a Set, it makes sense to optimize the hot loop in rnImports.combine
without changing the representation.

So here's what we do: instead of naively merging ImportAvails with
plusImportAvails in a loop, we make plusImportAvails merge empty imp_finsts
and compute the union on the side using Sets. When we're done, we can
convert it back to a list. One nice side effect of this approach is that
if there's a lot of overlap in the imp_finsts of imports, the
Set doesn't really need to grow and we don't need to allocate.

Running generateModules from #14693 with DEPTH=16, WIDTH=30 finishes in
23s before, and 11s after.
-}</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- | Given a located import declaration @decl@ from @this_mod@,</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- calculate the following pieces of information:</span><span>
</span><span id="line-274"></span><span class="hs-comment">--</span><span>
</span><span id="line-275"></span><span class="hs-comment">--  1. An updated 'LImportDecl', where all unresolved 'RdrName' in</span><span>
</span><span id="line-276"></span><span class="hs-comment">--     the entity lists have been resolved into 'Name's,</span><span>
</span><span id="line-277"></span><span class="hs-comment">--</span><span>
</span><span id="line-278"></span><span class="hs-comment">--  2. A 'GlobalRdrEnv' representing the new identifiers that were</span><span>
</span><span id="line-279"></span><span class="hs-comment">--     brought into scope (taking into account module qualification</span><span>
</span><span id="line-280"></span><span class="hs-comment">--     and hiding),</span><span>
</span><span id="line-281"></span><span class="hs-comment">--</span><span>
</span><span id="line-282"></span><span class="hs-comment">--  3. 'ImportAvails' summarizing the identifiers that were imported</span><span>
</span><span id="line-283"></span><span class="hs-comment">--     by this declaration, and</span><span>
</span><span id="line-284"></span><span class="hs-comment">--</span><span>
</span><span id="line-285"></span><span class="hs-comment">--  4. A boolean 'AnyHpcUsage' which is true if the imported module</span><span>
</span><span id="line-286"></span><span class="hs-comment">--     used HPC.</span><span>
</span><span id="line-287"></span><span class="annot"><a href="GHC.Rename.Names.html#rnImportDecl"><span class="hs-identifier hs-type">rnImportDecl</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-288"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#ImportAvails"><span class="hs-identifier hs-type">ImportAvails</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.HpcInfo.html#AnyHpcUsage"><span class="hs-identifier hs-type">AnyHpcUsage</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span id="rnImportDecl"><span class="annot"><span class="annottext">rnImportDecl :: Module
-&gt; LImportDecl GhcPs
-&gt; RnM (LImportDecl GhcRn, GlobalRdrEnv, ImportAvails, Bool)
</span><a href="GHC.Rename.Names.html#rnImportDecl"><span class="hs-identifier hs-var hs-var">rnImportDecl</span></a></span></span><span> </span><span id="local-6989586621681363555"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681363555"><span class="hs-identifier hs-var">this_mod</span></a></span></span><span>
</span><span id="line-290"></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681363553"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681363553"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621681363552"><span class="annot"><span class="annottext">decl :: ImportDecl GhcPs
</span><a href="#local-6989586621681363552"><span class="hs-identifier hs-var">decl</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#ImportDecl"><span class="hs-identifier hs-type">ImportDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ideclName :: forall pass. ImportDecl pass -&gt; XRec pass ModuleName
</span><a href="GHC.Hs.ImpExp.html#ideclName"><span class="hs-identifier hs-var">ideclName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681363549"><span class="annot"><span class="annottext">XRec GhcPs ModuleName
</span><a href="#local-6989586621681363549"><span class="hs-identifier hs-var">loc_imp_mod_name</span></a></span></span><span>
</span><span id="line-291"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ideclPkgQual :: forall pass. ImportDecl pass -&gt; Maybe StringLiteral
</span><a href="GHC.Hs.ImpExp.html#ideclPkgQual"><span class="hs-identifier hs-var">ideclPkgQual</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681363547"><span class="annot"><span class="annottext">Maybe StringLiteral
</span><a href="#local-6989586621681363547"><span class="hs-identifier hs-var">mb_pkg</span></a></span></span><span>
</span><span id="line-292"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ideclSource :: forall pass. ImportDecl pass -&gt; IsBootInterface
</span><a href="GHC.Hs.ImpExp.html#ideclSource"><span class="hs-identifier hs-var">ideclSource</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681363546"><span class="annot"><span class="annottext">IsBootInterface
</span><a href="#local-6989586621681363546"><span class="hs-identifier hs-var">want_boot</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ideclSafe :: forall pass. ImportDecl pass -&gt; Bool
</span><a href="GHC.Hs.ImpExp.html#ideclSafe"><span class="hs-identifier hs-var">ideclSafe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681363544"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363544"><span class="hs-identifier hs-var">mod_safe</span></a></span></span><span>
</span><span id="line-293"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ideclQualified :: forall pass. ImportDecl pass -&gt; ImportDeclQualifiedStyle
</span><a href="GHC.Hs.ImpExp.html#ideclQualified"><span class="hs-identifier hs-var">ideclQualified</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681363542"><span class="annot"><span class="annottext">ImportDeclQualifiedStyle
</span><a href="#local-6989586621681363542"><span class="hs-identifier hs-var">qual_style</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ideclImplicit :: forall pass. ImportDecl pass -&gt; Bool
</span><a href="GHC.Hs.ImpExp.html#ideclImplicit"><span class="hs-identifier hs-var">ideclImplicit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681363540"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363540"><span class="hs-identifier hs-var">implicit</span></a></span></span><span>
</span><span id="line-294"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ideclAs :: forall pass. ImportDecl pass -&gt; Maybe (XRec pass ModuleName)
</span><a href="GHC.Hs.ImpExp.html#ideclAs"><span class="hs-identifier hs-var">ideclAs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681363538"><span class="annot"><span class="annottext">Maybe (XRec GhcPs ModuleName)
</span><a href="#local-6989586621681363538"><span class="hs-identifier hs-var">as_mod</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ideclHiding :: forall pass. ImportDecl pass -&gt; Maybe (Bool, XRec pass [LIE pass])
</span><a href="GHC.Hs.ImpExp.html#ideclHiding"><span class="hs-identifier hs-var">ideclHiding</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681363536"><span class="annot"><span class="annottext">Maybe (Bool, XRec GhcPs [LIE GhcPs])
</span><a href="#local-6989586621681363536"><span class="hs-identifier hs-var">imp_details</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ann a. SrcSpanAnn' ann -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpanA"><span class="hs-identifier hs-var">setSrcSpanA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681363553"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Maybe.html#isJust"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StringLiteral
</span><a href="#local-6989586621681363547"><span class="hs-identifier hs-var">mb_pkg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-298"></span><span>        </span><span id="local-6989586621681363532"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363532"><span class="hs-identifier hs-var">pkg_imports</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><span class="hs-identifier hs-var">LangExt.PackageImports</span></span><span>
</span><span id="line-299"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363532"><span class="hs-identifier hs-var">pkg_imports</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Rename.Names.html#packageImportErr"><span class="hs-identifier hs-var">packageImportErr</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681363526"><span class="annot"><span class="annottext">qual_only :: Bool
</span><a href="#local-6989586621681363526"><span class="hs-identifier hs-var hs-var">qual_only</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImportDeclQualifiedStyle -&gt; Bool
</span><a href="GHC.Hs.ImpExp.html#isImportDeclQualified"><span class="hs-identifier hs-var">isImportDeclQualified</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDeclQualifiedStyle
</span><a href="#local-6989586621681363542"><span class="hs-identifier hs-var">qual_style</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-comment">-- If there's an error in loadInterface, (e.g. interface</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-comment">-- file not found) we get lots of spurious errors from 'filterImports'</span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681363524"><span class="annot"><span class="annottext">imp_mod_name :: ModuleName
</span><a href="#local-6989586621681363524"><span class="hs-identifier hs-var hs-var">imp_mod_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">XRec GhcPs ModuleName
</span><a href="#local-6989586621681363549"><span class="hs-identifier hs-var">loc_imp_mod_name</span></a></span><span>
</span><span id="line-306"></span><span>        </span><span id="local-6989586621681363523"><span class="annot"><span class="annottext">doc :: SDoc
</span><a href="#local-6989586621681363523"><span class="hs-identifier hs-var hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681363524"><span class="hs-identifier hs-var">imp_mod_name</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is directly imported&quot;</span></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-comment">-- Check for self-import, which confuses the typechecker (#9032)</span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-comment">-- ghc --make rejects self-import cycles already, but batch-mode may not</span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-comment">-- at least not until GHC.IfaceToCore.tcHiBootIface, which is too late to avoid</span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-comment">-- typechecker crashes.  (Indirect self imports are not caught until</span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-comment">-- GHC.IfaceToCore, see #10337 tracking how to make this error better.)</span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-comment">-- Originally, we also allowed 'import {-# SOURCE #-} M', but this</span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-comment">-- caused bug #10182: in one-shot mode, we should never load an hs-boot</span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-comment">-- file for the module we are compiling into the EPS.  In principle,</span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-comment">-- it should be possible to support this mode of use, but we would have to</span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-comment">-- extend Provenance to support a local definition in a qualified location.</span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-comment">-- For now, we don't support it, but see #10336</span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681363524"><span class="hs-identifier hs-var">imp_mod_name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall unit. GenModule unit -&gt; ModuleName
</span><a href="GHC.Unit.Types.html#moduleName"><span class="hs-identifier hs-var">moduleName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681363555"><span class="hs-identifier hs-var">this_mod</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-321"></span><span>          </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe StringLiteral
</span><a href="#local-6989586621681363547"><span class="hs-identifier hs-var">mb_pkg</span></a></span><span> </span><span class="hs-keyword">of</span><span>  </span><span class="hs-comment">-- If we have import &quot;&lt;pkg&gt;&quot; M, then we should</span><span>
</span><span id="line-322"></span><span>                           </span><span class="hs-comment">-- check that &quot;&lt;pkg&gt;&quot; is &quot;this&quot; (which is magic)</span><span>
</span><span id="line-323"></span><span>                           </span><span class="hs-comment">-- or the name of this_mod's package.  Yurgh!</span><span>
</span><span id="line-324"></span><span>                           </span><span class="hs-comment">-- c.f. GHC.findModule, and #9997</span><span>
</span><span id="line-325"></span><span>             </span><span class="annot"><span class="annottext">Maybe StringLiteral
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-326"></span><span>             </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SourceText.html#StringLiteral"><span class="hs-identifier hs-type">StringLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">SourceText
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681363516"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681363516"><span class="hs-identifier hs-var">pkg_fs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe RealSrcSpan
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681363516"><span class="hs-identifier hs-var">pkg_fs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; FastString
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;this&quot;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span>
</span><span id="line-327"></span><span>                            </span><span class="annot"><span class="annottext">FastString -&gt; Unit
</span><a href="GHC.Unit.Types.html#fsToUnit"><span class="hs-identifier hs-var">fsToUnit</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681363516"><span class="hs-identifier hs-var">pkg_fs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall unit. GenModule unit -&gt; unit
</span><a href="GHC.Unit.Types.html#moduleUnit"><span class="hs-identifier hs-var">moduleUnit</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681363555"><span class="hs-identifier hs-var">this_mod</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;A module cannot import itself:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681363524"><span class="hs-identifier hs-var">imp_mod_name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-comment">-- Check for a missing import list (Opt_WarnMissingImportList also</span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-comment">-- checks for T(..) items but that is done in checkDodgyImport below)</span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Bool, XRec GhcPs [LIE GhcPs])
</span><a href="#local-6989586621681363536"><span class="hs-identifier hs-var">imp_details</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-333"></span><span>        </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XRec GhcPs [LIE GhcPs]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Explicit import list</span><span>
</span><span id="line-334"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Bool, XRec GhcPs [LIE GhcPs])
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363540"><span class="hs-identifier hs-var">implicit</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Do not bleat for implicit imports</span><span>
</span><span id="line-335"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363526"><span class="hs-identifier hs-var">qual_only</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl.
WarningFlag -&gt; TcRnIf gbl lcl () -&gt; TcRnIf gbl lcl ()
</span><a href="GHC.Tc.Utils.Monad.html#whenWOptM"><span class="hs-identifier hs-var">whenWOptM</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnMissingImportList"><span class="hs-identifier hs-var">Opt_WarnMissingImportList</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-337"></span><span>                           </span><span class="annot"><span class="annottext">WarnReason -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addWarn"><span class="hs-identifier hs-var">addWarn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningFlag -&gt; WarnReason
</span><a href="GHC.Driver.Flags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnMissingImportList"><span class="hs-identifier hs-var">Opt_WarnMissingImportList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>                                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; SDoc
</span><a href="GHC.Rename.Names.html#missingImportListWarn"><span class="hs-identifier hs-var">missingImportListWarn</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681363524"><span class="hs-identifier hs-var">imp_mod_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>    </span><span id="local-6989586621681363507"><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363507"><span class="hs-identifier hs-var">iface</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SDoc
-&gt; ModuleName
-&gt; IsBootInterface
-&gt; Maybe FastString
-&gt; RnM ModIface
</span><a href="GHC.Iface.Load.html#loadSrcInterface"><span class="hs-identifier hs-var">loadSrcInterface</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681363523"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681363524"><span class="hs-identifier hs-var">imp_mod_name</span></a></span><span> </span><span class="annot"><span class="annottext">IsBootInterface
</span><a href="#local-6989586621681363546"><span class="hs-identifier hs-var">want_boot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">StringLiteral -&gt; FastString
</span><a href="GHC.Types.SourceText.html#sl_fs"><span class="hs-identifier hs-var">sl_fs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StringLiteral
</span><a href="#local-6989586621681363547"><span class="hs-identifier hs-var">mb_pkg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-comment">-- Compiler sanity check: if the import didn't say</span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-comment">-- {-# SOURCE #-} we should not get a hi-boot file</span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-identifier">WARN</span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">want_boot</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">NotBoot</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mi_boot</span><span> </span><span class="hs-identifier">iface</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">IsBoot</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">imp_mod_name</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-comment">-- Issue a user warning for a redundant {- SOURCE -} import</span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-comment">-- NB that we arrange to read all the ordinary imports before</span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-comment">-- any of the {- SOURCE -} imports.</span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-comment">-- in --make and GHCi, the compilation manager checks for this,</span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-comment">-- and indeed we shouldn't do it here because the existence of</span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-comment">-- the non-boot module depends on the compilation order, which</span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-comment">-- is not deterministic.  The hs-boot test can show this up.</span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-identifier">dflags</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getDynFlags</span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-identifier">warnIf</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">want_boot</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">IsBoot</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mi_boot</span><span> </span><span class="hs-identifier">iface</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">NotBoot</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">isOneShot</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ghcMode</span><span> </span><span class="hs-identifier">dflags</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>           </span><span class="hs-special">(</span><span class="hs-identifier">warnRedundantSourceImport</span><span> </span><span class="hs-identifier">imp_mod_name</span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-identifier">when</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mod_safe</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">safeImportsOn</span><span> </span><span class="hs-identifier">dflags</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-358"></span><span>        </span><span class="hs-identifier">addErr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">text</span><span> </span><span class="hs-string">&quot;safe import can't be used as Safe Haskell isn't on!&quot;</span><span>
</span><span id="line-359"></span><span>                </span><span class="hs-operator">$+$</span><span> </span><span class="hs-identifier">ptext</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">sLit</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-string">&quot;please enable Safe Haskell through either &quot;</span><span>
</span><span id="line-360"></span><span>                                   </span><span class="hs-operator">++</span><span> </span><span class="hs-string">&quot;Safe, Trustworthy or Unsafe&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-363"></span><span>        </span><span class="hs-identifier">qual_mod_name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">unLoc</span><span> </span><span class="hs-identifier">as_mod</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">orElse</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">imp_mod_name</span><span>
</span><span id="line-364"></span><span>        </span><span class="hs-identifier">imp_spec</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ImpDeclSpec</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">is_mod</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">imp_mod_name</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">is_qual</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">qual_only</span><span class="hs-special">,</span><span>
</span><span id="line-365"></span><span>                                  </span><span class="hs-identifier">is_dloc</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">locA</span><span> </span><span class="hs-identifier">loc</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">is_as</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">qual_mod_name</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span>    </span><span class="hs-comment">-- filter the imports according to the import declaration</span><span>
</span><span id="line-368"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">new_imp_details</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gres</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">filterImports</span><span> </span><span class="hs-identifier">iface</span><span> </span><span class="hs-identifier">imp_spec</span><span> </span><span class="hs-identifier">imp_details</span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-comment">-- for certain error messages, we&#8217;d like to know what could be imported</span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-comment">-- here, if everything were imported</span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-identifier">potential_gres</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">mkGlobalRdrEnv</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">snd</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">filterImports</span><span> </span><span class="hs-identifier">iface</span><span> </span><span class="hs-identifier">imp_spec</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">gbl_env</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkGlobalRdrEnv</span><span> </span><span class="hs-identifier">gres</span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span>        </span><span class="hs-identifier">is_hiding</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">True</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">imp_details</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-377"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">False</span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-comment">-- should the import be safe?</span><span>
</span><span id="line-380"></span><span>        </span><span class="hs-identifier">mod_safe'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mod_safe</span><span>
</span><span id="line-381"></span><span>                    </span><span class="hs-operator">||</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">not</span><span> </span><span class="hs-identifier">implicit</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">safeDirectImpsReq</span><span> </span><span class="hs-identifier">dflags</span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>                    </span><span class="hs-operator">||</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">implicit</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">safeImplicitImpsReq</span><span> </span><span class="hs-identifier">dflags</span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-identifier">hsc_env</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">getTopEnv</span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">home_unit</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">hsc_home_unit</span><span> </span><span class="hs-identifier">hsc_env</span><span>
</span><span id="line-386"></span><span>        </span><span class="hs-identifier">imv</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ImportedModsVal</span><span>
</span><span id="line-387"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">imv_name</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">qual_mod_name</span><span>
</span><span id="line-388"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">imv_span</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">locA</span><span> </span><span class="hs-identifier">loc</span><span>
</span><span id="line-389"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">imv_is_safe</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mod_safe'</span><span>
</span><span id="line-390"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">imv_is_hiding</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">is_hiding</span><span>
</span><span id="line-391"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">imv_all_exports</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">potential_gres</span><span>
</span><span id="line-392"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">imv_qualified</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">qual_only</span><span>
</span><span id="line-393"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-394"></span><span>        </span><span class="hs-identifier">imports</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">calculateAvails</span><span> </span><span class="hs-identifier">home_unit</span><span> </span><span class="hs-identifier">iface</span><span> </span><span class="hs-identifier">mod_safe'</span><span> </span><span class="hs-identifier">want_boot</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ImportedByUser</span><span> </span><span class="hs-identifier">imv</span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span>    </span><span class="hs-comment">-- Complain if we import a deprecated module</span><span>
</span><span id="line-397"></span><span>    </span><span class="hs-identifier">whenWOptM</span><span> </span><span class="hs-identifier">Opt_WarnWarningsDeprecations</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-398"></span><span>       </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mi_warns</span><span> </span><span class="hs-identifier">iface</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-399"></span><span>          </span><span class="hs-identifier">WarnAll</span><span> </span><span class="hs-identifier">txt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">addWarn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Reason</span><span> </span><span class="hs-identifier">Opt_WarnWarningsDeprecations</span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>                                </span><span class="hs-special">(</span><span class="hs-identifier">moduleWarn</span><span> </span><span class="hs-identifier">imp_mod_name</span><span> </span><span class="hs-identifier">txt</span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>          </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-comment">-- Complain about -Wcompat-unqualified-imports violations.</span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-identifier">warnUnqualifiedImport</span><span> </span><span class="hs-identifier">decl</span><span> </span><span class="hs-identifier">iface</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">new_imp_decl</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">L</span><span> </span><span class="hs-identifier">loc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">decl</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ideclExt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">noExtField</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ideclSafe</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mod_safe'</span><span>
</span><span id="line-408"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ideclHiding</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">new_imp_details</span><span>
</span><span id="line-409"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ideclName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ideclName</span><span> </span><span class="hs-identifier">decl</span><span>
</span><span id="line-410"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ideclAs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ideclAs</span><span> </span><span class="hs-identifier">decl</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">new_imp_decl</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">gbl_env</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">imports</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mi_hpc</span><span> </span><span class="hs-identifier">iface</span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="hs-comment">-- | Calculate the 'ImportAvails' induced by an import of a particular</span><span>
</span><span id="line-415"></span><span class="hs-comment">-- interface, but without 'imp_mods'.</span><span>
</span><span id="line-416"></span><span class="annot"><a href="GHC.Rename.Names.html#calculateAvails"><span class="hs-identifier hs-type">calculateAvails</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Home.html#HomeUnit"><span class="hs-identifier hs-type">HomeUnit</span></a></span><span>
</span><span id="line-417"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModIface.html#ModIface"><span class="hs-identifier hs-type">ModIface</span></a></span><span>
</span><span id="line-418"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SafeHaskell.html#IsSafeImport"><span class="hs-identifier hs-type">IsSafeImport</span></a></span><span>
</span><span id="line-419"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#IsBootInterface"><span class="hs-identifier hs-type">IsBootInterface</span></a></span><span>
</span><span id="line-420"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Imported.html#ImportedBy"><span class="hs-identifier hs-type">ImportedBy</span></a></span><span>
</span><span id="line-421"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#ImportAvails"><span class="hs-identifier hs-type">ImportAvails</span></a></span><span>
</span><span id="line-422"></span><span id="calculateAvails"><span class="annot"><span class="annottext">calculateAvails :: HomeUnit
-&gt; ModIface
-&gt; Bool
-&gt; IsBootInterface
-&gt; ImportedBy
-&gt; ImportAvails
</span><a href="GHC.Rename.Names.html#calculateAvails"><span class="hs-identifier hs-var hs-var">calculateAvails</span></a></span></span><span> </span><span id="local-6989586621681363446"><span class="annot"><span class="annottext">HomeUnit
</span><a href="#local-6989586621681363446"><span class="hs-identifier hs-var">home_unit</span></a></span></span><span> </span><span id="local-6989586621681363445"><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363445"><span class="hs-identifier hs-var">iface</span></a></span></span><span> </span><span id="local-6989586621681363444"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363444"><span class="hs-identifier hs-var">mod_safe'</span></a></span></span><span> </span><span id="local-6989586621681363443"><span class="annot"><span class="annottext">IsBootInterface
</span><a href="#local-6989586621681363443"><span class="hs-identifier hs-var">want_boot</span></a></span></span><span> </span><span id="local-6989586621681363442"><span class="annot"><span class="annottext">ImportedBy
</span><a href="#local-6989586621681363442"><span class="hs-identifier hs-var">imported_by</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681363441"><span class="annot"><span class="annottext">imp_mod :: Module
</span><a href="#local-6989586621681363441"><span class="hs-identifier hs-var hs-var">imp_mod</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (phase :: ModIfacePhase). ModIface_ phase -&gt; Module
</span><a href="GHC.Unit.Module.ModIface.html#mi_module"><span class="hs-identifier hs-var">mi_module</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363445"><span class="hs-identifier hs-var">iface</span></a></span><span>
</span><span id="line-424"></span><span>      </span><span id="local-6989586621681363439"><span class="annot"><span class="annottext">imp_sem_mod :: Module
</span><a href="#local-6989586621681363439"><span class="hs-identifier hs-var hs-var">imp_sem_mod</span></a></span></span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (phase :: ModIfacePhase). ModIface_ phase -&gt; Module
</span><a href="GHC.Unit.Module.ModIface.html#mi_semantic_module"><span class="hs-identifier hs-var">mi_semantic_module</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363445"><span class="hs-identifier hs-var">iface</span></a></span><span>
</span><span id="line-425"></span><span>      </span><span id="local-6989586621681363437"><span class="annot"><span class="annottext">orph_iface :: Bool
</span><a href="#local-6989586621681363437"><span class="hs-identifier hs-var hs-var">orph_iface</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModIfaceBackend -&gt; Bool
</span><a href="GHC.Unit.Module.ModIface.html#mi_orphan"><span class="hs-identifier hs-var">mi_orphan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (phase :: ModIfacePhase).
ModIface_ phase -&gt; IfaceBackendExts phase
</span><a href="GHC.Unit.Module.ModIface.html#mi_final_exts"><span class="hs-identifier hs-var">mi_final_exts</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363445"><span class="hs-identifier hs-var">iface</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>      </span><span id="local-6989586621681363434"><span class="annot"><span class="annottext">has_finsts :: Bool
</span><a href="#local-6989586621681363434"><span class="hs-identifier hs-var hs-var">has_finsts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModIfaceBackend -&gt; Bool
</span><a href="GHC.Unit.Module.ModIface.html#mi_finsts"><span class="hs-identifier hs-var">mi_finsts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (phase :: ModIfacePhase).
ModIface_ phase -&gt; IfaceBackendExts phase
</span><a href="GHC.Unit.Module.ModIface.html#mi_final_exts"><span class="hs-identifier hs-var">mi_final_exts</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363445"><span class="hs-identifier hs-var">iface</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>      </span><span id="local-6989586621681363432"><span class="annot"><span class="annottext">deps :: Dependencies
</span><a href="#local-6989586621681363432"><span class="hs-identifier hs-var hs-var">deps</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (phase :: ModIfacePhase). ModIface_ phase -&gt; Dependencies
</span><a href="GHC.Unit.Module.ModIface.html#mi_deps"><span class="hs-identifier hs-var">mi_deps</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363445"><span class="hs-identifier hs-var">iface</span></a></span><span>
</span><span id="line-428"></span><span>      </span><span id="local-6989586621681363430"><span class="annot"><span class="annottext">trust :: SafeHaskellMode
</span><a href="#local-6989586621681363430"><span class="hs-identifier hs-var hs-var">trust</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfaceTrustInfo -&gt; SafeHaskellMode
</span><a href="GHC.Types.SafeHaskell.html#getSafeMode"><span class="hs-identifier hs-var">getSafeMode</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (phase :: ModIfacePhase). ModIface_ phase -&gt; IfaceTrustInfo
</span><a href="GHC.Unit.Module.ModIface.html#mi_trust"><span class="hs-identifier hs-var">mi_trust</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363445"><span class="hs-identifier hs-var">iface</span></a></span><span>
</span><span id="line-429"></span><span>      </span><span id="local-6989586621681363427"><span class="annot"><span class="annottext">trust_pkg :: Bool
</span><a href="#local-6989586621681363427"><span class="hs-identifier hs-var hs-var">trust_pkg</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (phase :: ModIfacePhase). ModIface_ phase -&gt; Bool
</span><a href="GHC.Unit.Module.ModIface.html#mi_trust_pkg"><span class="hs-identifier hs-var">mi_trust_pkg</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363445"><span class="hs-identifier hs-var">iface</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span>      </span><span class="hs-comment">-- If the module exports anything defined in this module, just</span><span>
</span><span id="line-432"></span><span>      </span><span class="hs-comment">-- ignore it.  Reason: otherwise it looks as if there are two</span><span>
</span><span id="line-433"></span><span>      </span><span class="hs-comment">-- local definition sites for the thing, and an error gets</span><span>
</span><span id="line-434"></span><span>      </span><span class="hs-comment">-- reported.  Easiest thing is just to filter them out up</span><span>
</span><span id="line-435"></span><span>      </span><span class="hs-comment">-- front. This situation only arises if a module imports</span><span>
</span><span id="line-436"></span><span>      </span><span class="hs-comment">-- itself, or another module that imported it.  (Necessarily,</span><span>
</span><span id="line-437"></span><span>      </span><span class="hs-comment">-- this involves a loop.)</span><span>
</span><span id="line-438"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-439"></span><span>      </span><span class="hs-comment">-- We do this *after* filterImports, so that if you say</span><span>
</span><span id="line-440"></span><span>      </span><span class="hs-comment">--      module A where</span><span>
</span><span id="line-441"></span><span>      </span><span class="hs-comment">--         import B( AType )</span><span>
</span><span id="line-442"></span><span>      </span><span class="hs-comment">--         type AType = ...</span><span>
</span><span id="line-443"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-444"></span><span>      </span><span class="hs-comment">--      module B( AType ) where</span><span>
</span><span id="line-445"></span><span>      </span><span class="hs-comment">--         import {-# SOURCE #-} A( AType )</span><span>
</span><span id="line-446"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-447"></span><span>      </span><span class="hs-comment">-- then you won't get a 'B does not export AType' message.</span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span>      </span><span class="hs-comment">-- Compute new transitive dependencies</span><span>
</span><span id="line-451"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-452"></span><span>      </span><span class="hs-comment">-- 'dep_orphs' and 'dep_finsts' do NOT include the imported module</span><span>
</span><span id="line-453"></span><span>      </span><span class="hs-comment">-- itself, but we DO need to include this module in 'imp_orphs' and</span><span>
</span><span id="line-454"></span><span>      </span><span class="hs-comment">-- 'imp_finsts' if it defines an orphan or instance family; thus the</span><span>
</span><span id="line-455"></span><span>      </span><span class="hs-comment">-- orph_iface/has_iface tests.</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span>      </span><span id="local-6989586621681363425"><span class="annot"><span class="annottext">orphans :: [Module]
</span><a href="#local-6989586621681363425"><span class="hs-identifier hs-var hs-var">orphans</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363437"><span class="hs-identifier hs-var">orph_iface</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">imp_sem_mod</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">elem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">dep_orphs</span><span> </span><span class="hs-identifier">deps</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">imp_sem_mod</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">dep_orphs</span><span> </span><span class="hs-identifier">deps</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>                             </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681363439"><span class="hs-identifier hs-var">imp_sem_mod</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Dependencies -&gt; [Module]
</span><a href="GHC.Unit.Module.Deps.html#dep_orphs"><span class="hs-identifier hs-var">dep_orphs</span></a></span><span> </span><span class="annot"><span class="annottext">Dependencies
</span><a href="#local-6989586621681363432"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-459"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dependencies -&gt; [Module]
</span><a href="GHC.Unit.Module.Deps.html#dep_orphs"><span class="hs-identifier hs-var">dep_orphs</span></a></span><span> </span><span class="annot"><span class="annottext">Dependencies
</span><a href="#local-6989586621681363432"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span>      </span><span id="local-6989586621681363420"><span class="annot"><span class="annottext">finsts :: [Module]
</span><a href="#local-6989586621681363420"><span class="hs-identifier hs-var hs-var">finsts</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363434"><span class="hs-identifier hs-var">has_finsts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">imp_sem_mod</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">elem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">dep_finsts</span><span> </span><span class="hs-identifier">deps</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">imp_sem_mod</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">dep_orphs</span><span> </span><span class="hs-identifier">deps</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>                            </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681363439"><span class="hs-identifier hs-var">imp_sem_mod</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Dependencies -&gt; [Module]
</span><a href="GHC.Unit.Module.Deps.html#dep_finsts"><span class="hs-identifier hs-var">dep_finsts</span></a></span><span> </span><span class="annot"><span class="annottext">Dependencies
</span><a href="#local-6989586621681363432"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-463"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dependencies -&gt; [Module]
</span><a href="GHC.Unit.Module.Deps.html#dep_finsts"><span class="hs-identifier hs-var">dep_finsts</span></a></span><span> </span><span class="annot"><span class="annottext">Dependencies
</span><a href="#local-6989586621681363432"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span>      </span><span id="local-6989586621681363418"><span class="annot"><span class="annottext">pkg :: Unit
</span><a href="#local-6989586621681363418"><span class="hs-identifier hs-var hs-var">pkg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall unit. GenModule unit -&gt; unit
</span><a href="GHC.Unit.Types.html#moduleUnit"><span class="hs-identifier hs-var">moduleUnit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (phase :: ModIfacePhase). ModIface_ phase -&gt; Module
</span><a href="GHC.Unit.Module.ModIface.html#mi_module"><span class="hs-identifier hs-var">mi_module</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363445"><span class="hs-identifier hs-var">iface</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>      </span><span id="local-6989586621681363417"><span class="annot"><span class="annottext">ipkg :: UnitId
</span><a href="#local-6989586621681363417"><span class="hs-identifier hs-var hs-var">ipkg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unit -&gt; UnitId
</span><a href="GHC.Unit.Types.html#toUnitId"><span class="hs-identifier hs-var">toUnitId</span></a></span><span> </span><span class="annot"><span class="annottext">Unit
</span><a href="#local-6989586621681363418"><span class="hs-identifier hs-var">pkg</span></a></span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span>      </span><span class="hs-comment">-- Does this import mean we now require our own pkg</span><span>
</span><span id="line-469"></span><span>      </span><span class="hs-comment">-- to be trusted? See Note [Trust Own Package]</span><span>
</span><span id="line-470"></span><span>      </span><span id="local-6989586621681363415"><span class="annot"><span class="annottext">ptrust :: Bool
</span><a href="#local-6989586621681363415"><span class="hs-identifier hs-var hs-var">ptrust</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SafeHaskellMode
</span><a href="#local-6989586621681363430"><span class="hs-identifier hs-var">trust</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">SafeHaskellMode
</span><a href="GHC.Types.SafeHaskell.html#Sf_Trustworthy"><span class="hs-identifier hs-var">Sf_Trustworthy</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363427"><span class="hs-identifier hs-var">trust_pkg</span></a></span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681363413"><span class="annot"><span class="annottext">[GenWithIsBoot ModuleName]
</span><a href="#local-6989586621681363413"><span class="hs-identifier hs-var">dependent_mods</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363412"><span class="annot"><span class="annottext">[(UnitId, Bool)]
</span><a href="#local-6989586621681363412"><span class="hs-identifier hs-var">dependent_pkgs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363411"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363411"><span class="hs-identifier hs-var">pkg_trust_req</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HomeUnit -&gt; Unit -&gt; Bool
</span><a href="GHC.Unit.Home.html#isHomeUnit"><span class="hs-identifier hs-var">isHomeUnit</span></a></span><span> </span><span class="annot"><span class="annottext">HomeUnit
</span><a href="#local-6989586621681363446"><span class="hs-identifier hs-var">home_unit</span></a></span><span> </span><span class="annot"><span class="annottext">Unit
</span><a href="#local-6989586621681363418"><span class="hs-identifier hs-var">pkg</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-474"></span><span>            </span><span class="hs-comment">-- Imported module is from the home package</span><span>
</span><span id="line-475"></span><span>            </span><span class="hs-comment">-- Take its dependent modules and add imp_mod itself</span><span>
</span><span id="line-476"></span><span>            </span><span class="hs-comment">-- Take its dependent packages unchanged</span><span>
</span><span id="line-477"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-478"></span><span>            </span><span class="hs-comment">-- NB: (dep_mods deps) might include a hi-boot file</span><span>
</span><span id="line-479"></span><span>            </span><span class="hs-comment">-- for the module being compiled, CM. Do *not* filter</span><span>
</span><span id="line-480"></span><span>            </span><span class="hs-comment">-- this out (as we used to), because when we've</span><span>
</span><span id="line-481"></span><span>            </span><span class="hs-comment">-- finished dealing with the direct imports we want to</span><span>
</span><span id="line-482"></span><span>            </span><span class="hs-comment">-- know if any of them depended on CM.hi-boot, in</span><span>
</span><span id="line-483"></span><span>            </span><span class="hs-comment">-- which case we should do the hi-boot consistency</span><span>
</span><span id="line-484"></span><span>            </span><span class="hs-comment">-- check.  See GHC.Iface.Load.loadHiBootInterface</span><span>
</span><span id="line-485"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html#GWIB"><span class="hs-identifier hs-type">GWIB</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">gwib_mod :: ModuleName
</span><a href="GHC.Unit.Types.html#gwib_mod"><span class="hs-identifier hs-var">gwib_mod</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall unit. GenModule unit -&gt; ModuleName
</span><a href="GHC.Unit.Types.html#moduleName"><span class="hs-identifier hs-var">moduleName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681363441"><span class="hs-identifier hs-var">imp_mod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">gwib_isBoot :: IsBootInterface
</span><a href="GHC.Unit.Types.html#gwib_isBoot"><span class="hs-identifier hs-var">gwib_isBoot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IsBootInterface
</span><a href="#local-6989586621681363443"><span class="hs-identifier hs-var">want_boot</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Dependencies -&gt; [GenWithIsBoot ModuleName]
</span><a href="GHC.Unit.Module.Deps.html#dep_mods"><span class="hs-identifier hs-var">dep_mods</span></a></span><span> </span><span class="annot"><span class="annottext">Dependencies
</span><a href="#local-6989586621681363432"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-486"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dependencies -&gt; [(UnitId, Bool)]
</span><a href="GHC.Unit.Module.Deps.html#dep_pkgs"><span class="hs-identifier hs-var">dep_pkgs</span></a></span><span> </span><span class="annot"><span class="annottext">Dependencies
</span><a href="#local-6989586621681363432"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-487"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363415"><span class="hs-identifier hs-var">ptrust</span></a></span><span>
</span><span id="line-488"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-491"></span><span>            </span><span class="hs-comment">-- Imported module is from another package</span><span>
</span><span id="line-492"></span><span>            </span><span class="hs-comment">-- Dump the dependent modules</span><span>
</span><span id="line-493"></span><span>            </span><span class="hs-comment">-- Add the package imp_mod comes from to the dependent packages</span><span>
</span><span id="line-494"></span><span>            </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ipkg</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">fst</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">dep_pkgs</span><span> </span><span class="hs-identifier">deps</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">ipkg</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">dep_pkgs</span><span> </span><span class="hs-identifier">deps</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621681363417"><span class="hs-identifier hs-var">ipkg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Dependencies -&gt; [(UnitId, Bool)]
</span><a href="GHC.Unit.Module.Deps.html#dep_pkgs"><span class="hs-identifier hs-var">dep_pkgs</span></a></span><span> </span><span class="annot"><span class="annottext">Dependencies
</span><a href="#local-6989586621681363432"><span class="hs-identifier hs-var">deps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#ImportAvails"><span class="hs-identifier hs-type">ImportAvails</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-499"></span><span>          </span><span class="annot"><span class="annottext">imp_mods :: ImportedMods
</span><a href="GHC.Tc.Types.html#imp_mods"><span class="hs-identifier hs-var">imp_mods</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Module -&gt; a -&gt; ModuleEnv a
</span><a href="GHC.Unit.Module.Env.html#unitModuleEnv"><span class="hs-identifier hs-var">unitModuleEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (phase :: ModIfacePhase). ModIface_ phase -&gt; Module
</span><a href="GHC.Unit.Module.ModIface.html#mi_module"><span class="hs-identifier hs-var">mi_module</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363445"><span class="hs-identifier hs-var">iface</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ImportedBy
</span><a href="#local-6989586621681363442"><span class="hs-identifier hs-var">imported_by</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-500"></span><span>          </span><span class="annot"><span class="annottext">imp_orphs :: [Module]
</span><a href="GHC.Tc.Types.html#imp_orphs"><span class="hs-identifier hs-var">imp_orphs</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Module]
</span><a href="#local-6989586621681363425"><span class="hs-identifier hs-var">orphans</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-501"></span><span>          </span><span class="annot"><span class="annottext">imp_finsts :: [Module]
</span><a href="GHC.Tc.Types.html#imp_finsts"><span class="hs-identifier hs-var">imp_finsts</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Module]
</span><a href="#local-6989586621681363420"><span class="hs-identifier hs-var">finsts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-502"></span><span>          </span><span class="annot"><span class="annottext">imp_dep_mods :: ModuleNameEnv (GenWithIsBoot ModuleName)
</span><a href="GHC.Tc.Types.html#imp_dep_mods"><span class="hs-identifier hs-var">imp_dep_mods</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GenWithIsBoot ModuleName]
-&gt; ModuleNameEnv (GenWithIsBoot ModuleName)
</span><a href="GHC.Tc.Types.html#mkModDeps"><span class="hs-identifier hs-var">mkModDeps</span></a></span><span> </span><span class="annot"><span class="annottext">[GenWithIsBoot ModuleName]
</span><a href="#local-6989586621681363413"><span class="hs-identifier hs-var">dependent_mods</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-503"></span><span>          </span><span class="annot"><span class="annottext">imp_dep_pkgs :: Set UnitId
</span><a href="GHC.Tc.Types.html#imp_dep_pkgs"><span class="hs-identifier hs-var">imp_dep_pkgs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../../containers-0.6.5.1/src/Data-Set-Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../../base-4.16.4.0/src/Data-Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(UnitId, Bool)]
</span><a href="#local-6989586621681363412"><span class="hs-identifier hs-var">dependent_pkgs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-504"></span><span>          </span><span class="hs-comment">-- Add in the imported modules trusted package</span><span>
</span><span id="line-505"></span><span>          </span><span class="hs-comment">-- requirements. ONLY do this though if we import the</span><span>
</span><span id="line-506"></span><span>          </span><span class="hs-comment">-- module as a safe import.</span><span>
</span><span id="line-507"></span><span>          </span><span class="hs-comment">-- See Note [Tracking Trust Transitively]</span><span>
</span><span id="line-508"></span><span>          </span><span class="hs-comment">-- and Note [Trust Transitive Property]</span><span>
</span><span id="line-509"></span><span>          </span><span class="annot"><span class="annottext">imp_trust_pkgs :: Set UnitId
</span><a href="GHC.Tc.Types.html#imp_trust_pkgs"><span class="hs-identifier hs-var">imp_trust_pkgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363444"><span class="hs-identifier hs-var">mod_safe'</span></a></span><span>
</span><span id="line-510"></span><span>                               </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../../containers-0.6.5.1/src/Data-Set-Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../../base-4.16.4.0/src/Data-Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../../base-4.16.4.0/src/Data-Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(UnitId, Bool)]
</span><a href="#local-6989586621681363412"><span class="hs-identifier hs-var">dependent_pkgs</span></a></span><span>
</span><span id="line-511"></span><span>                               </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><a href="../../containers-0.6.5.1/src/Data-Set-Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-512"></span><span>          </span><span class="hs-comment">-- Do we require our own pkg to be trusted?</span><span>
</span><span id="line-513"></span><span>          </span><span class="hs-comment">-- See Note [Trust Own Package]</span><span>
</span><span id="line-514"></span><span>          </span><span class="annot"><span class="annottext">imp_trust_own_pkg :: Bool
</span><a href="GHC.Tc.Types.html#imp_trust_own_pkg"><span class="hs-identifier hs-var">imp_trust_own_pkg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363411"><span class="hs-identifier hs-var">pkg_trust_req</span></a></span><span>
</span><span id="line-515"></span><span>     </span><span class="hs-special">}</span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span class="hs-comment">-- | Issue a warning if the user imports Data.List without either an import</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- list or `qualified`. This is part of the migration plan for the</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- `Data.List.singleton` proposal. See #17244.</span><span>
</span><span id="line-521"></span><span class="annot"><a href="GHC.Rename.Names.html#warnUnqualifiedImport"><span class="hs-identifier hs-type">warnUnqualifiedImport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#ImportDecl"><span class="hs-identifier hs-type">ImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModIface.html#ModIface"><span class="hs-identifier hs-type">ModIface</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span id="warnUnqualifiedImport"><span class="annot"><span class="annottext">warnUnqualifiedImport :: ImportDecl GhcPs -&gt; ModIface -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Names.html#warnUnqualifiedImport"><span class="hs-identifier hs-var hs-var">warnUnqualifiedImport</span></a></span></span><span> </span><span id="local-6989586621681363393"><span class="annot"><span class="annottext">ImportDecl GhcPs
</span><a href="#local-6989586621681363393"><span class="hs-identifier hs-var">decl</span></a></span></span><span> </span><span id="local-6989586621681363392"><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363392"><span class="hs-identifier hs-var">iface</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-523"></span><span>    </span><span class="annot"><span class="annottext">forall gbl lcl.
WarningFlag -&gt; TcRnIf gbl lcl () -&gt; TcRnIf gbl lcl ()
</span><a href="GHC.Tc.Utils.Monad.html#whenWOptM"><span class="hs-identifier hs-var">whenWOptM</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnCompatUnqualifiedImports"><span class="hs-identifier hs-var">Opt_WarnCompatUnqualifiedImports</span></a></span><span>
</span><span id="line-524"></span><span>    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363390"><span class="hs-identifier hs-var">bad_import</span></a></span><span>
</span><span id="line-525"></span><span>    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WarnReason -&gt; SrcSpan -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addWarnAt"><span class="hs-identifier hs-var">addWarnAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningFlag -&gt; WarnReason
</span><a href="GHC.Driver.Flags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnCompatUnqualifiedImports"><span class="hs-identifier hs-var">Opt_WarnCompatUnqualifiedImports</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681363388"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681363387"><span class="hs-identifier hs-var">warning</span></a></span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-527"></span><span>    </span><span id="local-6989586621681363386"><span class="annot"><span class="annottext">mod :: Module
</span><a href="#local-6989586621681363386"><span class="hs-identifier hs-var hs-var">mod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (phase :: ModIfacePhase). ModIface_ phase -&gt; Module
</span><a href="GHC.Unit.Module.ModIface.html#mi_module"><span class="hs-identifier hs-var">mi_module</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363392"><span class="hs-identifier hs-var">iface</span></a></span><span>
</span><span id="line-528"></span><span>    </span><span id="local-6989586621681363388"><span class="annot"><span class="annottext">loc :: SrcSpan
</span><a href="#local-6989586621681363388"><span class="hs-identifier hs-var hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a e. GenLocated (SrcSpanAnn' a) e -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#getLocA"><span class="hs-identifier hs-var">getLocA</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; XRec pass ModuleName
</span><a href="GHC.Hs.ImpExp.html#ideclName"><span class="hs-identifier hs-var">ideclName</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcPs
</span><a href="#local-6989586621681363393"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span>    </span><span id="local-6989586621681363384"><span class="annot"><span class="annottext">is_qual :: Bool
</span><a href="#local-6989586621681363384"><span class="hs-identifier hs-var hs-var">is_qual</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImportDeclQualifiedStyle -&gt; Bool
</span><a href="GHC.Hs.ImpExp.html#isImportDeclQualified"><span class="hs-identifier hs-var">isImportDeclQualified</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; ImportDeclQualifiedStyle
</span><a href="GHC.Hs.ImpExp.html#ideclQualified"><span class="hs-identifier hs-var">ideclQualified</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcPs
</span><a href="#local-6989586621681363393"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>    </span><span id="local-6989586621681363383"><span class="annot"><span class="annottext">has_import_list :: Bool
</span><a href="#local-6989586621681363383"><span class="hs-identifier hs-var hs-var">has_import_list</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-532"></span><span>      </span><span class="hs-comment">-- We treat a `hiding` clause as not having an import list although</span><span>
</span><span id="line-533"></span><span>      </span><span class="hs-comment">-- it's not entirely clear this is the right choice.</span><span>
</span><span id="line-534"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; Maybe (Bool, XRec pass [LIE pass])
</span><a href="GHC.Hs.ImpExp.html#ideclHiding"><span class="hs-identifier hs-var">ideclHiding</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcPs
</span><a href="#local-6989586621681363393"><span class="hs-identifier hs-var">decl</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-535"></span><span>        </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XRec GhcPs [LIE GhcPs]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-536"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Bool, XRec GhcPs [LIE GhcPs])
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-537"></span><span>    </span><span id="local-6989586621681363390"><span class="annot"><span class="annottext">bad_import :: Bool
</span><a href="#local-6989586621681363390"><span class="hs-identifier hs-var hs-var">bad_import</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-538"></span><span>      </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681363386"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Module -&gt; ModuleSet -&gt; Bool
</span><a href="GHC.Unit.Module.Env.html#elemModuleSet"><span class="hs-operator hs-var">`elemModuleSet`</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleSet
</span><a href="#local-6989586621681363381"><span class="hs-identifier hs-var">qualifiedMods</span></a></span><span>
</span><span id="line-539"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363384"><span class="hs-identifier hs-var">is_qual</span></a></span><span>
</span><span id="line-540"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363383"><span class="hs-identifier hs-var">has_import_list</span></a></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span>    </span><span id="local-6989586621681363387"><span class="annot"><span class="annottext">warning :: SDoc
</span><a href="#local-6989586621681363387"><span class="hs-identifier hs-var hs-var">warning</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-543"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;To ensure compatibility with future core libraries changes&quot;</span></span><span>
</span><span id="line-544"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;imports to&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; XRec pass ModuleName
</span><a href="GHC.Hs.ImpExp.html#ideclName"><span class="hs-identifier hs-var">ideclName</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcPs
</span><a href="#local-6989586621681363393"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;should be&quot;</span></span><span>
</span><span id="line-545"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;either qualified or have an explicit import list.&quot;</span></span><span>
</span><span id="line-546"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span>    </span><span class="hs-comment">-- Modules for which we warn if we see unqualified imports</span><span>
</span><span id="line-549"></span><span>    </span><span id="local-6989586621681363381"><span class="annot"><span class="annottext">qualifiedMods :: ModuleSet
</span><a href="#local-6989586621681363381"><span class="hs-identifier hs-var hs-var">qualifiedMods</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Module] -&gt; ModuleSet
</span><a href="GHC.Unit.Module.Env.html#mkModuleSet"><span class="hs-identifier hs-var">mkModuleSet</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="GHC.Builtin.Names.html#dATA_LIST"><span class="hs-identifier hs-var">dATA_LIST</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span class="annot"><a href="GHC.Rename.Names.html#warnRedundantSourceImport"><span class="hs-identifier hs-type">warnRedundantSourceImport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-553"></span><span id="warnRedundantSourceImport"><span class="annot"><span class="annottext">warnRedundantSourceImport :: ModuleName -&gt; SDoc
</span><a href="GHC.Rename.Names.html#warnRedundantSourceImport"><span class="hs-identifier hs-var hs-var">warnRedundantSourceImport</span></a></span></span><span> </span><span id="local-6989586621681363377"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681363377"><span class="hs-identifier hs-var">mod_name</span></a></span></span><span>
</span><span id="line-554"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unnecessary {-# SOURCE #-} in the import of module&quot;</span></span><span>
</span><span id="line-555"></span><span>          </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681363377"><span class="hs-identifier hs-var">mod_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{importsFromLocalDecls}
*                                                                      *
************************************************************************

From the top-level declarations of this module produce
        * the lexical environment
        * the ImportAvails
created by its bindings.

Note [Top-level Names in Template Haskell decl quotes]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
See also: Note [Interactively-bound Ids in GHCi] in GHC.Driver.Env
          Note [Looking up Exact RdrNames] in GHC.Rename.Env

Consider a Template Haskell declaration quotation like this:
      module M where
        f x = h [d| f = 3 |]
When renaming the declarations inside [d| ...|], we treat the
top level binders specially in two ways

1.  We give them an Internal Name, not (as usual) an External one.
    This is done by GHC.Rename.Env.newTopSrcBinder.

2.  We make them *shadow* the outer bindings.
    See Note [GlobalRdrEnv shadowing]

3. We find out whether we are inside a [d| ... |] by testing the TH
   stage. This is a slight hack, because the stage field was really
   meant for the type checker, and here we are not interested in the
   fields of Brack, hence the error thunks in thRnBrack.
-}</span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span class="annot"><a href="GHC.Rename.Names.html#extendGlobalRdrEnvRn"><span class="hs-identifier hs-type">extendGlobalRdrEnvRn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-593"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Fixity.html#MiniFixityEnv"><span class="hs-identifier hs-type">MiniFixityEnv</span></a></span><span>
</span><span id="line-594"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span class="hs-comment">-- Updates both the GlobalRdrEnv and the FixityEnv</span><span>
</span><span id="line-596"></span><span class="hs-comment">-- We return a new TcLclEnv only because we might have to</span><span>
</span><span id="line-597"></span><span class="hs-comment">-- delete some bindings from it;</span><span>
</span><span id="line-598"></span><span class="hs-comment">-- see Note [Top-level Names in Template Haskell decl quotes]</span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span id="extendGlobalRdrEnvRn"><span class="annot"><span class="annottext">extendGlobalRdrEnvRn :: [AvailInfo] -&gt; MiniFixityEnv -&gt; RnM (TcGblEnv, TcLclEnv)
</span><a href="GHC.Rename.Names.html#extendGlobalRdrEnvRn"><span class="hs-identifier hs-var hs-var">extendGlobalRdrEnvRn</span></a></span></span><span> </span><span id="local-6989586621681363375"><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363375"><span class="hs-identifier hs-var">avails</span></a></span></span><span> </span><span id="local-6989586621681363374"><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621681363374"><span class="hs-identifier hs-var">new_fixities</span></a></span></span><span>
</span><span id="line-601"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363373"><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681363373"><span class="hs-identifier hs-var">gbl_env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363372"><span class="annot"><span class="annottext">TcLclEnv
</span><a href="#local-6989586621681363372"><span class="hs-identifier hs-var">lcl_env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. TcRnIf gbl lcl (gbl, lcl)
</span><a href="GHC.Tc.Utils.Monad.html#getEnvs"><span class="hs-identifier hs-var">getEnvs</span></a></span><span>
</span><span id="line-602"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681363370"><span class="annot"><span class="annottext">ThStage
</span><a href="#local-6989586621681363370"><span class="hs-identifier hs-var">stage</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcM ThStage
</span><a href="GHC.Tc.Utils.Monad.html#getStage"><span class="hs-identifier hs-var">getStage</span></a></span><span>
</span><span id="line-603"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681363368"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363368"><span class="hs-identifier hs-var">isGHCi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRn Bool
</span><a href="GHC.Tc.Utils.Monad.html#getIsGHCi"><span class="hs-identifier hs-var">getIsGHCi</span></a></span><span>
</span><span id="line-604"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681363366"><span class="annot"><span class="annottext">rdr_env :: GlobalRdrEnv
</span><a href="#local-6989586621681363366"><span class="hs-identifier hs-var hs-var">rdr_env</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcGblEnv -&gt; GlobalRdrEnv
</span><a href="GHC.Tc.Types.html#tcg_rdr_env"><span class="hs-identifier hs-var">tcg_rdr_env</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681363373"><span class="hs-identifier hs-var">gbl_env</span></a></span><span>
</span><span id="line-605"></span><span>              </span><span id="local-6989586621681363364"><span class="annot"><span class="annottext">fix_env :: FixityEnv
</span><a href="#local-6989586621681363364"><span class="hs-identifier hs-var hs-var">fix_env</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcGblEnv -&gt; FixityEnv
</span><a href="GHC.Tc.Types.html#tcg_fix_env"><span class="hs-identifier hs-var">tcg_fix_env</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681363373"><span class="hs-identifier hs-var">gbl_env</span></a></span><span>
</span><span id="line-606"></span><span>              </span><span id="local-6989586621681363362"><span class="annot"><span class="annottext">th_bndrs :: ThBindEnv
</span><a href="#local-6989586621681363362"><span class="hs-identifier hs-var hs-var">th_bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLclEnv -&gt; ThBindEnv
</span><a href="GHC.Tc.Types.html#tcl_th_bndrs"><span class="hs-identifier hs-var">tcl_th_bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">TcLclEnv
</span><a href="#local-6989586621681363372"><span class="hs-identifier hs-var">lcl_env</span></a></span><span>
</span><span id="line-607"></span><span>              </span><span id="local-6989586621681363360"><span class="annot"><span class="annottext">th_lvl :: Int
</span><a href="#local-6989586621681363360"><span class="hs-identifier hs-var hs-var">th_lvl</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThStage -&gt; Int
</span><a href="GHC.Tc.Types.html#thLevel"><span class="hs-identifier hs-var">thLevel</span></a></span><span> </span><span class="annot"><span class="annottext">ThStage
</span><a href="#local-6989586621681363370"><span class="hs-identifier hs-var">stage</span></a></span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span>              </span><span class="hs-comment">-- Delete new_occs from global and local envs</span><span>
</span><span id="line-610"></span><span>              </span><span class="hs-comment">-- If we are in a TemplateHaskell decl bracket,</span><span>
</span><span id="line-611"></span><span>              </span><span class="hs-comment">--    we are going to shadow them</span><span>
</span><span id="line-612"></span><span>              </span><span class="hs-comment">-- See Note [GlobalRdrEnv shadowing]</span><span>
</span><span id="line-613"></span><span>              </span><span id="local-6989586621681363358"><span class="annot"><span class="annottext">inBracket :: Bool
</span><a href="#local-6989586621681363358"><span class="hs-identifier hs-var hs-var">inBracket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ThStage -&gt; Bool
</span><a href="GHC.Tc.Utils.Env.html#isBrackStage"><span class="hs-identifier hs-var">isBrackStage</span></a></span><span> </span><span class="annot"><span class="annottext">ThStage
</span><a href="#local-6989586621681363370"><span class="hs-identifier hs-var">stage</span></a></span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span>              </span><span id="local-6989586621681363356"><span class="annot"><span class="annottext">lcl_env_TH :: TcLclEnv
</span><a href="#local-6989586621681363356"><span class="hs-identifier hs-var hs-var">lcl_env_TH</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLclEnv
</span><a href="#local-6989586621681363372"><span class="hs-identifier hs-var">lcl_env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcl_rdr :: LocalRdrEnv
</span><a href="GHC.Tc.Types.html#tcl_rdr"><span class="hs-identifier hs-var">tcl_rdr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalRdrEnv -&gt; [OccName] -&gt; LocalRdrEnv
</span><a href="GHC.Types.Name.Reader.html#delLocalRdrEnvList"><span class="hs-identifier hs-var">delLocalRdrEnvList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcLclEnv -&gt; LocalRdrEnv
</span><a href="GHC.Tc.Types.html#tcl_rdr"><span class="hs-identifier hs-var">tcl_rdr</span></a></span><span> </span><span class="annot"><span class="annottext">TcLclEnv
</span><a href="#local-6989586621681363372"><span class="hs-identifier hs-var">lcl_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[OccName]
</span><a href="#local-6989586621681363353"><span class="hs-identifier hs-var">new_occs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-616"></span><span>                           </span><span class="hs-comment">-- See Note [GlobalRdrEnv shadowing]</span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span>              </span><span id="local-6989586621681363352"><span class="annot"><span class="annottext">lcl_env2 :: TcLclEnv
</span><a href="#local-6989586621681363352"><span class="hs-identifier hs-var hs-var">lcl_env2</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363358"><span class="hs-identifier hs-var">inBracket</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLclEnv
</span><a href="#local-6989586621681363356"><span class="hs-identifier hs-var">lcl_env_TH</span></a></span><span>
</span><span id="line-619"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLclEnv
</span><a href="#local-6989586621681363372"><span class="hs-identifier hs-var">lcl_env</span></a></span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span>              </span><span class="hs-comment">-- Deal with shadowing: see Note [GlobalRdrEnv shadowing]</span><span>
</span><span id="line-622"></span><span>              </span><span id="local-6989586621681363351"><span class="annot"><span class="annottext">want_shadowing :: Bool
</span><a href="#local-6989586621681363351"><span class="hs-identifier hs-var hs-var">want_shadowing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363368"><span class="hs-identifier hs-var">isGHCi</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363358"><span class="hs-identifier hs-var">inBracket</span></a></span><span>
</span><span id="line-623"></span><span>              </span><span id="local-6989586621681363350"><span class="annot"><span class="annottext">rdr_env1 :: GlobalRdrEnv
</span><a href="#local-6989586621681363350"><span class="hs-identifier hs-var hs-var">rdr_env1</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363351"><span class="hs-identifier hs-var">want_shadowing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; [GreName] -&gt; GlobalRdrEnv
</span><a href="GHC.Types.Name.Reader.html#shadowNames"><span class="hs-identifier hs-var">shadowNames</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363366"><span class="hs-identifier hs-var">rdr_env</span></a></span><span> </span><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681363348"><span class="hs-identifier hs-var">new_names</span></a></span><span>
</span><span id="line-624"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363366"><span class="hs-identifier hs-var">rdr_env</span></a></span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span>              </span><span id="local-6989586621681363347"><span class="annot"><span class="annottext">lcl_env3 :: TcLclEnv
</span><a href="#local-6989586621681363347"><span class="hs-identifier hs-var hs-var">lcl_env3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcLclEnv
</span><a href="#local-6989586621681363352"><span class="hs-identifier hs-var">lcl_env2</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcl_th_bndrs :: ThBindEnv
</span><a href="GHC.Tc.Types.html#tcl_th_bndrs"><span class="hs-identifier hs-var">tcl_th_bndrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NameEnv a -&gt; [(Name, a)] -&gt; NameEnv a
</span><a href="GHC.Types.Name.Env.html#extendNameEnvList"><span class="hs-identifier hs-var">extendNameEnvList</span></a></span><span> </span><span class="annot"><span class="annottext">ThBindEnv
</span><a href="#local-6989586621681363362"><span class="hs-identifier hs-var">th_bndrs</span></a></span><span>
</span><span id="line-627"></span><span>                                                       </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">GreName -&gt; Name
</span><a href="GHC.Types.Avail.html#greNameMangledName"><span class="hs-identifier hs-var">greNameMangledName</span></a></span><span> </span><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681363344"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-628"></span><span>                                                         </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TopLevelFlag
</span><a href="GHC.Types.Basic.html#TopLevel"><span class="hs-identifier hs-var">TopLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681363360"><span class="hs-identifier hs-var">th_lvl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>                                                       </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681363344"><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681363344"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681363348"><span class="hs-identifier hs-var">new_names</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-630"></span><span>
</span><span id="line-631"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681363342"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363342"><span class="hs-identifier hs-var">rdr_env2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#foldlM"><span class="hs-identifier hs-var">foldlM</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
-&gt; GlobalRdrElt -&gt; IOEnv (Env TcGblEnv TcLclEnv) GlobalRdrEnv
</span><a href="#local-6989586621681363340"><span class="hs-identifier hs-var">add_gre</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363350"><span class="hs-identifier hs-var">rdr_env1</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681363339"><span class="hs-identifier hs-var">new_gres</span></a></span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681363338"><span class="annot"><span class="annottext">fix_env' :: FixityEnv
</span><a href="#local-6989586621681363338"><span class="hs-identifier hs-var hs-var">fix_env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">FixityEnv -&gt; GlobalRdrElt -&gt; FixityEnv
</span><a href="#local-6989586621681363336"><span class="hs-identifier hs-var">extend_fix_env</span></a></span><span> </span><span class="annot"><span class="annottext">FixityEnv
</span><a href="#local-6989586621681363364"><span class="hs-identifier hs-var">fix_env</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681363339"><span class="hs-identifier hs-var">new_gres</span></a></span><span>
</span><span id="line-634"></span><span>              </span><span id="local-6989586621681363335"><span class="annot"><span class="annottext">gbl_env' :: TcGblEnv
</span><a href="#local-6989586621681363335"><span class="hs-identifier hs-var hs-var">gbl_env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681363373"><span class="hs-identifier hs-var">gbl_env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcg_rdr_env :: GlobalRdrEnv
</span><a href="GHC.Tc.Types.html#tcg_rdr_env"><span class="hs-identifier hs-var">tcg_rdr_env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363342"><span class="hs-identifier hs-var">rdr_env2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tcg_fix_env :: FixityEnv
</span><a href="GHC.Tc.Types.html#tcg_fix_env"><span class="hs-identifier hs-var">tcg_fix_env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FixityEnv
</span><a href="#local-6989586621681363338"><span class="hs-identifier hs-var">fix_env'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;extendGlobalRdrEnvRn 2&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; GlobalRdrEnv -&gt; SDoc
</span><a href="GHC.Types.Name.Reader.html#pprGlobalRdrEnv"><span class="hs-identifier hs-var">pprGlobalRdrEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363342"><span class="hs-identifier hs-var">rdr_env2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681363335"><span class="hs-identifier hs-var">gbl_env'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcLclEnv
</span><a href="#local-6989586621681363347"><span class="hs-identifier hs-var">lcl_env3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-638"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-639"></span><span>    </span><span id="local-6989586621681363348"><span class="annot"><span class="annottext">new_names :: [GreName]
</span><a href="#local-6989586621681363348"><span class="hs-identifier hs-var hs-var">new_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo -&gt; [GreName]
</span><a href="GHC.Types.Avail.html#availGreNames"><span class="hs-identifier hs-var">availGreNames</span></a></span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363375"><span class="hs-identifier hs-var">avails</span></a></span><span>
</span><span id="line-640"></span><span>    </span><span id="local-6989586621681363353"><span class="annot"><span class="annottext">new_occs :: [OccName]
</span><a href="#local-6989586621681363353"><span class="hs-identifier hs-var hs-var">new_occs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. HasOccName name =&gt; name -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#occName"><span class="hs-identifier hs-var">occName</span></a></span><span> </span><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681363348"><span class="hs-identifier hs-var">new_names</span></a></span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span><span>    </span><span class="hs-comment">-- If there is a fixity decl for the gre, add it to the fixity env</span><span>
</span><span id="line-643"></span><span>    </span><span id="local-6989586621681363336"><span class="annot"><span class="annottext">extend_fix_env :: FixityEnv -&gt; GlobalRdrElt -&gt; FixityEnv
</span><a href="#local-6989586621681363336"><span class="hs-identifier hs-var hs-var">extend_fix_env</span></a></span></span><span> </span><span id="local-6989586621681363329"><span class="annot"><span class="annottext">FixityEnv
</span><a href="#local-6989586621681363329"><span class="hs-identifier hs-var">fix_env</span></a></span></span><span> </span><span id="local-6989586621681363328"><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363328"><span class="hs-identifier hs-var">gre</span></a></span></span><span>
</span><span id="line-644"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681363327"><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621681363327"><span class="hs-identifier hs-var">fi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. FastStringEnv a -&gt; FastString -&gt; Maybe a
</span><a href="GHC.Data.FastString.Env.html#lookupFsEnv"><span class="hs-identifier hs-var">lookupFsEnv</span></a></span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621681363374"><span class="hs-identifier hs-var">new_fixities</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OccName -&gt; FastString
</span><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681363324"><span class="hs-identifier hs-var">occ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NameEnv a -&gt; Name -&gt; a -&gt; NameEnv a
</span><a href="GHC.Types.Name.Env.html#extendNameEnv"><span class="hs-identifier hs-var">extendNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">FixityEnv
</span><a href="#local-6989586621681363329"><span class="hs-identifier hs-var">fix_env</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363322"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OccName -&gt; Fixity -&gt; FixItem
</span><a href="GHC.Types.Fixity.Env.html#FixItem"><span class="hs-identifier hs-var">FixItem</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681363324"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621681363327"><span class="hs-identifier hs-var">fi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-647"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FixityEnv
</span><a href="#local-6989586621681363329"><span class="hs-identifier hs-var">fix_env</span></a></span><span>
</span><span id="line-648"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-649"></span><span>        </span><span id="local-6989586621681363322"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621681363322"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greMangledName"><span class="hs-identifier hs-var">greMangledName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363328"><span class="hs-identifier hs-var">gre</span></a></span><span>
</span><span id="line-650"></span><span>        </span><span id="local-6989586621681363324"><span class="annot"><span class="annottext">occ :: OccName
</span><a href="#local-6989586621681363324"><span class="hs-identifier hs-var hs-var">occ</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#greOccName"><span class="hs-identifier hs-var">greOccName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363328"><span class="hs-identifier hs-var">gre</span></a></span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span>    </span><span class="annot"><a href="#local-6989586621681363339"><span class="hs-identifier hs-type">new_gres</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- New LocalDef GREs, derived from avails</span><span>
</span><span id="line-653"></span><span>    </span><span id="local-6989586621681363339"><span class="annot"><span class="annottext">new_gres :: [GlobalRdrElt]
</span><a href="#local-6989586621681363339"><span class="hs-identifier hs-var hs-var">new_gres</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo -&gt; [GlobalRdrElt]
</span><a href="GHC.Types.Name.Reader.html#localGREsFromAvail"><span class="hs-identifier hs-var">localGREsFromAvail</span></a></span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363375"><span class="hs-identifier hs-var">avails</span></a></span><span>
</span><span id="line-654"></span><span>
</span><span id="line-655"></span><span>    </span><span class="annot"><a href="#local-6989586621681363340"><span class="hs-identifier hs-type">add_gre</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrEnv"><span class="hs-identifier hs-type">GlobalRdrEnv</span></a></span><span>
</span><span id="line-656"></span><span>    </span><span class="hs-comment">-- Extend the GlobalRdrEnv with a LocalDef GRE</span><span>
</span><span id="line-657"></span><span>    </span><span class="hs-comment">-- If there is already a LocalDef GRE with the same OccName,</span><span>
</span><span id="line-658"></span><span>    </span><span class="hs-comment">--    report an error and discard the new GRE</span><span>
</span><span id="line-659"></span><span>    </span><span class="hs-comment">-- This establishes INVARIANT 1 of GlobalRdrEnvs</span><span>
</span><span id="line-660"></span><span>    </span><span id="local-6989586621681363340"><span class="annot"><span class="annottext">add_gre :: GlobalRdrEnv
-&gt; GlobalRdrElt -&gt; IOEnv (Env TcGblEnv TcLclEnv) GlobalRdrEnv
</span><a href="#local-6989586621681363340"><span class="hs-identifier hs-var hs-var">add_gre</span></a></span></span><span> </span><span id="local-6989586621681363317"><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363317"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621681363316"><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363316"><span class="hs-identifier hs-var">gre</span></a></span></span><span>
</span><span id="line-661"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681363314"><span class="hs-identifier hs-var">dups</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Same OccName defined twice</span><span>
</span><span id="line-662"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt] -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Names.html#addDupDeclErr"><span class="hs-identifier hs-var">addDupDeclErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363316"><span class="hs-identifier hs-var">gre</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681363314"><span class="hs-identifier hs-var">dups</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363317"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-663"></span><span>
</span><span id="line-664"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-665"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; GlobalRdrElt -&gt; GlobalRdrEnv
</span><a href="GHC.Types.Name.Reader.html#extendGlobalRdrEnv"><span class="hs-identifier hs-var">extendGlobalRdrEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363317"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363316"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-666"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-667"></span><span>        </span><span class="hs-comment">-- See Note [Reporting duplicate local declarations]</span><span>
</span><span id="line-668"></span><span>        </span><span id="local-6989586621681363314"><span class="annot"><span class="annottext">dups :: [GlobalRdrElt]
</span><a href="#local-6989586621681363314"><span class="hs-identifier hs-var hs-var">dups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Bool
</span><a href="#local-6989586621681363311"><span class="hs-identifier hs-var">isDupGRE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; OccName -&gt; [GlobalRdrElt]
</span><a href="GHC.Types.Name.Reader.html#lookupGlobalRdrEnv"><span class="hs-identifier hs-var">lookupGlobalRdrEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681363317"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#greOccName"><span class="hs-identifier hs-var">greOccName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363316"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-669"></span><span>        </span><span id="local-6989586621681363311"><span class="annot"><span class="annottext">isDupGRE :: GlobalRdrElt -&gt; Bool
</span><a href="#local-6989586621681363311"><span class="hs-identifier hs-var hs-var">isDupGRE</span></a></span></span><span> </span><span id="local-6989586621681363309"><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363309"><span class="hs-identifier hs-var">gre'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isLocalGRE"><span class="hs-identifier hs-var">isLocalGRE</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363309"><span class="hs-identifier hs-var">gre'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Bool
</span><a href="#local-6989586621681363307"><span class="hs-identifier hs-var">isAllowedDup</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363309"><span class="hs-identifier hs-var">gre'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>        </span><span id="local-6989586621681363307"><span class="annot"><span class="annottext">isAllowedDup :: GlobalRdrElt -&gt; Bool
</span><a href="#local-6989586621681363307"><span class="hs-identifier hs-var hs-var">isAllowedDup</span></a></span></span><span> </span><span id="local-6989586621681363306"><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363306"><span class="hs-identifier hs-var">gre'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-671"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isRecFldGRE"><span class="hs-identifier hs-var">isRecFldGRE</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363316"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isRecFldGRE"><span class="hs-identifier hs-var">isRecFldGRE</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363306"><span class="hs-identifier hs-var">gre'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-672"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; GreName
</span><a href="GHC.Types.Name.Reader.html#gre_name"><span class="hs-identifier hs-var">gre_name</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363316"><span class="hs-identifier hs-var">gre</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; GreName
</span><a href="GHC.Types.Name.Reader.html#gre_name"><span class="hs-identifier hs-var">gre_name</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363306"><span class="hs-identifier hs-var">gre'</span></a></span><span>
</span><span id="line-673"></span><span>                                  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isDuplicateRecFldGRE"><span class="hs-identifier hs-var">isDuplicateRecFldGRE</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363306"><span class="hs-identifier hs-var">gre'</span></a></span><span>
</span><span id="line-674"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isNoFieldSelectorGRE"><span class="hs-identifier hs-var">isNoFieldSelectorGRE</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363316"><span class="hs-identifier hs-var">gre</span></a></span><span>
</span><span id="line-675"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isNoFieldSelectorGRE"><span class="hs-identifier hs-var">isNoFieldSelectorGRE</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681363306"><span class="hs-identifier hs-var">gre'</span></a></span><span>
</span><span id="line-676"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span class="hs-comment">{-
Note [Reporting duplicate local declarations]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In general, a single module may not define the same OccName multiple times. This
is checked in extendGlobalRdrEnvRn: when adding a new locally-defined GRE to the
GlobalRdrEnv we report an error if there are already duplicates in the
environment.  This establishes INVARIANT 1 (see comments on GlobalRdrEnv in
GHC.Types.Name.Reader), which says that for a given OccName, all the
GlobalRdrElts to which it maps must have distinct 'gre_name's.

For example, the following will be rejected:

  f x = x
  g x = x
  f x = x  -- Duplicate!

Two GREs with the same OccName are OK iff:
-------------------------------------------------------------------
  Existing GRE     |          Newly-defined GRE
                   |  NormalGre            FieldGre
-------------------------------------------------------------------
  Imported         |  Always               Always
                   |
  Local NormalGre  |  Never                NoFieldSelectors
                   |
  Local FieldGre   |  NoFieldSelectors     DuplicateRecordFields
                   |                       and not in same record
-------------------------------------------------------------------            -
In this table &quot;NoFieldSelectors&quot; means &quot;NoFieldSelectors was enabled at the
definition site of the fields; ditto &quot;DuplicateRecordFields&quot;.  These facts are
recorded in the 'FieldLabel' (but where both GREs are local, both will
necessarily have the same extensions enabled).

More precisely:

* The programmer is allowed to make a new local definition that clashes with an
  imported one (although attempting to refer to either may lead to ambiguity
  errors at use sites).  For example, the following definition is allowed:

    import M (f)
    f x = x

  Thus isDupGRE reports errors only if the existing GRE is a LocalDef.

* When DuplicateRecordFields is enabled, the same field label may be defined in
  multiple records. For example, this is allowed:

    {-# LANGUAGE DuplicateRecordFields #-}
    data S1 = MkS1 { f :: Int }
    data S2 = MkS2 { f :: Int }

  Even though both fields have the same OccName, this does not violate INVARIANT
  1 of the GlobalRdrEnv, because the fields have distinct selector names, which
  form part of the gre_name (see Note [GreNames] in GHC.Types.Name.Reader).

* However, we must be careful to reject the following (#9156):

    {-# LANGUAGE DuplicateRecordFields #-}
    data T = MkT { f :: Int, f :: Int }  -- Duplicate!

  In this case, both 'gre_name's are the same (because the fields belong to the
  same type), and adding them both to the environment would be a violation of
  INVARIANT 1. Thus isAllowedDup checks both GREs have distinct 'gre_name's
  if they are both record fields.

* With DuplicateRecordFields, we reject attempts to define a field and a
  non-field with the same OccName (#17965):

    {-# LANGUAGE DuplicateRecordFields #-}
    f x = x
    data T = MkT { f :: Int}

  In principle this could be supported, but the current &quot;specification&quot; of
  DuplicateRecordFields does not allow it. Thus isAllowedDup checks for
  DuplicateRecordFields only if *both* GREs being compared are record fields.

* However, with NoFieldSelectors, it is possible by design to define a field and
  a non-field with the same OccName:

    {-# LANGUAGE NoFieldSelectors #-}
    f x = x
    data T = MkT { f :: Int}

  Thus isAllowedDup checks for NoFieldSelectors if either the existing or the
  new GRE are record fields.  See Note [NoFieldSelectors] in GHC.Rename.Env.

See also Note [Skipping ambiguity errors at use sites of local declarations] in
GHC.Rename.Utils.
-}</span><span>
</span><span id="line-767"></span><span>
</span><span id="line-768"></span><span>
</span><span id="line-769"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
    getLocalDeclBindersd@ returns the names for an HsDecl
             It's used for source code.

        *** See Note [The Naming story] in GHC.Hs.Decls ****
*                                                                      *
********************************************************************* -}</span><span>
</span><span id="line-777"></span><span>
</span><span id="line-778"></span><span class="annot"><a href="GHC.Rename.Names.html#getLocalNonValBinders"><span class="hs-identifier hs-type">getLocalNonValBinders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Rename.Fixity.html#MiniFixityEnv"><span class="hs-identifier hs-type">MiniFixityEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-779"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-780"></span><span class="hs-comment">-- Get all the top-level binders bound the group *except*</span><span>
</span><span id="line-781"></span><span class="hs-comment">-- for value bindings, which are treated separately</span><span>
</span><span id="line-782"></span><span class="hs-comment">-- Specifically we return AvailInfo for</span><span>
</span><span id="line-783"></span><span class="hs-comment">--      * type decls (incl constructors and record selectors)</span><span>
</span><span id="line-784"></span><span class="hs-comment">--      * class decls (including class ops)</span><span>
</span><span id="line-785"></span><span class="hs-comment">--      * associated types</span><span>
</span><span id="line-786"></span><span class="hs-comment">--      * foreign imports</span><span>
</span><span id="line-787"></span><span class="hs-comment">--      * value signatures (in hs-boot files only)</span><span>
</span><span id="line-788"></span><span>
</span><span id="line-789"></span><span id="getLocalNonValBinders"><span class="annot"><span class="annottext">getLocalNonValBinders :: MiniFixityEnv -&gt; HsGroup GhcPs -&gt; RnM ((TcGblEnv, TcLclEnv), Defs)
</span><a href="GHC.Rename.Names.html#getLocalNonValBinders"><span class="hs-identifier hs-var hs-var">getLocalNonValBinders</span></a></span></span><span> </span><span id="local-6989586621681363299"><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621681363299"><span class="hs-identifier hs-var">fixity_env</span></a></span></span><span>
</span><span id="line-790"></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsGroup"><span class="hs-identifier hs-type">HsGroup</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hs_valds :: forall p. HsGroup p -&gt; HsValBinds p
</span><a href="Language.Haskell.Syntax.Decls.html#hs_valds"><span class="hs-identifier hs-var">hs_valds</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681363296"><span class="annot"><span class="annottext">HsValBinds GhcPs
</span><a href="#local-6989586621681363296"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-791"></span><span>                </span><span class="annot"><span class="annottext">hs_tyclds :: forall p. HsGroup p -&gt; [TyClGroup p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_tyclds"><span class="hs-identifier hs-var">hs_tyclds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681363294"><span class="annot"><span class="annottext">[TyClGroup GhcPs]
</span><a href="#local-6989586621681363294"><span class="hs-identifier hs-var">tycl_decls</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-792"></span><span>                </span><span class="annot"><span class="annottext">hs_fords :: forall p. HsGroup p -&gt; [LForeignDecl p]
</span><a href="Language.Haskell.Syntax.Decls.html#hs_fords"><span class="hs-identifier hs-var">hs_fords</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681363292"><span class="annot"><span class="annottext">[LForeignDecl GhcPs]
</span><a href="#local-6989586621681363292"><span class="hs-identifier hs-var">foreign_decls</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-793"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Process all type/class decls *except* family instances</span><span>
</span><span id="line-794"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681363291"><span class="annot"><span class="annottext">inst_decls :: [GenLocated SrcSpanAnnA (InstDecl GhcPs)]
</span><a href="#local-6989586621681363291"><span class="hs-identifier hs-var hs-var">inst_decls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyClGroup GhcPs]
</span><a href="#local-6989586621681363294"><span class="hs-identifier hs-var">tycl_decls</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall pass. TyClGroup pass -&gt; [LInstDecl pass]
</span><a href="Language.Haskell.Syntax.Decls.html#group_instds"><span class="hs-identifier hs-var">group_instds</span></a></span><span>
</span><span id="line-795"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681363289"><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621681363289"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; DuplicateRecordFields
</span><a href="GHC.Driver.Session.html#xopt_DuplicateRecordFields"><span class="hs-identifier hs-var">xopt_DuplicateRecordFields</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.4.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.Session.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-796"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681363287"><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621681363287"><span class="hs-identifier hs-var">has_sel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; FieldSelectors
</span><a href="GHC.Driver.Session.html#xopt_FieldSelectors"><span class="hs-identifier hs-var">xopt_FieldSelectors</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.4.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.Session.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-797"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363285"><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363285"><span class="hs-identifier hs-var">tc_avails</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363284"><span class="annot"><span class="annottext">[[(Name, [FieldLabel])]]
</span><a href="#local-6989586621681363284"><span class="hs-identifier hs-var">tc_fldss</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-798"></span><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="../../base-4.16.4.0/src/GHC-List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base-4.16.4.0/src/Data-Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DuplicateRecordFields
-&gt; FieldSelectors
-&gt; LTyClDecl GhcPs
-&gt; RnM (AvailInfo, [(Name, [FieldLabel])])
</span><a href="#local-6989586621681363281"><span class="hs-identifier hs-var">new_tc</span></a></span><span> </span><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621681363289"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span><span> </span><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621681363287"><span class="hs-identifier hs-var">has_sel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-799"></span><span>                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass. [TyClGroup pass] -&gt; [LTyClDecl pass]
</span><a href="Language.Haskell.Syntax.Decls.html#tyClGroupTyClDecls"><span class="hs-identifier hs-var">tyClGroupTyClDecls</span></a></span><span> </span><span class="annot"><span class="annottext">[TyClGroup GhcPs]
</span><a href="#local-6989586621681363294"><span class="hs-identifier hs-var">tycl_decls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-800"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getLocalNonValBinders 1&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363285"><span class="hs-identifier hs-var">tc_avails</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-801"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681363279"><span class="annot"><span class="annottext">(TcGblEnv, TcLclEnv)
</span><a href="#local-6989586621681363279"><span class="hs-identifier hs-var">envs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[AvailInfo] -&gt; MiniFixityEnv -&gt; RnM (TcGblEnv, TcLclEnv)
</span><a href="GHC.Rename.Names.html#extendGlobalRdrEnvRn"><span class="hs-identifier hs-var">extendGlobalRdrEnvRn</span></a></span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363285"><span class="hs-identifier hs-var">tc_avails</span></a></span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621681363299"><span class="hs-identifier hs-var">fixity_env</span></a></span><span>
</span><span id="line-802"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall gbl' lcl' a gbl lcl.
(gbl', lcl') -&gt; TcRnIf gbl' lcl' a -&gt; TcRnIf gbl lcl a
</span><a href="GHC.Tc.Utils.Monad.html#setEnvs"><span class="hs-identifier hs-var">setEnvs</span></a></span><span> </span><span class="annot"><span class="annottext">(TcGblEnv, TcLclEnv)
</span><a href="#local-6989586621681363279"><span class="hs-identifier hs-var">envs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-803"></span><span>            </span><span class="hs-comment">-- Bring these things into scope first</span><span>
</span><span id="line-804"></span><span>            </span><span class="hs-comment">-- See Note [Looking up family names in family instances]</span><span>
</span><span id="line-805"></span><span>
</span><span id="line-806"></span><span>          </span><span class="hs-comment">-- Process all family instances</span><span>
</span><span id="line-807"></span><span>          </span><span class="hs-comment">-- to bring new data constructors into scope</span><span>
</span><span id="line-808"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363277"><span class="annot"><span class="annottext">[[AvailInfo]]
</span><a href="#local-6989586621681363277"><span class="hs-identifier hs-var">nti_availss</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363276"><span class="annot"><span class="annottext">[[(Name, [FieldLabel])]]
</span><a href="#local-6989586621681363276"><span class="hs-identifier hs-var">nti_fldss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; m (b, c)) -&gt; [a] -&gt; m ([b], [c])
</span><a href="../../base-4.16.4.0/src/Control-Monad.html#mapAndUnzipM"><span class="hs-identifier hs-var">mapAndUnzipM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DuplicateRecordFields
-&gt; FieldSelectors
-&gt; LInstDecl GhcPs
-&gt; RnM ([AvailInfo], [(Name, [FieldLabel])])
</span><a href="#local-6989586621681363274"><span class="hs-identifier hs-var">new_assoc</span></a></span><span> </span><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621681363289"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span><span> </span><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621681363287"><span class="hs-identifier hs-var">has_sel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-809"></span><span>                                                   </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (InstDecl GhcPs)]
</span><a href="#local-6989586621681363291"><span class="hs-identifier hs-var">inst_decls</span></a></span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span>          </span><span class="hs-comment">-- Finish off with value binders:</span><span>
</span><span id="line-812"></span><span>          </span><span class="hs-comment">--    foreign decls and pattern synonyms for an ordinary module</span><span>
</span><span id="line-813"></span><span>          </span><span class="hs-comment">--    type sigs in case of a hs-boot file only</span><span>
</span><span id="line-814"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681363273"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363273"><span class="hs-identifier hs-var">is_boot</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcRn Bool
</span><a href="GHC.Tc.Utils.Monad.html#tcIsHsBootOrSig"><span class="hs-identifier hs-var">tcIsHsBootOrSig</span></a></span><span>
</span><span id="line-815"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681363271"><span class="annot"><span class="annottext">val_bndrs :: [GenLocated SrcSpanAnnN RdrName]
</span><a href="#local-6989586621681363271"><span class="hs-identifier hs-var hs-var">val_bndrs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363273"><span class="hs-identifier hs-var">is_boot</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnN RdrName]
</span><a href="#local-6989586621681363270"><span class="hs-identifier hs-var">hs_boot_sig_bndrs</span></a></span><span>
</span><span id="line-816"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnN RdrName]
</span><a href="#local-6989586621681363269"><span class="hs-identifier hs-var">for_hs_bndrs</span></a></span><span>
</span><span id="line-817"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681363268"><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363268"><span class="hs-identifier hs-var">val_avails</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base-4.16.4.0/src/Data-Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; RnM AvailInfo
</span><a href="#local-6989586621681363267"><span class="hs-identifier hs-var">new_simple</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnN RdrName]
</span><a href="#local-6989586621681363271"><span class="hs-identifier hs-var">val_bndrs</span></a></span><span>
</span><span id="line-818"></span><span>
</span><span id="line-819"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681363266"><span class="annot"><span class="annottext">avails :: [AvailInfo]
</span><a href="#local-6989586621681363266"><span class="hs-identifier hs-var hs-var">avails</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[AvailInfo]]
</span><a href="#local-6989586621681363277"><span class="hs-identifier hs-var">nti_availss</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363268"><span class="hs-identifier hs-var">val_avails</span></a></span><span>
</span><span id="line-820"></span><span>              </span><span id="local-6989586621681363264"><span class="annot"><span class="annottext">new_bndrs :: Defs
</span><a href="#local-6989586621681363264"><span class="hs-identifier hs-var hs-var">new_bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[AvailInfo] -&gt; Defs
</span><a href="GHC.Types.Avail.html#availsToNameSetWithSelectors"><span class="hs-identifier hs-var">availsToNameSetWithSelectors</span></a></span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363266"><span class="hs-identifier hs-var">avails</span></a></span><span> </span><span class="annot"><span class="annottext">Defs -&gt; Defs -&gt; Defs
</span><a href="GHC.Types.Name.Set.html#unionNameSet"><span class="hs-operator hs-var">`unionNameSet`</span></a></span><span>
</span><span id="line-821"></span><span>                          </span><span class="annot"><span class="annottext">[AvailInfo] -&gt; Defs
</span><a href="GHC.Types.Avail.html#availsToNameSetWithSelectors"><span class="hs-identifier hs-var">availsToNameSetWithSelectors</span></a></span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363285"><span class="hs-identifier hs-var">tc_avails</span></a></span><span>
</span><span id="line-822"></span><span>              </span><span id="local-6989586621681363261"><span class="annot"><span class="annottext">flds :: [(Name, [FieldLabel])]
</span><a href="#local-6989586621681363261"><span class="hs-identifier hs-var hs-var">flds</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Name, [FieldLabel])]]
</span><a href="#local-6989586621681363276"><span class="hs-identifier hs-var">nti_fldss</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Name, [FieldLabel])]]
</span><a href="#local-6989586621681363284"><span class="hs-identifier hs-var">tc_fldss</span></a></span><span>
</span><span id="line-823"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getLocalNonValBinders 2&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363266"><span class="hs-identifier hs-var">avails</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-824"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363260"><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681363260"><span class="hs-identifier hs-var">tcg_env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363259"><span class="annot"><span class="annottext">TcLclEnv
</span><a href="#local-6989586621681363259"><span class="hs-identifier hs-var">tcl_env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[AvailInfo] -&gt; MiniFixityEnv -&gt; RnM (TcGblEnv, TcLclEnv)
</span><a href="GHC.Rename.Names.html#extendGlobalRdrEnvRn"><span class="hs-identifier hs-var">extendGlobalRdrEnvRn</span></a></span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363266"><span class="hs-identifier hs-var">avails</span></a></span><span> </span><span class="annot"><span class="annottext">MiniFixityEnv
</span><a href="#local-6989586621681363299"><span class="hs-identifier hs-var">fixity_env</span></a></span><span>
</span><span id="line-825"></span><span>
</span><span id="line-826"></span><span>        </span><span class="hs-comment">-- Extend tcg_field_env with new fields (this used to be the</span><span>
</span><span id="line-827"></span><span>        </span><span class="hs-comment">-- work of extendRecordFieldEnv)</span><span>
</span><span id="line-828"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681363258"><span class="annot"><span class="annottext">field_env :: NameEnv [FieldLabel]
</span><a href="#local-6989586621681363258"><span class="hs-identifier hs-var hs-var">field_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NameEnv a -&gt; [(Name, a)] -&gt; NameEnv a
</span><a href="GHC.Types.Name.Env.html#extendNameEnvList"><span class="hs-identifier hs-var">extendNameEnvList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcGblEnv -&gt; NameEnv [FieldLabel]
</span><a href="GHC.Tc.Types.html#tcg_field_env"><span class="hs-identifier hs-var">tcg_field_env</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681363260"><span class="hs-identifier hs-var">tcg_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Name, [FieldLabel])]
</span><a href="#local-6989586621681363261"><span class="hs-identifier hs-var">flds</span></a></span><span>
</span><span id="line-829"></span><span>              </span><span id="local-6989586621681363256"><span class="annot"><span class="annottext">envs :: (TcGblEnv, TcLclEnv)
</span><a href="#local-6989586621681363256"><span class="hs-identifier hs-var hs-var">envs</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681363260"><span class="hs-identifier hs-var">tcg_env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcg_field_env :: NameEnv [FieldLabel]
</span><a href="GHC.Tc.Types.html#tcg_field_env"><span class="hs-identifier hs-var">tcg_field_env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameEnv [FieldLabel]
</span><a href="#local-6989586621681363258"><span class="hs-identifier hs-var">field_env</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TcLclEnv
</span><a href="#local-6989586621681363259"><span class="hs-identifier hs-var">tcl_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-830"></span><span>
</span><span id="line-831"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getLocalNonValBinders 3&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, [FieldLabel])]
</span><a href="#local-6989586621681363261"><span class="hs-identifier hs-var">flds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv [FieldLabel]
</span><a href="#local-6989586621681363258"><span class="hs-identifier hs-var">field_env</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-832"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TcGblEnv, TcLclEnv)
</span><a href="#local-6989586621681363256"><span class="hs-identifier hs-var">envs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681363264"><span class="hs-identifier hs-var">new_bndrs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-833"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-834"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#ValBinds"><span class="hs-identifier hs-type">ValBinds</span></a></span><span> </span><span class="annot"><span class="annottext">XValBinds GhcPs GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681363254"><span class="annot"><span class="annottext">LHsBindsLR GhcPs GhcPs
</span><a href="#local-6989586621681363254"><span class="hs-identifier hs-var">_val_binds</span></a></span></span><span> </span><span id="local-6989586621681363253"><span class="annot"><span class="annottext">[LSig GhcPs]
</span><a href="#local-6989586621681363253"><span class="hs-identifier hs-var">val_sigs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsValBinds GhcPs
</span><a href="#local-6989586621681363296"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-835"></span><span>
</span><span id="line-836"></span><span>    </span><span class="annot"><a href="#local-6989586621681363269"><span class="hs-identifier hs-type">for_hs_bndrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedN"><span class="hs-identifier hs-type">LocatedN</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-837"></span><span>    </span><span id="local-6989586621681363269"><span class="annot"><span class="annottext">for_hs_bndrs :: [GenLocated SrcSpanAnnN RdrName]
</span><a href="#local-6989586621681363269"><span class="hs-identifier hs-var hs-var">for_hs_bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (p :: Pass) a.
(UnXRec (GhcPass p), IsSrcSpanAnn p a) =&gt;
[LForeignDecl (GhcPass p)] -&gt; [LIdP (GhcPass p)]
</span><a href="GHC.Hs.Utils.html#hsForeignDeclsBinders"><span class="hs-identifier hs-var">hsForeignDeclsBinders</span></a></span><span> </span><span class="annot"><span class="annottext">[LForeignDecl GhcPs]
</span><a href="#local-6989586621681363292"><span class="hs-identifier hs-var">foreign_decls</span></a></span><span>
</span><span id="line-838"></span><span>
</span><span id="line-839"></span><span>    </span><span class="hs-comment">-- In a hs-boot file, the value binders come from the</span><span>
</span><span id="line-840"></span><span>    </span><span class="hs-comment">--  *signatures*, and there should be no foreign binders</span><span>
</span><span id="line-841"></span><span>    </span><span id="local-6989586621681363270"><span class="annot"><span class="annottext">hs_boot_sig_bndrs :: [GenLocated SrcSpanAnnN RdrName]
</span><a href="#local-6989586621681363270"><span class="hs-identifier hs-var hs-var">hs_boot_sig_bndrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a ann. SrcSpanAnn' a -&gt; SrcAnn ann
</span><a href="GHC.Parser.Annotation.html#l2l"><span class="hs-identifier hs-var">l2l</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681363250"><span class="hs-identifier hs-var">decl_loc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621681363249"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-842"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681363250"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681363250"><span class="hs-identifier hs-var">decl_loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Binds.html#TypeSig"><span class="hs-identifier hs-type">TypeSig</span></a></span><span> </span><span class="annot"><span class="annottext">XTypeSig GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681363247"><span class="annot"><span class="annottext">[LIdP GhcPs]
</span><a href="#local-6989586621681363247"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[LSig GhcPs]
</span><a href="#local-6989586621681363253"><span class="hs-identifier hs-var">val_sigs</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363249"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621681363249"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[LIdP GhcPs]
</span><a href="#local-6989586621681363247"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-843"></span><span>
</span><span id="line-844"></span><span>      </span><span class="hs-comment">-- the SrcSpan attached to the input should be the span of the</span><span>
</span><span id="line-845"></span><span>      </span><span class="hs-comment">-- declaration, not just the name</span><span>
</span><span id="line-846"></span><span>    </span><span class="annot"><a href="#local-6989586621681363267"><span class="hs-identifier hs-type">new_simple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedN"><span class="hs-identifier hs-type">LocatedN</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span>
</span><span id="line-847"></span><span>    </span><span id="local-6989586621681363267"><span class="annot"><span class="annottext">new_simple :: GenLocated SrcSpanAnnN RdrName -&gt; RnM AvailInfo
</span><a href="#local-6989586621681363267"><span class="hs-identifier hs-var hs-var">new_simple</span></a></span></span><span> </span><span id="local-6989586621681363246"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621681363246"><span class="hs-identifier hs-var">rdr_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span class="hs-special">{</span><span> </span><span id="local-6989586621681363245"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363245"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; RnM Name
</span><a href="GHC.Rename.Env.html#newTopSrcBinder"><span class="hs-identifier hs-var">newTopSrcBinder</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName
</span><a href="#local-6989586621681363246"><span class="hs-identifier hs-var">rdr_name</span></a></span><span>
</span><span id="line-848"></span><span>                            </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; AvailInfo
</span><a href="GHC.Types.Avail.html#avail"><span class="hs-identifier hs-var">avail</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363245"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-849"></span><span>
</span><span id="line-850"></span><span>    </span><span class="annot"><a href="#local-6989586621681363281"><span class="hs-identifier hs-type">new_tc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#DuplicateRecordFields"><span class="hs-identifier hs-type">DuplicateRecordFields</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldSelectors"><span class="hs-identifier hs-type">FieldSelectors</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LTyClDecl"><span class="hs-identifier hs-type">LTyClDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-851"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-852"></span><span>    </span><span id="local-6989586621681363281"><span class="annot"><span class="annottext">new_tc :: DuplicateRecordFields
-&gt; FieldSelectors
-&gt; LTyClDecl GhcPs
-&gt; RnM (AvailInfo, [(Name, [FieldLabel])])
</span><a href="#local-6989586621681363281"><span class="hs-identifier hs-var hs-var">new_tc</span></a></span></span><span> </span><span id="local-6989586621681363242"><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621681363242"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span></span><span> </span><span id="local-6989586621681363241"><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621681363241"><span class="hs-identifier hs-var">has_sel</span></a></span></span><span> </span><span id="local-6989586621681363240"><span class="annot"><span class="annottext">LTyClDecl GhcPs
</span><a href="#local-6989586621681363240"><span class="hs-identifier hs-var">tc_decl</span></a></span></span><span> </span><span class="hs-comment">-- NOT for type/data instances</span><span>
</span><span id="line-853"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363239"><span class="annot"><span class="annottext">[LocatedA (IdP GhcPs)]
</span><a href="#local-6989586621681363239"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363238"><span class="annot"><span class="annottext">[LFieldOcc GhcPs]
</span><a href="#local-6989586621681363238"><span class="hs-identifier hs-var">flds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (p :: Pass).
IsPass p =&gt;
LocatedA (TyClDecl (GhcPass p))
-&gt; ([LocatedA (IdP (GhcPass p))], [LFieldOcc (GhcPass p)])
</span><a href="GHC.Hs.Utils.html#hsLTyClDeclBinders"><span class="hs-identifier hs-var">hsLTyClDeclBinders</span></a></span><span> </span><span class="annot"><span class="annottext">LTyClDecl GhcPs
</span><a href="#local-6989586621681363240"><span class="hs-identifier hs-var">tc_decl</span></a></span><span>
</span><span id="line-854"></span><span>             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681363236"><span class="annot"><span class="annottext">names :: [Name]
</span><a href="#local-6989586621681363236"><span class="hs-identifier hs-var">names</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621681363235"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363235"><span class="hs-identifier hs-var">main_name</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681363234"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681363234"><span class="hs-identifier hs-var">sub_names</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base-4.16.4.0/src/Data-Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; RnM Name
</span><a href="GHC.Rename.Env.html#newTopSrcBinder"><span class="hs-identifier hs-var">newTopSrcBinder</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a1 a2. LocatedAn a1 a2 -&gt; LocatedN a2
</span><a href="GHC.Parser.Annotation.html#l2n"><span class="hs-identifier hs-var">l2n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LocatedA (IdP GhcPs)]
</span><a href="#local-6989586621681363239"><span class="hs-identifier hs-var">bndrs</span></a></span><span>
</span><span id="line-855"></span><span>             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681363232"><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621681363232"><span class="hs-identifier hs-var">flds'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base-4.16.4.0/src/Data-Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DuplicateRecordFields
-&gt; FieldSelectors -&gt; [Name] -&gt; LFieldOcc GhcPs -&gt; RnM FieldLabel
</span><a href="GHC.Rename.Names.html#newRecordSelector"><span class="hs-identifier hs-var">newRecordSelector</span></a></span><span> </span><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621681363242"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span><span> </span><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621681363241"><span class="hs-identifier hs-var">has_sel</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681363234"><span class="hs-identifier hs-var">sub_names</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LFieldOcc GhcPs]
</span><a href="#local-6989586621681363238"><span class="hs-identifier hs-var">flds</span></a></span><span>
</span><span id="line-856"></span><span>             </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681363231"><span class="annot"><span class="annottext">fld_env :: [(Name, [FieldLabel])]
</span><a href="#local-6989586621681363231"><span class="hs-identifier hs-var hs-var">fld_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LTyClDecl GhcPs
</span><a href="#local-6989586621681363240"><span class="hs-identifier hs-var">tc_decl</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-857"></span><span>                     </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DataDecl"><span class="hs-identifier hs-type">DataDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcdDataDefn :: forall pass. TyClDecl pass -&gt; HsDataDefn pass
</span><a href="Language.Haskell.Syntax.Decls.html#tcdDataDefn"><span class="hs-identifier hs-var">tcdDataDefn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681363228"><span class="annot"><span class="annottext">HsDataDefn GhcPs
</span><a href="#local-6989586621681363228"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsDataDefn GhcPs
-&gt; [Name] -&gt; [FieldLabel] -&gt; [(Name, [FieldLabel])]
</span><a href="#local-6989586621681363227"><span class="hs-identifier hs-var">mk_fld_env</span></a></span><span> </span><span class="annot"><span class="annottext">HsDataDefn GhcPs
</span><a href="#local-6989586621681363228"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681363236"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621681363232"><span class="hs-identifier hs-var">flds'</span></a></span><span>
</span><span id="line-858"></span><span>                     </span><span class="annot"><span class="annottext">TyClDecl GhcPs
</span><span class="hs-identifier">_</span></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-859"></span><span>             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [FieldLabel] -&gt; AvailInfo
</span><a href="GHC.Types.Avail.html#availTC"><span class="hs-identifier hs-var">availTC</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363235"><span class="hs-identifier hs-var">main_name</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681363236"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621681363232"><span class="hs-identifier hs-var">flds'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Name, [FieldLabel])]
</span><a href="#local-6989586621681363231"><span class="hs-identifier hs-var">fld_env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-860"></span><span>
</span><span id="line-861"></span><span>
</span><span id="line-862"></span><span>    </span><span class="hs-comment">-- Calculate the mapping from constructor names to fields, which</span><span>
</span><span id="line-863"></span><span>    </span><span class="hs-comment">-- will go in tcg_field_env. It's convenient to do this here where</span><span>
</span><span id="line-864"></span><span>    </span><span class="hs-comment">-- we are working with a single datatype definition.</span><span>
</span><span id="line-865"></span><span>    </span><span class="annot"><a href="#local-6989586621681363227"><span class="hs-identifier hs-type">mk_fld_env</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#HsDataDefn"><span class="hs-identifier hs-type">HsDataDefn</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-866"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-867"></span><span>    </span><span id="local-6989586621681363227"><span class="annot"><span class="annottext">mk_fld_env :: HsDataDefn GhcPs
-&gt; [Name] -&gt; [FieldLabel] -&gt; [(Name, [FieldLabel])]
</span><a href="#local-6989586621681363227"><span class="hs-identifier hs-var hs-var">mk_fld_env</span></a></span></span><span> </span><span id="local-6989586621681363225"><span class="annot"><span class="annottext">HsDataDefn GhcPs
</span><a href="#local-6989586621681363225"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621681363224"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681363224"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span id="local-6989586621681363223"><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621681363223"><span class="hs-identifier hs-var">flds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (ConDecl GhcPs) -&gt; [(Name, [FieldLabel])]
</span><a href="#local-6989586621681363222"><span class="hs-identifier hs-var">find_con_flds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass. HsDataDefn pass -&gt; [LConDecl pass]
</span><a href="Language.Haskell.Syntax.Decls.html#dd_cons"><span class="hs-identifier hs-var">dd_cons</span></a></span><span> </span><span class="annot"><span class="annottext">HsDataDefn GhcPs
</span><a href="#local-6989586621681363225"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-868"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-869"></span><span>        </span><span id="local-6989586621681363222"><span class="annot"><span class="annottext">find_con_flds :: GenLocated SrcSpanAnnA (ConDecl GhcPs) -&gt; [(Name, [FieldLabel])]
</span><a href="#local-6989586621681363222"><span class="hs-identifier hs-var hs-var">find_con_flds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ConDeclH98"><span class="hs-identifier hs-type">ConDeclH98</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">con_name :: forall pass. ConDecl pass -&gt; LIdP pass
</span><a href="Language.Haskell.Syntax.Decls.html#con_name"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681363218"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363218"><span class="hs-identifier hs-var">rdr</span></a></span></span><span>
</span><span id="line-870"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">con_args :: forall pass. ConDecl pass -&gt; HsConDeclH98Details pass
</span><a href="Language.Haskell.Syntax.Decls.html#con_args"><span class="hs-identifier hs-var">con_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#RecCon"><span class="hs-identifier hs-type">RecCon</span></a></span><span> </span><span id="local-6989586621681363215"><span class="annot"><span class="annottext">XRec GhcPs [LConDeclField GhcPs]
</span><a href="#local-6989586621681363215"><span class="hs-identifier hs-var">cdflds</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-871"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; Name
</span><a href="#local-6989586621681363214"><span class="hs-identifier hs-var">find_con_name</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363218"><span class="hs-identifier hs-var">rdr</span></a></span><span>
</span><span id="line-872"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (ConDeclField GhcPs) -&gt; [FieldLabel]
</span><a href="#local-6989586621681363213"><span class="hs-identifier hs-var">find_con_decl_flds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">XRec GhcPs [LConDeclField GhcPs]
</span><a href="#local-6989586621681363215"><span class="hs-identifier hs-var">cdflds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-873"></span><span>        </span><span class="annot"><a href="#local-6989586621681363222"><span class="hs-identifier hs-var">find_con_flds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ConDeclGADT"><span class="hs-identifier hs-type">ConDeclGADT</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">con_names :: forall pass. ConDecl pass -&gt; [LIdP pass]
</span><a href="Language.Haskell.Syntax.Decls.html#con_names"><span class="hs-identifier hs-var">con_names</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681363210"><span class="annot"><span class="annottext">[LIdP GhcPs]
</span><a href="#local-6989586621681363210"><span class="hs-identifier hs-var">rdrs</span></a></span></span><span>
</span><span id="line-874"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">con_g_args :: forall pass. ConDecl pass -&gt; HsConDeclGADTDetails pass
</span><a href="Language.Haskell.Syntax.Decls.html#con_g_args"><span class="hs-identifier hs-var">con_g_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#RecConGADT"><span class="hs-identifier hs-type">RecConGADT</span></a></span><span> </span><span id="local-6989586621681363207"><span class="annot"><span class="annottext">XRec GhcPs [LConDeclField GhcPs]
</span><a href="#local-6989586621681363207"><span class="hs-identifier hs-var">flds</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-875"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; Name
</span><a href="#local-6989586621681363214"><span class="hs-identifier hs-var">find_con_name</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363206"><span class="hs-identifier hs-var">rdr</span></a></span><span>
</span><span id="line-876"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (ConDeclField GhcPs) -&gt; [FieldLabel]
</span><a href="#local-6989586621681363213"><span class="hs-identifier hs-var">find_con_decl_flds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">XRec GhcPs [LConDeclField GhcPs]
</span><a href="#local-6989586621681363207"><span class="hs-identifier hs-var">flds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-877"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681363206"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363206"><span class="hs-identifier hs-var">rdr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[LIdP GhcPs]
</span><a href="#local-6989586621681363210"><span class="hs-identifier hs-var">rdrs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-878"></span><span>
</span><span id="line-879"></span><span>        </span><span class="annot"><a href="#local-6989586621681363222"><span class="hs-identifier hs-var">find_con_flds</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (ConDecl GhcPs)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-880"></span><span>
</span><span id="line-881"></span><span>        </span><span id="local-6989586621681363214"><span class="annot"><span class="annottext">find_con_name :: RdrName -&gt; Name
</span><a href="#local-6989586621681363214"><span class="hs-identifier hs-var hs-var">find_con_name</span></a></span></span><span> </span><span id="local-6989586621681363205"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363205"><span class="hs-identifier hs-var">rdr</span></a></span></span><span>
</span><span id="line-882"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; Maybe a -&gt; a
</span><a href="GHC.Data.Maybe.html#expectJust"><span class="hs-identifier hs-var">expectJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getLocalNonValBinders/find_con_name&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-883"></span><span>              </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#find"><span class="hs-identifier hs-var">find</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681363203"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363203"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363203"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363205"><span class="hs-identifier hs-var">rdr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681363224"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-884"></span><span>        </span><span id="local-6989586621681363213"><span class="annot"><span class="annottext">find_con_decl_flds :: GenLocated SrcSpanAnnA (ConDeclField GhcPs) -&gt; [FieldLabel]
</span><a href="#local-6989586621681363213"><span class="hs-identifier hs-var hs-var">find_con_decl_flds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681363200"><span class="annot"><span class="annottext">ConDeclField GhcPs
</span><a href="#local-6989586621681363200"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-885"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpan (FieldOcc GhcPs) -&gt; FieldLabel
</span><a href="#local-6989586621681363199"><span class="hs-identifier hs-var">find_con_decl_fld</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass. ConDeclField pass -&gt; [LFieldOcc pass]
</span><a href="Language.Haskell.Syntax.Type.html#cd_fld_names"><span class="hs-identifier hs-var">cd_fld_names</span></a></span><span> </span><span class="annot"><span class="annottext">ConDeclField GhcPs
</span><a href="#local-6989586621681363200"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-886"></span><span>
</span><span id="line-887"></span><span>        </span><span id="local-6989586621681363199"><span class="annot"><span class="annottext">find_con_decl_fld :: GenLocated SrcSpan (FieldOcc GhcPs) -&gt; FieldLabel
</span><a href="#local-6989586621681363199"><span class="hs-identifier hs-var hs-var">find_con_decl_fld</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#FieldOcc"><span class="hs-identifier hs-type">FieldOcc</span></a></span><span> </span><span class="annot"><span class="annottext">XCFieldOcc GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681363196"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363196"><span class="hs-identifier hs-var">rdr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-888"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; Maybe a -&gt; a
</span><a href="GHC.Data.Maybe.html#expectJust"><span class="hs-identifier hs-var">expectJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getLocalNonValBinders/find_con_decl_fld&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-889"></span><span>              </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#find"><span class="hs-identifier hs-var">find</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681363195"><span class="annot"><span class="annottext">FieldLabel
</span><a href="#local-6989586621681363195"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FieldLabel -&gt; FastString
</span><a href="GHC.Types.FieldLabel.html#flLabel"><span class="hs-identifier hs-var">flLabel</span></a></span><span> </span><span class="annot"><span class="annottext">FieldLabel
</span><a href="#local-6989586621681363195"><span class="hs-identifier hs-var">fl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681363193"><span class="hs-identifier hs-var">lbl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621681363223"><span class="hs-identifier hs-var">flds</span></a></span><span>
</span><span id="line-890"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681363193"><span class="annot"><span class="annottext">lbl :: FastString
</span><a href="#local-6989586621681363193"><span class="hs-identifier hs-var hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; FastString
</span><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363196"><span class="hs-identifier hs-var">rdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-891"></span><span>
</span><span id="line-892"></span><span>    </span><span class="annot"><a href="#local-6989586621681363274"><span class="hs-identifier hs-type">new_assoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#DuplicateRecordFields"><span class="hs-identifier hs-type">DuplicateRecordFields</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldSelectors"><span class="hs-identifier hs-type">FieldSelectors</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LInstDecl"><span class="hs-identifier hs-type">LInstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-893"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-894"></span><span>    </span><span id="local-6989586621681363274"><span class="annot"><span class="annottext">new_assoc :: DuplicateRecordFields
-&gt; FieldSelectors
-&gt; LInstDecl GhcPs
-&gt; RnM ([AvailInfo], [(Name, [FieldLabel])])
</span><a href="#local-6989586621681363274"><span class="hs-identifier hs-var hs-var">new_assoc</span></a></span></span><span> </span><span class="annot"><span class="annottext">DuplicateRecordFields
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FieldSelectors
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#TyFamInstD"><span class="hs-identifier hs-type">TyFamInstD</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-895"></span><span>      </span><span class="hs-comment">-- type instances don't bind new names</span><span>
</span><span id="line-896"></span><span>
</span><span id="line-897"></span><span>    </span><span class="annot"><a href="#local-6989586621681363274"><span class="hs-identifier hs-var">new_assoc</span></a></span><span> </span><span id="local-6989586621681363191"><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621681363191"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span></span><span> </span><span id="local-6989586621681363190"><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621681363190"><span class="hs-identifier hs-var">has_sel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DataFamInstD"><span class="hs-identifier hs-type">DataFamInstD</span></a></span><span> </span><span class="annot"><span class="annottext">XDataFamInstD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681363188"><span class="annot"><span class="annottext">DataFamInstDecl GhcPs
</span><a href="#local-6989586621681363188"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-898"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363187"><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363187"><span class="hs-identifier hs-var">avail</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363186"><span class="annot"><span class="annottext">[(Name, [FieldLabel])]
</span><a href="#local-6989586621681363186"><span class="hs-identifier hs-var">flds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DuplicateRecordFields
-&gt; FieldSelectors
-&gt; Maybe Name
-&gt; DataFamInstDecl GhcPs
-&gt; RnM (AvailInfo, [(Name, [FieldLabel])])
</span><a href="#local-6989586621681363185"><span class="hs-identifier hs-var">new_di</span></a></span><span> </span><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621681363191"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span><span> </span><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621681363190"><span class="hs-identifier hs-var">has_sel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">DataFamInstDecl GhcPs
</span><a href="#local-6989586621681363188"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-899"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363187"><span class="hs-identifier hs-var">avail</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Name, [FieldLabel])]
</span><a href="#local-6989586621681363186"><span class="hs-identifier hs-var">flds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-900"></span><span>    </span><span class="annot"><a href="#local-6989586621681363274"><span class="hs-identifier hs-var">new_assoc</span></a></span><span> </span><span id="local-6989586621681363184"><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621681363184"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span></span><span> </span><span id="local-6989586621681363183"><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621681363183"><span class="hs-identifier hs-var">has_sel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ClsInstD"><span class="hs-identifier hs-type">ClsInstD</span></a></span><span> </span><span class="annot"><span class="annottext">XClsInstD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#ClsInstDecl"><span class="hs-identifier hs-type">ClsInstDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cid_poly_ty :: forall pass. ClsInstDecl pass -&gt; LHsSigType pass
</span><a href="Language.Haskell.Syntax.Decls.html#cid_poly_ty"><span class="hs-identifier hs-var">cid_poly_ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681363179"><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><a href="#local-6989586621681363179"><span class="hs-identifier hs-var">inst_ty</span></a></span></span><span>
</span><span id="line-901"></span><span>                                                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cid_datafam_insts :: forall pass. ClsInstDecl pass -&gt; [LDataFamInstDecl pass]
</span><a href="Language.Haskell.Syntax.Decls.html#cid_datafam_insts"><span class="hs-identifier hs-var">cid_datafam_insts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681363177"><span class="annot"><span class="annottext">[LDataFamInstDecl GhcPs]
</span><a href="#local-6989586621681363177"><span class="hs-identifier hs-var">adts</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-902"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- First, attempt to grab the name of the class from the instance.</span><span>
</span><span id="line-903"></span><span>           </span><span class="hs-comment">-- This step could fail if the instance is not headed by a class,</span><span>
</span><span id="line-904"></span><span>           </span><span class="hs-comment">-- such as in the following examples:</span><span>
</span><span id="line-905"></span><span>           </span><span class="hs-comment">--</span><span>
</span><span id="line-906"></span><span>           </span><span class="hs-comment">-- (1) The class is headed by a bang pattern, such as in</span><span>
</span><span id="line-907"></span><span>           </span><span class="hs-comment">--     `instance !Show Int` (#3811c)</span><span>
</span><span id="line-908"></span><span>           </span><span class="hs-comment">-- (2) The class is headed by a type variable, such as in</span><span>
</span><span id="line-909"></span><span>           </span><span class="hs-comment">--     `instance c` (#16385)</span><span>
</span><span id="line-910"></span><span>           </span><span class="hs-comment">--</span><span>
</span><span id="line-911"></span><span>           </span><span class="hs-comment">-- If looking up the class name fails, then mb_cls_nm will</span><span>
</span><span id="line-912"></span><span>           </span><span class="hs-comment">-- be Nothing.</span><span>
</span><span id="line-913"></span><span>           </span><span id="local-6989586621681363176"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681363176"><span class="hs-identifier hs-var">mb_cls_nm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MaybeT m a -&gt; m (Maybe a)
</span><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-Maybe.html#runMaybeT"><span class="hs-identifier hs-var">runMaybeT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-914"></span><span>             </span><span class="hs-comment">-- See (1) above</span><span>
</span><span id="line-915"></span><span>             </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681363174"><span class="annot"><span class="annottext">SrcSpanAnnN
</span><a href="#local-6989586621681363174"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621681363173"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363173"><span class="hs-identifier hs-var">cls_rdr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. m (Maybe a) -&gt; MaybeT m a
</span><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-Maybe.html#MaybeT"><span class="hs-identifier hs-var">MaybeT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (p :: Pass).
(Anno (IdGhcP p) ~ SrcSpanAnnN) =&gt;
LHsSigType (GhcPass p) -&gt; Maybe (LocatedN (IdP (GhcPass p)))
</span><a href="GHC.Hs.Type.html#getLHsInstDeclClass_maybe"><span class="hs-identifier hs-var">getLHsInstDeclClass_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><a href="#local-6989586621681363179"><span class="hs-identifier hs-var">inst_ty</span></a></span><span>
</span><span id="line-916"></span><span>             </span><span class="hs-comment">-- See (2) above</span><span>
</span><span id="line-917"></span><span>             </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. m (Maybe a) -&gt; MaybeT m a
</span><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-Maybe.html#MaybeT"><span class="hs-identifier hs-var">MaybeT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SrcSpan -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpan"><span class="hs-identifier hs-var">setSrcSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><a href="#local-6989586621681363174"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; IOEnv (Env TcGblEnv TcLclEnv) (Maybe Name)
</span><a href="GHC.Rename.Env.html#lookupGlobalOccRn_maybe"><span class="hs-identifier hs-var">lookupGlobalOccRn_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363173"><span class="hs-identifier hs-var">cls_rdr</span></a></span><span>
</span><span id="line-918"></span><span>           </span><span class="hs-comment">-- Assuming the previous step succeeded, process any associated data</span><span>
</span><span id="line-919"></span><span>           </span><span class="hs-comment">-- family instances. If the previous step failed, bail out.</span><span>
</span><span id="line-920"></span><span>           </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681363176"><span class="hs-identifier hs-var">mb_cls_nm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-921"></span><span>             </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-922"></span><span>             </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681363168"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363168"><span class="hs-identifier hs-var">cls_nm</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-923"></span><span>               </span><span class="hs-special">(</span><span id="local-6989586621681363167"><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363167"><span class="hs-identifier hs-var">avails</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363166"><span class="annot"><span class="annottext">[[(Name, [FieldLabel])]]
</span><a href="#local-6989586621681363166"><span class="hs-identifier hs-var">fldss</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-924"></span><span>                 </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; m (b, c)) -&gt; [a] -&gt; m ([b], [c])
</span><a href="../../base-4.16.4.0/src/Control-Monad.html#mapAndUnzipM"><span class="hs-identifier hs-var">mapAndUnzipM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DuplicateRecordFields
-&gt; FieldSelectors
-&gt; Maybe Name
-&gt; LDataFamInstDecl GhcPs
-&gt; RnM (AvailInfo, [(Name, [FieldLabel])])
</span><a href="#local-6989586621681363165"><span class="hs-identifier hs-var">new_loc_di</span></a></span><span> </span><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621681363184"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span><span> </span><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621681363183"><span class="hs-identifier hs-var">has_sel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363168"><span class="hs-identifier hs-var">cls_nm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LDataFamInstDecl GhcPs]
</span><a href="#local-6989586621681363177"><span class="hs-identifier hs-var">adts</span></a></span><span>
</span><span id="line-925"></span><span>               </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363167"><span class="hs-identifier hs-var">avails</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Name, [FieldLabel])]]
</span><a href="#local-6989586621681363166"><span class="hs-identifier hs-var">fldss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-926"></span><span>
</span><span id="line-927"></span><span>    </span><span class="annot"><a href="#local-6989586621681363185"><span class="hs-identifier hs-type">new_di</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#DuplicateRecordFields"><span class="hs-identifier hs-type">DuplicateRecordFields</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldSelectors"><span class="hs-identifier hs-type">FieldSelectors</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DataFamInstDecl"><span class="hs-identifier hs-type">DataFamInstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-928"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-929"></span><span>    </span><span id="local-6989586621681363185"><span class="annot"><span class="annottext">new_di :: DuplicateRecordFields
-&gt; FieldSelectors
-&gt; Maybe Name
-&gt; DataFamInstDecl GhcPs
-&gt; RnM (AvailInfo, [(Name, [FieldLabel])])
</span><a href="#local-6989586621681363185"><span class="hs-identifier hs-var hs-var">new_di</span></a></span></span><span> </span><span id="local-6989586621681363164"><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621681363164"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span></span><span> </span><span id="local-6989586621681363163"><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621681363163"><span class="hs-identifier hs-var">has_sel</span></a></span></span><span> </span><span id="local-6989586621681363162"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681363162"><span class="hs-identifier hs-var">mb_cls</span></a></span></span><span> </span><span id="local-6989586621681363161"><span class="annot"><span class="annottext">dfid :: DataFamInstDecl GhcPs
</span><a href="#local-6989586621681363161"><span class="hs-identifier hs-var">dfid</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#DataFamInstDecl"><span class="hs-identifier hs-type">DataFamInstDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dfid_eqn :: forall pass. DataFamInstDecl pass -&gt; FamEqn pass (HsDataDefn pass)
</span><a href="Language.Haskell.Syntax.Decls.html#dfid_eqn"><span class="hs-identifier hs-var">dfid_eqn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681363158"><span class="annot"><span class="annottext">FamEqn GhcPs (HsDataDefn GhcPs)
</span><a href="#local-6989586621681363158"><span class="hs-identifier hs-var">ti_decl</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-930"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681363157"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN Name
</span><a href="#local-6989586621681363157"><span class="hs-identifier hs-var">main_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; GenLocated SrcSpanAnnN RdrName
-&gt; RnM (GenLocated SrcSpanAnnN Name)
</span><a href="GHC.Rename.Env.html#lookupFamInstName"><span class="hs-identifier hs-var">lookupFamInstName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681363162"><span class="hs-identifier hs-var">mb_cls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass rhs. FamEqn pass rhs -&gt; LIdP pass
</span><a href="Language.Haskell.Syntax.Decls.html#feqn_tycon"><span class="hs-identifier hs-var">feqn_tycon</span></a></span><span> </span><span class="annot"><span class="annottext">FamEqn GhcPs (HsDataDefn GhcPs)
</span><a href="#local-6989586621681363158"><span class="hs-identifier hs-var">ti_decl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-931"></span><span>             </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363154"><span class="annot"><span class="annottext">[LocatedA (IdP GhcPs)]
</span><a href="#local-6989586621681363154"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363153"><span class="annot"><span class="annottext">[LFieldOcc GhcPs]
</span><a href="#local-6989586621681363153"><span class="hs-identifier hs-var">flds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (p :: Pass).
IsPass p =&gt;
DataFamInstDecl (GhcPass p)
-&gt; ([LocatedA (IdP (GhcPass p))], [LFieldOcc (GhcPass p)])
</span><a href="GHC.Hs.Utils.html#hsDataFamInstBinders"><span class="hs-identifier hs-var">hsDataFamInstBinders</span></a></span><span> </span><span class="annot"><span class="annottext">DataFamInstDecl GhcPs
</span><a href="#local-6989586621681363161"><span class="hs-identifier hs-var">dfid</span></a></span><span>
</span><span id="line-932"></span><span>             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681363151"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681363151"><span class="hs-identifier hs-var">sub_names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base-4.16.4.0/src/Data-Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; RnM Name
</span><a href="GHC.Rename.Env.html#newTopSrcBinder"><span class="hs-identifier hs-var">newTopSrcBinder</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span class="annot"><span class="annottext">forall a1 a2. LocatedAn a1 a2 -&gt; LocatedN a2
</span><a href="GHC.Parser.Annotation.html#l2n"><span class="hs-identifier hs-var">l2n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LocatedA (IdP GhcPs)]
</span><a href="#local-6989586621681363154"><span class="hs-identifier hs-var">bndrs</span></a></span><span>
</span><span id="line-933"></span><span>             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681363150"><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621681363150"><span class="hs-identifier hs-var">flds'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base-4.16.4.0/src/Data-Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DuplicateRecordFields
-&gt; FieldSelectors -&gt; [Name] -&gt; LFieldOcc GhcPs -&gt; RnM FieldLabel
</span><a href="GHC.Rename.Names.html#newRecordSelector"><span class="hs-identifier hs-var">newRecordSelector</span></a></span><span> </span><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621681363164"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span><span> </span><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621681363163"><span class="hs-identifier hs-var">has_sel</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681363151"><span class="hs-identifier hs-var">sub_names</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LFieldOcc GhcPs]
</span><a href="#local-6989586621681363153"><span class="hs-identifier hs-var">flds</span></a></span><span>
</span><span id="line-934"></span><span>             </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681363149"><span class="annot"><span class="annottext">avail :: AvailInfo
</span><a href="#local-6989586621681363149"><span class="hs-identifier hs-var hs-var">avail</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [FieldLabel] -&gt; AvailInfo
</span><a href="GHC.Types.Avail.html#availTC"><span class="hs-identifier hs-var">availTC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN Name
</span><a href="#local-6989586621681363157"><span class="hs-identifier hs-var">main_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681363151"><span class="hs-identifier hs-var">sub_names</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621681363150"><span class="hs-identifier hs-var">flds'</span></a></span><span>
</span><span id="line-935"></span><span>                                  </span><span class="hs-comment">-- main_name is not bound here!</span><span>
</span><span id="line-936"></span><span>                   </span><span id="local-6989586621681363148"><span class="annot"><span class="annottext">fld_env :: [(Name, [FieldLabel])]
</span><a href="#local-6989586621681363148"><span class="hs-identifier hs-var hs-var">fld_env</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsDataDefn GhcPs
-&gt; [Name] -&gt; [FieldLabel] -&gt; [(Name, [FieldLabel])]
</span><a href="#local-6989586621681363227"><span class="hs-identifier hs-var">mk_fld_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass rhs. FamEqn pass rhs -&gt; rhs
</span><a href="Language.Haskell.Syntax.Decls.html#feqn_rhs"><span class="hs-identifier hs-var">feqn_rhs</span></a></span><span> </span><span class="annot"><span class="annottext">FamEqn GhcPs (HsDataDefn GhcPs)
</span><a href="#local-6989586621681363158"><span class="hs-identifier hs-var">ti_decl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681363151"><span class="hs-identifier hs-var">sub_names</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621681363150"><span class="hs-identifier hs-var">flds'</span></a></span><span>
</span><span id="line-937"></span><span>             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363149"><span class="hs-identifier hs-var">avail</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Name, [FieldLabel])]
</span><a href="#local-6989586621681363148"><span class="hs-identifier hs-var">fld_env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-938"></span><span>
</span><span id="line-939"></span><span>    </span><span class="annot"><a href="#local-6989586621681363165"><span class="hs-identifier hs-type">new_loc_di</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#DuplicateRecordFields"><span class="hs-identifier hs-type">DuplicateRecordFields</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldSelectors"><span class="hs-identifier hs-type">FieldSelectors</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Decls.html#LDataFamInstDecl"><span class="hs-identifier hs-type">LDataFamInstDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-940"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-941"></span><span>    </span><span id="local-6989586621681363165"><span class="annot"><span class="annottext">new_loc_di :: DuplicateRecordFields
-&gt; FieldSelectors
-&gt; Maybe Name
-&gt; LDataFamInstDecl GhcPs
-&gt; RnM (AvailInfo, [(Name, [FieldLabel])])
</span><a href="#local-6989586621681363165"><span class="hs-identifier hs-var hs-var">new_loc_di</span></a></span></span><span> </span><span id="local-6989586621681363146"><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621681363146"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span></span><span> </span><span id="local-6989586621681363145"><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621681363145"><span class="hs-identifier hs-var">has_sel</span></a></span></span><span> </span><span id="local-6989586621681363144"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681363144"><span class="hs-identifier hs-var">mb_cls</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681363143"><span class="annot"><span class="annottext">DataFamInstDecl GhcPs
</span><a href="#local-6989586621681363143"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DuplicateRecordFields
-&gt; FieldSelectors
-&gt; Maybe Name
-&gt; DataFamInstDecl GhcPs
-&gt; RnM (AvailInfo, [(Name, [FieldLabel])])
</span><a href="#local-6989586621681363185"><span class="hs-identifier hs-var">new_di</span></a></span><span> </span><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621681363146"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span><span> </span><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621681363145"><span class="hs-identifier hs-var">has_sel</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681363144"><span class="hs-identifier hs-var">mb_cls</span></a></span><span> </span><span class="annot"><span class="annottext">DataFamInstDecl GhcPs
</span><a href="#local-6989586621681363143"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-942"></span><span>
</span><span id="line-943"></span><span class="annot"><a href="GHC.Rename.Names.html#newRecordSelector"><span class="hs-identifier hs-type">newRecordSelector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#DuplicateRecordFields"><span class="hs-identifier hs-type">DuplicateRecordFields</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldSelectors"><span class="hs-identifier hs-type">FieldSelectors</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#LFieldOcc"><span class="hs-identifier hs-type">LFieldOcc</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a></span><span>
</span><span id="line-944"></span><span id="newRecordSelector"><span class="annot"><span class="annottext">newRecordSelector :: DuplicateRecordFields
-&gt; FieldSelectors -&gt; [Name] -&gt; LFieldOcc GhcPs -&gt; RnM FieldLabel
</span><a href="GHC.Rename.Names.html#newRecordSelector"><span class="hs-identifier hs-var hs-var">newRecordSelector</span></a></span></span><span> </span><span class="annot"><span class="annottext">DuplicateRecordFields
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FieldSelectors
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">LFieldOcc GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;newRecordSelector: datatype has no constructors!&quot;</span></span><span>
</span><span id="line-945"></span><span class="annot"><a href="GHC.Rename.Names.html#newRecordSelector"><span class="hs-identifier hs-var">newRecordSelector</span></a></span><span> </span><span id="local-6989586621681363141"><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621681363141"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span></span><span> </span><span id="local-6989586621681363140"><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621681363140"><span class="hs-identifier hs-var">has_sel</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363139"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363139"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Name]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681363138"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681363138"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Type.html#FieldOcc"><span class="hs-identifier hs-type">FieldOcc</span></a></span><span> </span><span class="annot"><span class="annottext">XCFieldOcc GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681363137"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363137"><span class="hs-identifier hs-var">fld</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-946"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681363136"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363136"><span class="hs-identifier hs-var">selName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; RnM Name
</span><a href="GHC.Rename.Env.html#newTopSrcBinder"><span class="hs-identifier hs-var">newTopSrcBinder</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ann. SrcSpan -&gt; SrcAnn ann
</span><a href="GHC.Parser.Annotation.html#noAnnSrcSpan"><span class="hs-identifier hs-var">noAnnSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621681363138"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363134"><span class="hs-identifier hs-var">field</span></a></span><span>
</span><span id="line-947"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">flLabel :: FastString
</span><a href="GHC.Types.FieldLabel.html#flLabel"><span class="hs-identifier hs-var">flLabel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681363132"><span class="hs-identifier hs-var">fieldLabelString</span></a></span><span>
</span><span id="line-948"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flHasDuplicateRecordFields :: DuplicateRecordFields
</span><a href="GHC.Types.FieldLabel.html#flHasDuplicateRecordFields"><span class="hs-identifier hs-var">flHasDuplicateRecordFields</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621681363141"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span><span>
</span><span id="line-949"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flHasFieldSelector :: FieldSelectors
</span><a href="GHC.Types.FieldLabel.html#flHasFieldSelector"><span class="hs-identifier hs-var">flHasFieldSelector</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621681363140"><span class="hs-identifier hs-var">has_sel</span></a></span><span>
</span><span id="line-950"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flSelector :: Name
</span><a href="GHC.Types.FieldLabel.html#flSelector"><span class="hs-identifier hs-var">flSelector</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363136"><span class="hs-identifier hs-var">selName</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-951"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-952"></span><span>    </span><span id="local-6989586621681363132"><span class="annot"><span class="annottext">fieldLabelString :: FastString
</span><a href="#local-6989586621681363132"><span class="hs-identifier hs-var hs-var">fieldLabelString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; FastString
</span><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363137"><span class="hs-identifier hs-var">fld</span></a></span><span>
</span><span id="line-953"></span><span>    </span><span id="local-6989586621681363128"><span class="annot"><span class="annottext">selOccName :: OccName
</span><a href="#local-6989586621681363128"><span class="hs-identifier hs-var hs-var">selOccName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString
-&gt; OccName -&gt; DuplicateRecordFields -&gt; FieldSelectors -&gt; OccName
</span><a href="GHC.Types.FieldLabel.html#fieldSelectorOccName"><span class="hs-identifier hs-var">fieldSelectorOccName</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681363132"><span class="hs-identifier hs-var">fieldLabelString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363139"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DuplicateRecordFields
</span><a href="#local-6989586621681363141"><span class="hs-identifier hs-var">dup_fields_ok</span></a></span><span> </span><span class="annot"><span class="annottext">FieldSelectors
</span><a href="#local-6989586621681363140"><span class="hs-identifier hs-var">has_sel</span></a></span><span>
</span><span id="line-954"></span><span>    </span><span id="local-6989586621681363134"><span class="annot"><span class="annottext">field :: RdrName
</span><a href="#local-6989586621681363134"><span class="hs-identifier hs-var hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isExact"><span class="hs-identifier hs-var">isExact</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363137"><span class="hs-identifier hs-var">fld</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363137"><span class="hs-identifier hs-var">fld</span></a></span><span>
</span><span id="line-955"></span><span>              </span><span class="hs-comment">-- use an Exact RdrName as is to preserve the bindings</span><span>
</span><span id="line-956"></span><span>              </span><span class="hs-comment">-- of an already renamer-resolved field and its use</span><span>
</span><span id="line-957"></span><span>              </span><span class="hs-comment">-- sites. This is needed to correctly support record</span><span>
</span><span id="line-958"></span><span>              </span><span class="hs-comment">-- selectors in Template Haskell. See Note [Binders in</span><span>
</span><span id="line-959"></span><span>              </span><span class="hs-comment">-- Template Haskell] in &quot;GHC.ThToHs&quot; and Note [Looking up</span><span>
</span><span id="line-960"></span><span>              </span><span class="hs-comment">-- Exact RdrNames] in &quot;GHC.Rename.Env&quot;.</span><span>
</span><span id="line-961"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; RdrName
</span><a href="GHC.Types.Name.Reader.html#mkRdrUnqual"><span class="hs-identifier hs-var">mkRdrUnqual</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681363128"><span class="hs-identifier hs-var">selOccName</span></a></span><span>
</span><span id="line-962"></span><span>
</span><span id="line-963"></span><span class="hs-comment">{-
Note [Looking up family names in family instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider

  module M where
    type family T a :: *
    type instance M.T Int = Bool

We might think that we can simply use 'lookupOccRn' when processing the type
instance to look up 'M.T'.  Alas, we can't!  The type family declaration is in
the *same* HsGroup as the type instance declaration.  Hence, as we are
currently collecting the binders declared in that HsGroup, these binders will
not have been added to the global environment yet.

Solution is simple: process the type family declarations first, extend
the environment, and then process the type instances.


************************************************************************
*                                                                      *
\subsection{Filtering imports}
*                                                                      *
************************************************************************

@filterImports@ takes the @ExportEnv@ telling what the imported module makes
available, and filters it through the import spec (if any).

Note [Dealing with imports]
~~~~~~~~~~~~~~~~~~~~~~~~~~~
For import M( ies ), we take the mi_exports of M, and make
   imp_occ_env :: OccEnv (NameEnv (GreName, AvailInfo, Maybe Name))
One entry for each OccName that M exports, mapping each corresponding Name to
its GreName, the AvailInfo exported from M that exports that Name, and
optionally a Name for an associated type's parent class. (Typically there will
be a single Name in the NameEnv, but see Note [Importing DuplicateRecordFields]
for why we may need more than one.)

The situation is made more complicated by associated types. E.g.
   module M where
     class    C a    where { data T a }
     instance C Int  where { data T Int = T1 | T2 }
     instance C Bool where { data T Int = T3 }
Then M's export_avails are (recall the AvailTC invariant from Avails.hs)
  C(C,T), T(T,T1,T2,T3)
Notice that T appears *twice*, once as a child and once as a parent. From
this list we construct a raw list including
   T -&gt; (T, T( T1, T2, T3 ), Nothing)
   T -&gt; (T, C( C, T ),       Nothing)
and we combine these (in function 'combine' in 'imp_occ_env' in
'filterImports') to get
   T  -&gt; (T,  T(T,T1,T2,T3), Just C)

So the overall imp_occ_env is
   C  -&gt; (C,  C(C,T),        Nothing)
   T  -&gt; (T,  T(T,T1,T2,T3), Just C)
   T1 -&gt; (T1, T(T,T1,T2,T3), Nothing)   -- similarly T2,T3

If we say
   import M( T(T1,T2) )
then we get *two* Avails:  C(T), T(T1,T2)

Note that the imp_occ_env will have entries for data constructors too,
although we never look up data constructors.

Note [Importing PatternSynonyms]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
As described in Note [Dealing with imports], associated types can lead to the
same Name appearing twice, both as a child and once as a parent, when
constructing the imp_occ_env.  The same thing can happen with pattern synonyms
if they are exported bundled with a type.

A simplified example, based on #11959:

  {-# LANGUAGE PatternSynonyms #-}
  module M (T(P), pattern P) where  -- Duplicate export warning, but allowed
    data T = MkT
    pattern P = MkT

Here we have T(P) and P in export_avails, and construct both
  P -&gt; (P, P, Nothing)
  P -&gt; (P, T(P), Nothing)
which are 'combine'd to leave
  P -&gt; (P, T(P), Nothing)
i.e. we simply discard the non-bundled Avail.

Note [Importing DuplicateRecordFields]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In filterImports, another complicating factor is DuplicateRecordFields.
Suppose we have:

  {-# LANGUAGE DuplicateRecordFields #-}
  module M (S(foo), T(foo)) where
    data S = MkS { foo :: Int }
    data T = mkT { foo :: Int }

  module N where
    import M (foo)    -- this is an ambiguity error (A)
    import M (S(foo)) -- this is allowed (B)

Here M exports the OccName 'foo' twice, so we get an imp_occ_env where 'foo'
maps to a NameEnv containing an entry for each of the two mangled field selector
names (see Note [FieldLabel] in GHC.Types.FieldLabel).

  foo -&gt; [ $sel:foo:MkS -&gt; (foo, S(foo), Nothing)
         , $sel:foo:MKT -&gt; (foo, T(foo), Nothing)
         ]

Then when we look up 'foo' in lookup_name for case (A) we get both entries and
hence report an ambiguity error.  Whereas in case (B) we reach the lookup_ie
case for IEThingWith, which looks up 'S' and then finds the unique 'foo' amongst
its children.

See T16745 for a test of this.

-}</span><span>
</span><span id="line-1079"></span><span>
</span><span id="line-1080"></span><span class="annot"><a href="GHC.Rename.Names.html#filterImports"><span class="hs-identifier hs-type">filterImports</span></a></span><span>
</span><span id="line-1081"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModIface.html#ModIface"><span class="hs-identifier hs-type">ModIface</span></a></span><span>
</span><span id="line-1082"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#ImpDeclSpec"><span class="hs-identifier hs-type">ImpDeclSpec</span></a></span><span>                     </span><span class="hs-comment">-- The span for the entire import decl</span><span>
</span><span id="line-1083"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedL"><span class="hs-identifier hs-type">LocatedL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Import spec; True =&gt; hiding</span><span>
</span><span id="line-1084"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedL"><span class="hs-identifier hs-type">LocatedL</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Import spec w/ Names</span><span>
</span><span id="line-1085"></span><span>            </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>                   </span><span class="hs-comment">-- Same again, but in GRE form</span><span>
</span><span id="line-1086"></span><span id="filterImports"><span class="annot"><span class="annottext">filterImports :: ModIface
-&gt; ImpDeclSpec
-&gt; Maybe (Bool, LocatedL [LIE GhcPs])
-&gt; RnM (Maybe (Bool, LocatedL [LIE GhcRn]), [GlobalRdrElt])
</span><a href="GHC.Rename.Names.html#filterImports"><span class="hs-identifier hs-var hs-var">filterImports</span></a></span></span><span> </span><span id="local-6989586621681363124"><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363124"><span class="hs-identifier hs-var">iface</span></a></span></span><span> </span><span id="local-6989586621681363123"><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681363123"><span class="hs-identifier hs-var">decl_spec</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Bool, LocatedL [LIE GhcPs])
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1087"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe ImportSpec -&gt; [AvailInfo] -&gt; [GlobalRdrElt]
</span><a href="GHC.Types.Name.Reader.html#gresFromAvails"><span class="hs-identifier hs-var">gresFromAvails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ImportSpec
</span><a href="#local-6989586621681363122"><span class="hs-identifier hs-var">imp_spec</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (phase :: ModIfacePhase). ModIface_ phase -&gt; [AvailInfo]
</span><a href="GHC.Unit.Module.ModIface.html#mi_exports"><span class="hs-identifier hs-var">mi_exports</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363124"><span class="hs-identifier hs-var">iface</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1088"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1089"></span><span>    </span><span id="local-6989586621681363122"><span class="annot"><span class="annottext">imp_spec :: ImportSpec
</span><a href="#local-6989586621681363122"><span class="hs-identifier hs-var hs-var">imp_spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#ImpSpec"><span class="hs-identifier hs-type">ImpSpec</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">is_decl :: ImpDeclSpec
</span><a href="GHC.Types.Name.Reader.html#is_decl"><span class="hs-identifier hs-var">is_decl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681363123"><span class="hs-identifier hs-var">decl_spec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">is_item :: ImpItemSpec
</span><a href="GHC.Types.Name.Reader.html#is_item"><span class="hs-identifier hs-var">is_item</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImpItemSpec
</span><a href="GHC.Types.Name.Reader.html#ImpAll"><span class="hs-identifier hs-var">ImpAll</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1090"></span><span>
</span><span id="line-1091"></span><span>
</span><span id="line-1092"></span><span class="annot"><a href="GHC.Rename.Names.html#filterImports"><span class="hs-identifier hs-var">filterImports</span></a></span><span> </span><span id="local-6989586621681363116"><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363116"><span class="hs-identifier hs-var">iface</span></a></span></span><span> </span><span id="local-6989586621681363115"><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681363115"><span class="hs-identifier hs-var">decl_spec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363114"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363114"><span class="hs-identifier hs-var">want_hiding</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681363113"><span class="annot"><span class="annottext">SrcSpanAnnL
</span><a href="#local-6989586621681363113"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681363112"><span class="annot"><span class="annottext">[LIE GhcPs]
</span><a href="#local-6989586621681363112"><span class="hs-identifier hs-var">import_items</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1093"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-comment">-- check for errors, convert RdrNames to Names</span><span>
</span><span id="line-1094"></span><span>        </span><span id="local-6989586621681363111"><span class="annot"><span class="annottext">[[(GenLocated SrcSpanAnnA (IE GhcRn), AvailInfo)]]
</span><a href="#local-6989586621681363111"><span class="hs-identifier hs-var">items1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base-4.16.4.0/src/Data-Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">LIE GhcPs -&gt; TcRn [(LIE GhcRn, AvailInfo)]
</span><a href="#local-6989586621681363110"><span class="hs-identifier hs-var">lookup_lie</span></a></span><span> </span><span class="annot"><span class="annottext">[LIE GhcPs]
</span><a href="#local-6989586621681363112"><span class="hs-identifier hs-var">import_items</span></a></span><span>
</span><span id="line-1095"></span><span>
</span><span id="line-1096"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621681363109"><span class="hs-identifier hs-type">items2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1097"></span><span>            </span><span id="local-6989586621681363109"><span class="annot"><span class="annottext">items2 :: [(LIE GhcRn, AvailInfo)]
</span><a href="#local-6989586621681363109"><span class="hs-identifier hs-var hs-var">items2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[(GenLocated SrcSpanAnnA (IE GhcRn), AvailInfo)]]
</span><a href="#local-6989586621681363111"><span class="hs-identifier hs-var">items1</span></a></span><span>
</span><span id="line-1098"></span><span>                </span><span class="hs-comment">-- NB the AvailInfo may have duplicates, and several items</span><span>
</span><span id="line-1099"></span><span>                </span><span class="hs-comment">--    for the same parent; e.g N(x) and N(y)</span><span>
</span><span id="line-1100"></span><span>
</span><span id="line-1101"></span><span>            </span><span id="local-6989586621681363108"><span class="annot"><span class="annottext">names :: Defs
</span><a href="#local-6989586621681363108"><span class="hs-identifier hs-var hs-var">names</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[AvailInfo] -&gt; Defs
</span><a href="GHC.Types.Avail.html#availsToNameSetWithSelectors"><span class="hs-identifier hs-var">availsToNameSetWithSelectors</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../../base-4.16.4.0/src/Data-Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(LIE GhcRn, AvailInfo)]
</span><a href="#local-6989586621681363109"><span class="hs-identifier hs-var">items2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1102"></span><span>            </span><span id="local-6989586621681363107"><span class="annot"><span class="annottext">keep :: Name -&gt; Bool
</span><a href="#local-6989586621681363107"><span class="hs-identifier hs-var hs-var">keep</span></a></span></span><span> </span><span id="local-6989586621681363106"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363106"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363106"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Defs -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681363108"><span class="hs-identifier hs-var">names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1103"></span><span>            </span><span id="local-6989586621681363104"><span class="annot"><span class="annottext">pruned_avails :: [AvailInfo]
</span><a href="#local-6989586621681363104"><span class="hs-identifier hs-var hs-var">pruned_avails</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Bool) -&gt; [AvailInfo] -&gt; [AvailInfo]
</span><a href="GHC.Types.Avail.html#filterAvails"><span class="hs-identifier hs-var">filterAvails</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="#local-6989586621681363107"><span class="hs-identifier hs-var">keep</span></a></span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363102"><span class="hs-identifier hs-var">all_avails</span></a></span><span>
</span><span id="line-1104"></span><span>            </span><span id="local-6989586621681363101"><span class="annot"><span class="annottext">hiding_spec :: ImportSpec
</span><a href="#local-6989586621681363101"><span class="hs-identifier hs-var hs-var">hiding_spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#ImpSpec"><span class="hs-identifier hs-type">ImpSpec</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">is_decl :: ImpDeclSpec
</span><a href="GHC.Types.Name.Reader.html#is_decl"><span class="hs-identifier hs-var">is_decl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681363115"><span class="hs-identifier hs-var">decl_spec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">is_item :: ImpItemSpec
</span><a href="GHC.Types.Name.Reader.html#is_item"><span class="hs-identifier hs-var">is_item</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImpItemSpec
</span><a href="GHC.Types.Name.Reader.html#ImpAll"><span class="hs-identifier hs-var">ImpAll</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1105"></span><span>
</span><span id="line-1106"></span><span>            </span><span id="local-6989586621681363100"><span class="annot"><span class="annottext">gres :: [GlobalRdrElt]
</span><a href="#local-6989586621681363100"><span class="hs-identifier hs-var hs-var">gres</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363114"><span class="hs-identifier hs-var">want_hiding</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ImportSpec -&gt; [AvailInfo] -&gt; [GlobalRdrElt]
</span><a href="GHC.Types.Name.Reader.html#gresFromAvails"><span class="hs-identifier hs-var">gresFromAvails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ImportSpec
</span><a href="#local-6989586621681363101"><span class="hs-identifier hs-var">hiding_spec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363104"><span class="hs-identifier hs-var">pruned_avails</span></a></span><span>
</span><span id="line-1107"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ImpDeclSpec -&gt; (LIE GhcRn, AvailInfo) -&gt; [GlobalRdrElt]
</span><a href="GHC.Rename.Names.html#gresFromIE"><span class="hs-identifier hs-var">gresFromIE</span></a></span><span> </span><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681363115"><span class="hs-identifier hs-var">decl_spec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(LIE GhcRn, AvailInfo)]
</span><a href="#local-6989586621681363109"><span class="hs-identifier hs-var">items2</span></a></span><span>
</span><span id="line-1108"></span><span>
</span><span id="line-1109"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363114"><span class="hs-identifier hs-var">want_hiding</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnL
</span><a href="#local-6989586621681363113"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><a href="../../base-4.16.4.0/src/Data-Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(LIE GhcRn, AvailInfo)]
</span><a href="#local-6989586621681363109"><span class="hs-identifier hs-var">items2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681363100"><span class="hs-identifier hs-var">gres</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1110"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1111"></span><span>    </span><span id="local-6989586621681363102"><span class="annot"><span class="annottext">all_avails :: [AvailInfo]
</span><a href="#local-6989586621681363102"><span class="hs-identifier hs-var hs-var">all_avails</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (phase :: ModIfacePhase). ModIface_ phase -&gt; [AvailInfo]
</span><a href="GHC.Unit.Module.ModIface.html#mi_exports"><span class="hs-identifier hs-var">mi_exports</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363116"><span class="hs-identifier hs-var">iface</span></a></span><span>
</span><span id="line-1112"></span><span>
</span><span id="line-1113"></span><span>        </span><span class="hs-comment">-- See Note [Dealing with imports]</span><span>
</span><span id="line-1114"></span><span>    </span><span class="annot"><a href="#local-6989586621681363098"><span class="hs-identifier hs-type">imp_occ_env</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccEnv"><span class="hs-identifier hs-type">OccEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#GreName"><span class="hs-identifier hs-type">GreName</span></a></span><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- the name or field</span><span>
</span><span id="line-1115"></span><span>                           </span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- the export item providing it</span><span>
</span><span id="line-1116"></span><span>                           </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- the parent of associated types</span><span>
</span><span id="line-1117"></span><span>    </span><span id="local-6989586621681363098"><span class="annot"><span class="annottext">imp_occ_env :: OccEnv (NameEnv (GreName, AvailInfo, Maybe Name))
</span><a href="#local-6989586621681363098"><span class="hs-identifier hs-var hs-var">imp_occ_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; a) -&gt; [(OccName, a)] -&gt; OccEnv a
</span><a href="GHC.Types.Name.Occurrence.html#mkOccEnv_C"><span class="hs-identifier hs-var">mkOccEnv_C</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; a) -&gt; NameEnv a -&gt; NameEnv a -&gt; NameEnv a
</span><a href="GHC.Types.Name.Env.html#plusNameEnv_C"><span class="hs-identifier hs-var">plusNameEnv_C</span></a></span><span> </span><span class="annot"><span class="annottext">(GreName, AvailInfo, Maybe Name)
-&gt; (GreName, AvailInfo, Maybe Name)
-&gt; (GreName, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681363095"><span class="hs-identifier hs-var">combine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1118"></span><span>                             </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. HasOccName name =&gt; name -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#occName"><span class="hs-identifier hs-var">occName</span></a></span><span> </span><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681363094"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. [(Name, a)] -&gt; NameEnv a
</span><a href="GHC.Types.Name.Env.html#mkNameEnv"><span class="hs-identifier hs-var">mkNameEnv</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">GreName -&gt; Name
</span><a href="GHC.Types.Avail.html#greNameMangledName"><span class="hs-identifier hs-var">greNameMangledName</span></a></span><span> </span><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681363094"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681363094"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363092"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1119"></span><span>                                     </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681363092"><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363092"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363102"><span class="hs-identifier hs-var">all_avails</span></a></span><span>
</span><span id="line-1120"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363094"><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681363094"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AvailInfo -&gt; [GreName]
</span><a href="GHC.Types.Avail.html#availGreNames"><span class="hs-identifier hs-var">availGreNames</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363092"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1121"></span><span>    </span><span class="hs-comment">-- See Note [Dealing with imports]</span><span>
</span><span id="line-1122"></span><span>    </span><span class="hs-comment">-- 'combine' may be called for associated data types which appear</span><span>
</span><span id="line-1123"></span><span>    </span><span class="hs-comment">-- twice in the all_avails. In the example, we combine</span><span>
</span><span id="line-1124"></span><span>    </span><span class="hs-comment">--    T(T,T1,T2,T3) and C(C,T)  to give   (T, T(T,T1,T2,T3), Just C)</span><span>
</span><span id="line-1125"></span><span>    </span><span class="hs-comment">-- NB: the AvailTC can have fields as well as data constructors (#12127)</span><span>
</span><span id="line-1126"></span><span>    </span><span class="annot"><a href="#local-6989586621681363095"><span class="hs-identifier hs-type">combine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#GreName"><span class="hs-identifier hs-type">GreName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1127"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#GreName"><span class="hs-identifier hs-type">GreName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1128"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#GreName"><span class="hs-identifier hs-type">GreName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1129"></span><span>    </span><span id="local-6989586621681363095"><span class="annot"><span class="annottext">combine :: (GreName, AvailInfo, Maybe Name)
-&gt; (GreName, AvailInfo, Maybe Name)
-&gt; (GreName, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681363095"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#NormalGreName"><span class="hs-identifier hs-type">NormalGreName</span></a></span><span> </span><span id="local-6989586621681363090"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363090"><span class="hs-identifier hs-var">name1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363089"><span class="annot"><span class="annottext">a1 :: AvailInfo
</span><a href="#local-6989586621681363089"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#AvailTC"><span class="hs-identifier hs-type">AvailTC</span></a></span><span> </span><span id="local-6989586621681363087"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363087"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="annot"><span class="annottext">[GreName]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363086"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681363086"><span class="hs-identifier hs-var">mb1</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1130"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#NormalGreName"><span class="hs-identifier hs-type">NormalGreName</span></a></span><span> </span><span id="local-6989586621681363085"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363085"><span class="hs-identifier hs-var">name2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363084"><span class="annot"><span class="annottext">a2 :: AvailInfo
</span><a href="#local-6989586621681363084"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#AvailTC"><span class="hs-identifier hs-type">AvailTC</span></a></span><span> </span><span id="local-6989586621681363083"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363083"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="annot"><span class="annottext">[GreName]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363082"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681363082"><span class="hs-identifier hs-var">mb2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1131"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">name1</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">name2</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">isNothing</span><span> </span><span class="hs-identifier">mb1</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">isNothing</span><span> </span><span class="hs-identifier">mb2</span><span>
</span><span id="line-1132"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">name1</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">name2</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">mb1</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">mb2</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1133"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363087"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363090"><span class="hs-identifier hs-var">name1</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; GreName
</span><a href="GHC.Types.Avail.html#NormalGreName"><span class="hs-identifier hs-var">NormalGreName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363090"><span class="hs-identifier hs-var">name1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363089"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363083"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1134"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; GreName
</span><a href="GHC.Types.Avail.html#NormalGreName"><span class="hs-identifier hs-var">NormalGreName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363090"><span class="hs-identifier hs-var">name1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363084"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363087"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1135"></span><span>    </span><span class="hs-comment">-- 'combine' may also be called for pattern synonyms which appear both</span><span>
</span><span id="line-1136"></span><span>    </span><span class="hs-comment">-- unassociated and associated (see Note [Importing PatternSynonyms]).</span><span>
</span><span id="line-1137"></span><span>    </span><span class="annot"><a href="#local-6989586621681363095"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363080"><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681363080"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363079"><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363079"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363078"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681363078"><span class="hs-identifier hs-var">mb1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363077"><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681363077"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363076"><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363076"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363075"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681363075"><span class="hs-identifier hs-var">mb2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1138"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT2</span><span class="hs-special">(</span><span> </span><span class="hs-identifier">c1</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">c2</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">isNothing</span><span> </span><span class="hs-identifier">mb1</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">isNothing</span><span> </span><span class="hs-identifier">mb2</span><span>
</span><span id="line-1139"></span><span>                          </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">isAvailTC</span><span> </span><span class="hs-identifier">a1</span><span> </span><span class="hs-operator">||</span><span> </span><span class="hs-identifier">isAvailTC</span><span> </span><span class="hs-identifier">a2</span><span class="hs-special">)</span><span>
</span><span id="line-1140"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">c1</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">c2</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">a1</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">a2</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">mb1</span><span> </span><span class="hs-operator">&lt;+&gt;</span><span> </span><span class="hs-identifier">ppr</span><span> </span><span class="hs-identifier">mb2</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1141"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">AvailInfo -&gt; Bool
</span><a href="#local-6989586621681363074"><span class="hs-identifier hs-var">isAvailTC</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363079"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681363080"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363079"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1142"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681363080"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363076"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1143"></span><span>
</span><span id="line-1144"></span><span>    </span><span id="local-6989586621681363074"><span class="annot"><span class="annottext">isAvailTC :: AvailInfo -&gt; Bool
</span><a href="#local-6989586621681363074"><span class="hs-identifier hs-var hs-var">isAvailTC</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Avail.html#AvailTC"><span class="hs-identifier hs-type">AvailTC</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1145"></span><span>    </span><span class="annot"><a href="#local-6989586621681363074"><span class="hs-identifier hs-var">isAvailTC</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1146"></span><span>
</span><span id="line-1147"></span><span>    </span><span class="annot"><a href="#local-6989586621681363073"><span class="hs-identifier hs-type">lookup_name</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#IELookupM"><span class="hs-identifier hs-type">IELookupM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1148"></span><span>    </span><span id="local-6989586621681363073"><span class="annot"><span class="annottext">lookup_name :: IE GhcPs -&gt; RdrName -&gt; IELookupM (Name, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681363073"><span class="hs-identifier hs-var hs-var">lookup_name</span></a></span></span><span> </span><span id="local-6989586621681363072"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363072"><span class="hs-identifier hs-var">ie</span></a></span></span><span> </span><span id="local-6989586621681363071"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363071"><span class="hs-identifier hs-var">rdr</span></a></span></span><span>
</span><span id="line-1149"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isQual"><span class="hs-identifier hs-var">isQual</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363071"><span class="hs-identifier hs-var">rdr</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. IELookupError -&gt; IELookupM a
</span><a href="GHC.Rename.Names.html#failLookupWith"><span class="hs-identifier hs-var">failLookupWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName -&gt; IELookupError
</span><a href="GHC.Rename.Names.html#QualImportError"><span class="hs-identifier hs-var">QualImportError</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363071"><span class="hs-identifier hs-var">rdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1150"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681363067"><span class="annot"><span class="annottext">NameEnv (GreName, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681363067"><span class="hs-identifier hs-var">succ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (NameEnv (GreName, AvailInfo, Maybe Name))
</span><a href="#local-6989586621681363066"><span class="hs-identifier hs-var">mb_success</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. NameEnv a -&gt; [a]
</span><a href="GHC.Types.Name.Env.html#nameEnvElts"><span class="hs-identifier hs-var">nameEnvElts</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv (GreName, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681363067"><span class="hs-identifier hs-var">succ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1151"></span><span>                                     </span><span class="hs-comment">-- See Note [Importing DuplicateRecordFields]</span><span>
</span><span id="line-1152"></span><span>                                     </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621681363064"><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681363064"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681363063"><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363063"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681363062"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681363062"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GreName -&gt; Name
</span><a href="GHC.Types.Avail.html#greNameMangledName"><span class="hs-identifier hs-var">greNameMangledName</span></a></span><span> </span><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681363064"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363063"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681363062"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1153"></span><span>                                     </span><span id="local-6989586621681363061"><span class="annot"><span class="annottext">[(GreName, AvailInfo, Maybe Name)]
</span><a href="#local-6989586621681363061"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. IELookupError -&gt; IELookupM a
</span><a href="GHC.Rename.Names.html#failLookupWith"><span class="hs-identifier hs-var">failLookupWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName -&gt; [AvailInfo] -&gt; IELookupError
</span><a href="GHC.Rename.Names.html#AmbiguousImport"><span class="hs-identifier hs-var">AmbiguousImport</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363071"><span class="hs-identifier hs-var">rdr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a, b, c) -&gt; b
</span><a href="GHC.Utils.Misc.html#sndOf3"><span class="hs-identifier hs-var">sndOf3</span></a></span><span> </span><span class="annot"><span class="annottext">[(GreName, AvailInfo, Maybe Name)]
</span><a href="#local-6989586621681363061"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1154"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. IELookupError -&gt; IELookupM a
</span><a href="GHC.Rename.Names.html#failLookupWith"><span class="hs-identifier hs-var">failLookupWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IE GhcPs -&gt; IELookupError
</span><a href="GHC.Rename.Names.html#BadImport"><span class="hs-identifier hs-var">BadImport</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363072"><span class="hs-identifier hs-var">ie</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1155"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1156"></span><span>        </span><span id="local-6989586621681363066"><span class="annot"><span class="annottext">mb_success :: Maybe (NameEnv (GreName, AvailInfo, Maybe Name))
</span><a href="#local-6989586621681363066"><span class="hs-identifier hs-var hs-var">mb_success</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. OccEnv a -&gt; OccName -&gt; Maybe a
</span><a href="GHC.Types.Name.Occurrence.html#lookupOccEnv"><span class="hs-identifier hs-var">lookupOccEnv</span></a></span><span> </span><span class="annot"><span class="annottext">OccEnv (NameEnv (GreName, AvailInfo, Maybe Name))
</span><a href="#local-6989586621681363098"><span class="hs-identifier hs-var">imp_occ_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363071"><span class="hs-identifier hs-var">rdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1157"></span><span>
</span><span id="line-1158"></span><span>    </span><span class="annot"><a href="#local-6989586621681363110"><span class="hs-identifier hs-type">lookup_lie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRn"><span class="hs-identifier hs-type">TcRn</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1159"></span><span>    </span><span id="local-6989586621681363110"><span class="annot"><span class="annottext">lookup_lie :: LIE GhcPs -&gt; TcRn [(LIE GhcRn, AvailInfo)]
</span><a href="#local-6989586621681363110"><span class="hs-identifier hs-var hs-var">lookup_lie</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681363056"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681363056"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621681363055"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363055"><span class="hs-identifier hs-var">ieRdr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1160"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363054"><span class="annot"><span class="annottext">[(IE GhcRn, AvailInfo)]
</span><a href="#local-6989586621681363054"><span class="hs-identifier hs-var">stuff</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363053"><span class="annot"><span class="annottext">[IELookupWarning]
</span><a href="#local-6989586621681363053"><span class="hs-identifier hs-var">warns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall ann a. SrcSpanAnn' ann -&gt; TcRn a -&gt; TcRn a
</span><a href="GHC.Tc.Utils.Monad.html#setSrcSpanA"><span class="hs-identifier hs-var">setSrcSpanA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681363056"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1161"></span><span>                               </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../base-4.16.4.0/src/Data-Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1162"></span><span>                               </span><span class="annot"><span class="annottext">forall a. IELookupM a -&gt; TcRn (Maybe a)
</span><a href="#local-6989586621681363050"><span class="hs-identifier hs-var">run_lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IE GhcPs -&gt; IELookupM ([(IE GhcRn, AvailInfo)], [IELookupWarning])
</span><a href="#local-6989586621681363049"><span class="hs-identifier hs-var">lookup_ie</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363055"><span class="hs-identifier hs-var">ieRdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1163"></span><span>             </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">IELookupWarning -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681363047"><span class="hs-identifier hs-var">emit_warning</span></a></span><span> </span><span class="annot"><span class="annottext">[IELookupWarning]
</span><a href="#local-6989586621681363053"><span class="hs-identifier hs-var">warns</span></a></span><span>
</span><span id="line-1164"></span><span>             </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681363056"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcRn
</span><a href="#local-6989586621681363046"><span class="hs-identifier hs-var">ie</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363045"><span class="hs-identifier hs-var">avail</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681363046"><span class="annot"><span class="annottext">IE GhcRn
</span><a href="#local-6989586621681363046"><span class="hs-identifier hs-var">ie</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681363045"><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363045"><span class="hs-identifier hs-var">avail</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(IE GhcRn, AvailInfo)]
</span><a href="#local-6989586621681363054"><span class="hs-identifier hs-var">stuff</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1165"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1166"></span><span>            </span><span class="hs-comment">-- Warn when importing T(..) if T was exported abstractly</span><span>
</span><span id="line-1167"></span><span>            </span><span id="local-6989586621681363047"><span class="annot"><span class="annottext">emit_warning :: IELookupWarning -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681363047"><span class="hs-identifier hs-var hs-var">emit_warning</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Names.html#DodgyImport"><span class="hs-identifier hs-type">DodgyImport</span></a></span><span> </span><span id="local-6989586621681363043"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363043"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl.
WarningFlag -&gt; TcRnIf gbl lcl () -&gt; TcRnIf gbl lcl ()
</span><a href="GHC.Tc.Utils.Monad.html#whenWOptM"><span class="hs-identifier hs-var">whenWOptM</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnDodgyImports"><span class="hs-identifier hs-var">Opt_WarnDodgyImports</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1168"></span><span>              </span><span class="annot"><span class="annottext">WarnReason -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addWarn"><span class="hs-identifier hs-var">addWarn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningFlag -&gt; WarnReason
</span><a href="GHC.Driver.Flags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnDodgyImports"><span class="hs-identifier hs-var">Opt_WarnDodgyImports</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName -&gt; SDoc
</span><a href="GHC.Rename.Names.html#dodgyImportWarn"><span class="hs-identifier hs-var">dodgyImportWarn</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363043"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1169"></span><span>            </span><span class="annot"><a href="#local-6989586621681363047"><span class="hs-identifier hs-var">emit_warning</span></a></span><span> </span><span class="annot"><span class="annottext">IELookupWarning
</span><a href="GHC.Rename.Names.html#MissingImportList"><span class="hs-identifier hs-var">MissingImportList</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl.
WarningFlag -&gt; TcRnIf gbl lcl () -&gt; TcRnIf gbl lcl ()
</span><a href="GHC.Tc.Utils.Monad.html#whenWOptM"><span class="hs-identifier hs-var">whenWOptM</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnMissingImportList"><span class="hs-identifier hs-var">Opt_WarnMissingImportList</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1170"></span><span>              </span><span class="annot"><span class="annottext">WarnReason -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addWarn"><span class="hs-identifier hs-var">addWarn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningFlag -&gt; WarnReason
</span><a href="GHC.Driver.Flags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnMissingImportList"><span class="hs-identifier hs-var">Opt_WarnMissingImportList</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IE GhcPs -&gt; SDoc
</span><a href="GHC.Rename.Names.html#missingImportListItem"><span class="hs-identifier hs-var">missingImportListItem</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363055"><span class="hs-identifier hs-var">ieRdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1171"></span><span>            </span><span class="annot"><a href="#local-6989586621681363047"><span class="hs-identifier hs-var">emit_warning</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Names.html#BadImportW"><span class="hs-identifier hs-type">BadImportW</span></a></span><span> </span><span id="local-6989586621681363037"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363037"><span class="hs-identifier hs-var">ie</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl.
WarningFlag -&gt; TcRnIf gbl lcl () -&gt; TcRnIf gbl lcl ()
</span><a href="GHC.Tc.Utils.Monad.html#whenWOptM"><span class="hs-identifier hs-var">whenWOptM</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnDodgyImports"><span class="hs-identifier hs-var">Opt_WarnDodgyImports</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1172"></span><span>              </span><span class="annot"><span class="annottext">WarnReason -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addWarn"><span class="hs-identifier hs-var">addWarn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningFlag -&gt; WarnReason
</span><a href="GHC.Driver.Flags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnDodgyImports"><span class="hs-identifier hs-var">Opt_WarnDodgyImports</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IELookupError -&gt; SDoc
</span><a href="#local-6989586621681363036"><span class="hs-identifier hs-var">lookup_err_msg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IE GhcPs -&gt; IELookupError
</span><a href="GHC.Rename.Names.html#BadImport"><span class="hs-identifier hs-var">BadImport</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363037"><span class="hs-identifier hs-var">ie</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1173"></span><span>
</span><span id="line-1174"></span><span>            </span><span id="local-6989586621681364238"><span class="annot"><a href="#local-6989586621681363050"><span class="hs-identifier hs-type">run_lookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#IELookupM"><span class="hs-identifier hs-type">IELookupM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681364238"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRn"><span class="hs-identifier hs-type">TcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681364238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1175"></span><span>            </span><span id="local-6989586621681363050"><span class="annot"><span class="annottext">run_lookup :: forall a. IELookupM a -&gt; TcRn (Maybe a)
</span><a href="#local-6989586621681363050"><span class="hs-identifier hs-var hs-var">run_lookup</span></a></span></span><span> </span><span id="local-6989586621681363032"><span class="annot"><span class="annottext">IELookupM a
</span><a href="#local-6989586621681363032"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IELookupM a
</span><a href="#local-6989586621681363032"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1176"></span><span>              </span><span class="annot"><a href="GHC.Data.Maybe.html#Failed"><span class="hs-identifier hs-type">Failed</span></a></span><span> </span><span id="local-6989586621681363030"><span class="annot"><span class="annottext">IELookupError
</span><a href="#local-6989586621681363030"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addErr"><span class="hs-identifier hs-var">addErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IELookupError -&gt; SDoc
</span><a href="#local-6989586621681363036"><span class="hs-identifier hs-var">lookup_err_msg</span></a></span><span> </span><span class="annot"><span class="annottext">IELookupError
</span><a href="#local-6989586621681363030"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1177"></span><span>              </span><span class="annot"><a href="GHC.Data.Maybe.html#Succeeded"><span class="hs-identifier hs-type">Succeeded</span></a></span><span> </span><span id="local-6989586621681363028"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681363028"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681363028"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1178"></span><span>
</span><span id="line-1179"></span><span>            </span><span id="local-6989586621681363036"><span class="annot"><span class="annottext">lookup_err_msg :: IELookupError -&gt; SDoc
</span><a href="#local-6989586621681363036"><span class="hs-identifier hs-var hs-var">lookup_err_msg</span></a></span></span><span> </span><span id="local-6989586621681363027"><span class="annot"><span class="annottext">IELookupError
</span><a href="#local-6989586621681363027"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IELookupError
</span><a href="#local-6989586621681363027"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1180"></span><span>              </span><span class="annot"><a href="GHC.Rename.Names.html#BadImport"><span class="hs-identifier hs-type">BadImport</span></a></span><span> </span><span id="local-6989586621681363026"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363026"><span class="hs-identifier hs-var">ie</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModIface -&gt; ImpDeclSpec -&gt; IE GhcPs -&gt; [AvailInfo] -&gt; SDoc
</span><a href="GHC.Rename.Names.html#badImportItemErr"><span class="hs-identifier hs-var">badImportItemErr</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681363116"><span class="hs-identifier hs-var">iface</span></a></span><span> </span><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681363115"><span class="hs-identifier hs-var">decl_spec</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363026"><span class="hs-identifier hs-var">ie</span></a></span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363102"><span class="hs-identifier hs-var">all_avails</span></a></span><span>
</span><span id="line-1181"></span><span>              </span><span class="annot"><span class="annottext">IELookupError
</span><a href="GHC.Rename.Names.html#IllegalImport"><span class="hs-identifier hs-var">IllegalImport</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Rename.Names.html#illegalImportItemErr"><span class="hs-identifier hs-var">illegalImportItemErr</span></a></span><span>
</span><span id="line-1182"></span><span>              </span><span class="annot"><a href="GHC.Rename.Names.html#QualImportError"><span class="hs-identifier hs-type">QualImportError</span></a></span><span> </span><span id="local-6989586621681363022"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363022"><span class="hs-identifier hs-var">rdr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; SDoc
</span><a href="GHC.Rename.Names.html#qualImportItemErr"><span class="hs-identifier hs-var">qualImportItemErr</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363022"><span class="hs-identifier hs-var">rdr</span></a></span><span>
</span><span id="line-1183"></span><span>              </span><span class="annot"><a href="GHC.Rename.Names.html#AmbiguousImport"><span class="hs-identifier hs-type">AmbiguousImport</span></a></span><span> </span><span id="local-6989586621681363020"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363020"><span class="hs-identifier hs-var">rdr</span></a></span></span><span> </span><span id="local-6989586621681363019"><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363019"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; [AvailInfo] -&gt; SDoc
</span><a href="GHC.Rename.Names.html#ambiguousImportItemErr"><span class="hs-identifier hs-var">ambiguousImportItemErr</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681363020"><span class="hs-identifier hs-var">rdr</span></a></span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681363019"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1184"></span><span>
</span><span id="line-1185"></span><span>        </span><span class="hs-comment">-- For each import item, we convert its RdrNames to Names,</span><span>
</span><span id="line-1186"></span><span>        </span><span class="hs-comment">-- and at the same time construct an AvailInfo corresponding</span><span>
</span><span id="line-1187"></span><span>        </span><span class="hs-comment">-- to what is actually imported by this item.</span><span>
</span><span id="line-1188"></span><span>        </span><span class="hs-comment">-- Returns Nothing on error.</span><span>
</span><span id="line-1189"></span><span>        </span><span class="hs-comment">-- We return a list here, because in the case of an import</span><span>
</span><span id="line-1190"></span><span>        </span><span class="hs-comment">-- item like C, if we are hiding, then C refers to *both* a</span><span>
</span><span id="line-1191"></span><span>        </span><span class="hs-comment">-- type/class and a data constructor.  Moreover, when we import</span><span>
</span><span id="line-1192"></span><span>        </span><span class="hs-comment">-- data constructors of an associated family, we need separate</span><span>
</span><span id="line-1193"></span><span>        </span><span class="hs-comment">-- AvailInfos for the data constructors and the family (as they have</span><span>
</span><span id="line-1194"></span><span>        </span><span class="hs-comment">-- different parents).  See Note [Dealing with imports]</span><span>
</span><span id="line-1195"></span><span>    </span><span class="annot"><a href="#local-6989586621681363049"><span class="hs-identifier hs-type">lookup_ie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-1196"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#IELookupM"><span class="hs-identifier hs-type">IELookupM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Names.html#IELookupWarning"><span class="hs-identifier hs-type">IELookupWarning</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1197"></span><span>    </span><span id="local-6989586621681363049"><span class="annot"><span class="annottext">lookup_ie :: IE GhcPs -&gt; IELookupM ([(IE GhcRn, AvailInfo)], [IELookupWarning])
</span><a href="#local-6989586621681363049"><span class="hs-identifier hs-var hs-var">lookup_ie</span></a></span></span><span> </span><span id="local-6989586621681363017"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363017"><span class="hs-identifier hs-var">ie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IELookupM ([(IE GhcRn, AvailInfo)], [IELookupWarning])
-&gt; IELookupM ([(IE GhcRn, AvailInfo)], [IELookupWarning])
</span><a href="#local-6989586621681363016"><span class="hs-identifier hs-var">handle_bad_import</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1198"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363017"><span class="hs-identifier hs-var">ie</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1199"></span><span>        </span><span class="annot"><a href="GHC.Hs.ImpExp.html#IEVar"><span class="hs-identifier hs-type">IEVar</span></a></span><span> </span><span class="annot"><span class="annottext">XIEVar GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681363014"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681363014"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681363013"><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681363013"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1200"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621681363012"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363012"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363011"><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363011"><span class="hs-identifier hs-var">avail</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IE GhcPs -&gt; RdrName -&gt; IELookupM (Name, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681363073"><span class="hs-identifier hs-var">lookup_name</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363017"><span class="hs-identifier hs-var">ie</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. IEWrappedName name -&gt; name
</span><a href="GHC.Hs.ImpExp.html#ieWrappedName"><span class="hs-identifier hs-var">ieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681363013"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1201"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass. XIEVar pass -&gt; LIEWrappedName (IdP pass) -&gt; IE pass
</span><a href="GHC.Hs.ImpExp.html#IEVar"><span class="hs-identifier hs-var">IEVar</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681363014"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name1 name2.
IEWrappedName name1 -&gt; name2 -&gt; IEWrappedName name2
</span><a href="GHC.Hs.ImpExp.html#replaceWrappedName"><span class="hs-identifier hs-var">replaceWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681363013"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363012"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1202"></span><span>                                                  </span><span class="annot"><span class="annottext">AvailInfo -&gt; Name -&gt; AvailInfo
</span><a href="GHC.Types.Avail.html#trimAvail"><span class="hs-identifier hs-var">trimAvail</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363011"><span class="hs-identifier hs-var">avail</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363012"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1203"></span><span>
</span><span id="line-1204"></span><span>        </span><span class="annot"><a href="GHC.Hs.ImpExp.html#IEThingAll"><span class="hs-identifier hs-type">IEThingAll</span></a></span><span> </span><span class="annot"><span class="annottext">XIEThingAll GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681363006"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681363006"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681363005"><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681363005"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1205"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621681363004"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363004"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363003"><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363003"><span class="hs-identifier hs-var">avail</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681363002"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681363002"><span class="hs-identifier hs-var">mb_parent</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IE GhcPs -&gt; RdrName -&gt; IELookupM (Name, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681363073"><span class="hs-identifier hs-var">lookup_name</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363017"><span class="hs-identifier hs-var">ie</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. IEWrappedName name -&gt; name
</span><a href="GHC.Hs.ImpExp.html#ieWrappedName"><span class="hs-identifier hs-var">ieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681363005"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1206"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681363001"><span class="annot"><span class="annottext">warns :: [IELookupWarning]
</span><a href="#local-6989586621681363001"><span class="hs-identifier hs-var hs-var">warns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363003"><span class="hs-identifier hs-var">avail</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1207"></span><span>                          </span><span class="annot"><a href="GHC.Types.Avail.html#Avail"><span class="hs-identifier hs-type">Avail</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>                     </span><span class="hs-comment">-- e.g. f(..)</span><span>
</span><span id="line-1208"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RdrName -&gt; IELookupWarning
</span><a href="GHC.Rename.Names.html#DodgyImport"><span class="hs-identifier hs-var">DodgyImport</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. IEWrappedName name -&gt; name
</span><a href="GHC.Hs.ImpExp.html#ieWrappedName"><span class="hs-identifier hs-var">ieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681363005"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1209"></span><span>
</span><span id="line-1210"></span><span>                          </span><span class="annot"><a href="GHC.Types.Avail.html#AvailTC"><span class="hs-identifier hs-type">AvailTC</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681362999"><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362999"><span class="hs-identifier hs-var">subs</span></a></span></span><span>
</span><span id="line-1211"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-List.html#drop"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362999"><span class="hs-identifier hs-var">subs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- e.g. T(..) where T is a synonym</span><span>
</span><span id="line-1212"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RdrName -&gt; IELookupWarning
</span><a href="GHC.Rename.Names.html#DodgyImport"><span class="hs-identifier hs-var">DodgyImport</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. IEWrappedName name -&gt; name
</span><a href="GHC.Hs.ImpExp.html#ieWrappedName"><span class="hs-identifier hs-var">ieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681363005"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1213"></span><span>
</span><span id="line-1214"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ImpDeclSpec -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#is_qual"><span class="hs-identifier hs-var">is_qual</span></a></span><span> </span><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681363115"><span class="hs-identifier hs-var">decl_spec</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- e.g. import M( T(..) )</span><span>
</span><span id="line-1215"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IELookupWarning
</span><a href="GHC.Rename.Names.html#MissingImportList"><span class="hs-identifier hs-var">MissingImportList</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1216"></span><span>
</span><span id="line-1217"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1218"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1219"></span><span>
</span><span id="line-1220"></span><span>                </span><span id="local-6989586621681362997"><span class="annot"><span class="annottext">renamed_ie :: IE GhcRn
</span><a href="#local-6989586621681362997"><span class="hs-identifier hs-var hs-var">renamed_ie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall pass.
XIEThingAll pass -&gt; LIEWrappedName (IdP pass) -&gt; IE pass
</span><a href="GHC.Hs.ImpExp.html#IEThingAll"><span class="hs-identifier hs-var">IEThingAll</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681363006"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name1 name2.
IEWrappedName name1 -&gt; name2 -&gt; IEWrappedName name2
</span><a href="GHC.Hs.ImpExp.html#replaceWrappedName"><span class="hs-identifier hs-var">replaceWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681363005"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363004"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1221"></span><span>                </span><span id="local-6989586621681362995"><span class="annot"><span class="annottext">sub_avails :: [(IE GhcRn, AvailInfo)]
</span><a href="#local-6989586621681362995"><span class="hs-identifier hs-var hs-var">sub_avails</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363003"><span class="hs-identifier hs-var">avail</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1222"></span><span>                               </span><span class="annot"><a href="GHC.Types.Avail.html#Avail"><span class="hs-identifier hs-type">Avail</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1223"></span><span>                               </span><span class="annot"><a href="GHC.Types.Avail.html#AvailTC"><span class="hs-identifier hs-type">AvailTC</span></a></span><span> </span><span id="local-6989586621681362994"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362994"><span class="hs-identifier hs-var">name2</span></a></span></span><span> </span><span id="local-6989586621681362993"><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362993"><span class="hs-identifier hs-var">subs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">IE GhcRn
</span><a href="#local-6989586621681362997"><span class="hs-identifier hs-var">renamed_ie</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [GreName] -&gt; AvailInfo
</span><a href="GHC.Types.Avail.html#AvailTC"><span class="hs-identifier hs-var">AvailTC</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362994"><span class="hs-identifier hs-var">name2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362993"><span class="hs-identifier hs-var">subs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/Data-OldList.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; GreName
</span><a href="GHC.Types.Avail.html#NormalGreName"><span class="hs-identifier hs-var">NormalGreName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363004"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1224"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681363002"><span class="hs-identifier hs-var">mb_parent</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1225"></span><span>              </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">IE GhcRn
</span><a href="#local-6989586621681362997"><span class="hs-identifier hs-var">renamed_ie</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681363003"><span class="hs-identifier hs-var">avail</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[IELookupWarning]
</span><a href="#local-6989586621681363001"><span class="hs-identifier hs-var">warns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1226"></span><span>                             </span><span class="hs-comment">-- non-associated ty/cls</span><span>
</span><span id="line-1227"></span><span>              </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681362992"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362992"><span class="hs-identifier hs-var">parent</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">IE GhcRn
</span><a href="#local-6989586621681362997"><span class="hs-identifier hs-var">renamed_ie</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [GreName] -&gt; AvailInfo
</span><a href="GHC.Types.Avail.html#AvailTC"><span class="hs-identifier hs-var">AvailTC</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362992"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; GreName
</span><a href="GHC.Types.Avail.html#NormalGreName"><span class="hs-identifier hs-var">NormalGreName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681363004"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(IE GhcRn, AvailInfo)]
</span><a href="#local-6989586621681362995"><span class="hs-identifier hs-var">sub_avails</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[IELookupWarning]
</span><a href="#local-6989586621681363001"><span class="hs-identifier hs-var">warns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1228"></span><span>                             </span><span class="hs-comment">-- associated type</span><span>
</span><span id="line-1229"></span><span>
</span><span id="line-1230"></span><span>        </span><span class="annot"><a href="GHC.Hs.ImpExp.html#IEThingAbs"><span class="hs-identifier hs-type">IEThingAbs</span></a></span><span> </span><span class="annot"><span class="annottext">XIEThingAbs GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681362990"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362990"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681362989"><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681362989"><span class="hs-identifier hs-var">tc'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1231"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363114"><span class="hs-identifier hs-var">want_hiding</span></a></span><span>   </span><span class="hs-comment">-- hiding ( C )</span><span>
</span><span id="line-1232"></span><span>                       </span><span class="hs-comment">-- Here the 'C' can be a data constructor</span><span>
</span><span id="line-1233"></span><span>                       </span><span class="hs-comment">--  *or* a type/class, or even both</span><span>
</span><span id="line-1234"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681362988"><span class="annot"><span class="annottext">tc :: RdrName
</span><a href="#local-6989586621681362988"><span class="hs-identifier hs-var hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall name. IEWrappedName name -&gt; name
</span><a href="GHC.Hs.ImpExp.html#ieWrappedName"><span class="hs-identifier hs-var">ieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681362989"><span class="hs-identifier hs-var">tc'</span></a></span><span>
</span><span id="line-1235"></span><span>                   </span><span id="local-6989586621681362987"><span class="annot"><span class="annottext">tc_name :: IELookupM (Name, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681362987"><span class="hs-identifier hs-var hs-var">tc_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IE GhcPs -&gt; RdrName -&gt; IELookupM (Name, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681363073"><span class="hs-identifier hs-var">lookup_name</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363017"><span class="hs-identifier hs-var">ie</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681362988"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-1236"></span><span>                   </span><span id="local-6989586621681362986"><span class="annot"><span class="annottext">dc_name :: IELookupM (Name, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681362986"><span class="hs-identifier hs-var hs-var">dc_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IE GhcPs -&gt; RdrName -&gt; IELookupM (Name, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681363073"><span class="hs-identifier hs-var">lookup_name</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363017"><span class="hs-identifier hs-var">ie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName -&gt; NameSpace -&gt; RdrName
</span><a href="GHC.Parser.PostProcess.html#setRdrNameSpace"><span class="hs-identifier hs-var">setRdrNameSpace</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681362988"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><a href="GHC.Types.Name.Occurrence.html#srcDataName"><span class="hs-identifier hs-var">srcDataName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1237"></span><span>               </span><span class="hs-keyword">in</span><span>
</span><span id="line-1238"></span><span>               </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. [IELookupM a] -&gt; [a]
</span><a href="GHC.Rename.Names.html#catIELookupM"><span class="hs-identifier hs-var">catIELookupM</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">IELookupM (Name, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681362987"><span class="hs-identifier hs-var">tc_name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IELookupM (Name, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681362986"><span class="hs-identifier hs-var">dc_name</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1239"></span><span>                 </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. IELookupError -&gt; IELookupM a
</span><a href="GHC.Rename.Names.html#failLookupWith"><span class="hs-identifier hs-var">failLookupWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IE GhcPs -&gt; IELookupError
</span><a href="GHC.Rename.Names.html#BadImport"><span class="hs-identifier hs-var">BadImport</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363017"><span class="hs-identifier hs-var">ie</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1240"></span><span>                 </span><span id="local-6989586621681362983"><span class="annot"><span class="annottext">[(Name, AvailInfo, Maybe Name)]
</span><a href="#local-6989586621681362983"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall {pass} {a} {name1}.
(IdP pass ~ Name, XIEThingAbs pass ~ EpAnn a) =&gt;
IEWrappedName name1
-&gt; SrcSpanAnnA
-&gt; (Name, AvailInfo, Maybe Name)
-&gt; (IE pass, AvailInfo)
</span><a href="#local-6989586621681362982"><span class="hs-identifier hs-var">mkIEThingAbs</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681362989"><span class="hs-identifier hs-var">tc'</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362990"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(Name, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681362981"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681362981"><span class="annot"><span class="annottext">(Name, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681362981"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Name, AvailInfo, Maybe Name)]
</span><a href="#local-6989586621681362983"><span class="hs-identifier hs-var">names</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1241"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1242"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681362980"><span class="annot"><span class="annottext">(Name, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681362980"><span class="hs-identifier hs-var">nameAvail</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IE GhcPs -&gt; RdrName -&gt; IELookupM (Name, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681363073"><span class="hs-identifier hs-var">lookup_name</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681363017"><span class="hs-identifier hs-var">ie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. IEWrappedName name -&gt; name
</span><a href="GHC.Hs.ImpExp.html#ieWrappedName"><span class="hs-identifier hs-var">ieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681362989"><span class="hs-identifier hs-var">tc'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1243"></span><span>                  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall {pass} {a} {name1}.
(IdP pass ~ Name, XIEThingAbs pass ~ EpAnn a) =&gt;
IEWrappedName name1
-&gt; SrcSpanAnnA
-&gt; (Name, AvailInfo, Maybe Name)
-&gt; (IE pass, AvailInfo)
</span><a href="#local-6989586621681362982"><span class="hs-identifier hs-var">mkIEThingAbs</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681362989"><span class="hs-identifier hs-var">tc'</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362990"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(Name, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681362980"><span class="hs-identifier hs-var">nameAvail</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1244"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1245"></span><span>
</span><span id="line-1246"></span><span>        </span><span class="annot"><a href="GHC.Hs.ImpExp.html#IEThingWith"><span class="hs-identifier hs-type">IEThingWith</span></a></span><span> </span><span id="local-6989586621681362978"><span class="annot"><span class="annottext">XIEThingWith GhcPs
</span><a href="#local-6989586621681362978"><span class="hs-identifier hs-var">xt</span></a></span></span><span> </span><span id="local-6989586621681362977"><span class="annot"><span class="annottext">ltc :: GenLocated SrcSpanAnnA (IEWrappedName (IdP GhcPs))
</span><a href="#local-6989586621681362977"><span class="hs-identifier hs-var">ltc</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681362976"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362976"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681362975"><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681362975"><span class="hs-identifier hs-var">rdr_tc</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681362974"><span class="annot"><span class="annottext">IEWildcard
</span><a href="#local-6989586621681362974"><span class="hs-identifier hs-var">wc</span></a></span></span><span> </span><span id="local-6989586621681362973"><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (IEWrappedName (IdP GhcPs))]
</span><a href="#local-6989586621681362973"><span class="hs-identifier hs-var">rdr_ns</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1247"></span><span>           </span><span class="hs-special">(</span><span id="local-6989586621681362972"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362972"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681362971"><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681362971"><span class="hs-identifier hs-var">avail</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681362970"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681362970"><span class="hs-identifier hs-var">mb_parent</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1248"></span><span>               </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IE GhcPs -&gt; RdrName -&gt; IELookupM (Name, AvailInfo, Maybe Name)
</span><a href="#local-6989586621681363073"><span class="hs-identifier hs-var">lookup_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass.
XIEThingAbs pass -&gt; LIEWrappedName (IdP pass) -&gt; IE pass
</span><a href="GHC.Hs.ImpExp.html#IEThingAbs"><span class="hs-identifier hs-var">IEThingAbs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (IEWrappedName (IdP GhcPs))
</span><a href="#local-6989586621681362977"><span class="hs-identifier hs-var">ltc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. IEWrappedName name -&gt; name
</span><a href="GHC.Hs.ImpExp.html#ieWrappedName"><span class="hs-identifier hs-var">ieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681362975"><span class="hs-identifier hs-var">rdr_tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1249"></span><span>
</span><span id="line-1250"></span><span>           </span><span class="hs-comment">-- Look up the children in the sub-names of the parent</span><span>
</span><span id="line-1251"></span><span>           </span><span class="hs-comment">-- See Note [Importing DuplicateRecordFields]</span><span>
</span><span id="line-1252"></span><span>           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681362969"><span class="annot"><span class="annottext">subnames :: [GreName]
</span><a href="#local-6989586621681362969"><span class="hs-identifier hs-var hs-var">subnames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AvailInfo -&gt; [GreName]
</span><a href="GHC.Types.Avail.html#availSubordinateGreNames"><span class="hs-identifier hs-var">availSubordinateGreNames</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681362971"><span class="hs-identifier hs-var">avail</span></a></span><span>
</span><span id="line-1253"></span><span>           </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[GreName]
-&gt; [LIEWrappedName RdrName]
-&gt; MaybeErr
     [LIEWrappedName RdrName] ([LocatedA Name], [Located FieldLabel])
</span><a href="GHC.Rename.Names.html#lookupChildren"><span class="hs-identifier hs-var">lookupChildren</span></a></span><span> </span><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362969"><span class="hs-identifier hs-var">subnames</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (IEWrappedName (IdP GhcPs))]
</span><a href="#local-6989586621681362973"><span class="hs-identifier hs-var">rdr_ns</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1254"></span><span>
</span><span id="line-1255"></span><span>             </span><span class="annot"><a href="GHC.Data.Maybe.html#Failed"><span class="hs-identifier hs-type">Failed</span></a></span><span> </span><span id="local-6989586621681362966"><span class="annot"><span class="annottext">[LIEWrappedName RdrName]
</span><a href="#local-6989586621681362966"><span class="hs-identifier hs-var">rdrs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. IELookupError -&gt; IELookupM a
</span><a href="GHC.Rename.Names.html#failLookupWith"><span class="hs-identifier hs-var">failLookupWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IE GhcPs -&gt; IELookupError
</span><a href="GHC.Rename.Names.html#BadImport"><span class="hs-identifier hs-var">BadImport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass.
XIEThingWith pass
-&gt; LIEWrappedName (IdP pass)
-&gt; IEWildcard
-&gt; [LIEWrappedName (IdP pass)]
-&gt; IE pass
</span><a href="GHC.Hs.ImpExp.html#IEThingWith"><span class="hs-identifier hs-var">IEThingWith</span></a></span><span> </span><span class="annot"><span class="annottext">XIEThingWith GhcPs
</span><a href="#local-6989586621681362978"><span class="hs-identifier hs-var">xt</span></a></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (IEWrappedName (IdP GhcPs))
</span><a href="#local-6989586621681362977"><span class="hs-identifier hs-var">ltc</span></a></span><span> </span><span class="annot"><span class="annottext">IEWildcard
</span><a href="#local-6989586621681362974"><span class="hs-identifier hs-var">wc</span></a></span><span> </span><span class="annot"><span class="annottext">[LIEWrappedName RdrName]
</span><a href="#local-6989586621681362966"><span class="hs-identifier hs-var">rdrs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1256"></span><span>                                </span><span class="hs-comment">-- We are trying to import T( a,b,c,d ), and failed</span><span>
</span><span id="line-1257"></span><span>                                </span><span class="hs-comment">-- to find 'b' and 'd'.  So we make up an import item</span><span>
</span><span id="line-1258"></span><span>                                </span><span class="hs-comment">-- to report as failing, namely T( b, d ).</span><span>
</span><span id="line-1259"></span><span>                                </span><span class="hs-comment">-- c.f. #15412</span><span>
</span><span id="line-1260"></span><span>
</span><span id="line-1261"></span><span>             </span><span class="annot"><a href="GHC.Data.Maybe.html#Succeeded"><span class="hs-identifier hs-type">Succeeded</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681362965"><span class="annot"><span class="annottext">[LocatedA Name]
</span><a href="#local-6989586621681362965"><span class="hs-identifier hs-var">childnames</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681362964"><span class="annot"><span class="annottext">[Located FieldLabel]
</span><a href="#local-6989586621681362964"><span class="hs-identifier hs-var">childflds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1262"></span><span>               </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621681362970"><span class="hs-identifier hs-var">mb_parent</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1263"></span><span>                 </span><span class="hs-comment">-- non-associated ty/cls</span><span>
</span><span id="line-1264"></span><span>                 </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1265"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass.
XIEThingWith pass
-&gt; LIEWrappedName (IdP pass)
-&gt; IEWildcard
-&gt; [LIEWrappedName (IdP pass)]
-&gt; IE pass
</span><a href="GHC.Hs.ImpExp.html#IEThingWith"><span class="hs-identifier hs-var">IEThingWith</span></a></span><span> </span><span class="annot"><span class="annottext">[Located FieldLabel]
</span><a href="#local-6989586621681362964"><span class="hs-identifier hs-var">childflds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362976"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName Name
</span><a href="#local-6989586621681362963"><span class="hs-identifier hs-var">name'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IEWildcard
</span><a href="#local-6989586621681362974"><span class="hs-identifier hs-var">wc</span></a></span><span> </span><span class="annot"><span class="annottext">[LIEWrappedName Name]
</span><a href="#local-6989586621681362962"><span class="hs-identifier hs-var">childnames'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1266"></span><span>                               </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [FieldLabel] -&gt; AvailInfo
</span><a href="GHC.Types.Avail.html#availTC"><span class="hs-identifier hs-var">availTC</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362972"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362972"><span class="hs-identifier hs-var">name</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">[LocatedA Name]
</span><a href="#local-6989586621681362965"><span class="hs-identifier hs-var">childnames</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Located FieldLabel]
</span><a href="#local-6989586621681362964"><span class="hs-identifier hs-var">childflds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-1267"></span><span>                              </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1268"></span><span>                   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681362963"><span class="annot"><span class="annottext">name' :: IEWrappedName Name
</span><a href="#local-6989586621681362963"><span class="hs-identifier hs-var hs-var">name'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall name1 name2.
IEWrappedName name1 -&gt; name2 -&gt; IEWrappedName name2
</span><a href="GHC.Hs.ImpExp.html#replaceWrappedName"><span class="hs-identifier hs-var">replaceWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681362975"><span class="hs-identifier hs-var">rdr_tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362972"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1269"></span><span>                         </span><span id="local-6989586621681362962"><span class="annot"><span class="annottext">childnames' :: [LIEWrappedName Name]
</span><a href="#local-6989586621681362962"><span class="hs-identifier hs-var hs-var">childnames'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall name.
HasOccName name =&gt;
LocatedA name -&gt; LIEWrappedName name
</span><a href="GHC.Rename.Names.html#to_ie_post_rn"><span class="hs-identifier hs-var">to_ie_post_rn</span></a></span><span> </span><span class="annot"><span class="annottext">[LocatedA Name]
</span><a href="#local-6989586621681362965"><span class="hs-identifier hs-var">childnames</span></a></span><span>
</span><span id="line-1270"></span><span>                         </span><span class="hs-comment">-- childnames' = postrn_ies childnames</span><span>
</span><span id="line-1271"></span><span>                 </span><span class="hs-comment">-- associated ty</span><span>
</span><span id="line-1272"></span><span>                 </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681362960"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362960"><span class="hs-identifier hs-var">parent</span></a></span></span><span>
</span><span id="line-1273"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass.
XIEThingWith pass
-&gt; LIEWrappedName (IdP pass)
-&gt; IEWildcard
-&gt; [LIEWrappedName (IdP pass)]
-&gt; IE pass
</span><a href="GHC.Hs.ImpExp.html#IEThingWith"><span class="hs-identifier hs-var">IEThingWith</span></a></span><span> </span><span class="annot"><span class="annottext">[Located FieldLabel]
</span><a href="#local-6989586621681362964"><span class="hs-identifier hs-var">childflds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362976"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName Name
</span><a href="#local-6989586621681362959"><span class="hs-identifier hs-var">name'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IEWildcard
</span><a href="#local-6989586621681362974"><span class="hs-identifier hs-var">wc</span></a></span><span> </span><span class="annot"><span class="annottext">[LIEWrappedName Name]
</span><a href="#local-6989586621681362958"><span class="hs-identifier hs-var">childnames'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1274"></span><span>                                </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [FieldLabel] -&gt; AvailInfo
</span><a href="GHC.Types.Avail.html#availTC"><span class="hs-identifier hs-var">availTC</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362972"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">[LocatedA Name]
</span><a href="#local-6989586621681362965"><span class="hs-identifier hs-var">childnames</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Located FieldLabel]
</span><a href="#local-6989586621681362964"><span class="hs-identifier hs-var">childflds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1275"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass.
XIEThingWith pass
-&gt; LIEWrappedName (IdP pass)
-&gt; IEWildcard
-&gt; [LIEWrappedName (IdP pass)]
-&gt; IE pass
</span><a href="GHC.Hs.ImpExp.html#IEThingWith"><span class="hs-identifier hs-var">IEThingWith</span></a></span><span> </span><span class="annot"><span class="annottext">[Located FieldLabel]
</span><a href="#local-6989586621681362964"><span class="hs-identifier hs-var">childflds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362976"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName Name
</span><a href="#local-6989586621681362959"><span class="hs-identifier hs-var">name'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IEWildcard
</span><a href="#local-6989586621681362974"><span class="hs-identifier hs-var">wc</span></a></span><span> </span><span class="annot"><span class="annottext">[LIEWrappedName Name]
</span><a href="#local-6989586621681362958"><span class="hs-identifier hs-var">childnames'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1276"></span><span>                                </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [FieldLabel] -&gt; AvailInfo
</span><a href="GHC.Types.Avail.html#availTC"><span class="hs-identifier hs-var">availTC</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362960"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362972"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-1277"></span><span>                              </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1278"></span><span>                   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681362959"><span class="annot"><span class="annottext">name' :: IEWrappedName Name
</span><a href="#local-6989586621681362959"><span class="hs-identifier hs-var hs-var">name'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall name1 name2.
IEWrappedName name1 -&gt; name2 -&gt; IEWrappedName name2
</span><a href="GHC.Hs.ImpExp.html#replaceWrappedName"><span class="hs-identifier hs-var">replaceWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName (IdP GhcPs)
</span><a href="#local-6989586621681362975"><span class="hs-identifier hs-var">rdr_tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362972"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1279"></span><span>                         </span><span id="local-6989586621681362958"><span class="annot"><span class="annottext">childnames' :: [LIEWrappedName Name]
</span><a href="#local-6989586621681362958"><span class="hs-identifier hs-var hs-var">childnames'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall name.
HasOccName name =&gt;
LocatedA name -&gt; LIEWrappedName name
</span><a href="GHC.Rename.Names.html#to_ie_post_rn"><span class="hs-identifier hs-var">to_ie_post_rn</span></a></span><span> </span><span class="annot"><span class="annottext">[LocatedA Name]
</span><a href="#local-6989586621681362965"><span class="hs-identifier hs-var">childnames</span></a></span><span>
</span><span id="line-1280"></span><span>
</span><span id="line-1281"></span><span>        </span><span id="local-6989586621681362957"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681362957"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. IELookupError -&gt; IELookupM a
</span><a href="GHC.Rename.Names.html#failLookupWith"><span class="hs-identifier hs-var">failLookupWith</span></a></span><span> </span><span class="annot"><span class="annottext">IELookupError
</span><a href="GHC.Rename.Names.html#IllegalImport"><span class="hs-identifier hs-var">IllegalImport</span></a></span><span>
</span><span id="line-1282"></span><span>        </span><span class="hs-comment">-- could be IEModuleContents, IEGroup, IEDoc, IEDocNamed</span><span>
</span><span id="line-1283"></span><span>        </span><span class="hs-comment">-- all errors.</span><span>
</span><span id="line-1284"></span><span>
</span><span id="line-1285"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1286"></span><span>        </span><span id="local-6989586621681362982"><span class="annot"><span class="annottext">mkIEThingAbs :: IEWrappedName name1
-&gt; SrcSpanAnnA
-&gt; (Name, AvailInfo, Maybe Name)
-&gt; (IE pass, AvailInfo)
</span><a href="#local-6989586621681362982"><span class="hs-identifier hs-var hs-var">mkIEThingAbs</span></a></span></span><span> </span><span id="local-6989586621681362952"><span class="annot"><span class="annottext">IEWrappedName name1
</span><a href="#local-6989586621681362952"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621681362951"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362951"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681362950"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362950"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681362949"><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681362949"><span class="hs-identifier hs-var">av</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-1287"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass.
XIEThingAbs pass -&gt; LIEWrappedName (IdP pass) -&gt; IE pass
</span><a href="GHC.Hs.ImpExp.html#IEThingAbs"><span class="hs-identifier hs-var">IEThingAbs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362951"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name1 name2.
IEWrappedName name1 -&gt; name2 -&gt; IEWrappedName name2
</span><a href="GHC.Hs.ImpExp.html#replaceWrappedName"><span class="hs-identifier hs-var">replaceWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName name1
</span><a href="#local-6989586621681362952"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362950"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AvailInfo -&gt; Name -&gt; AvailInfo
</span><a href="GHC.Types.Avail.html#trimAvail"><span class="hs-identifier hs-var">trimAvail</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681362949"><span class="hs-identifier hs-var">av</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362950"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1288"></span><span>        </span><span class="annot"><a href="#local-6989586621681362982"><span class="hs-identifier hs-var">mkIEThingAbs</span></a></span><span> </span><span id="local-6989586621681362948"><span class="annot"><span class="annottext">IEWrappedName name1
</span><a href="#local-6989586621681362948"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621681362947"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362947"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681362946"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362946"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681362945"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362945"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1289"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass.
XIEThingAbs pass -&gt; LIEWrappedName (IdP pass) -&gt; IE pass
</span><a href="GHC.Hs.ImpExp.html#IEThingAbs"><span class="hs-identifier hs-var">IEThingAbs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362947"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name1 name2.
IEWrappedName name1 -&gt; name2 -&gt; IEWrappedName name2
</span><a href="GHC.Hs.ImpExp.html#replaceWrappedName"><span class="hs-identifier hs-var">replaceWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">IEWrappedName name1
</span><a href="#local-6989586621681362948"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362946"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1290"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [FieldLabel] -&gt; AvailInfo
</span><a href="GHC.Types.Avail.html#availTC"><span class="hs-identifier hs-var">availTC</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362945"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362946"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1291"></span><span>
</span><span id="line-1292"></span><span>        </span><span id="local-6989586621681363016"><span class="annot"><span class="annottext">handle_bad_import :: IELookupM ([(IE GhcRn, AvailInfo)], [IELookupWarning])
-&gt; IELookupM ([(IE GhcRn, AvailInfo)], [IELookupWarning])
</span><a href="#local-6989586621681363016"><span class="hs-identifier hs-var hs-var">handle_bad_import</span></a></span></span><span> </span><span id="local-6989586621681362944"><span class="annot"><span class="annottext">IELookupM ([(IE GhcRn, AvailInfo)], [IELookupWarning])
</span><a href="#local-6989586621681362944"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
IELookupM a -&gt; (IELookupError -&gt; IELookupM a) -&gt; IELookupM a
</span><a href="GHC.Rename.Names.html#catchIELookup"><span class="hs-identifier hs-var">catchIELookup</span></a></span><span> </span><span class="annot"><span class="annottext">IELookupM ([(IE GhcRn, AvailInfo)], [IELookupWarning])
</span><a href="#local-6989586621681362944"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681362942"><span class="annot"><span class="annottext">IELookupError
</span><a href="#local-6989586621681362942"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IELookupError
</span><a href="#local-6989586621681362942"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1293"></span><span>          </span><span class="annot"><a href="GHC.Rename.Names.html#BadImport"><span class="hs-identifier hs-type">BadImport</span></a></span><span> </span><span id="local-6989586621681362941"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681362941"><span class="hs-identifier hs-var">ie</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681363114"><span class="hs-identifier hs-var">want_hiding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">IE GhcPs -&gt; IELookupWarning
</span><a href="GHC.Rename.Names.html#BadImportW"><span class="hs-identifier hs-var">BadImportW</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681362941"><span class="hs-identifier hs-var">ie</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1294"></span><span>          </span><span class="annot"><span class="annottext">IELookupError
</span><span class="hs-identifier">_</span></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. IELookupError -&gt; IELookupM a
</span><a href="GHC.Rename.Names.html#failLookupWith"><span class="hs-identifier hs-var">failLookupWith</span></a></span><span> </span><span class="annot"><span class="annottext">IELookupError
</span><a href="#local-6989586621681362942"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-1295"></span><span>
</span><span id="line-1296"></span><span class="hs-keyword">type</span><span> </span><span id="IELookupM"><span class="annot"><a href="GHC.Rename.Names.html#IELookupM"><span class="hs-identifier hs-var">IELookupM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html#MaybeErr"><span class="hs-identifier hs-type">MaybeErr</span></a></span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#IELookupError"><span class="hs-identifier hs-type">IELookupError</span></a></span><span>
</span><span id="line-1297"></span><span>
</span><span id="line-1298"></span><span class="hs-keyword">data</span><span> </span><span id="IELookupWarning"><span class="annot"><a href="GHC.Rename.Names.html#IELookupWarning"><span class="hs-identifier hs-var">IELookupWarning</span></a></span></span><span>
</span><span id="line-1299"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="BadImportW"><span class="annot"><a href="GHC.Rename.Names.html#BadImportW"><span class="hs-identifier hs-var">BadImportW</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1300"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MissingImportList"><span class="annot"><a href="GHC.Rename.Names.html#MissingImportList"><span class="hs-identifier hs-var">MissingImportList</span></a></span></span><span>
</span><span id="line-1301"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DodgyImport"><span class="annot"><a href="GHC.Rename.Names.html#DodgyImport"><span class="hs-identifier hs-var">DodgyImport</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span>
</span><span id="line-1302"></span><span>  </span><span class="hs-comment">-- NB. use the RdrName for reporting a &quot;dodgy&quot; import</span><span>
</span><span id="line-1303"></span><span>
</span><span id="line-1304"></span><span class="hs-keyword">data</span><span> </span><span id="IELookupError"><span class="annot"><a href="GHC.Rename.Names.html#IELookupError"><span class="hs-identifier hs-var">IELookupError</span></a></span></span><span>
</span><span id="line-1305"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="QualImportError"><span class="annot"><a href="GHC.Rename.Names.html#QualImportError"><span class="hs-identifier hs-var">QualImportError</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span>
</span><span id="line-1306"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="BadImport"><span class="annot"><a href="GHC.Rename.Names.html#BadImport"><span class="hs-identifier hs-var">BadImport</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1307"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="IllegalImport"><span class="annot"><a href="GHC.Rename.Names.html#IllegalImport"><span class="hs-identifier hs-var">IllegalImport</span></a></span></span><span>
</span><span id="line-1308"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AmbiguousImport"><span class="annot"><a href="GHC.Rename.Names.html#AmbiguousImport"><span class="hs-identifier hs-var">AmbiguousImport</span></a></span></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- e.g. a duplicated field name as a top-level import</span><span>
</span><span id="line-1309"></span><span>
</span><span id="line-1310"></span><span id="local-6989586621681364249"><span class="annot"><a href="GHC.Rename.Names.html#failLookupWith"><span class="hs-identifier hs-type">failLookupWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#IELookupError"><span class="hs-identifier hs-type">IELookupError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#IELookupM"><span class="hs-identifier hs-type">IELookupM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681364249"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1311"></span><span id="failLookupWith"><span class="annot"><span class="annottext">failLookupWith :: forall a. IELookupError -&gt; IELookupM a
</span><a href="GHC.Rename.Names.html#failLookupWith"><span class="hs-identifier hs-var hs-var">failLookupWith</span></a></span></span><span> </span><span id="local-6989586621681362940"><span class="annot"><span class="annottext">IELookupError
</span><a href="#local-6989586621681362940"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall err val. err -&gt; MaybeErr err val
</span><a href="GHC.Data.Maybe.html#Failed"><span class="hs-identifier hs-var">Failed</span></a></span><span> </span><span class="annot"><span class="annottext">IELookupError
</span><a href="#local-6989586621681362940"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-1312"></span><span>
</span><span id="line-1313"></span><span id="local-6989586621681364211"><span class="annot"><a href="GHC.Rename.Names.html#catchIELookup"><span class="hs-identifier hs-type">catchIELookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#IELookupM"><span class="hs-identifier hs-type">IELookupM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681364211"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Rename.Names.html#IELookupError"><span class="hs-identifier hs-type">IELookupError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#IELookupM"><span class="hs-identifier hs-type">IELookupM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681364211"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#IELookupM"><span class="hs-identifier hs-type">IELookupM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681364211"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1314"></span><span id="catchIELookup"><span class="annot"><span class="annottext">catchIELookup :: forall a.
IELookupM a -&gt; (IELookupError -&gt; IELookupM a) -&gt; IELookupM a
</span><a href="GHC.Rename.Names.html#catchIELookup"><span class="hs-identifier hs-var hs-var">catchIELookup</span></a></span></span><span> </span><span id="local-6989586621681362938"><span class="annot"><span class="annottext">IELookupM a
</span><a href="#local-6989586621681362938"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681362937"><span class="annot"><span class="annottext">IELookupError -&gt; IELookupM a
</span><a href="#local-6989586621681362937"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IELookupM a
</span><a href="#local-6989586621681362938"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1315"></span><span>  </span><span class="annot"><a href="GHC.Data.Maybe.html#Succeeded"><span class="hs-identifier hs-type">Succeeded</span></a></span><span> </span><span id="local-6989586621681362936"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681362936"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681362936"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1316"></span><span>  </span><span class="annot"><a href="GHC.Data.Maybe.html#Failed"><span class="hs-identifier hs-type">Failed</span></a></span><span> </span><span id="local-6989586621681362935"><span class="annot"><span class="annottext">IELookupError
</span><a href="#local-6989586621681362935"><span class="hs-identifier hs-var">err</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IELookupError -&gt; IELookupM a
</span><a href="#local-6989586621681362937"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">IELookupError
</span><a href="#local-6989586621681362935"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-1317"></span><span>
</span><span id="line-1318"></span><span id="local-6989586621681364218"><span class="annot"><a href="GHC.Rename.Names.html#catIELookupM"><span class="hs-identifier hs-type">catIELookupM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Names.html#IELookupM"><span class="hs-identifier hs-type">IELookupM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681364218"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681364218"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1319"></span><span id="catIELookupM"><span class="annot"><span class="annottext">catIELookupM :: forall a. [IELookupM a] -&gt; [a]
</span><a href="GHC.Rename.Names.html#catIELookupM"><span class="hs-identifier hs-var hs-var">catIELookupM</span></a></span></span><span> </span><span id="local-6989586621681362934"><span class="annot"><span class="annottext">[IELookupM a]
</span><a href="#local-6989586621681362934"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681362933"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html#Succeeded"><span class="hs-identifier hs-type">Succeeded</span></a></span><span> </span><span id="local-6989586621681362933"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681362933"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[IELookupM a]
</span><a href="#local-6989586621681362934"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1320"></span><span>
</span><span id="line-1321"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Import/Export Utils}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1328"></span><span>
</span><span id="line-1329"></span><span class="hs-comment">-- | Given an import\/export spec, construct the appropriate 'GlobalRdrElt's.</span><span>
</span><span id="line-1330"></span><span class="annot"><a href="GHC.Rename.Names.html#gresFromIE"><span class="hs-identifier hs-type">gresFromIE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#ImpDeclSpec"><span class="hs-identifier hs-type">ImpDeclSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LIE"><span class="hs-identifier hs-type">LIE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1331"></span><span id="gresFromIE"><span class="annot"><span class="annottext">gresFromIE :: ImpDeclSpec -&gt; (LIE GhcRn, AvailInfo) -&gt; [GlobalRdrElt]
</span><a href="GHC.Rename.Names.html#gresFromIE"><span class="hs-identifier hs-var hs-var">gresFromIE</span></a></span></span><span> </span><span id="local-6989586621681362932"><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681362932"><span class="hs-identifier hs-var">decl_spec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681362931"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362931"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621681362930"><span class="annot"><span class="annottext">IE GhcRn
</span><a href="#local-6989586621681362930"><span class="hs-identifier hs-var">ie</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681362929"><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681362929"><span class="hs-identifier hs-var">avail</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1332"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Maybe ImportSpec) -&gt; AvailInfo -&gt; [GlobalRdrElt]
</span><a href="GHC.Types.Name.Reader.html#gresFromAvail"><span class="hs-identifier hs-var">gresFromAvail</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe ImportSpec
</span><a href="#local-6989586621681362927"><span class="hs-identifier hs-var">prov_fn</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681362929"><span class="hs-identifier hs-var">avail</span></a></span><span>
</span><span id="line-1333"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1334"></span><span>    </span><span id="local-6989586621681362926"><span class="annot"><span class="annottext">is_explicit :: Name -&gt; Bool
</span><a href="#local-6989586621681362926"><span class="hs-identifier hs-var hs-var">is_explicit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IE GhcRn
</span><a href="#local-6989586621681362930"><span class="hs-identifier hs-var">ie</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1335"></span><span>                    </span><span class="annot"><a href="GHC.Hs.ImpExp.html#IEThingAll"><span class="hs-identifier hs-type">IEThingAll</span></a></span><span> </span><span class="annot"><span class="annottext">XIEThingAll GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681362925"><span class="annot"><span class="annottext">LIEWrappedName (IdP GhcRn)
</span><a href="#local-6989586621681362925"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681362924"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362924"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362924"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall name. LIEWrappedName name -&gt; name
</span><a href="GHC.Hs.ImpExp.html#lieWrappedName"><span class="hs-identifier hs-var">lieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName (IdP GhcRn)
</span><a href="#local-6989586621681362925"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1336"></span><span>                    </span><span class="annot"><span class="annottext">IE GhcRn
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1337"></span><span>    </span><span id="local-6989586621681362927"><span class="annot"><span class="annottext">prov_fn :: Name -&gt; Maybe ImportSpec
</span><a href="#local-6989586621681362927"><span class="hs-identifier hs-var hs-var">prov_fn</span></a></span></span><span> </span><span id="local-6989586621681362922"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362922"><span class="hs-identifier hs-var">name</span></a></span></span><span>
</span><span id="line-1338"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Reader.html#ImpSpec"><span class="hs-identifier hs-type">ImpSpec</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">is_decl :: ImpDeclSpec
</span><a href="GHC.Types.Name.Reader.html#is_decl"><span class="hs-identifier hs-var">is_decl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681362932"><span class="hs-identifier hs-var">decl_spec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">is_item :: ImpItemSpec
</span><a href="GHC.Types.Name.Reader.html#is_item"><span class="hs-identifier hs-var">is_item</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImpItemSpec
</span><a href="#local-6989586621681362921"><span class="hs-identifier hs-var">item_spec</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1339"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1340"></span><span>        </span><span id="local-6989586621681362921"><span class="annot"><span class="annottext">item_spec :: ImpItemSpec
</span><a href="#local-6989586621681362921"><span class="hs-identifier hs-var hs-var">item_spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#ImpSome"><span class="hs-identifier hs-type">ImpSome</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">is_explicit :: Bool
</span><a href="GHC.Types.Name.Reader.html#is_explicit"><span class="hs-identifier hs-var">is_explicit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="#local-6989586621681362926"><span class="hs-identifier hs-var">is_explicit</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362922"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1341"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">is_iloc :: SrcSpan
</span><a href="GHC.Types.Name.Reader.html#is_iloc"><span class="hs-identifier hs-var">is_iloc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362931"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1342"></span><span>
</span><span id="line-1343"></span><span>
</span><span id="line-1344"></span><span class="hs-comment">{-
Note [Children for duplicate record fields]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider the module

    {-# LANGUAGE DuplicateRecordFields #-}
    module M (F(foo, MkFInt, MkFBool)) where
      data family F a
      data instance F Int = MkFInt { foo :: Int }
      data instance F Bool = MkFBool { foo :: Bool }

The `foo` in the export list refers to *both* selectors! For this
reason, lookupChildren builds an environment that maps the FastString
to a list of items, rather than a single item.
-}</span><span>
</span><span id="line-1359"></span><span>
</span><span id="line-1360"></span><span class="annot"><a href="GHC.Rename.Names.html#mkChildEnv"><span class="hs-identifier hs-type">mkChildEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1361"></span><span id="mkChildEnv"><span class="annot"><span class="annottext">mkChildEnv :: [GlobalRdrElt] -&gt; NameEnv [GlobalRdrElt]
</span><a href="GHC.Rename.Names.html#mkChildEnv"><span class="hs-identifier hs-var hs-var">mkChildEnv</span></a></span></span><span> </span><span id="local-6989586621681362917"><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362917"><span class="hs-identifier hs-var">gres</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; NameEnv [GlobalRdrElt] -&gt; NameEnv [GlobalRdrElt]
</span><a href="#local-6989586621681362916"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NameEnv a
</span><a href="GHC.Types.Name.Env.html#emptyNameEnv"><span class="hs-identifier hs-var">emptyNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362917"><span class="hs-identifier hs-var">gres</span></a></span><span>
</span><span id="line-1362"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1363"></span><span>    </span><span id="local-6989586621681362916"><span class="annot"><span class="annottext">add :: GlobalRdrElt -&gt; NameEnv [GlobalRdrElt] -&gt; NameEnv [GlobalRdrElt]
</span><a href="#local-6989586621681362916"><span class="hs-identifier hs-var hs-var">add</span></a></span></span><span> </span><span id="local-6989586621681362914"><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681362914"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span id="local-6989586621681362913"><span class="annot"><span class="annottext">NameEnv [GlobalRdrElt]
</span><a href="#local-6989586621681362913"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Parent
</span><a href="GHC.Types.Name.Reader.html#gre_par"><span class="hs-identifier hs-var">gre_par</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681362914"><span class="hs-identifier hs-var">gre</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1364"></span><span>        </span><span class="annot"><a href="GHC.Types.Name.Reader.html#ParentIs"><span class="hs-identifier hs-type">ParentIs</span></a></span><span>  </span><span id="local-6989586621681362910"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362910"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b.
(a -&gt; b -&gt; b) -&gt; (a -&gt; b) -&gt; NameEnv b -&gt; Name -&gt; a -&gt; NameEnv b
</span><a href="GHC.Types.Name.Env.html#extendNameEnv_Acc"><span class="hs-identifier hs-var">extendNameEnv_Acc</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a]
</span><a href="GHC.Utils.Misc.html#singleton"><span class="hs-identifier hs-var">Utils.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv [GlobalRdrElt]
</span><a href="#local-6989586621681362913"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362910"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681362914"><span class="hs-identifier hs-var">gre</span></a></span><span>
</span><span id="line-1365"></span><span>        </span><span class="annot"><span class="annottext">Parent
</span><a href="GHC.Types.Name.Reader.html#NoParent"><span class="hs-identifier hs-var">NoParent</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NameEnv [GlobalRdrElt]
</span><a href="#local-6989586621681362913"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-1366"></span><span>
</span><span id="line-1367"></span><span id="local-6989586621681364200"><span class="annot"><a href="GHC.Rename.Names.html#findChildren"><span class="hs-identifier hs-type">findChildren</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681364200"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681364200"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1368"></span><span id="findChildren"><span class="annot"><span class="annottext">findChildren :: forall a. NameEnv [a] -&gt; Name -&gt; [a]
</span><a href="GHC.Rename.Names.html#findChildren"><span class="hs-identifier hs-var hs-var">findChildren</span></a></span></span><span> </span><span id="local-6989586621681362906"><span class="annot"><span class="annottext">NameEnv [a]
</span><a href="#local-6989586621681362906"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621681362905"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362905"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NameEnv a -&gt; Name -&gt; Maybe a
</span><a href="GHC.Types.Name.Env.html#lookupNameEnv"><span class="hs-identifier hs-var">lookupNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv [a]
</span><a href="#local-6989586621681362906"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362905"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; a -&gt; a
</span><a href="GHC.Data.Maybe.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1369"></span><span>
</span><span id="line-1370"></span><span class="annot"><a href="GHC.Rename.Names.html#lookupChildren"><span class="hs-identifier hs-type">lookupChildren</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Avail.html#GreName"><span class="hs-identifier hs-type">GreName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LIEWrappedName"><span class="hs-identifier hs-type">LIEWrappedName</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1371"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html#MaybeErr"><span class="hs-identifier hs-type">MaybeErr</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LIEWrappedName"><span class="hs-identifier hs-type">LIEWrappedName</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- The ones for which the lookup failed</span><span>
</span><span id="line-1372"></span><span>                           </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedA"><span class="hs-identifier hs-type">LocatedA</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1373"></span><span class="hs-comment">-- (lookupChildren all_kids rdr_items) maps each rdr_item to its</span><span>
</span><span id="line-1374"></span><span class="hs-comment">-- corresponding Name all_kids, if the former exists</span><span>
</span><span id="line-1375"></span><span class="hs-comment">-- The matching is done by FastString, not OccName, so that</span><span>
</span><span id="line-1376"></span><span class="hs-comment">--    Cls( meth, AssocTy )</span><span>
</span><span id="line-1377"></span><span class="hs-comment">-- will correctly find AssocTy among the all_kids of Cls, even though</span><span>
</span><span id="line-1378"></span><span class="hs-comment">-- the RdrName for AssocTy may have a (bogus) DataName namespace</span><span>
</span><span id="line-1379"></span><span class="hs-comment">-- (Really the rdr_items should be FastStrings in the first place.)</span><span>
</span><span id="line-1380"></span><span id="lookupChildren"><span class="annot"><span class="annottext">lookupChildren :: [GreName]
-&gt; [LIEWrappedName RdrName]
-&gt; MaybeErr
     [LIEWrappedName RdrName] ([LocatedA Name], [Located FieldLabel])
</span><a href="GHC.Rename.Names.html#lookupChildren"><span class="hs-identifier hs-var hs-var">lookupChildren</span></a></span></span><span> </span><span id="local-6989586621681362903"><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362903"><span class="hs-identifier hs-var">all_kids</span></a></span></span><span> </span><span id="local-6989586621681362902"><span class="annot"><span class="annottext">[LIEWrappedName RdrName]
</span><a href="#local-6989586621681362902"><span class="hs-identifier hs-var">rdr_items</span></a></span></span><span>
</span><span id="line-1381"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[LIEWrappedName RdrName]
</span><a href="#local-6989586621681362901"><span class="hs-identifier hs-var">fails</span></a></span><span>
</span><span id="line-1382"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall err val. val -&gt; MaybeErr err val
</span><a href="GHC.Data.Maybe.html#Succeeded"><span class="hs-identifier hs-var">Succeeded</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [Either a b] -&gt; ([a], [b])
</span><a href="../../base-4.16.4.0/src/Data-Either.html#partitionEithers"><span class="hs-identifier hs-var">partitionEithers</span></a></span><span> </span><span class="annot"><span class="annottext">[Either (LocatedA Name) [Located FieldLabel]]
</span><a href="#local-6989586621681362900"><span class="hs-identifier hs-var">oks</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1383"></span><span>       </span><span class="hs-comment">-- This 'fmap concat' trickily applies concat to the /second/ component</span><span>
</span><span id="line-1384"></span><span>       </span><span class="hs-comment">-- of the pair, whose type is ([LocatedA Name], [[Located FieldLabel]])</span><span>
</span><span id="line-1385"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1386"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall err val. err -&gt; MaybeErr err val
</span><a href="GHC.Data.Maybe.html#Failed"><span class="hs-identifier hs-var">Failed</span></a></span><span> </span><span class="annot"><span class="annottext">[LIEWrappedName RdrName]
</span><a href="#local-6989586621681362901"><span class="hs-identifier hs-var">fails</span></a></span><span>
</span><span id="line-1387"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1388"></span><span>    </span><span id="local-6989586621681362899"><span class="annot"><span class="annottext">mb_xs :: [MaybeErr
   (LIEWrappedName RdrName)
   (Either (LocatedA Name) [Located FieldLabel])]
</span><a href="#local-6989586621681362899"><span class="hs-identifier hs-var hs-var">mb_xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName RdrName
-&gt; MaybeErr
     (LIEWrappedName RdrName)
     (Either (LocatedA Name) [Located FieldLabel])
</span><a href="#local-6989586621681362898"><span class="hs-identifier hs-var">doOne</span></a></span><span> </span><span class="annot"><span class="annottext">[LIEWrappedName RdrName]
</span><a href="#local-6989586621681362902"><span class="hs-identifier hs-var">rdr_items</span></a></span><span>
</span><span id="line-1389"></span><span>    </span><span id="local-6989586621681362901"><span class="annot"><span class="annottext">fails :: [LIEWrappedName RdrName]
</span><a href="#local-6989586621681362901"><span class="hs-identifier hs-var hs-var">fails</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LIEWrappedName RdrName
</span><a href="#local-6989586621681362897"><span class="hs-identifier hs-var">bad_rdr</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html#Failed"><span class="hs-identifier hs-type">Failed</span></a></span><span> </span><span id="local-6989586621681362897"><span class="annot"><span class="annottext">LIEWrappedName RdrName
</span><a href="#local-6989586621681362897"><span class="hs-identifier hs-var">bad_rdr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MaybeErr
   (LIEWrappedName RdrName)
   (Either (LocatedA Name) [Located FieldLabel])]
</span><a href="#local-6989586621681362899"><span class="hs-identifier hs-var">mb_xs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1390"></span><span>    </span><span id="local-6989586621681362900"><span class="annot"><span class="annottext">oks :: [Either (LocatedA Name) [Located FieldLabel]]
</span><a href="#local-6989586621681362900"><span class="hs-identifier hs-var hs-var">oks</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Either (LocatedA Name) [Located FieldLabel]
</span><a href="#local-6989586621681362896"><span class="hs-identifier hs-var">ok</span></a></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html#Succeeded"><span class="hs-identifier hs-type">Succeeded</span></a></span><span> </span><span id="local-6989586621681362896"><span class="annot"><span class="annottext">Either (LocatedA Name) [Located FieldLabel]
</span><a href="#local-6989586621681362896"><span class="hs-identifier hs-var">ok</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MaybeErr
   (LIEWrappedName RdrName)
   (Either (LocatedA Name) [Located FieldLabel])]
</span><a href="#local-6989586621681362899"><span class="hs-identifier hs-var">mb_xs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1391"></span><span>    </span><span class="annot"><a href="#local-6989586621681362900"><span class="hs-identifier hs-type">oks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../base-4.16.4.0/src/Data-Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedA"><span class="hs-identifier hs-type">LocatedA</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.SrcLoc.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldLabel"><span class="hs-identifier hs-type">FieldLabel</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1392"></span><span>
</span><span id="line-1393"></span><span>    </span><span id="local-6989586621681362898"><span class="annot"><span class="annottext">doOne :: LIEWrappedName RdrName
-&gt; MaybeErr
     (LIEWrappedName RdrName)
     (Either (LocatedA Name) [Located FieldLabel])
</span><a href="#local-6989586621681362898"><span class="hs-identifier hs-var hs-var">doOne</span></a></span></span><span> </span><span id="local-6989586621681362895"><span class="annot"><span class="annottext">item :: LIEWrappedName RdrName
</span><a href="#local-6989586621681362895"><span class="hs-identifier hs-var">item</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681362894"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362894"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681362893"><span class="annot"><span class="annottext">IEWrappedName RdrName
</span><a href="#local-6989586621681362893"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1394"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. FastStringEnv a -&gt; FastString -&gt; Maybe a
</span><a href="GHC.Data.FastString.Env.html#lookupFsEnv"><span class="hs-identifier hs-var">lookupFsEnv</span></a></span><span> </span><span class="annot"><span class="annottext">FastStringEnv [GreName]
</span><a href="#local-6989586621681362892"><span class="hs-identifier hs-var">kid_env</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">OccName -&gt; FastString
</span><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. IEWrappedName name -&gt; name
</span><a href="GHC.Hs.ImpExp.html#ieWrappedName"><span class="hs-identifier hs-var">ieWrappedName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IEWrappedName RdrName
</span><a href="#local-6989586621681362893"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1395"></span><span>           </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Avail.html#NormalGreName"><span class="hs-identifier hs-type">NormalGreName</span></a></span><span> </span><span id="local-6989586621681362891"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362891"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">]</span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall err val. val -&gt; MaybeErr err val
</span><a href="GHC.Data.Maybe.html#Succeeded"><span class="hs-identifier hs-var">Succeeded</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../base-4.16.4.0/src/Data-Either.html#Left"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362894"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362891"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1396"></span><span>           </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681362890"><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362890"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681362889"><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621681362889"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../base-4.16.4.0/src/Data-Traversable.html#traverse"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">GreName -&gt; Maybe FieldLabel
</span><a href="GHC.Types.Avail.html#greNameFieldLabel"><span class="hs-identifier hs-var">greNameFieldLabel</span></a></span><span> </span><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362890"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall err val. val -&gt; MaybeErr err val
</span><a href="GHC.Data.Maybe.html#Succeeded"><span class="hs-identifier hs-var">Succeeded</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../../base-4.16.4.0/src/Data-Either.html#Right"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362894"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621681362889"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1397"></span><span>           </span><span class="annot"><span class="annottext">Maybe [GreName]
</span><span class="hs-identifier">_</span></span><span>                                                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall err val. err -&gt; MaybeErr err val
</span><a href="GHC.Data.Maybe.html#Failed"><span class="hs-identifier hs-var">Failed</span></a></span><span>    </span><span class="annot"><span class="annottext">LIEWrappedName RdrName
</span><a href="#local-6989586621681362895"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-1398"></span><span>
</span><span id="line-1399"></span><span>    </span><span class="hs-comment">-- See Note [Children for duplicate record fields]</span><span>
</span><span id="line-1400"></span><span>    </span><span id="local-6989586621681362892"><span class="annot"><span class="annottext">kid_env :: FastStringEnv [GreName]
</span><a href="#local-6989586621681362892"><span class="hs-identifier hs-var hs-var">kid_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(a -&gt; a -&gt; a)
-&gt; FastStringEnv a -&gt; [(FastString, a)] -&gt; FastStringEnv a
</span><a href="GHC.Data.FastString.Env.html#extendFsEnvList_C"><span class="hs-identifier hs-var">extendFsEnvList_C</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%2B%2B"><span class="hs-operator hs-var">(++)</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FastStringEnv a
</span><a href="GHC.Data.FastString.Env.html#emptyFsEnv"><span class="hs-identifier hs-var">emptyFsEnv</span></a></span><span>
</span><span id="line-1401"></span><span>              </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">OccName -&gt; FastString
</span><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. HasOccName name =&gt; name -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#occName"><span class="hs-identifier hs-var">occName</span></a></span><span> </span><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681362884"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681362884"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681362884"><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681362884"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362903"><span class="hs-identifier hs-var">all_kids</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1402"></span><span>
</span><span id="line-1403"></span><span>
</span><span id="line-1404"></span><span>
</span><span id="line-1405"></span><span class="hs-comment">-------------------------------</span><span>
</span><span id="line-1406"></span><span>
</span><span id="line-1407"></span><span class="hs-comment">{-
*********************************************************
*                                                       *
\subsection{Unused names}
*                                                       *
*********************************************************
-}</span><span>
</span><span id="line-1414"></span><span>
</span><span id="line-1415"></span><span class="annot"><a href="GHC.Rename.Names.html#reportUnusedNames"><span class="hs-identifier hs-type">reportUnusedNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SourceFile.html#HscSource"><span class="hs-identifier hs-type">HscSource</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1416"></span><span id="reportUnusedNames"><span class="annot"><span class="annottext">reportUnusedNames :: TcGblEnv -&gt; HscSource -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Names.html#reportUnusedNames"><span class="hs-identifier hs-var hs-var">reportUnusedNames</span></a></span></span><span> </span><span id="local-6989586621681362883"><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362883"><span class="hs-identifier hs-var">gbl_env</span></a></span></span><span> </span><span id="local-6989586621681362882"><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621681362882"><span class="hs-identifier hs-var">hsc_src</span></a></span></span><span>
</span><span id="line-1417"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681362881"><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362881"><span class="hs-identifier hs-var">keep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a gbl lcl. TcRef a -&gt; TcRnIf gbl lcl a
</span><a href="GHC.Tc.Utils.Monad.html#readTcRef"><span class="hs-identifier hs-var">readTcRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcGblEnv -&gt; TcRef Defs
</span><a href="GHC.Tc.Types.html#tcg_keep"><span class="hs-identifier hs-var">tcg_keep</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362883"><span class="hs-identifier hs-var">gbl_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1418"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RUN&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcGblEnv -&gt; DefUses
</span><a href="GHC.Tc.Types.html#tcg_dus"><span class="hs-identifier hs-var">tcg_dus</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362883"><span class="hs-identifier hs-var">gbl_env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1419"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">TcGblEnv -&gt; HscSource -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Names.html#warnUnusedImportDecls"><span class="hs-identifier hs-var">warnUnusedImportDecls</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362883"><span class="hs-identifier hs-var">gbl_env</span></a></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621681362882"><span class="hs-identifier hs-var">hsc_src</span></a></span><span>
</span><span id="line-1420"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt] -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Utils.html#warnUnusedTopBinds"><span class="hs-identifier hs-var">warnUnusedTopBinds</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Defs -&gt; [GlobalRdrElt]
</span><a href="#local-6989586621681362876"><span class="hs-identifier hs-var">unused_locals</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362881"><span class="hs-identifier hs-var">keep</span></a></span><span>
</span><span id="line-1421"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">TcGblEnv -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Names.html#warnMissingSignatures"><span class="hs-identifier hs-var">warnMissingSignatures</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362883"><span class="hs-identifier hs-var">gbl_env</span></a></span><span>
</span><span id="line-1422"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">TcGblEnv -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Names.html#warnMissingKindSignatures"><span class="hs-identifier hs-var">warnMissingKindSignatures</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362883"><span class="hs-identifier hs-var">gbl_env</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1423"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1424"></span><span>    </span><span class="annot"><a href="#local-6989586621681362873"><span class="hs-identifier hs-type">used_names</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span>
</span><span id="line-1425"></span><span>    </span><span id="local-6989586621681362873"><span class="annot"><span class="annottext">used_names :: Defs -&gt; Defs
</span><a href="#local-6989586621681362873"><span class="hs-identifier hs-var hs-var">used_names</span></a></span></span><span> </span><span id="local-6989586621681362872"><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362872"><span class="hs-identifier hs-var">keep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefUses -&gt; Defs -&gt; Defs
</span><a href="GHC.Types.Name.Set.html#findUses"><span class="hs-identifier hs-var">findUses</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcGblEnv -&gt; DefUses
</span><a href="GHC.Tc.Types.html#tcg_dus"><span class="hs-identifier hs-var">tcg_dus</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362883"><span class="hs-identifier hs-var">gbl_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">Defs -&gt; Defs -&gt; Defs
</span><a href="GHC.Types.Name.Set.html#unionNameSet"><span class="hs-operator hs-var">`unionNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362872"><span class="hs-identifier hs-var">keep</span></a></span><span>
</span><span id="line-1426"></span><span>    </span><span class="hs-comment">-- NB: currently, if f x = g, we only treat 'g' as used if 'f' is used</span><span>
</span><span id="line-1427"></span><span>    </span><span class="hs-comment">-- Hence findUses</span><span>
</span><span id="line-1428"></span><span>
</span><span id="line-1429"></span><span>    </span><span class="hs-comment">-- Collect the defined names from the in-scope environment</span><span>
</span><span id="line-1430"></span><span>    </span><span class="annot"><a href="#local-6989586621681362869"><span class="hs-identifier hs-type">defined_names</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1431"></span><span>    </span><span id="local-6989586621681362869"><span class="annot"><span class="annottext">defined_names :: [GlobalRdrElt]
</span><a href="#local-6989586621681362869"><span class="hs-identifier hs-var hs-var">defined_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; [GlobalRdrElt]
</span><a href="GHC.Types.Name.Reader.html#globalRdrEnvElts"><span class="hs-identifier hs-var">globalRdrEnvElts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcGblEnv -&gt; GlobalRdrEnv
</span><a href="GHC.Tc.Types.html#tcg_rdr_env"><span class="hs-identifier hs-var">tcg_rdr_env</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362883"><span class="hs-identifier hs-var">gbl_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1432"></span><span>
</span><span id="line-1433"></span><span>    </span><span id="local-6989586621681362867"><span class="annot"><span class="annottext">kids_env :: NameEnv [GlobalRdrElt]
</span><a href="#local-6989586621681362867"><span class="hs-identifier hs-var hs-var">kids_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt] -&gt; NameEnv [GlobalRdrElt]
</span><a href="GHC.Rename.Names.html#mkChildEnv"><span class="hs-identifier hs-var">mkChildEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362869"><span class="hs-identifier hs-var">defined_names</span></a></span><span>
</span><span id="line-1434"></span><span>    </span><span class="hs-comment">-- This is done in mkExports too; duplicated work</span><span>
</span><span id="line-1435"></span><span>
</span><span id="line-1436"></span><span>    </span><span class="annot"><a href="#local-6989586621681362866"><span class="hs-identifier hs-type">gre_is_used</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1437"></span><span>    </span><span id="local-6989586621681362866"><span class="annot"><span class="annottext">gre_is_used :: Defs -&gt; GlobalRdrElt -&gt; Bool
</span><a href="#local-6989586621681362866"><span class="hs-identifier hs-var hs-var">gre_is_used</span></a></span></span><span> </span><span id="local-6989586621681362865"><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362865"><span class="hs-identifier hs-var">used_names</span></a></span></span><span> </span><span id="local-6989586621681362864"><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681362864"><span class="hs-identifier hs-var">gre0</span></a></span></span><span>
</span><span id="line-1438"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362863"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Defs -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362865"><span class="hs-identifier hs-var">used_names</span></a></span><span>
</span><span id="line-1439"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#any"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681362861"><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681362861"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greMangledName"><span class="hs-identifier hs-var">greMangledName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681362861"><span class="hs-identifier hs-var">gre</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Defs -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362865"><span class="hs-identifier hs-var">used_names</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. NameEnv [a] -&gt; Name -&gt; [a]
</span><a href="GHC.Rename.Names.html#findChildren"><span class="hs-identifier hs-var">findChildren</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv [GlobalRdrElt]
</span><a href="#local-6989586621681362867"><span class="hs-identifier hs-var">kids_env</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362863"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1440"></span><span>                </span><span class="hs-comment">-- A use of C implies a use of T,</span><span>
</span><span id="line-1441"></span><span>                </span><span class="hs-comment">-- if C was brought into scope by T(..) or T(C)</span><span>
</span><span id="line-1442"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1443"></span><span>        </span><span id="local-6989586621681362863"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621681362863"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greMangledName"><span class="hs-identifier hs-var">greMangledName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681362864"><span class="hs-identifier hs-var">gre0</span></a></span><span>
</span><span id="line-1444"></span><span>
</span><span id="line-1445"></span><span>    </span><span class="hs-comment">-- Filter out the ones that are</span><span>
</span><span id="line-1446"></span><span>    </span><span class="hs-comment">--  (a) defined in this module, and</span><span>
</span><span id="line-1447"></span><span>    </span><span class="hs-comment">--  (b) not defined by a 'deriving' clause</span><span>
</span><span id="line-1448"></span><span>    </span><span class="hs-comment">-- The latter have an Internal Name, so we can filter them out easily</span><span>
</span><span id="line-1449"></span><span>    </span><span class="annot"><a href="#local-6989586621681362876"><span class="hs-identifier hs-type">unused_locals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1450"></span><span>    </span><span id="local-6989586621681362876"><span class="annot"><span class="annottext">unused_locals :: Defs -&gt; [GlobalRdrElt]
</span><a href="#local-6989586621681362876"><span class="hs-identifier hs-var hs-var">unused_locals</span></a></span></span><span> </span><span id="local-6989586621681362860"><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362860"><span class="hs-identifier hs-var">keep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1451"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- Note that defined_and_used, defined_but_not_used</span><span>
</span><span id="line-1452"></span><span>          </span><span class="hs-comment">-- are both [GRE]; that's why we need defined_and_used</span><span>
</span><span id="line-1453"></span><span>          </span><span class="hs-comment">-- rather than just used_names</span><span>
</span><span id="line-1454"></span><span>          </span><span class="annot"><a href="#local-6989586621681362859"><span class="hs-identifier hs-type">_defined_and_used</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681362858"><span class="hs-identifier hs-type">defined_but_not_used</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1455"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621681362859"><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362859"><span class="hs-identifier hs-var">_defined_and_used</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681362858"><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362858"><span class="hs-identifier hs-var">defined_but_not_used</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1456"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="../../base-4.16.4.0/src/Data-OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Defs -&gt; GlobalRdrElt -&gt; Bool
</span><a href="#local-6989586621681362866"><span class="hs-identifier hs-var">gre_is_used</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Defs -&gt; Defs
</span><a href="#local-6989586621681362873"><span class="hs-identifier hs-var">used_names</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362860"><span class="hs-identifier hs-var">keep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362869"><span class="hs-identifier hs-var">defined_names</span></a></span><span>
</span><span id="line-1457"></span><span>
</span><span id="line-1458"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Bool
</span><a href="#local-6989586621681362857"><span class="hs-identifier hs-var">is_unused_local</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362858"><span class="hs-identifier hs-var">defined_but_not_used</span></a></span><span>
</span><span id="line-1459"></span><span>    </span><span class="annot"><a href="#local-6989586621681362857"><span class="hs-identifier hs-type">is_unused_local</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1460"></span><span>    </span><span id="local-6989586621681362857"><span class="annot"><span class="annottext">is_unused_local :: GlobalRdrElt -&gt; Bool
</span><a href="#local-6989586621681362857"><span class="hs-identifier hs-var hs-var">is_unused_local</span></a></span></span><span> </span><span id="local-6989586621681362856"><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681362856"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isLocalGRE"><span class="hs-identifier hs-var">isLocalGRE</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681362856"><span class="hs-identifier hs-var">gre</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="GHC.Types.Name.html#isExternalName"><span class="hs-identifier hs-var">isExternalName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greMangledName"><span class="hs-identifier hs-var">greMangledName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681362856"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1461"></span><span>
</span><span id="line-1462"></span><span class="hs-comment">{- *********************************************************************
*                                                                      *
              Missing signatures
*                                                                      *
********************************************************************* -}</span><span>
</span><span id="line-1467"></span><span>
</span><span id="line-1468"></span><span class="hs-comment">-- | Warn the user about top level binders that lack type signatures.</span><span>
</span><span id="line-1469"></span><span class="hs-comment">-- Called /after/ type inference, so that we can report the</span><span>
</span><span id="line-1470"></span><span class="hs-comment">-- inferred type of the function</span><span>
</span><span id="line-1471"></span><span class="annot"><a href="GHC.Rename.Names.html#warnMissingSignatures"><span class="hs-identifier hs-type">warnMissingSignatures</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1472"></span><span id="warnMissingSignatures"><span class="annot"><span class="annottext">warnMissingSignatures :: TcGblEnv -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Names.html#warnMissingSignatures"><span class="hs-identifier hs-var hs-var">warnMissingSignatures</span></a></span></span><span> </span><span id="local-6989586621681362854"><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362854"><span class="hs-identifier hs-var">gbl_env</span></a></span></span><span>
</span><span id="line-1473"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681362853"><span class="annot"><span class="annottext">exports :: Defs
</span><a href="#local-6989586621681362853"><span class="hs-identifier hs-var hs-var">exports</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[AvailInfo] -&gt; Defs
</span><a href="GHC.Types.Avail.html#availsToNameSet"><span class="hs-identifier hs-var">availsToNameSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcGblEnv -&gt; [AvailInfo]
</span><a href="GHC.Tc.Types.html#tcg_exports"><span class="hs-identifier hs-var">tcg_exports</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362854"><span class="hs-identifier hs-var">gbl_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1474"></span><span>             </span><span id="local-6989586621681362850"><span class="annot"><span class="annottext">sig_ns :: Defs
</span><a href="#local-6989586621681362850"><span class="hs-identifier hs-var hs-var">sig_ns</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcGblEnv -&gt; Defs
</span><a href="GHC.Tc.Types.html#tcg_sigs"><span class="hs-identifier hs-var">tcg_sigs</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362854"><span class="hs-identifier hs-var">gbl_env</span></a></span><span>
</span><span id="line-1475"></span><span>               </span><span class="hs-comment">-- We use sig_ns to exclude top-level bindings that are generated by GHC</span><span>
</span><span id="line-1476"></span><span>             </span><span id="local-6989586621681362848"><span class="annot"><span class="annottext">binds :: [IdP GhcTc]
</span><a href="#local-6989586621681362848"><span class="hs-identifier hs-var hs-var">binds</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall p idR.
CollectPass p =&gt;
CollectFlag p -&gt; LHsBindsLR p idR -&gt; [IdP p]
</span><a href="GHC.Hs.Utils.html#collectHsBindsBinders"><span class="hs-identifier hs-var">collectHsBindsBinders</span></a></span><span> </span><span class="annot"><span class="annottext">forall p. CollectFlag p
</span><a href="GHC.Hs.Utils.html#CollNoDictBinders"><span class="hs-identifier hs-var">CollNoDictBinders</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv -&gt; LHsBinds GhcTc
</span><a href="GHC.Tc.Types.html#tcg_binds"><span class="hs-identifier hs-var">tcg_binds</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362854"><span class="hs-identifier hs-var">gbl_env</span></a></span><span>
</span><span id="line-1477"></span><span>             </span><span id="local-6989586621681362844"><span class="annot"><span class="annottext">pat_syns :: [PatSyn]
</span><a href="#local-6989586621681362844"><span class="hs-identifier hs-var hs-var">pat_syns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcGblEnv -&gt; [PatSyn]
</span><a href="GHC.Tc.Types.html#tcg_patsyns"><span class="hs-identifier hs-var">tcg_patsyns</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362854"><span class="hs-identifier hs-var">gbl_env</span></a></span><span>
</span><span id="line-1478"></span><span>
</span><span id="line-1479"></span><span>         </span><span class="hs-comment">-- Warn about missing signatures</span><span>
</span><span id="line-1480"></span><span>         </span><span class="hs-comment">-- Do this only when we have a type to offer</span><span>
</span><span id="line-1481"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681362842"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362842"><span class="hs-identifier hs-var">warn_missing_sigs</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. WarningFlag -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#woptM"><span class="hs-identifier hs-var">woptM</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnMissingSignatures"><span class="hs-identifier hs-var">Opt_WarnMissingSignatures</span></a></span><span>
</span><span id="line-1482"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681362839"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362839"><span class="hs-identifier hs-var">warn_only_exported</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. WarningFlag -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#woptM"><span class="hs-identifier hs-var">woptM</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnMissingExportedSignatures"><span class="hs-identifier hs-var">Opt_WarnMissingExportedSignatures</span></a></span><span>
</span><span id="line-1483"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681362837"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362837"><span class="hs-identifier hs-var">warn_pat_syns</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. WarningFlag -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#woptM"><span class="hs-identifier hs-var">woptM</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnMissingPatternSynonymSignatures"><span class="hs-identifier hs-var">Opt_WarnMissingPatternSynonymSignatures</span></a></span><span>
</span><span id="line-1484"></span><span>
</span><span id="line-1485"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681362835"><span class="annot"><span class="annottext">add_sig_warns :: IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681362835"><span class="hs-identifier hs-var hs-var">add_sig_warns</span></a></span></span><span>
</span><span id="line-1486"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362842"><span class="hs-identifier hs-var">warn_missing_sigs</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681362834"><span class="hs-identifier hs-var">add_warns</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnMissingSignatures"><span class="hs-identifier hs-var">Opt_WarnMissingSignatures</span></a></span><span>
</span><span id="line-1487"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362839"><span class="hs-identifier hs-var">warn_only_exported</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681362834"><span class="hs-identifier hs-var">add_warns</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnMissingExportedSignatures"><span class="hs-identifier hs-var">Opt_WarnMissingExportedSignatures</span></a></span><span>
</span><span id="line-1488"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362837"><span class="hs-identifier hs-var">warn_pat_syns</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681362834"><span class="hs-identifier hs-var">add_warns</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnMissingPatternSynonymSignatures"><span class="hs-identifier hs-var">Opt_WarnMissingPatternSynonymSignatures</span></a></span><span>
</span><span id="line-1489"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1490"></span><span>
</span><span id="line-1491"></span><span>             </span><span id="local-6989586621681362834"><span class="annot"><span class="annottext">add_warns :: WarningFlag -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681362834"><span class="hs-identifier hs-var hs-var">add_warns</span></a></span></span><span> </span><span id="local-6989586621681362833"><span class="annot"><span class="annottext">WarningFlag
</span><a href="#local-6989586621681362833"><span class="hs-identifier hs-var">flag</span></a></span></span><span>
</span><span id="line-1492"></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362842"><span class="hs-identifier hs-var">warn_missing_sigs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362839"><span class="hs-identifier hs-var">warn_only_exported</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1493"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681362832"><span class="hs-identifier hs-var">add_bind_warn</span></a></span><span> </span><span class="annot"><span class="annottext">[IdP GhcTc]
</span><a href="#local-6989586621681362848"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span>
</span><span id="line-1494"></span><span>                  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362842"><span class="hs-identifier hs-var">warn_missing_sigs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362837"><span class="hs-identifier hs-var">warn_pat_syns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1495"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">PatSyn -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681362831"><span class="hs-identifier hs-var">add_pat_syn_warn</span></a></span><span> </span><span class="annot"><span class="annottext">[PatSyn]
</span><a href="#local-6989586621681362844"><span class="hs-identifier hs-var">pat_syns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1496"></span><span>                </span><span class="hs-keyword">where</span><span>
</span><span id="line-1497"></span><span>                  </span><span id="local-6989586621681362831"><span class="annot"><span class="annottext">add_pat_syn_warn :: PatSyn -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681362831"><span class="hs-identifier hs-var hs-var">add_pat_syn_warn</span></a></span></span><span> </span><span id="local-6989586621681362830"><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621681362830"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-1498"></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681362829"><span class="hs-identifier hs-var">add_warn</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362828"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1499"></span><span>                      </span><span class="annot"><span class="annottext">SDoc -&gt; Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Pattern synonym with no type signature:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1500"></span><span>                         </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pattern&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NamedThing a =&gt; a -&gt; SDoc
</span><a href="GHC.Types.Name.html#pprPrefixName"><span class="hs-identifier hs-var">pprPrefixName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362828"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362824"><span class="hs-identifier hs-var">pp_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1501"></span><span>                    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1502"></span><span>                      </span><span id="local-6989586621681362828"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621681362828"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatSyn -&gt; Name
</span><a href="GHC.Core.PatSyn.html#patSynName"><span class="hs-identifier hs-var">patSynName</span></a></span><span> </span><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621681362830"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1503"></span><span>                      </span><span id="local-6989586621681362824"><span class="annot"><span class="annottext">pp_ty :: SDoc
</span><a href="#local-6989586621681362824"><span class="hs-identifier hs-var hs-var">pp_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatSyn -&gt; SDoc
</span><a href="GHC.Core.PatSyn.html#pprPatSynType"><span class="hs-identifier hs-var">pprPatSynType</span></a></span><span> </span><span class="annot"><span class="annottext">PatSyn
</span><a href="#local-6989586621681362830"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1504"></span><span>
</span><span id="line-1505"></span><span>                  </span><span class="annot"><a href="#local-6989586621681362832"><span class="hs-identifier hs-type">add_bind_warn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.IOEnv.html#IOEnv"><span class="hs-identifier hs-type">IOEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1506"></span><span>                  </span><span id="local-6989586621681362832"><span class="annot"><span class="annottext">add_bind_warn :: Id -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681362832"><span class="hs-identifier hs-var hs-var">add_bind_warn</span></a></span></span><span> </span><span id="local-6989586621681362821"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681362821"><span class="hs-identifier hs-var">id</span></a></span></span><span>
</span><span id="line-1507"></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681362820"><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681362820"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TcM TidyEnv
</span><a href="GHC.Tc.Utils.Env.html#tcInitTidyEnv"><span class="hs-identifier hs-var">tcInitTidyEnv</span></a></span><span>     </span><span class="hs-comment">-- Why not use emptyTidyEnv?</span><span>
</span><span id="line-1508"></span><span>                         </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681362818"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621681362818"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681362821"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1509"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TidyEnv
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681362816"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681362816"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TidyEnv -&gt; Type -&gt; (TidyEnv, Type)
</span><a href="GHC.Core.TyCo.Tidy.html#tidyOpenType"><span class="hs-identifier hs-var">tidyOpenType</span></a></span><span> </span><span class="annot"><span class="annottext">TidyEnv
</span><a href="#local-6989586621681362820"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Type
</span><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-var">idType</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621681362821"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1510"></span><span>                               </span><span id="local-6989586621681362813"><span class="annot"><span class="annottext">ty_msg :: SDoc
</span><a href="#local-6989586621681362813"><span class="hs-identifier hs-var hs-var">ty_msg</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
</span><a href="GHC.Core.TyCo.Ppr.html#pprSigmaType"><span class="hs-identifier hs-var">pprSigmaType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681362816"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1511"></span><span>                         </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681362829"><span class="hs-identifier hs-var">add_warn</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362818"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1512"></span><span>                           </span><span class="annot"><span class="annottext">SDoc -&gt; Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Top-level binding with no type signature:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1513"></span><span>                              </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. NamedThing a =&gt; a -&gt; SDoc
</span><a href="GHC.Types.Name.html#pprPrefixName"><span class="hs-identifier hs-var">pprPrefixName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362818"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362813"><span class="hs-identifier hs-var">ty_msg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1514"></span><span>
</span><span id="line-1515"></span><span>                  </span><span id="local-6989586621681362829"><span class="annot"><span class="annottext">add_warn :: Name -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681362829"><span class="hs-identifier hs-var hs-var">add_warn</span></a></span></span><span> </span><span id="local-6989586621681362811"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362811"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681362810"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362810"><span class="hs-identifier hs-var">msg</span></a></span></span><span>
</span><span id="line-1516"></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362811"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Defs -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362850"><span class="hs-identifier hs-var">sig_ns</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="#local-6989586621681362809"><span class="hs-identifier hs-var">export_check</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362811"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1517"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarnReason -&gt; SrcSpan -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addWarnAt"><span class="hs-identifier hs-var">addWarnAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningFlag -&gt; WarnReason
</span><a href="GHC.Driver.Flags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="#local-6989586621681362833"><span class="hs-identifier hs-var">flag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. NamedThing a =&gt; a -&gt; SrcSpan
</span><a href="GHC.Types.Name.html#getSrcSpan"><span class="hs-identifier hs-var">getSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362811"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362810"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1518"></span><span>
</span><span id="line-1519"></span><span>                  </span><span id="local-6989586621681362809"><span class="annot"><span class="annottext">export_check :: Name -&gt; Bool
</span><a href="#local-6989586621681362809"><span class="hs-identifier hs-var hs-var">export_check</span></a></span></span><span> </span><span id="local-6989586621681362807"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362807"><span class="hs-identifier hs-var">name</span></a></span></span><span>
</span><span id="line-1520"></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362842"><span class="hs-identifier hs-var">warn_missing_sigs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362839"><span class="hs-identifier hs-var">warn_only_exported</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362807"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Defs -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362853"><span class="hs-identifier hs-var">exports</span></a></span><span>
</span><span id="line-1521"></span><span>
</span><span id="line-1522"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681362835"><span class="hs-identifier hs-var">add_sig_warns</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1523"></span><span>
</span><span id="line-1524"></span><span class="hs-comment">-- | Warn the user about tycons that lack kind signatures.</span><span>
</span><span id="line-1525"></span><span class="hs-comment">-- Called /after/ type (and kind) inference, so that we can report the</span><span>
</span><span id="line-1526"></span><span class="hs-comment">-- inferred kinds.</span><span>
</span><span id="line-1527"></span><span class="annot"><a href="GHC.Rename.Names.html#warnMissingKindSignatures"><span class="hs-identifier hs-type">warnMissingKindSignatures</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1528"></span><span id="warnMissingKindSignatures"><span class="annot"><span class="annottext">warnMissingKindSignatures :: TcGblEnv -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Names.html#warnMissingKindSignatures"><span class="hs-identifier hs-var hs-var">warnMissingKindSignatures</span></a></span></span><span> </span><span id="local-6989586621681362806"><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362806"><span class="hs-identifier hs-var">gbl_env</span></a></span></span><span>
</span><span id="line-1529"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681362805"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362805"><span class="hs-identifier hs-var">warn_missing_kind_sigs</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. WarningFlag -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#woptM"><span class="hs-identifier hs-var">woptM</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnMissingKindSignatures"><span class="hs-identifier hs-var">Opt_WarnMissingKindSignatures</span></a></span><span>
</span><span id="line-1530"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681362803"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362803"><span class="hs-identifier hs-var">cusks_enabled</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl. Extension -&gt; TcRnIf gbl lcl Bool
</span><a href="GHC.Tc.Utils.Monad.html#xoptM"><span class="hs-identifier hs-var">xoptM</span></a></span><span> </span><span class="annot"><span class="annottext">Extension
</span><span class="hs-identifier hs-var">LangExt.CUSKs</span></span><span>
</span><span id="line-1531"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362805"><span class="hs-identifier hs-var">warn_missing_kind_sigs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; TyCon -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681362801"><span class="hs-identifier hs-var">add_ty_warn</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362803"><span class="hs-identifier hs-var">cusks_enabled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyCon]
</span><a href="#local-6989586621681362800"><span class="hs-identifier hs-var">tcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1532"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-1533"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1534"></span><span>    </span><span id="local-6989586621681362800"><span class="annot"><span class="annottext">tcs :: [TyCon]
</span><a href="#local-6989586621681362800"><span class="hs-identifier hs-var hs-var">tcs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcGblEnv -&gt; [TyCon]
</span><a href="GHC.Tc.Types.html#tcg_tcs"><span class="hs-identifier hs-var">tcg_tcs</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362806"><span class="hs-identifier hs-var">gbl_env</span></a></span><span>
</span><span id="line-1535"></span><span>    </span><span id="local-6989586621681362798"><span class="annot"><span class="annottext">ksig_ns :: Defs
</span><a href="#local-6989586621681362798"><span class="hs-identifier hs-var hs-var">ksig_ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcGblEnv -&gt; Defs
</span><a href="GHC.Tc.Types.html#tcg_ksigs"><span class="hs-identifier hs-var">tcg_ksigs</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362806"><span class="hs-identifier hs-var">gbl_env</span></a></span><span>
</span><span id="line-1536"></span><span>
</span><span id="line-1537"></span><span>    </span><span class="annot"><a href="#local-6989586621681362801"><span class="hs-identifier hs-type">add_ty_warn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Data.IOEnv.html#IOEnv"><span class="hs-identifier hs-type">IOEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Tc.Types.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a></span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcLclEnv"><span class="hs-identifier hs-type">TcLclEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1538"></span><span>    </span><span id="local-6989586621681362801"><span class="annot"><span class="annottext">add_ty_warn :: Bool -&gt; TyCon -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="#local-6989586621681362801"><span class="hs-identifier hs-var hs-var">add_ty_warn</span></a></span></span><span> </span><span id="local-6989586621681362796"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362796"><span class="hs-identifier hs-var">cusks_enabled</span></a></span></span><span> </span><span id="local-6989586621681362795"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681362795"><span class="hs-identifier hs-var">tyCon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362794"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Defs -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362798"><span class="hs-identifier hs-var">ksig_ns</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1539"></span><span>        </span><span class="annot"><span class="annottext">WarnReason -&gt; SrcSpan -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addWarnAt"><span class="hs-identifier hs-var">addWarnAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningFlag -&gt; WarnReason
</span><a href="GHC.Driver.Flags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnMissingKindSignatures"><span class="hs-identifier hs-var">Opt_WarnMissingKindSignatures</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. NamedThing a =&gt; a -&gt; SrcSpan
</span><a href="GHC.Types.Name.html#getSrcSpan"><span class="hs-identifier hs-var">getSrcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362794"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1540"></span><span>            </span><span class="annot"><span class="annottext">SDoc -&gt; Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362793"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;type&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. NamedThing a =&gt; a -&gt; SDoc
</span><a href="GHC.Types.Name.html#pprPrefixName"><span class="hs-identifier hs-var">pprPrefixName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362794"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#dcolon"><span class="hs-identifier hs-var">dcolon</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362792"><span class="hs-identifier hs-var">ki_msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1541"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1542"></span><span>        </span><span id="local-6989586621681362793"><span class="annot"><span class="annottext">msg :: SDoc
</span><a href="#local-6989586621681362793"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681362796"><span class="hs-identifier hs-var">cusks_enabled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Top-level type constructor with no standalone kind signature or CUSK:&quot;</span></span><span>
</span><span id="line-1543"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Top-level type constructor with no standalone kind signature:&quot;</span></span><span>
</span><span id="line-1544"></span><span>        </span><span id="local-6989586621681362794"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621681362794"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681362795"><span class="hs-identifier hs-var">tyCon</span></a></span><span>
</span><span id="line-1545"></span><span>        </span><span id="local-6989586621681362791"><span class="annot"><span class="annottext">ki :: Type
</span><a href="#local-6989586621681362791"><span class="hs-identifier hs-var hs-var">ki</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Type
</span><a href="GHC.Core.TyCon.html#tyConKind"><span class="hs-identifier hs-var">tyConKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621681362795"><span class="hs-identifier hs-var">tyCon</span></a></span><span>
</span><span id="line-1546"></span><span>        </span><span class="annot"><a href="#local-6989586621681362792"><span class="hs-identifier hs-type">ki_msg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1547"></span><span>        </span><span id="local-6989586621681362792"><span class="annot"><span class="annottext">ki_msg :: SDoc
</span><a href="#local-6989586621681362792"><span class="hs-identifier hs-var hs-var">ki_msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; SDoc
</span><a href="GHC.Core.TyCo.Ppr.html#pprKind"><span class="hs-identifier hs-var">pprKind</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681362791"><span class="hs-identifier hs-var">ki</span></a></span><span>
</span><span id="line-1548"></span><span>
</span><span id="line-1549"></span><span class="hs-comment">{-
*********************************************************
*                                                       *
\subsection{Unused imports}
*                                                       *
*********************************************************

This code finds which import declarations are unused.  The
specification and implementation notes are here:
  https://gitlab.haskell.org/ghc/ghc/wikis/commentary/compiler/unused-imports

See also Note [Choosing the best import declaration] in GHC.Types.Name.Reader
-}</span><span>
</span><span id="line-1562"></span><span>
</span><span id="line-1563"></span><span class="hs-keyword">type</span><span> </span><span id="ImportDeclUsage"><span class="annot"><a href="GHC.Rename.Names.html#ImportDeclUsage"><span class="hs-identifier hs-var">ImportDeclUsage</span></a></span></span><span>
</span><span id="line-1564"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>   </span><span class="hs-comment">-- The import declaration</span><span>
</span><span id="line-1565"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span>      </span><span class="hs-comment">-- What *is* used (normalised)</span><span>
</span><span id="line-1566"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span>            </span><span class="hs-comment">-- What is imported but *not* used</span><span>
</span><span id="line-1567"></span><span>
</span><span id="line-1568"></span><span class="annot"><a href="GHC.Rename.Names.html#warnUnusedImportDecls"><span class="hs-identifier hs-type">warnUnusedImportDecls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcGblEnv"><span class="hs-identifier hs-type">TcGblEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.SourceFile.html#HscSource"><span class="hs-identifier hs-type">HscSource</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1569"></span><span id="warnUnusedImportDecls"><span class="annot"><span class="annottext">warnUnusedImportDecls :: TcGblEnv -&gt; HscSource -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Names.html#warnUnusedImportDecls"><span class="hs-identifier hs-var hs-var">warnUnusedImportDecls</span></a></span></span><span> </span><span id="local-6989586621681362789"><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362789"><span class="hs-identifier hs-var">gbl_env</span></a></span></span><span> </span><span id="local-6989586621681362788"><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621681362788"><span class="hs-identifier hs-var">hsc_src</span></a></span></span><span>
</span><span id="line-1570"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681362787"><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362787"><span class="hs-identifier hs-var">uses</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a env. IORef a -&gt; IOEnv env a
</span><a href="GHC.Data.IOEnv.html#readMutVar"><span class="hs-identifier hs-var">readMutVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcGblEnv -&gt; TcRef [GlobalRdrElt]
</span><a href="GHC.Tc.Types.html#tcg_used_gres"><span class="hs-identifier hs-var">tcg_used_gres</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362789"><span class="hs-identifier hs-var">gbl_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1571"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681362784"><span class="annot"><span class="annottext">user_imports :: [GenLocated SrcSpanAnnA (ImportDecl GhcRn)]
</span><a href="#local-6989586621681362784"><span class="hs-identifier hs-var hs-var">user_imports</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="GHC.Utils.Misc.html#filterOut"><span class="hs-identifier hs-var">filterOut</span></a></span><span>
</span><span id="line-1572"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; Bool
</span><a href="GHC.Hs.ImpExp.html#ideclImplicit"><span class="hs-identifier hs-var">ideclImplicit</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1573"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcGblEnv -&gt; [LImportDecl GhcRn]
</span><a href="GHC.Tc.Types.html#tcg_rn_imports"><span class="hs-identifier hs-var">tcg_rn_imports</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362789"><span class="hs-identifier hs-var">gbl_env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1574"></span><span>                </span><span class="hs-comment">-- This whole function deals only with *user* imports</span><span>
</span><span id="line-1575"></span><span>                </span><span class="hs-comment">-- both for warning about unnecessary ones, and for</span><span>
</span><span id="line-1576"></span><span>                </span><span class="hs-comment">-- deciding the minimal ones</span><span>
</span><span id="line-1577"></span><span>             </span><span id="local-6989586621681362781"><span class="annot"><span class="annottext">rdr_env :: GlobalRdrEnv
</span><a href="#local-6989586621681362781"><span class="hs-identifier hs-var hs-var">rdr_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcGblEnv -&gt; GlobalRdrEnv
</span><a href="GHC.Tc.Types.html#tcg_rdr_env"><span class="hs-identifier hs-var">tcg_rdr_env</span></a></span><span> </span><span class="annot"><span class="annottext">TcGblEnv
</span><a href="#local-6989586621681362789"><span class="hs-identifier hs-var">gbl_env</span></a></span><span>
</span><span id="line-1578"></span><span>             </span><span id="local-6989586621681362780"><span class="annot"><span class="annottext">fld_env :: NameEnv (FastString, Parent)
</span><a href="#local-6989586621681362780"><span class="hs-identifier hs-var hs-var">fld_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv -&gt; NameEnv (FastString, Parent)
</span><a href="GHC.Rename.Utils.html#mkFieldEnv"><span class="hs-identifier hs-var">mkFieldEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrEnv
</span><a href="#local-6989586621681362781"><span class="hs-identifier hs-var">rdr_env</span></a></span><span>
</span><span id="line-1579"></span><span>
</span><span id="line-1580"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621681362779"><span class="hs-identifier hs-type">usage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Names.html#ImportDeclUsage"><span class="hs-identifier hs-type">ImportDeclUsage</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1581"></span><span>             </span><span id="local-6989586621681362779"><span class="annot"><span class="annottext">usage :: [ImportDeclUsage]
</span><a href="#local-6989586621681362779"><span class="hs-identifier hs-var hs-var">usage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LImportDecl GhcRn] -&gt; [GlobalRdrElt] -&gt; [ImportDeclUsage]
</span><a href="GHC.Rename.Names.html#findImportUsage"><span class="hs-identifier hs-var">findImportUsage</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (ImportDecl GhcRn)]
</span><a href="#local-6989586621681362784"><span class="hs-identifier hs-var">user_imports</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362787"><span class="hs-identifier hs-var">uses</span></a></span><span>
</span><span id="line-1582"></span><span>
</span><span id="line-1583"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#traceRn"><span class="hs-identifier hs-var">traceRn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;warnUnusedImportDecls&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1584"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Uses:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362787"><span class="hs-identifier hs-var">uses</span></a></span><span>
</span><span id="line-1585"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Import usage&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[ImportDeclUsage]
</span><a href="#local-6989586621681362779"><span class="hs-identifier hs-var">usage</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1586"></span><span>
</span><span id="line-1587"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl.
WarningFlag -&gt; TcRnIf gbl lcl () -&gt; TcRnIf gbl lcl ()
</span><a href="GHC.Tc.Utils.Monad.html#whenWOptM"><span class="hs-identifier hs-var">whenWOptM</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnUnusedImports"><span class="hs-identifier hs-var">Opt_WarnUnusedImports</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1588"></span><span>         </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningFlag
-&gt; NameEnv (FastString, Parent)
-&gt; ImportDeclUsage
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Names.html#warnUnusedImport"><span class="hs-identifier hs-var">warnUnusedImport</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnUnusedImports"><span class="hs-identifier hs-var">Opt_WarnUnusedImports</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv (FastString, Parent)
</span><a href="#local-6989586621681362780"><span class="hs-identifier hs-var">fld_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ImportDeclUsage]
</span><a href="#local-6989586621681362779"><span class="hs-identifier hs-var">usage</span></a></span><span>
</span><span id="line-1589"></span><span>
</span><span id="line-1590"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall gbl lcl.
GeneralFlag -&gt; TcRnIf gbl lcl () -&gt; TcRnIf gbl lcl ()
</span><a href="GHC.Tc.Utils.Monad.html#whenGOptM"><span class="hs-identifier hs-var">whenGOptM</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_D_dump_minimal_imports"><span class="hs-identifier hs-var">Opt_D_dump_minimal_imports</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1591"></span><span>         </span><span class="annot"><span class="annottext">HscSource -&gt; [ImportDeclUsage] -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Names.html#printMinimalImports"><span class="hs-identifier hs-var">printMinimalImports</span></a></span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621681362788"><span class="hs-identifier hs-var">hsc_src</span></a></span><span> </span><span class="annot"><span class="annottext">[ImportDeclUsage]
</span><a href="#local-6989586621681362779"><span class="hs-identifier hs-var">usage</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1592"></span><span>
</span><span id="line-1593"></span><span class="annot"><a href="GHC.Rename.Names.html#findImportUsage"><span class="hs-identifier hs-type">findImportUsage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1594"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1595"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Names.html#ImportDeclUsage"><span class="hs-identifier hs-type">ImportDeclUsage</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1596"></span><span>
</span><span id="line-1597"></span><span id="findImportUsage"><span class="annot"><span class="annottext">findImportUsage :: [LImportDecl GhcRn] -&gt; [GlobalRdrElt] -&gt; [ImportDeclUsage]
</span><a href="GHC.Rename.Names.html#findImportUsage"><span class="hs-identifier hs-var hs-var">findImportUsage</span></a></span></span><span> </span><span id="local-6989586621681362774"><span class="annot"><span class="annottext">[LImportDecl GhcRn]
</span><a href="#local-6989586621681362774"><span class="hs-identifier hs-var">imports</span></a></span></span><span> </span><span id="local-6989586621681362773"><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362773"><span class="hs-identifier hs-var">used_gres</span></a></span></span><span>
</span><span id="line-1598"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">LImportDecl GhcRn -&gt; ImportDeclUsage
</span><a href="#local-6989586621681362772"><span class="hs-identifier hs-var">unused_decl</span></a></span><span> </span><span class="annot"><span class="annottext">[LImportDecl GhcRn]
</span><a href="#local-6989586621681362774"><span class="hs-identifier hs-var">imports</span></a></span><span>
</span><span id="line-1599"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1600"></span><span>    </span><span class="annot"><a href="#local-6989586621681362771"><span class="hs-identifier hs-type">import_usage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#ImportMap"><span class="hs-identifier hs-type">ImportMap</span></a></span><span>
</span><span id="line-1601"></span><span>    </span><span id="local-6989586621681362771"><span class="annot"><span class="annottext">import_usage :: ImportMap
</span><a href="#local-6989586621681362771"><span class="hs-identifier hs-var hs-var">import_usage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt] -&gt; ImportMap
</span><a href="GHC.Rename.Names.html#mkImportMap"><span class="hs-identifier hs-var">mkImportMap</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362773"><span class="hs-identifier hs-var">used_gres</span></a></span><span>
</span><span id="line-1602"></span><span>
</span><span id="line-1603"></span><span>    </span><span class="annot"><a href="#local-6989586621681362772"><span class="hs-identifier hs-type">unused_decl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1604"></span><span>    </span><span id="local-6989586621681362772"><span class="annot"><span class="annottext">unused_decl :: LImportDecl GhcRn -&gt; ImportDeclUsage
</span><a href="#local-6989586621681362772"><span class="hs-identifier hs-var hs-var">unused_decl</span></a></span></span><span> </span><span id="local-6989586621681362769"><span class="annot"><span class="annottext">decl :: LImportDecl GhcRn
</span><a href="#local-6989586621681362769"><span class="hs-identifier hs-var">decl</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681362768"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362768"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#ImportDecl"><span class="hs-identifier hs-type">ImportDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ideclHiding :: forall pass. ImportDecl pass -&gt; Maybe (Bool, XRec pass [LIE pass])
</span><a href="GHC.Hs.ImpExp.html#ideclHiding"><span class="hs-identifier hs-var">ideclHiding</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681362767"><span class="annot"><span class="annottext">Maybe (Bool, XRec GhcRn [LIE GhcRn])
</span><a href="#local-6989586621681362767"><span class="hs-identifier hs-var">imps</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1605"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LImportDecl GhcRn
</span><a href="#local-6989586621681362769"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362766"><span class="hs-identifier hs-var">used_gres</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Defs -&gt; [Name]
</span><a href="GHC.Types.Name.Set.html#nameSetElemsStable"><span class="hs-identifier hs-var">nameSetElemsStable</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362764"><span class="hs-identifier hs-var">unused_imps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1606"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1607"></span><span>        </span><span id="local-6989586621681362766"><span class="annot"><span class="annottext">used_gres :: [GlobalRdrElt]
</span><a href="#local-6989586621681362766"><span class="hs-identifier hs-var hs-var">used_gres</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. SrcLoc -&gt; Map RealSrcLoc a -&gt; Maybe a
</span><a href="GHC.Types.SrcLoc.html#lookupSrcLoc"><span class="hs-identifier hs-var">lookupSrcLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; SrcLoc
</span><a href="GHC.Types.SrcLoc.html#srcSpanEnd"><span class="hs-identifier hs-var">srcSpanEnd</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362768"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ImportMap
</span><a href="#local-6989586621681362771"><span class="hs-identifier hs-var">import_usage</span></a></span><span>
</span><span id="line-1608"></span><span>                               </span><span class="hs-comment">-- srcSpanEnd: see Note [The ImportMap]</span><span>
</span><span id="line-1609"></span><span>                    </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; a -&gt; a
</span><a href="GHC.Data.Maybe.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1610"></span><span>
</span><span id="line-1611"></span><span>        </span><span id="local-6989586621681362761"><span class="annot"><span class="annottext">used_names :: Defs
</span><a href="#local-6989586621681362761"><span class="hs-identifier hs-var hs-var">used_names</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Defs
</span><a href="GHC.Types.Name.Set.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span>      </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greMangledName"><span class="hs-identifier hs-var">greMangledName</span></a></span><span>        </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362766"><span class="hs-identifier hs-var">used_gres</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1612"></span><span>        </span><span id="local-6989586621681362759"><span class="annot"><span class="annottext">used_parents :: Defs
</span><a href="#local-6989586621681362759"><span class="hs-identifier hs-var hs-var">used_parents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Defs
</span><a href="GHC.Types.Name.Set.html#mkNameSet"><span class="hs-identifier hs-var">mkNameSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/Data-Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Maybe Name
</span><a href="GHC.Types.Name.Reader.html#greParent_maybe"><span class="hs-identifier hs-var">greParent_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362766"><span class="hs-identifier hs-var">used_gres</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1613"></span><span>
</span><span id="line-1614"></span><span>        </span><span id="local-6989586621681362764"><span class="annot"><span class="annottext">unused_imps :: Defs
</span><a href="#local-6989586621681362764"><span class="hs-identifier hs-var hs-var">unused_imps</span></a></span></span><span>   </span><span class="hs-comment">-- Not trivial; see eg #7454</span><span>
</span><span id="line-1615"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Bool, XRec GhcRn [LIE GhcRn])
</span><a href="#local-6989586621681362767"><span class="hs-identifier hs-var">imps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1616"></span><span>              </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnL
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681362756"><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (IE GhcRn)]
</span><a href="#local-6989586621681362756"><span class="hs-identifier hs-var">imp_ies</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1617"></span><span>                                 </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IE GhcRn -&gt; Defs -&gt; Defs
</span><a href="#local-6989586621681362755"><span class="hs-identifier hs-var">add_unused</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (IE GhcRn)]
</span><a href="#local-6989586621681362756"><span class="hs-identifier hs-var">imp_ies</span></a></span><span>
</span><span id="line-1618"></span><span>              </span><span id="local-6989586621681362754"><span class="annot"><span class="annottext">Maybe (Bool, XRec GhcRn [LIE GhcRn])
</span><a href="#local-6989586621681362754"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="GHC.Types.Name.Set.html#emptyNameSet"><span class="hs-identifier hs-var">emptyNameSet</span></a></span><span> </span><span class="hs-comment">-- No explicit import list =&gt; no unused-name list</span><span>
</span><span id="line-1619"></span><span>
</span><span id="line-1620"></span><span>        </span><span class="annot"><a href="#local-6989586621681362755"><span class="hs-identifier hs-type">add_unused</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Set.html#NameSet"><span class="hs-identifier hs-type">NameSet</span></a></span><span>
</span><span id="line-1621"></span><span>        </span><span id="local-6989586621681362755"><span class="annot"><span class="annottext">add_unused :: IE GhcRn -&gt; Defs -&gt; Defs
</span><a href="#local-6989586621681362755"><span class="hs-identifier hs-var hs-var">add_unused</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#IEVar"><span class="hs-identifier hs-type">IEVar</span></a></span><span> </span><span class="annot"><span class="annottext">XIEVar GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681362753"><span class="annot"><span class="annottext">LIEWrappedName (IdP GhcRn)
</span><a href="#local-6989586621681362753"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>      </span><span id="local-6989586621681362752"><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362752"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Defs -&gt; Defs
</span><a href="#local-6989586621681362751"><span class="hs-identifier hs-var">add_unused_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. LIEWrappedName name -&gt; name
</span><a href="GHC.Hs.ImpExp.html#lieWrappedName"><span class="hs-identifier hs-var">lieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName (IdP GhcRn)
</span><a href="#local-6989586621681362753"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362752"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1622"></span><span>        </span><span class="annot"><a href="#local-6989586621681362755"><span class="hs-identifier hs-var">add_unused</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#IEThingAbs"><span class="hs-identifier hs-type">IEThingAbs</span></a></span><span> </span><span class="annot"><span class="annottext">XIEThingAbs GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681362750"><span class="annot"><span class="annottext">LIEWrappedName (IdP GhcRn)
</span><a href="#local-6989586621681362750"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681362749"><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362749"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Defs -&gt; Defs
</span><a href="#local-6989586621681362751"><span class="hs-identifier hs-var">add_unused_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. LIEWrappedName name -&gt; name
</span><a href="GHC.Hs.ImpExp.html#lieWrappedName"><span class="hs-identifier hs-var">lieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName (IdP GhcRn)
</span><a href="#local-6989586621681362750"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362749"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1623"></span><span>        </span><span class="annot"><a href="#local-6989586621681362755"><span class="hs-identifier hs-var">add_unused</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#IEThingAll"><span class="hs-identifier hs-type">IEThingAll</span></a></span><span> </span><span class="annot"><span class="annottext">XIEThingAll GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681362748"><span class="annot"><span class="annottext">LIEWrappedName (IdP GhcRn)
</span><a href="#local-6989586621681362748"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681362747"><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362747"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Defs -&gt; Defs
</span><a href="#local-6989586621681362746"><span class="hs-identifier hs-var">add_unused_all</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. LIEWrappedName name -&gt; name
</span><a href="GHC.Hs.ImpExp.html#lieWrappedName"><span class="hs-identifier hs-var">lieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName (IdP GhcRn)
</span><a href="#local-6989586621681362748"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362747"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1624"></span><span>        </span><span class="annot"><a href="#local-6989586621681362755"><span class="hs-identifier hs-var">add_unused</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.ImpExp.html#IEThingWith"><span class="hs-identifier hs-type">IEThingWith</span></a></span><span> </span><span id="local-6989586621681362745"><span class="annot"><span class="annottext">XIEThingWith GhcRn
</span><a href="#local-6989586621681362745"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621681362744"><span class="annot"><span class="annottext">LIEWrappedName (IdP GhcRn)
</span><a href="#local-6989586621681362744"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681362743"><span class="annot"><span class="annottext">IEWildcard
</span><a href="#local-6989586621681362743"><span class="hs-identifier hs-var">wc</span></a></span></span><span> </span><span id="local-6989586621681362742"><span class="annot"><span class="annottext">[LIEWrappedName (IdP GhcRn)]
</span><a href="#local-6989586621681362742"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681362741"><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362741"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1625"></span><span>          </span><span class="annot"><span class="annottext">Defs -&gt; Defs
</span><a href="#local-6989586621681362740"><span class="hs-identifier hs-var">add_wc_all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Defs -&gt; Defs
</span><a href="#local-6989586621681362739"><span class="hs-identifier hs-var">add_unused_with</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362738"><span class="hs-identifier hs-var">pn</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681362737"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362741"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1626"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681362738"><span class="annot"><span class="annottext">pn :: Name
</span><a href="#local-6989586621681362738"><span class="hs-identifier hs-var hs-var">pn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall name. LIEWrappedName name -&gt; name
</span><a href="GHC.Hs.ImpExp.html#lieWrappedName"><span class="hs-identifier hs-var">lieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName (IdP GhcRn)
</span><a href="#local-6989586621681362744"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1627"></span><span>                </span><span id="local-6989586621681362737"><span class="annot"><span class="annottext">xs :: [Name]
</span><a href="#local-6989586621681362737"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. LIEWrappedName name -&gt; name
</span><a href="GHC.Hs.ImpExp.html#lieWrappedName"><span class="hs-identifier hs-var">lieWrappedName</span></a></span><span> </span><span class="annot"><span class="annottext">[LIEWrappedName (IdP GhcRn)]
</span><a href="#local-6989586621681362742"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldLabel -&gt; Name
</span><a href="GHC.Types.FieldLabel.html#flSelector"><span class="hs-identifier hs-var">flSelector</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XIEThingWith GhcRn
</span><a href="#local-6989586621681362745"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-1628"></span><span>                </span><span id="local-6989586621681362740"><span class="annot"><span class="annottext">add_wc_all :: Defs -&gt; Defs
</span><a href="#local-6989586621681362740"><span class="hs-identifier hs-var hs-var">add_wc_all</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IEWildcard
</span><a href="#local-6989586621681362743"><span class="hs-identifier hs-var">wc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1629"></span><span>                            </span><span class="annot"><span class="annottext">IEWildcard
</span><a href="GHC.Hs.ImpExp.html#NoIEWildcard"><span class="hs-identifier hs-var">NoIEWildcard</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1630"></span><span>                            </span><span class="annot"><a href="GHC.Hs.ImpExp.html#IEWildcard"><span class="hs-identifier hs-type">IEWildcard</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Defs -&gt; Defs
</span><a href="#local-6989586621681362746"><span class="hs-identifier hs-var">add_unused_all</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362738"><span class="hs-identifier hs-var">pn</span></a></span><span>
</span><span id="line-1631"></span><span>        </span><span class="annot"><a href="#local-6989586621681362755"><span class="hs-identifier hs-var">add_unused</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681362733"><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362733"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362733"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1632"></span><span>
</span><span id="line-1633"></span><span>        </span><span id="local-6989586621681362751"><span class="annot"><span class="annottext">add_unused_name :: Name -&gt; Defs -&gt; Defs
</span><a href="#local-6989586621681362751"><span class="hs-identifier hs-var hs-var">add_unused_name</span></a></span></span><span> </span><span id="local-6989586621681362732"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362732"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681362731"><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362731"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-1634"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362732"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Defs -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362761"><span class="hs-identifier hs-var">used_names</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362731"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1635"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362731"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Defs -&gt; Name -&gt; Defs
</span><a href="GHC.Types.Name.Set.html#extendNameSet"><span class="hs-operator hs-var">`extendNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362732"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1636"></span><span>        </span><span id="local-6989586621681362746"><span class="annot"><span class="annottext">add_unused_all :: Name -&gt; Defs -&gt; Defs
</span><a href="#local-6989586621681362746"><span class="hs-identifier hs-var hs-var">add_unused_all</span></a></span></span><span> </span><span id="local-6989586621681362729"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362729"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681362728"><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362728"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-1637"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362729"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Defs -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362761"><span class="hs-identifier hs-var">used_names</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362728"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1638"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362729"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Defs -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362759"><span class="hs-identifier hs-var">used_parents</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362728"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1639"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362728"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Defs -&gt; Name -&gt; Defs
</span><a href="GHC.Types.Name.Set.html#extendNameSet"><span class="hs-operator hs-var">`extendNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362729"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1640"></span><span>        </span><span id="local-6989586621681362739"><span class="annot"><span class="annottext">add_unused_with :: Name -&gt; [Name] -&gt; Defs -&gt; Defs
</span><a href="#local-6989586621681362739"><span class="hs-identifier hs-var hs-var">add_unused_with</span></a></span></span><span> </span><span id="local-6989586621681362727"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362727"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681362726"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681362726"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span id="local-6989586621681362725"><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362725"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-1641"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Defs -&gt; Bool
</span><a href="GHC.Types.Name.Set.html#elemNameSet"><span class="hs-operator hs-var">`elemNameSet`</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362723"><span class="hs-identifier hs-var">acc1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681362726"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Defs -&gt; Defs
</span><a href="#local-6989586621681362751"><span class="hs-identifier hs-var">add_unused_name</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362727"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362723"><span class="hs-identifier hs-var">acc1</span></a></span><span>
</span><span id="line-1642"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362723"><span class="hs-identifier hs-var">acc1</span></a></span><span>
</span><span id="line-1643"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-1644"></span><span>            </span><span id="local-6989586621681362723"><span class="annot"><span class="annottext">acc1 :: Defs
</span><a href="#local-6989586621681362723"><span class="hs-identifier hs-var hs-var">acc1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Defs -&gt; Defs
</span><a href="#local-6989586621681362751"><span class="hs-identifier hs-var">add_unused_name</span></a></span><span> </span><span class="annot"><span class="annottext">Defs
</span><a href="#local-6989586621681362725"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681362726"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-1645"></span><span>       </span><span class="hs-comment">-- If you use 'signum' from Num, then the user may well have</span><span>
</span><span id="line-1646"></span><span>       </span><span class="hs-comment">-- imported Num(signum).  We don't want to complain that</span><span>
</span><span id="line-1647"></span><span>       </span><span class="hs-comment">-- Num is not itself mentioned.  Hence the two cases in add_unused_with.</span><span>
</span><span id="line-1648"></span><span>
</span><span id="line-1649"></span><span>
</span><span id="line-1650"></span><span class="hs-comment">{- Note [The ImportMap]
~~~~~~~~~~~~~~~~~~~~~~~
The ImportMap is a short-lived intermediate data structure records, for
each import declaration, what stuff brought into scope by that
declaration is actually used in the module.

The SrcLoc is the location of the END of a particular 'import'
declaration.  Why *END*?  Because we don't want to get confused
by the implicit Prelude import. Consider (#7476) the module
    import Foo( foo )
    main = print foo
There is an implicit 'import Prelude(print)', and it gets a SrcSpan
of line 1:1 (just the point, not a span). If we use the *START* of
the SrcSpan to identify the import decl, we'll confuse the implicit
import Prelude with the explicit 'import Foo'.  So we use the END.
It's just a cheap hack; we could equally well use the Span too.

The [GlobalRdrElt] are the things imported from that decl.
-}</span><span>
</span><span id="line-1669"></span><span>
</span><span id="line-1670"></span><span class="hs-keyword">type</span><span> </span><span id="ImportMap"><span class="annot"><a href="GHC.Rename.Names.html#ImportMap"><span class="hs-identifier hs-var">ImportMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../containers-0.6.5.1/src/Data-Map-Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#RealSrcLoc"><span class="hs-identifier hs-type">RealSrcLoc</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- See [The ImportMap]</span><span>
</span><span id="line-1671"></span><span>     </span><span class="hs-comment">-- If loc :-&gt; gres, then</span><span>
</span><span id="line-1672"></span><span>     </span><span class="hs-comment">--   'loc' = the end loc of the bestImport of each GRE in 'gres'</span><span>
</span><span id="line-1673"></span><span>
</span><span id="line-1674"></span><span class="annot"><a href="GHC.Rename.Names.html#mkImportMap"><span class="hs-identifier hs-type">mkImportMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#ImportMap"><span class="hs-identifier hs-type">ImportMap</span></a></span><span>
</span><span id="line-1675"></span><span class="hs-comment">-- For each of a list of used GREs, find all the import decls that brought</span><span>
</span><span id="line-1676"></span><span class="hs-comment">-- it into scope; choose one of them (bestImport), and record</span><span>
</span><span id="line-1677"></span><span class="hs-comment">-- the RdrName in that import decl's entry in the ImportMap</span><span>
</span><span id="line-1678"></span><span id="mkImportMap"><span class="annot"><span class="annottext">mkImportMap :: [GlobalRdrElt] -&gt; ImportMap
</span><a href="GHC.Rename.Names.html#mkImportMap"><span class="hs-identifier hs-var hs-var">mkImportMap</span></a></span></span><span> </span><span id="local-6989586621681362722"><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362722"><span class="hs-identifier hs-var">gres</span></a></span></span><span>
</span><span id="line-1679"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; ImportMap -&gt; ImportMap
</span><a href="#local-6989586621681362721"><span class="hs-identifier hs-var">add_one</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><a href="../../containers-0.6.5.1/src/Data-Map-Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362722"><span class="hs-identifier hs-var">gres</span></a></span><span>
</span><span id="line-1680"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1681"></span><span>    </span><span id="local-6989586621681362721"><span class="annot"><span class="annottext">add_one :: GlobalRdrElt -&gt; ImportMap -&gt; ImportMap
</span><a href="#local-6989586621681362721"><span class="hs-identifier hs-var hs-var">add_one</span></a></span></span><span> </span><span id="local-6989586621681362717"><span class="annot"><span class="annottext">gre :: GlobalRdrElt
</span><a href="#local-6989586621681362717"><span class="hs-identifier hs-var">gre</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GRE"><span class="hs-identifier hs-type">GRE</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">gre_imp :: GlobalRdrElt -&gt; [ImportSpec]
</span><a href="GHC.Types.Name.Reader.html#gre_imp"><span class="hs-identifier hs-var">gre_imp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681362714"><span class="annot"><span class="annottext">[ImportSpec]
</span><a href="#local-6989586621681362714"><span class="hs-identifier hs-var">imp_specs</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621681362713"><span class="annot"><span class="annottext">ImportMap
</span><a href="#local-6989586621681362713"><span class="hs-identifier hs-var">imp_map</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1682"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; SrcLoc
</span><a href="GHC.Types.SrcLoc.html#srcSpanEnd"><span class="hs-identifier hs-var">srcSpanEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ImpDeclSpec -&gt; SrcSpan
</span><a href="GHC.Types.Name.Reader.html#is_dloc"><span class="hs-identifier hs-var">is_dloc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ImportSpec -&gt; ImpDeclSpec
</span><a href="GHC.Types.Name.Reader.html#is_decl"><span class="hs-identifier hs-var">is_decl</span></a></span><span> </span><span class="annot"><span class="annottext">ImportSpec
</span><a href="#local-6989586621681362712"><span class="hs-identifier hs-var">best_imp_spec</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1683"></span><span>                              </span><span class="hs-comment">-- For srcSpanEnd see Note [The ImportMap]</span><span>
</span><span id="line-1684"></span><span>       </span><span class="annot"><a href="GHC.Types.SrcLoc.html#RealSrcLoc"><span class="hs-identifier hs-type">RealSrcLoc</span></a></span><span> </span><span id="local-6989586621681362710"><span class="annot"><span class="annottext">RealSrcLoc
</span><a href="#local-6989586621681362710"><span class="hs-identifier hs-var">decl_loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe BufPos
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../../containers-0.6.5.1/src/Data-Map-Internal.html#insertWith"><span class="hs-identifier hs-var">Map.insertWith</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt] -&gt; [GlobalRdrElt] -&gt; [GlobalRdrElt]
</span><a href="#local-6989586621681362708"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcLoc
</span><a href="#local-6989586621681362710"><span class="hs-identifier hs-var">decl_loc</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681362717"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ImportMap
</span><a href="#local-6989586621681362713"><span class="hs-identifier hs-var">imp_map</span></a></span><span>
</span><span id="line-1685"></span><span>       </span><span class="annot"><a href="GHC.Types.SrcLoc.html#UnhelpfulLoc"><span class="hs-identifier hs-type">UnhelpfulLoc</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ImportMap
</span><a href="#local-6989586621681362713"><span class="hs-identifier hs-var">imp_map</span></a></span><span>
</span><span id="line-1686"></span><span>       </span><span class="hs-keyword">where</span><span>
</span><span id="line-1687"></span><span>          </span><span id="local-6989586621681362712"><span class="annot"><span class="annottext">best_imp_spec :: ImportSpec
</span><a href="#local-6989586621681362712"><span class="hs-identifier hs-var hs-var">best_imp_spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ImportSpec] -&gt; ImportSpec
</span><a href="GHC.Types.Name.Reader.html#bestImport"><span class="hs-identifier hs-var">bestImport</span></a></span><span> </span><span class="annot"><span class="annottext">[ImportSpec]
</span><a href="#local-6989586621681362714"><span class="hs-identifier hs-var">imp_specs</span></a></span><span>
</span><span id="line-1688"></span><span>          </span><span id="local-6989586621681362708"><span class="annot"><span class="annottext">add :: [GlobalRdrElt] -&gt; [GlobalRdrElt] -&gt; [GlobalRdrElt]
</span><a href="#local-6989586621681362708"><span class="hs-identifier hs-var hs-var">add</span></a></span></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681362705"><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362705"><span class="hs-identifier hs-var">gres</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681362717"><span class="hs-identifier hs-var">gre</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362705"><span class="hs-identifier hs-var">gres</span></a></span><span>
</span><span id="line-1689"></span><span>
</span><span id="line-1690"></span><span class="annot"><a href="GHC.Rename.Names.html#warnUnusedImport"><span class="hs-identifier hs-type">warnUnusedImport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.Flags.html#WarningFlag"><span class="hs-identifier hs-type">WarningFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Env.html#NameEnv"><span class="hs-identifier hs-type">NameEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.FieldLabel.html#FieldLabelString"><span class="hs-identifier hs-type">FieldLabelString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#Parent"><span class="hs-identifier hs-type">Parent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1691"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Rename.Names.html#ImportDeclUsage"><span class="hs-identifier hs-type">ImportDeclUsage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1692"></span><span id="warnUnusedImport"><span class="annot"><span class="annottext">warnUnusedImport :: WarningFlag
-&gt; NameEnv (FastString, Parent)
-&gt; ImportDeclUsage
-&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Names.html#warnUnusedImport"><span class="hs-identifier hs-var hs-var">warnUnusedImport</span></a></span></span><span> </span><span id="local-6989586621681362703"><span class="annot"><span class="annottext">WarningFlag
</span><a href="#local-6989586621681362703"><span class="hs-identifier hs-var">flag</span></a></span></span><span> </span><span id="local-6989586621681362702"><span class="annot"><span class="annottext">NameEnv (FastString, Parent)
</span><a href="#local-6989586621681362702"><span class="hs-identifier hs-var">fld_env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681362701"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362701"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621681362700"><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362700"><span class="hs-identifier hs-var">decl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681362699"><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362699"><span class="hs-identifier hs-var">used</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681362698"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681362698"><span class="hs-identifier hs-var">unused</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1693"></span><span>
</span><span id="line-1694"></span><span>  </span><span class="hs-comment">-- Do not warn for 'import M()'</span><span>
</span><span id="line-1695"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnL
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; Maybe (Bool, XRec pass [LIE pass])
</span><a href="GHC.Hs.ImpExp.html#ideclHiding"><span class="hs-identifier hs-var">ideclHiding</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362700"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-1696"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1697"></span><span>
</span><span id="line-1698"></span><span>  </span><span class="hs-comment">-- Note [Do not warn about Prelude hiding]</span><span>
</span><span id="line-1699"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnL
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681362697"><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (IE GhcRn)]
</span><a href="#local-6989586621681362697"><span class="hs-identifier hs-var">hides</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; Maybe (Bool, XRec pass [LIE pass])
</span><a href="GHC.Hs.ImpExp.html#ideclHiding"><span class="hs-identifier hs-var">ideclHiding</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362700"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-1700"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (IE GhcRn)]
</span><a href="#local-6989586621681362697"><span class="hs-identifier hs-var">hides</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1701"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="GHC.Builtin.Names.html#pRELUDE_NAME"><span class="hs-identifier hs-var">pRELUDE_NAME</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; XRec pass ModuleName
</span><a href="GHC.Hs.ImpExp.html#ideclName"><span class="hs-identifier hs-var">ideclName</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362700"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1702"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1703"></span><span>
</span><span id="line-1704"></span><span>  </span><span class="hs-comment">-- Nothing used; drop entire declaration</span><span>
</span><span id="line-1705"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362699"><span class="hs-identifier hs-var">used</span></a></span><span>
</span><span id="line-1706"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarnReason -&gt; SrcSpan -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addWarnAt"><span class="hs-identifier hs-var">addWarnAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningFlag -&gt; WarnReason
</span><a href="GHC.Driver.Flags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="#local-6989586621681362703"><span class="hs-identifier hs-var">flag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362701"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362695"><span class="hs-identifier hs-var">msg1</span></a></span><span>
</span><span id="line-1707"></span><span>
</span><span id="line-1708"></span><span>  </span><span class="hs-comment">-- Everything imported is used; nop</span><span>
</span><span id="line-1709"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681362698"><span class="hs-identifier hs-var">unused</span></a></span><span>
</span><span id="line-1710"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1711"></span><span>
</span><span id="line-1712"></span><span>  </span><span class="hs-comment">-- Only one import is unused, with `SrcSpan` covering only the unused item instead of</span><span>
</span><span id="line-1713"></span><span>  </span><span class="hs-comment">-- the whole import statement</span><span>
</span><span id="line-1714"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnL
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681362694"><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (IE GhcRn)]
</span><a href="#local-6989586621681362694"><span class="hs-identifier hs-var">imports</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; Maybe (Bool, XRec pass [LIE pass])
</span><a href="GHC.Hs.ImpExp.html#ideclHiding"><span class="hs-identifier hs-var">ideclHiding</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362700"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-1715"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681362698"><span class="hs-identifier hs-var">unused</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1716"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681362692"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362692"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">IE GhcRn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#find"><span class="hs-identifier hs-var">find</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681362691"><span class="annot"><span class="annottext">IE GhcRn
</span><a href="#local-6989586621681362691"><span class="hs-identifier hs-var">ie</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: Pass). IE (GhcPass p) -&gt; IdP (GhcPass p)
</span><a href="GHC.Hs.ImpExp.html#ieName"><span class="hs-identifier hs-var">ieName</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcRn
</span><a href="#local-6989586621681362691"><span class="hs-identifier hs-var">ie</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#elem"><span class="hs-operator hs-var">`elem`</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681362698"><span class="hs-identifier hs-var">unused</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (IE GhcRn)]
</span><a href="#local-6989586621681362694"><span class="hs-identifier hs-var">imports</span></a></span><span>
</span><span id="line-1717"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarnReason -&gt; SrcSpan -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addWarnAt"><span class="hs-identifier hs-var">addWarnAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningFlag -&gt; WarnReason
</span><a href="GHC.Driver.Flags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="#local-6989586621681362703"><span class="hs-identifier hs-var">flag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362692"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362689"><span class="hs-identifier hs-var">msg2</span></a></span><span>
</span><span id="line-1718"></span><span>
</span><span id="line-1719"></span><span>  </span><span class="hs-comment">-- Some imports are unused</span><span>
</span><span id="line-1720"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1721"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WarnReason -&gt; SrcSpan -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addWarnAt"><span class="hs-identifier hs-var">addWarnAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningFlag -&gt; WarnReason
</span><a href="GHC.Driver.Flags.html#Reason"><span class="hs-identifier hs-var">Reason</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="#local-6989586621681362703"><span class="hs-identifier hs-var">flag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362701"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362689"><span class="hs-identifier hs-var">msg2</span></a></span><span>
</span><span id="line-1722"></span><span>
</span><span id="line-1723"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1724"></span><span>    </span><span id="local-6989586621681362695"><span class="annot"><span class="annottext">msg1 :: SDoc
</span><a href="#local-6989586621681362695"><span class="hs-identifier hs-var hs-var">msg1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362688"><span class="hs-identifier hs-var">pp_herald</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362687"><span class="hs-identifier hs-var">pp_mod</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362686"><span class="hs-identifier hs-var">is_redundant</span></a></span><span>
</span><span id="line-1725"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;except perhaps to import instances from&quot;</span></span><span>
</span><span id="line-1726"></span><span>                                   </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362687"><span class="hs-identifier hs-var">pp_mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1727"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;To import instances alone, use:&quot;</span></span><span>
</span><span id="line-1728"></span><span>                                   </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;import&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362687"><span class="hs-identifier hs-var">pp_mod</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">Outputable.empty</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1729"></span><span>    </span><span id="local-6989586621681362689"><span class="annot"><span class="annottext">msg2 :: SDoc
</span><a href="#local-6989586621681362689"><span class="hs-identifier hs-var hs-var">msg2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362688"><span class="hs-identifier hs-var">pp_herald</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362680"><span class="hs-identifier hs-var">sort_unused</span></a></span><span>
</span><span id="line-1730"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;from module&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362687"><span class="hs-identifier hs-var">pp_mod</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362686"><span class="hs-identifier hs-var">is_redundant</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1731"></span><span>    </span><span id="local-6989586621681362688"><span class="annot"><span class="annottext">pp_herald :: SDoc
</span><a href="#local-6989586621681362688"><span class="hs-identifier hs-var hs-var">pp_herald</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362679"><span class="hs-identifier hs-var">pp_qual</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;import of&quot;</span></span><span>
</span><span id="line-1732"></span><span>    </span><span id="local-6989586621681362679"><span class="annot"><span class="annottext">pp_qual :: SDoc
</span><a href="#local-6989586621681362679"><span class="hs-identifier hs-var hs-var">pp_qual</span></a></span></span><span>
</span><span id="line-1733"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ImportDeclQualifiedStyle -&gt; Bool
</span><a href="GHC.Hs.ImpExp.html#isImportDeclQualified"><span class="hs-identifier hs-var">isImportDeclQualified</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; ImportDeclQualifiedStyle
</span><a href="GHC.Hs.ImpExp.html#ideclQualified"><span class="hs-identifier hs-var">ideclQualified</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362700"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-special">)</span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;qualified&quot;</span></span><span>
</span><span id="line-1734"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">Outputable.empty</span></a></span><span>
</span><span id="line-1735"></span><span>    </span><span id="local-6989586621681362687"><span class="annot"><span class="annottext">pp_mod :: SDoc
</span><a href="#local-6989586621681362687"><span class="hs-identifier hs-var hs-var">pp_mod</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; XRec pass ModuleName
</span><a href="GHC.Hs.ImpExp.html#ideclName"><span class="hs-identifier hs-var">ideclName</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362700"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1736"></span><span>    </span><span id="local-6989586621681362686"><span class="annot"><span class="annottext">is_redundant :: SDoc
</span><a href="#local-6989586621681362686"><span class="hs-identifier hs-var hs-var">is_redundant</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is redundant&quot;</span></span><span>
</span><span id="line-1737"></span><span>
</span><span id="line-1738"></span><span>    </span><span class="hs-comment">-- In warning message, pretty-print identifiers unqualified unconditionally</span><span>
</span><span id="line-1739"></span><span>    </span><span class="hs-comment">-- to improve the consistent for ambiguous/unambiguous identifiers.</span><span>
</span><span id="line-1740"></span><span>    </span><span class="hs-comment">-- See trac#14881.</span><span>
</span><span id="line-1741"></span><span>    </span><span id="local-6989586621681362678"><span class="annot"><span class="annottext">ppr_possible_field :: Name -&gt; SDoc
</span><a href="#local-6989586621681362678"><span class="hs-identifier hs-var hs-var">ppr_possible_field</span></a></span></span><span> </span><span id="local-6989586621681362677"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362677"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. NameEnv a -&gt; Name -&gt; Maybe a
</span><a href="GHC.Types.Name.Env.html#lookupNameEnv"><span class="hs-identifier hs-var">lookupNameEnv</span></a></span><span> </span><span class="annot"><span class="annottext">NameEnv (FastString, Parent)
</span><a href="#local-6989586621681362702"><span class="hs-identifier hs-var">fld_env</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362677"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1742"></span><span>                               </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681362676"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681362676"><span class="hs-identifier hs-var">fld</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#ParentIs"><span class="hs-identifier hs-type">ParentIs</span></a></span><span> </span><span id="local-6989586621681362675"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362675"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; SDoc
</span><a href="GHC.Types.Name.html#pprNameUnqualified"><span class="hs-identifier hs-var">pprNameUnqualified</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362675"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681362676"><span class="hs-identifier hs-var">fld</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1743"></span><span>                               </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681362673"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681362673"><span class="hs-identifier hs-var">fld</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Parent
</span><a href="GHC.Types.Name.Reader.html#NoParent"><span class="hs-identifier hs-var">NoParent</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681362673"><span class="hs-identifier hs-var">fld</span></a></span><span>
</span><span id="line-1744"></span><span>                               </span><span class="annot"><span class="annottext">Maybe (FastString, Parent)
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; SDoc
</span><a href="GHC.Types.Name.html#pprNameUnqualified"><span class="hs-identifier hs-var">pprNameUnqualified</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362677"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1745"></span><span>
</span><span id="line-1746"></span><span>    </span><span class="hs-comment">-- Print unused names in a deterministic (lexicographic) order</span><span>
</span><span id="line-1747"></span><span>    </span><span class="annot"><a href="#local-6989586621681362680"><span class="hs-identifier hs-type">sort_unused</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1748"></span><span>    </span><span id="local-6989586621681362680"><span class="annot"><span class="annottext">sort_unused :: SDoc
</span><a href="#local-6989586621681362680"><span class="hs-identifier hs-var hs-var">sort_unused</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; SDoc) -&gt; [a] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#pprWithCommas"><span class="hs-identifier hs-var">pprWithCommas</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SDoc
</span><a href="#local-6989586621681362678"><span class="hs-identifier hs-var">ppr_possible_field</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1749"></span><span>                  </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/Data-OldList.html#sortBy"><span class="hs-identifier hs-var">sortBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><a href="../../base-4.16.4.0/src/Data-Ord.html#comparing"><span class="hs-identifier hs-var">comparing</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681362698"><span class="hs-identifier hs-var">unused</span></a></span><span>
</span><span id="line-1750"></span><span>
</span><span id="line-1751"></span><span class="hs-comment">{-
Note [Do not warn about Prelude hiding]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We do not warn about
   import Prelude hiding( x, y )
because even if nothing else from Prelude is used, it may be essential to hide
x,y to avoid name-shadowing warnings.  Example (#9061)
   import Prelude hiding( log )
   f x = log where log = ()



Note [Printing minimal imports]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
To print the minimal imports we walk over the user-supplied import
decls, and simply trim their import lists.  NB that

  * We do *not* change the 'qualified' or 'as' parts!

  * We do not discard a decl altogether; we might need instances
    from it.  Instead we just trim to an empty import list
-}</span><span>
</span><span id="line-1773"></span><span>
</span><span id="line-1774"></span><span class="annot"><a href="GHC.Rename.Names.html#getMinimalImports"><span class="hs-identifier hs-type">getMinimalImports</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Names.html#ImportDeclUsage"><span class="hs-identifier hs-type">ImportDeclUsage</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1775"></span><span id="getMinimalImports"><span class="annot"><span class="annottext">getMinimalImports :: [ImportDeclUsage] -&gt; RnM [LImportDecl GhcRn]
</span><a href="GHC.Rename.Names.html#getMinimalImports"><span class="hs-identifier hs-var hs-var">getMinimalImports</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">[LImportDecl GhcRn] -&gt; [LImportDecl GhcRn]
</span><a href="#local-6989586621681362671"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../base-4.16.4.0/src/Data-Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">forall {t :: * -&gt; *} {a}.
Foldable t =&gt;
(GenLocated SrcSpanAnnA (ImportDecl GhcRn), [GlobalRdrElt], t a)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnA (ImportDecl GhcRn))
</span><a href="#local-6989586621681362670"><span class="hs-identifier hs-var">mk_minimal</span></a></span><span>
</span><span id="line-1776"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1777"></span><span>    </span><span id="local-6989586621681362670"><span class="annot"><span class="annottext">mk_minimal :: (GenLocated SrcSpanAnnA (ImportDecl GhcRn), [GlobalRdrElt], t a)
-&gt; IOEnv
     (Env TcGblEnv TcLclEnv) (GenLocated SrcSpanAnnA (ImportDecl GhcRn))
</span><a href="#local-6989586621681362670"><span class="hs-identifier hs-var hs-var">mk_minimal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681362647"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362647"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681362646"><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362646"><span class="hs-identifier hs-var">decl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681362645"><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362645"><span class="hs-identifier hs-var">used_gres</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681362644"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621681362644"><span class="hs-identifier hs-var">unused</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1778"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621681362644"><span class="hs-identifier hs-var">unused</span></a></span><span>
</span><span id="line-1779"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XRec GhcRn [LIE GhcRn]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; Maybe (Bool, XRec pass [LIE pass])
</span><a href="GHC.Hs.ImpExp.html#ideclHiding"><span class="hs-identifier hs-var">ideclHiding</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362646"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-1780"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362647"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362646"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1781"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-1782"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#ImportDecl"><span class="hs-identifier hs-type">ImportDecl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ideclName :: forall pass. ImportDecl pass -&gt; XRec pass ModuleName
</span><a href="GHC.Hs.ImpExp.html#ideclName"><span class="hs-identifier hs-var">ideclName</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681362643"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681362643"><span class="hs-identifier hs-var">mod_name</span></a></span></span><span>
</span><span id="line-1783"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ideclSource :: forall pass. ImportDecl pass -&gt; IsBootInterface
</span><a href="GHC.Hs.ImpExp.html#ideclSource"><span class="hs-identifier hs-var">ideclSource</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681362642"><span class="annot"><span class="annottext">IsBootInterface
</span><a href="#local-6989586621681362642"><span class="hs-identifier hs-var">is_boot</span></a></span></span><span>
</span><span id="line-1784"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ideclPkgQual :: forall pass. ImportDecl pass -&gt; Maybe StringLiteral
</span><a href="GHC.Hs.ImpExp.html#ideclPkgQual"><span class="hs-identifier hs-var">ideclPkgQual</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681362641"><span class="annot"><span class="annottext">Maybe StringLiteral
</span><a href="#local-6989586621681362641"><span class="hs-identifier hs-var">mb_pkg</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362646"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-1785"></span><span>           </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681362640"><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681362640"><span class="hs-identifier hs-var">iface</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SDoc
-&gt; ModuleName
-&gt; IsBootInterface
-&gt; Maybe FastString
-&gt; RnM ModIface
</span><a href="GHC.Iface.Load.html#loadSrcInterface"><span class="hs-identifier hs-var">loadSrcInterface</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362639"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681362643"><span class="hs-identifier hs-var">mod_name</span></a></span><span> </span><span class="annot"><span class="annottext">IsBootInterface
</span><a href="#local-6989586621681362642"><span class="hs-identifier hs-var">is_boot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">StringLiteral -&gt; FastString
</span><a href="GHC.Types.SourceText.html#sl_fs"><span class="hs-identifier hs-var">sl_fs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StringLiteral
</span><a href="#local-6989586621681362641"><span class="hs-identifier hs-var">mb_pkg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1786"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681362638"><span class="annot"><span class="annottext">used_avails :: [AvailInfo]
</span><a href="#local-6989586621681362638"><span class="hs-identifier hs-var hs-var">used_avails</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt] -&gt; [AvailInfo]
</span><a href="GHC.Types.Name.Reader.html#gresToAvailInfo"><span class="hs-identifier hs-var">gresToAvailInfo</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362645"><span class="hs-identifier hs-var">used_gres</span></a></span><span>
</span><span id="line-1787"></span><span>                 </span><span id="local-6989586621681362636"><span class="annot"><span class="annottext">lies :: [GenLocated SrcSpanAnnA (IE GhcRn)]
</span><a href="#local-6989586621681362636"><span class="hs-identifier hs-var hs-var">lies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362647"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModIface -&gt; AvailInfo -&gt; [IE GhcRn]
</span><a href="#local-6989586621681362635"><span class="hs-identifier hs-var">to_ie</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681362640"><span class="hs-identifier hs-var">iface</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681362638"><span class="hs-identifier hs-var">used_avails</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1788"></span><span>           </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362647"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362646"><span class="hs-identifier hs-var">decl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ideclHiding :: Maybe (Bool, XRec GhcRn [LIE GhcRn])
</span><a href="GHC.Hs.ImpExp.html#ideclHiding"><span class="hs-identifier hs-var">ideclHiding</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a ann. SrcSpanAnn' a -&gt; SrcAnn ann
</span><a href="GHC.Parser.Annotation.html#l2l"><span class="hs-identifier hs-var">l2l</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362647"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (IE GhcRn)]
</span><a href="#local-6989586621681362636"><span class="hs-identifier hs-var">lies</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1789"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1790"></span><span>        </span><span id="local-6989586621681362639"><span class="annot"><span class="annottext">doc :: SDoc
</span><a href="#local-6989586621681362639"><span class="hs-identifier hs-var hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Compute minimal imports for&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362646"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-1791"></span><span>
</span><span id="line-1792"></span><span>    </span><span class="annot"><a href="#local-6989586621681362635"><span class="hs-identifier hs-type">to_ie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModIface.html#ModIface"><span class="hs-identifier hs-type">ModIface</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1793"></span><span>    </span><span class="hs-comment">-- The main trick here is that if we're importing all the constructors</span><span>
</span><span id="line-1794"></span><span>    </span><span class="hs-comment">-- we want to say &quot;T(..)&quot;, but if we're importing only a subset we want</span><span>
</span><span id="line-1795"></span><span>    </span><span class="hs-comment">-- to say &quot;T(A,B,C)&quot;.  So we have to find out what the module exports.</span><span>
</span><span id="line-1796"></span><span>    </span><span id="local-6989586621681362635"><span class="annot"><span class="annottext">to_ie :: ModIface -&gt; AvailInfo -&gt; [IE GhcRn]
</span><a href="#local-6989586621681362635"><span class="hs-identifier hs-var hs-var">to_ie</span></a></span></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#Avail"><span class="hs-identifier hs-type">Avail</span></a></span><span> </span><span id="local-6989586621681362634"><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681362634"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Note [Overloaded field import]</span><span>
</span><span id="line-1797"></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall pass. XIEVar pass -&gt; LIEWrappedName (IdP pass) -&gt; IE pass
</span><a href="GHC.Hs.ImpExp.html#IEVar"><span class="hs-identifier hs-var">IEVar</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name.
HasOccName name =&gt;
LocatedA name -&gt; LIEWrappedName name
</span><a href="GHC.Rename.Names.html#to_ie_post_rn"><span class="hs-identifier hs-var">to_ie_post_rn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GreName -&gt; Name
</span><a href="GHC.Types.Avail.html#greNamePrintableName"><span class="hs-identifier hs-var">greNamePrintableName</span></a></span><span> </span><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681362634"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1798"></span><span>    </span><span class="annot"><a href="#local-6989586621681362635"><span class="hs-identifier hs-var">to_ie</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681362631"><span class="annot"><span class="annottext">avail :: AvailInfo
</span><a href="#local-6989586621681362631"><span class="hs-identifier hs-var">avail</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#AvailTC"><span class="hs-identifier hs-type">AvailTC</span></a></span><span> </span><span id="local-6989586621681362630"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362630"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GreName
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Exporting the main decl and nothing else</span><span>
</span><span id="line-1799"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AvailInfo -&gt; Bool
</span><a href="GHC.Types.Avail.html#availExportsDecl"><span class="hs-identifier hs-var">availExportsDecl</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681362631"><span class="hs-identifier hs-var">avail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall pass.
XIEThingAbs pass -&gt; LIEWrappedName (IdP pass) -&gt; IE pass
</span><a href="GHC.Hs.ImpExp.html#IEThingAbs"><span class="hs-identifier hs-var">IEThingAbs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name.
HasOccName name =&gt;
LocatedA name -&gt; LIEWrappedName name
</span><a href="GHC.Rename.Names.html#to_ie_post_rn"><span class="hs-identifier hs-var">to_ie_post_rn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362630"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1800"></span><span>    </span><span class="annot"><a href="#local-6989586621681362635"><span class="hs-identifier hs-var">to_ie</span></a></span><span> </span><span id="local-6989586621681362628"><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681362628"><span class="hs-identifier hs-var">iface</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#AvailTC"><span class="hs-identifier hs-type">AvailTC</span></a></span><span> </span><span id="local-6989586621681362627"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362627"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681362626"><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362626"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1801"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362625"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681362624"><span class="annot"><span class="annottext">avail :: AvailInfo
</span><a href="#local-6989586621681362624"><span class="hs-identifier hs-var">avail</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#AvailTC"><span class="hs-identifier hs-type">AvailTC</span></a></span><span> </span><span id="local-6989586621681362623"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362623"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681362625"><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362625"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (phase :: ModIfacePhase). ModIface_ phase -&gt; [AvailInfo]
</span><a href="GHC.Unit.Module.ModIface.html#mi_exports"><span class="hs-identifier hs-var">mi_exports</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681362628"><span class="hs-identifier hs-var">iface</span></a></span><span>
</span><span id="line-1802"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362623"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362627"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1803"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AvailInfo -&gt; Bool
</span><a href="GHC.Types.Avail.html#availExportsDecl"><span class="hs-identifier hs-var">availExportsDecl</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681362624"><span class="hs-identifier hs-var">avail</span></a></span><span>  </span><span class="hs-comment">-- Note [Partial export]</span><span>
</span><span id="line-1804"></span><span>                 </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1805"></span><span>           </span><span class="hs-special">[</span><span id="local-6989586621681362622"><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362622"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[GreName] -&gt; Bool
</span><a href="#local-6989586621681362621"><span class="hs-identifier hs-var">all_used</span></a></span><span> </span><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362622"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1806"></span><span>                   </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall pass.
XIEThingAll pass -&gt; LIEWrappedName (IdP pass) -&gt; IE pass
</span><a href="GHC.Hs.ImpExp.html#IEThingAll"><span class="hs-identifier hs-var">IEThingAll</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name.
HasOccName name =&gt;
LocatedA name -&gt; LIEWrappedName name
</span><a href="GHC.Rename.Names.html#to_ie_post_rn"><span class="hs-identifier hs-var">to_ie_post_rn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362627"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1807"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1808"></span><span>                   </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall pass.
XIEThingWith pass
-&gt; LIEWrappedName (IdP pass)
-&gt; IEWildcard
-&gt; [LIEWrappedName (IdP pass)]
-&gt; IE pass
</span><a href="GHC.Hs.ImpExp.html#IEThingWith"><span class="hs-identifier hs-var">IEThingWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall e. e -&gt; Located e
</span><a href="GHC.Types.SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621681362619"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name.
HasOccName name =&gt;
LocatedA name -&gt; LIEWrappedName name
</span><a href="GHC.Rename.Names.html#to_ie_post_rn"><span class="hs-identifier hs-var">to_ie_post_rn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362627"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IEWildcard
</span><a href="GHC.Hs.ImpExp.html#NoIEWildcard"><span class="hs-identifier hs-var">NoIEWildcard</span></a></span><span>
</span><span id="line-1809"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name.
HasOccName name =&gt;
LocatedA name -&gt; LIEWrappedName name
</span><a href="GHC.Rename.Names.html#to_ie_post_rn"><span class="hs-identifier hs-var">to_ie_post_rn</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362627"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681362618"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1810"></span><span>                                          </span><span class="hs-comment">-- Note [Overloaded field import]</span><span>
</span><span id="line-1811"></span><span>           </span><span id="local-6989586621681362617"><span class="annot"><span class="annottext">[[GreName]]
</span><a href="#local-6989586621681362617"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[FieldLabel] -&gt; Bool
</span><a href="#local-6989586621681362616"><span class="hs-identifier hs-var">all_non_overloaded</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621681362619"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-1812"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass. XIEVar pass -&gt; LIEWrappedName (IdP pass) -&gt; IE pass
</span><a href="GHC.Hs.ImpExp.html#IEVar"><span class="hs-identifier hs-var">IEVar</span></a></span><span> </span><span class="annot"><span class="annottext">NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall name.
HasOccName name =&gt;
LocatedA name -&gt; LIEWrappedName name
</span><a href="GHC.Rename.Names.html#to_ie_post_rn_var"><span class="hs-identifier hs-var">to_ie_post_rn_var</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681362618"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-1813"></span><span>                                 </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">FieldLabel -&gt; Name
</span><a href="GHC.Types.FieldLabel.html#flSelector"><span class="hs-identifier hs-var">flSelector</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621681362619"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-1814"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1815"></span><span>                      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall pass.
XIEThingWith pass
-&gt; LIEWrappedName (IdP pass)
-&gt; IEWildcard
-&gt; [LIEWrappedName (IdP pass)]
-&gt; IE pass
</span><a href="GHC.Hs.ImpExp.html#IEThingWith"><span class="hs-identifier hs-var">IEThingWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall e. e -&gt; Located e
</span><a href="GHC.Types.SrcLoc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621681362619"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name.
HasOccName name =&gt;
LocatedA name -&gt; LIEWrappedName name
</span><a href="GHC.Rename.Names.html#to_ie_post_rn"><span class="hs-identifier hs-var">to_ie_post_rn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362627"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IEWildcard
</span><a href="GHC.Hs.ImpExp.html#NoIEWildcard"><span class="hs-identifier hs-var">NoIEWildcard</span></a></span><span>
</span><span id="line-1816"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name.
HasOccName name =&gt;
LocatedA name -&gt; LIEWrappedName name
</span><a href="GHC.Rename.Names.html#to_ie_post_rn"><span class="hs-identifier hs-var">to_ie_post_rn</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362627"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681362618"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1817"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1818"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621681362618"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681362618"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681362619"><span class="annot"><span class="annottext">[FieldLabel]
</span><a href="#local-6989586621681362619"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GreName] -&gt; ([Name], [FieldLabel])
</span><a href="GHC.Types.Avail.html#partitionGreNames"><span class="hs-identifier hs-var">partitionGreNames</span></a></span><span> </span><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362626"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-1819"></span><span>
</span><span id="line-1820"></span><span>          </span><span id="local-6989586621681362621"><span class="annot"><span class="annottext">all_used :: [GreName] -&gt; Bool
</span><a href="#local-6989586621681362621"><span class="hs-identifier hs-var hs-var">all_used</span></a></span></span><span> </span><span id="local-6989586621681362613"><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362613"><span class="hs-identifier hs-var">avail_cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#elem"><span class="hs-operator hs-var">`elem`</span></a></span><span> </span><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362626"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362613"><span class="hs-identifier hs-var">avail_cs</span></a></span><span>
</span><span id="line-1821"></span><span>
</span><span id="line-1822"></span><span>          </span><span id="local-6989586621681362616"><span class="annot"><span class="annottext">all_non_overloaded :: [FieldLabel] -&gt; Bool
</span><a href="#local-6989586621681362616"><span class="hs-identifier hs-var hs-var">all_non_overloaded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">FieldLabel -&gt; Bool
</span><a href="GHC.Types.FieldLabel.html#flIsOverloaded"><span class="hs-identifier hs-var">flIsOverloaded</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1823"></span><span>
</span><span id="line-1824"></span><span>    </span><span class="annot"><a href="#local-6989586621681362671"><span class="hs-identifier hs-type">combine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1825"></span><span>    </span><span id="local-6989586621681362671"><span class="annot"><span class="annottext">combine :: [LImportDecl GhcRn] -&gt; [LImportDecl GhcRn]
</span><a href="#local-6989586621681362671"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">[LImportDecl GhcRn] -&gt; LImportDecl GhcRn
</span><a href="#local-6989586621681362610"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="../../base-4.16.4.0/src/Data-OldList.html#groupBy"><span class="hs-identifier hs-var">groupBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/Data-Function.html#on"><span class="hs-operator hs-var">`on`</span></a></span><span> </span><span class="annot"><span class="annottext">LImportDecl GhcRn -&gt; (Bool, Maybe ModuleName, ModuleName)
</span><a href="#local-6989586621681362609"><span class="hs-identifier hs-var">getKey</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/Data-OldList.html#sortOn"><span class="hs-identifier hs-var">sortOn</span></a></span><span> </span><span class="annot"><span class="annottext">LImportDecl GhcRn -&gt; (Bool, Maybe ModuleName, ModuleName)
</span><a href="#local-6989586621681362609"><span class="hs-identifier hs-var">getKey</span></a></span><span>
</span><span id="line-1826"></span><span>
</span><span id="line-1827"></span><span>    </span><span class="annot"><a href="#local-6989586621681362609"><span class="hs-identifier hs-type">getKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="GHC.Unit.Module.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1828"></span><span>    </span><span id="local-6989586621681362609"><span class="annot"><span class="annottext">getKey :: LImportDecl GhcRn -&gt; (Bool, Maybe ModuleName, ModuleName)
</span><a href="#local-6989586621681362609"><span class="hs-identifier hs-var hs-var">getKey</span></a></span></span><span> </span><span id="local-6989586621681362608"><span class="annot"><span class="annottext">LImportDecl GhcRn
</span><a href="#local-6989586621681362608"><span class="hs-identifier hs-var">decl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1829"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ImportDeclQualifiedStyle -&gt; Bool
</span><a href="GHC.Hs.ImpExp.html#isImportDeclQualified"><span class="hs-identifier hs-var">isImportDeclQualified</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; ImportDeclQualifiedStyle
</span><a href="GHC.Hs.ImpExp.html#ideclQualified"><span class="hs-identifier hs-var">ideclQualified</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362607"><span class="hs-identifier hs-var">idecl</span></a></span><span> </span><span class="hs-comment">-- is this qualified? (important that this be first)</span><span>
</span><span id="line-1830"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.4.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; Maybe (XRec pass ModuleName)
</span><a href="GHC.Hs.ImpExp.html#ideclAs"><span class="hs-identifier hs-var">ideclAs</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362607"><span class="hs-identifier hs-var">idecl</span></a></span><span> </span><span class="hs-comment">-- what is the qualifier (inside Maybe monad)</span><span>
</span><span id="line-1831"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; XRec pass ModuleName
</span><a href="GHC.Hs.ImpExp.html#ideclName"><span class="hs-identifier hs-var">ideclName</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362607"><span class="hs-identifier hs-var">idecl</span></a></span><span> </span><span class="hs-comment">-- Module Name</span><span>
</span><span id="line-1832"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-1833"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1834"></span><span>        </span><span class="annot"><a href="#local-6989586621681362607"><span class="hs-identifier hs-type">idecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#ImportDecl"><span class="hs-identifier hs-type">ImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-1835"></span><span>        </span><span id="local-6989586621681362607"><span class="annot"><span class="annottext">idecl :: ImportDecl GhcRn
</span><a href="#local-6989586621681362607"><span class="hs-identifier hs-var hs-var">idecl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">LImportDecl GhcRn
</span><a href="#local-6989586621681362608"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-1836"></span><span>
</span><span id="line-1837"></span><span>    </span><span class="annot"><a href="#local-6989586621681362610"><span class="hs-identifier hs-type">merge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Hs.ImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#LImportDecl"><span class="hs-identifier hs-type">LImportDecl</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span>
</span><span id="line-1838"></span><span>    </span><span id="local-6989586621681362610"><span class="annot"><span class="annottext">merge :: [LImportDecl GhcRn] -&gt; LImportDecl GhcRn
</span><a href="#local-6989586621681362610"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getMinimalImports: unexpected empty list&quot;</span></span><span>
</span><span id="line-1839"></span><span>    </span><span class="annot"><a href="#local-6989586621681362610"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span id="local-6989586621681362606"><span class="annot"><span class="annottext">decls :: [LImportDecl GhcRn]
</span><a href="#local-6989586621681362606"><span class="hs-identifier hs-var">decls</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681362605"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362605"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681362604"><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362604"><span class="hs-identifier hs-var">decl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[LImportDecl GhcRn]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362605"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ImportDecl GhcRn
</span><a href="#local-6989586621681362604"><span class="hs-identifier hs-var">decl</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ideclHiding :: Maybe (Bool, XRec GhcRn [LIE GhcRn])
</span><a href="GHC.Hs.ImpExp.html#ideclHiding"><span class="hs-identifier hs-var">ideclHiding</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ann. SrcSpan -&gt; SrcAnn ann
</span><a href="GHC.Parser.Annotation.html#noAnnSrcSpan"><span class="hs-identifier hs-var">noAnnSrcSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><a href="GHC.Parser.Annotation.html#locA"><span class="hs-identifier hs-var">locA</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362605"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LIE GhcRn]
</span><a href="#local-6989586621681362603"><span class="hs-identifier hs-var">lies</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1840"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681362603"><span class="annot"><span class="annottext">lies :: [LIE GhcRn]
</span><a href="#local-6989586621681362603"><span class="hs-identifier hs-var hs-var">lies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><a href="../../base-4.16.4.0/src/Data-Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/Data-Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall pass. ImportDecl pass -&gt; Maybe (Bool, XRec pass [LIE pass])
</span><a href="GHC.Hs.ImpExp.html#ideclHiding"><span class="hs-identifier hs-var">ideclHiding</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LImportDecl GhcRn]
</span><a href="#local-6989586621681362606"><span class="hs-identifier hs-var">decls</span></a></span><span>
</span><span id="line-1841"></span><span>
</span><span id="line-1842"></span><span>
</span><span id="line-1843"></span><span class="annot"><a href="GHC.Rename.Names.html#printMinimalImports"><span class="hs-identifier hs-type">printMinimalImports</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SourceFile.html#HscSource"><span class="hs-identifier hs-type">HscSource</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Rename.Names.html#ImportDeclUsage"><span class="hs-identifier hs-type">ImportDeclUsage</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#RnM"><span class="hs-identifier hs-type">RnM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1844"></span><span class="hs-comment">-- See Note [Printing minimal imports]</span><span>
</span><span id="line-1845"></span><span id="printMinimalImports"><span class="annot"><span class="annottext">printMinimalImports :: HscSource -&gt; [ImportDeclUsage] -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Names.html#printMinimalImports"><span class="hs-identifier hs-var hs-var">printMinimalImports</span></a></span></span><span> </span><span id="local-6989586621681362602"><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621681362602"><span class="hs-identifier hs-var">hsc_src</span></a></span></span><span> </span><span id="local-6989586621681362601"><span class="annot"><span class="annottext">[ImportDeclUsage]
</span><a href="#local-6989586621681362601"><span class="hs-identifier hs-var">imports_w_usage</span></a></span></span><span>
</span><span id="line-1846"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621681362600"><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (ImportDecl GhcRn)]
</span><a href="#local-6989586621681362600"><span class="hs-identifier hs-var">imports'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ImportDeclUsage] -&gt; RnM [LImportDecl GhcRn]
</span><a href="GHC.Rename.Names.html#getMinimalImports"><span class="hs-identifier hs-var">getMinimalImports</span></a></span><span> </span><span class="annot"><span class="annottext">[ImportDeclUsage]
</span><a href="#local-6989586621681362601"><span class="hs-identifier hs-var">imports_w_usage</span></a></span><span>
</span><span id="line-1847"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681362599"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681362599"><span class="hs-identifier hs-var">this_mod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). HasModule m =&gt; m Module
</span><a href="GHC.Unit.Module.html#getModule"><span class="hs-identifier hs-var">getModule</span></a></span><span>
</span><span id="line-1848"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621681362597"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681362597"><span class="hs-identifier hs-var">dflags</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.Session.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-1849"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../base-4.16.4.0/src/Control-Monad-IO-Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. String -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; IO r
</span><a href="../../base-4.16.4.0/src/GHC-IO-StdHandles.html#withFile"><span class="hs-identifier hs-var">withFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Module -&gt; String
</span><a href="#local-6989586621681362594"><span class="hs-identifier hs-var">mkFilename</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681362597"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681362599"><span class="hs-identifier hs-var">this_mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IOMode
</span><a href="../../base-4.16.4.0/src/GHC-IO-IOMode.html#WriteMode"><span class="hs-identifier hs-var">WriteMode</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681362592"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621681362592"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1850"></span><span>          </span><span class="annot"><span class="annottext">DynFlags -&gt; Handle -&gt; PrintUnqualified -&gt; Depth -&gt; SDoc -&gt; IO ()
</span><a href="GHC.Driver.Ppr.html#printForUser"><span class="hs-identifier hs-var">printForUser</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681362597"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621681362592"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">PrintUnqualified
</span><a href="GHC.Utils.Outputable.html#neverQualify"><span class="hs-identifier hs-var">neverQualify</span></a></span><span> </span><span class="annot"><span class="annottext">Depth
</span><a href="GHC.Utils.Outputable.html#AllTheWay"><span class="hs-identifier hs-var">AllTheWay</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (ImportDecl GhcRn)]
</span><a href="#local-6989586621681362600"><span class="hs-identifier hs-var">imports'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1851"></span><span>              </span><span class="hs-comment">-- The neverQualify is important.  We are printing Names</span><span>
</span><span id="line-1852"></span><span>              </span><span class="hs-comment">-- but they are in the context of an 'import' decl, and</span><span>
</span><span id="line-1853"></span><span>              </span><span class="hs-comment">-- we never qualify things inside there</span><span>
</span><span id="line-1854"></span><span>              </span><span class="hs-comment">-- E.g.   import Blag( f, b )</span><span>
</span><span id="line-1855"></span><span>              </span><span class="hs-comment">-- not    import Blag( Blag.f, Blag.g )!</span><span>
</span><span id="line-1856"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-1857"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1858"></span><span>    </span><span id="local-6989586621681362594"><span class="annot"><span class="annottext">mkFilename :: DynFlags -&gt; Module -&gt; String
</span><a href="#local-6989586621681362594"><span class="hs-identifier hs-var hs-var">mkFilename</span></a></span></span><span> </span><span id="local-6989586621681362588"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681362588"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681362587"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681362587"><span class="hs-identifier hs-var">this_mod</span></a></span></span><span>
</span><span id="line-1859"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681362586"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681362586"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Maybe String
</span><a href="GHC.Driver.Session.html#dumpDir"><span class="hs-identifier hs-var">dumpDir</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681362588"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681362586"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="../../filepath-1.4.2.2/src/System-FilePath-Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681362584"><span class="hs-identifier hs-var">basefn</span></a></span><span>
</span><span id="line-1860"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681362584"><span class="hs-identifier hs-var">basefn</span></a></span><span>
</span><span id="line-1861"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1862"></span><span>        </span><span id="local-6989586621681362583"><span class="annot"><span class="annottext">suffix :: String
</span><a href="#local-6989586621681362583"><span class="hs-identifier hs-var hs-var">suffix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HscSource
</span><a href="#local-6989586621681362602"><span class="hs-identifier hs-var">hsc_src</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1863"></span><span>                     </span><span class="annot"><span class="annottext">HscSource
</span><a href="GHC.Types.SourceFile.html#HsBootFile"><span class="hs-identifier hs-var">HsBootFile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.imports-boot&quot;</span></span><span>
</span><span id="line-1864"></span><span>                     </span><span class="annot"><span class="annottext">HscSource
</span><a href="GHC.Types.SourceFile.html#HsSrcFile"><span class="hs-identifier hs-var">HsSrcFile</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.imports&quot;</span></span><span>
</span><span id="line-1865"></span><span>                     </span><span class="annot"><span class="annottext">HscSource
</span><a href="GHC.Types.SourceFile.html#HsigFile"><span class="hs-identifier hs-var">HsigFile</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.imports&quot;</span></span><span>
</span><span id="line-1866"></span><span>        </span><span id="local-6989586621681362584"><span class="annot"><span class="annottext">basefn :: String
</span><a href="#local-6989586621681362584"><span class="hs-identifier hs-var hs-var">basefn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; String
</span><a href="GHC.Unit.Module.Name.html#moduleNameString"><span class="hs-identifier hs-var">moduleNameString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall unit. GenModule unit -&gt; ModuleName
</span><a href="GHC.Unit.Types.html#moduleName"><span class="hs-identifier hs-var">moduleName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621681362587"><span class="hs-identifier hs-var">this_mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681362583"><span class="hs-identifier hs-var">suffix</span></a></span><span>
</span><span id="line-1867"></span><span>
</span><span id="line-1868"></span><span>
</span><span id="line-1869"></span><span id="local-6989586621681362578"><span class="annot"><a href="GHC.Rename.Names.html#to_ie_post_rn_var"><span class="hs-identifier hs-type">to_ie_post_rn_var</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#HasOccName"><span class="hs-identifier hs-type">HasOccName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681362578"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedA"><span class="hs-identifier hs-type">LocatedA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681362578"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#LIEWrappedName"><span class="hs-identifier hs-type">LIEWrappedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681362578"><span class="hs-identifier hs-type">name</span></a></span></span><span>
</span><span id="line-1870"></span><span id="to_ie_post_rn_var"><span class="annot"><span class="annottext">to_ie_post_rn_var :: forall name.
HasOccName name =&gt;
LocatedA name -&gt; LIEWrappedName name
</span><a href="GHC.Rename.Names.html#to_ie_post_rn_var"><span class="hs-identifier hs-var hs-var">to_ie_post_rn_var</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681362575"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362575"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681362574"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681362574"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1871"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; Bool
</span><a href="GHC.Types.Name.Occurrence.html#isDataOcc"><span class="hs-identifier hs-var">isDataOcc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall name. HasOccName name =&gt; name -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#occName"><span class="hs-identifier hs-var">occName</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681362574"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362575"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. EpaLocation -&gt; LocatedN name -&gt; IEWrappedName name
</span><a href="GHC.Hs.ImpExp.html#IEPattern"><span class="hs-identifier hs-var">IEPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcSpan -&gt; EpaLocation
</span><a href="GHC.Parser.Annotation.html#EpaSpan"><span class="hs-identifier hs-var">EpaSpan</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; RealSrcSpan
</span><a href="GHC.Parser.Annotation.html#la2r"><span class="hs-identifier hs-var">la2r</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362575"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpanAnnN
</span><a href="GHC.Parser.Annotation.html#la2na"><span class="hs-identifier hs-var">la2na</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362575"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681362574"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1872"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362575"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. LocatedN name -&gt; IEWrappedName name
</span><a href="GHC.Hs.ImpExp.html#IEName"><span class="hs-identifier hs-var">IEName</span></a></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpanAnnN
</span><a href="GHC.Parser.Annotation.html#la2na"><span class="hs-identifier hs-var">la2na</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362575"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681362574"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1873"></span><span>
</span><span id="line-1874"></span><span>
</span><span id="line-1875"></span><span id="local-6989586621681364212"><span class="annot"><a href="GHC.Rename.Names.html#to_ie_post_rn"><span class="hs-identifier hs-type">to_ie_post_rn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#HasOccName"><span class="hs-identifier hs-type">HasOccName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681364212"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Parser.Annotation.html#LocatedA"><span class="hs-identifier hs-type">LocatedA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681364212"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#LIEWrappedName"><span class="hs-identifier hs-type">LIEWrappedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681364212"><span class="hs-identifier hs-type">name</span></a></span></span><span>
</span><span id="line-1876"></span><span id="to_ie_post_rn"><span class="annot"><span class="annottext">to_ie_post_rn :: forall name.
HasOccName name =&gt;
LocatedA name -&gt; LIEWrappedName name
</span><a href="GHC.Rename.Names.html#to_ie_post_rn"><span class="hs-identifier hs-var hs-var">to_ie_post_rn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621681362565"><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362565"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621681362564"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681362564"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1877"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; Bool
</span><a href="GHC.Types.Name.Occurrence.html#isTcOcc"><span class="hs-identifier hs-var">isTcOcc</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681362562"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">OccName -&gt; Bool
</span><a href="GHC.Types.Name.Occurrence.html#isSymOcc"><span class="hs-identifier hs-var">isSymOcc</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681362562"><span class="hs-identifier hs-var">occ</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362565"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. EpaLocation -&gt; LocatedN name -&gt; IEWrappedName name
</span><a href="GHC.Hs.ImpExp.html#IEType"><span class="hs-identifier hs-var">IEType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcSpan -&gt; EpaLocation
</span><a href="GHC.Parser.Annotation.html#EpaSpan"><span class="hs-identifier hs-var">EpaSpan</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; RealSrcSpan
</span><a href="GHC.Parser.Annotation.html#la2r"><span class="hs-identifier hs-var">la2r</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362565"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpanAnnN
</span><a href="GHC.Parser.Annotation.html#la2na"><span class="hs-identifier hs-var">la2na</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362565"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681362564"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1878"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362565"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. LocatedN name -&gt; IEWrappedName name
</span><a href="GHC.Hs.ImpExp.html#IEName"><span class="hs-identifier hs-var">IEName</span></a></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall l e. l -&gt; e -&gt; GenLocated l e
</span><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SrcSpanAnn' a -&gt; SrcSpanAnnN
</span><a href="GHC.Parser.Annotation.html#la2na"><span class="hs-identifier hs-var">la2na</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><a href="#local-6989586621681362565"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681362564"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1879"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681362562"><span class="annot"><span class="annottext">occ :: OccName
</span><a href="#local-6989586621681362562"><span class="hs-identifier hs-var hs-var">occ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall name. HasOccName name =&gt; name -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#occName"><span class="hs-identifier hs-var">occName</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681362564"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1880"></span><span>
</span><span id="line-1881"></span><span class="hs-comment">{-
Note [Partial export]
~~~~~~~~~~~~~~~~~~~~~
Suppose we have

   module A( op ) where
     class C a where
       op :: a -&gt; a

   module B where
   import A
   f = ..op...

Then the minimal import for module B is
   import A( op )
not
   import A( C( op ) )
which we would usually generate if C was exported from B.  Hence
the availExportsDecl test when deciding what to generate.


Note [Overloaded field import]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
On the other hand, if we have

    {-# LANGUAGE DuplicateRecordFields #-}
    module A where
      data T = MkT { foo :: Int }

    module B where
      import A
      f = ...foo...

then the minimal import for module B must be
    import A ( T(foo) )
because when DuplicateRecordFields is enabled, field selectors are
not in scope without their enclosing datatype.

On the third hand, if we have

    {-# LANGUAGE DuplicateRecordFields #-}
    module A where
      pattern MkT { foo } = Just foo

    module B where
      import A
      f = ...foo...

then the minimal import for module B must be
    import A ( foo )
because foo doesn't have a parent.  This might actually be ambiguous if A
exports another field called foo, but there is no good answer to return and this
is a very obscure corner, so it seems to be the best we can do.  See
DRFPatSynExport for a test of this.


************************************************************************
*                                                                      *
\subsection{Errors}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1943"></span><span>
</span><span id="line-1944"></span><span class="annot"><a href="GHC.Rename.Names.html#qualImportItemErr"><span class="hs-identifier hs-type">qualImportItemErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1945"></span><span id="qualImportItemErr"><span class="annot"><span class="annottext">qualImportItemErr :: RdrName -&gt; SDoc
</span><a href="GHC.Rename.Names.html#qualImportItemErr"><span class="hs-identifier hs-var hs-var">qualImportItemErr</span></a></span></span><span> </span><span id="local-6989586621681362559"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681362559"><span class="hs-identifier hs-var">rdr</span></a></span></span><span>
</span><span id="line-1946"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Illegal qualified name in import item:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1947"></span><span>       </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681362559"><span class="hs-identifier hs-var">rdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1948"></span><span>
</span><span id="line-1949"></span><span class="annot"><a href="GHC.Rename.Names.html#ambiguousImportItemErr"><span class="hs-identifier hs-type">ambiguousImportItemErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1950"></span><span id="ambiguousImportItemErr"><span class="annot"><span class="annottext">ambiguousImportItemErr :: RdrName -&gt; [AvailInfo] -&gt; SDoc
</span><a href="GHC.Rename.Names.html#ambiguousImportItemErr"><span class="hs-identifier hs-var hs-var">ambiguousImportItemErr</span></a></span></span><span> </span><span id="local-6989586621681362558"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681362558"><span class="hs-identifier hs-var">rdr</span></a></span></span><span> </span><span id="local-6989586621681362557"><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681362557"><span class="hs-identifier hs-var">avails</span></a></span></span><span>
</span><span id="line-1951"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hang"><span class="hs-identifier hs-var">hang</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Ambiguous name&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681362558"><span class="hs-identifier hs-var">rdr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;in import item. It could refer to:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1952"></span><span>       </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo -&gt; SDoc
</span><a href="#local-6989586621681362556"><span class="hs-identifier hs-var">ppr_avail</span></a></span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681362557"><span class="hs-identifier hs-var">avails</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1953"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1954"></span><span>    </span><span id="local-6989586621681362556"><span class="annot"><span class="annottext">ppr_avail :: AvailInfo -&gt; SDoc
</span><a href="#local-6989586621681362556"><span class="hs-identifier hs-var hs-var">ppr_avail</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#AvailTC"><span class="hs-identifier hs-type">AvailTC</span></a></span><span> </span><span id="local-6989586621681362555"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362555"><span class="hs-identifier hs-var">parent</span></a></span></span><span> </span><span class="annot"><span class="annottext">[GreName]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681362555"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681362558"><span class="hs-identifier hs-var">rdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1955"></span><span>    </span><span class="annot"><a href="#local-6989586621681362556"><span class="hs-identifier hs-var">ppr_avail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#Avail"><span class="hs-identifier hs-type">Avail</span></a></span><span> </span><span id="local-6989586621681362554"><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681362554"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681362554"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1956"></span><span>
</span><span id="line-1957"></span><span class="annot"><a href="GHC.Rename.Names.html#pprImpDeclSpec"><span class="hs-identifier hs-type">pprImpDeclSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModIface.html#ModIface"><span class="hs-identifier hs-type">ModIface</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#ImpDeclSpec"><span class="hs-identifier hs-type">ImpDeclSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1958"></span><span id="pprImpDeclSpec"><span class="annot"><span class="annottext">pprImpDeclSpec :: ModIface -&gt; ImpDeclSpec -&gt; SDoc
</span><a href="GHC.Rename.Names.html#pprImpDeclSpec"><span class="hs-identifier hs-var hs-var">pprImpDeclSpec</span></a></span></span><span> </span><span id="local-6989586621681362552"><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681362552"><span class="hs-identifier hs-var">iface</span></a></span></span><span> </span><span id="local-6989586621681362551"><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681362551"><span class="hs-identifier hs-var">decl_spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1959"></span><span>  </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ImpDeclSpec -&gt; ModuleName
</span><a href="GHC.Types.Name.Reader.html#is_mod"><span class="hs-identifier hs-var">is_mod</span></a></span><span> </span><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681362551"><span class="hs-identifier hs-var">decl_spec</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ModIface -&gt; IsBootInterface
</span><a href="GHC.Unit.Module.ModIface.html#mi_boot"><span class="hs-identifier hs-var">mi_boot</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681362552"><span class="hs-identifier hs-var">iface</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1960"></span><span>    </span><span class="annot"><span class="annottext">IsBootInterface
</span><a href="GHC.Unit.Types.html#IsBoot"><span class="hs-identifier hs-var">IsBoot</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(hi-boot interface)&quot;</span></span><span>
</span><span id="line-1961"></span><span>    </span><span class="annot"><span class="annottext">IsBootInterface
</span><a href="GHC.Unit.Types.html#NotBoot"><span class="hs-identifier hs-var">NotBoot</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#empty"><span class="hs-identifier hs-var">Outputable.empty</span></a></span><span>
</span><span id="line-1962"></span><span>
</span><span id="line-1963"></span><span class="annot"><a href="GHC.Rename.Names.html#badImportItemErrStd"><span class="hs-identifier hs-type">badImportItemErrStd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModIface.html#ModIface"><span class="hs-identifier hs-type">ModIface</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#ImpDeclSpec"><span class="hs-identifier hs-type">ImpDeclSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1964"></span><span id="badImportItemErrStd"><span class="annot"><span class="annottext">badImportItemErrStd :: ModIface -&gt; ImpDeclSpec -&gt; IE GhcPs -&gt; SDoc
</span><a href="GHC.Rename.Names.html#badImportItemErrStd"><span class="hs-identifier hs-var hs-var">badImportItemErrStd</span></a></span></span><span> </span><span id="local-6989586621681362549"><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681362549"><span class="hs-identifier hs-var">iface</span></a></span></span><span> </span><span id="local-6989586621681362548"><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681362548"><span class="hs-identifier hs-var">decl_spec</span></a></span></span><span> </span><span id="local-6989586621681362547"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681362547"><span class="hs-identifier hs-var">ie</span></a></span></span><span>
</span><span id="line-1965"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Module&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ModIface -&gt; ImpDeclSpec -&gt; SDoc
</span><a href="GHC.Rename.Names.html#pprImpDeclSpec"><span class="hs-identifier hs-var">pprImpDeclSpec</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681362549"><span class="hs-identifier hs-var">iface</span></a></span><span> </span><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681362548"><span class="hs-identifier hs-var">decl_spec</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1966"></span><span>         </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;does not export&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681362547"><span class="hs-identifier hs-var">ie</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1967"></span><span>
</span><span id="line-1968"></span><span class="annot"><a href="GHC.Rename.Names.html#badImportItemErrDataCon"><span class="hs-identifier hs-type">badImportItemErrDataCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#OccName"><span class="hs-identifier hs-type">OccName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModIface.html#ModIface"><span class="hs-identifier hs-type">ModIface</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#ImpDeclSpec"><span class="hs-identifier hs-type">ImpDeclSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span>
</span><span id="line-1969"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1970"></span><span id="badImportItemErrDataCon"><span class="annot"><span class="annottext">badImportItemErrDataCon :: OccName -&gt; ModIface -&gt; ImpDeclSpec -&gt; IE GhcPs -&gt; SDoc
</span><a href="GHC.Rename.Names.html#badImportItemErrDataCon"><span class="hs-identifier hs-var hs-var">badImportItemErrDataCon</span></a></span></span><span> </span><span id="local-6989586621681362545"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681362545"><span class="hs-identifier hs-var">dataType_occ</span></a></span></span><span> </span><span id="local-6989586621681362544"><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681362544"><span class="hs-identifier hs-var">iface</span></a></span></span><span> </span><span id="local-6989586621681362543"><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681362543"><span class="hs-identifier hs-var">decl_spec</span></a></span></span><span> </span><span id="local-6989586621681362542"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681362542"><span class="hs-identifier hs-var">ie</span></a></span></span><span>
</span><span id="line-1971"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In module&quot;</span></span><span>
</span><span id="line-1972"></span><span>             </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface -&gt; ImpDeclSpec -&gt; SDoc
</span><a href="GHC.Rename.Names.html#pprImpDeclSpec"><span class="hs-identifier hs-var">pprImpDeclSpec</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681362544"><span class="hs-identifier hs-var">iface</span></a></span><span> </span><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681362543"><span class="hs-identifier hs-var">decl_spec</span></a></span><span>
</span><span id="line-1973"></span><span>             </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#colon"><span class="hs-identifier hs-var">colon</span></a></span><span>
</span><span id="line-1974"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362540"><span class="hs-identifier hs-var">datacon</span></a></span><span>
</span><span id="line-1975"></span><span>             </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is a data constructor of&quot;</span></span><span>
</span><span id="line-1976"></span><span>             </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362539"><span class="hs-identifier hs-var">dataType</span></a></span><span>
</span><span id="line-1977"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;To import it use&quot;</span></span><span>
</span><span id="line-1978"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;import&quot;</span></span><span>
</span><span id="line-1979"></span><span>             </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ImpDeclSpec -&gt; ModuleName
</span><a href="GHC.Types.Name.Reader.html#is_mod"><span class="hs-identifier hs-var">is_mod</span></a></span><span> </span><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681362543"><span class="hs-identifier hs-var">decl_spec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1980"></span><span>             </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="#local-6989586621681362538"><span class="hs-identifier hs-var">parens_sp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362539"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="#local-6989586621681362538"><span class="hs-identifier hs-var">parens_sp</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362540"><span class="hs-identifier hs-var">datacon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1981"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;or&quot;</span></span><span>
</span><span id="line-1982"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;import&quot;</span></span><span>
</span><span id="line-1983"></span><span>             </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ImpDeclSpec -&gt; ModuleName
</span><a href="GHC.Types.Name.Reader.html#is_mod"><span class="hs-identifier hs-var">is_mod</span></a></span><span> </span><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681362543"><span class="hs-identifier hs-var">decl_spec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1984"></span><span>             </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="#local-6989586621681362538"><span class="hs-identifier hs-var">parens_sp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362539"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(..)&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1985"></span><span>         </span><span class="hs-special">]</span><span>
</span><span id="line-1986"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1987"></span><span>    </span><span id="local-6989586621681362537"><span class="annot"><span class="annottext">datacon_occ :: OccName
</span><a href="#local-6989586621681362537"><span class="hs-identifier hs-var hs-var">datacon_occ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (p :: Pass). IE (GhcPass p) -&gt; IdP (GhcPass p)
</span><a href="GHC.Hs.ImpExp.html#ieName"><span class="hs-identifier hs-var">ieName</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681362542"><span class="hs-identifier hs-var">ie</span></a></span><span>
</span><span id="line-1988"></span><span>    </span><span id="local-6989586621681362540"><span class="annot"><span class="annottext">datacon :: SDoc
</span><a href="#local-6989586621681362540"><span class="hs-identifier hs-var hs-var">datacon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Types.Name.Occurrence.html#parenSymOcc"><span class="hs-identifier hs-var">parenSymOcc</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681362537"><span class="hs-identifier hs-var">datacon_occ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681362537"><span class="hs-identifier hs-var">datacon_occ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1989"></span><span>    </span><span id="local-6989586621681362539"><span class="annot"><span class="annottext">dataType :: SDoc
</span><a href="#local-6989586621681362539"><span class="hs-identifier hs-var hs-var">dataType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Types.Name.Occurrence.html#parenSymOcc"><span class="hs-identifier hs-var">parenSymOcc</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681362545"><span class="hs-identifier hs-var">dataType_occ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621681362545"><span class="hs-identifier hs-var">dataType_occ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1990"></span><span>    </span><span id="local-6989586621681362538"><span class="annot"><span class="annottext">parens_sp :: SDoc -&gt; SDoc
</span><a href="#local-6989586621681362538"><span class="hs-identifier hs-var hs-var">parens_sp</span></a></span></span><span> </span><span id="local-6989586621681362535"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362535"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#space"><span class="hs-identifier hs-var">space</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362535"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="GHC.Utils.Outputable.html#space"><span class="hs-identifier hs-var">space</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- T( f,g )</span><span>
</span><span id="line-1991"></span><span>
</span><span id="line-1992"></span><span class="annot"><a href="GHC.Rename.Names.html#badImportItemErr"><span class="hs-identifier hs-type">badImportItemErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Module.ModIface.html#ModIface"><span class="hs-identifier hs-type">ModIface</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#ImpDeclSpec"><span class="hs-identifier hs-type">ImpDeclSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Avail.html#AvailInfo"><span class="hs-identifier hs-type">AvailInfo</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-1993"></span><span id="badImportItemErr"><span class="annot"><span class="annottext">badImportItemErr :: ModIface -&gt; ImpDeclSpec -&gt; IE GhcPs -&gt; [AvailInfo] -&gt; SDoc
</span><a href="GHC.Rename.Names.html#badImportItemErr"><span class="hs-identifier hs-var hs-var">badImportItemErr</span></a></span></span><span> </span><span id="local-6989586621681362533"><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681362533"><span class="hs-identifier hs-var">iface</span></a></span></span><span> </span><span id="local-6989586621681362532"><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681362532"><span class="hs-identifier hs-var">decl_spec</span></a></span></span><span> </span><span id="local-6989586621681362531"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681362531"><span class="hs-identifier hs-var">ie</span></a></span></span><span> </span><span id="local-6989586621681362530"><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681362530"><span class="hs-identifier hs-var">avails</span></a></span></span><span>
</span><span id="line-1994"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#find"><span class="hs-identifier hs-var">find</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo -&gt; Bool
</span><a href="#local-6989586621681362529"><span class="hs-identifier hs-var">checkIfDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">[AvailInfo]
</span><a href="#local-6989586621681362530"><span class="hs-identifier hs-var">avails</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1995"></span><span>      </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681362528"><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681362528"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; ModIface -&gt; ImpDeclSpec -&gt; IE GhcPs -&gt; SDoc
</span><a href="GHC.Rename.Names.html#badImportItemErrDataCon"><span class="hs-identifier hs-var">badImportItemErrDataCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AvailInfo -&gt; OccName
</span><a href="#local-6989586621681362527"><span class="hs-identifier hs-var">availOccName</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><a href="#local-6989586621681362528"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681362533"><span class="hs-identifier hs-var">iface</span></a></span><span> </span><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681362532"><span class="hs-identifier hs-var">decl_spec</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681362531"><span class="hs-identifier hs-var">ie</span></a></span><span>
</span><span id="line-1996"></span><span>      </span><span class="annot"><span class="annottext">Maybe AvailInfo
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModIface -&gt; ImpDeclSpec -&gt; IE GhcPs -&gt; SDoc
</span><a href="GHC.Rename.Names.html#badImportItemErrStd"><span class="hs-identifier hs-var">badImportItemErrStd</span></a></span><span> </span><span class="annot"><span class="annottext">ModIface
</span><a href="#local-6989586621681362533"><span class="hs-identifier hs-var">iface</span></a></span><span> </span><span class="annot"><span class="annottext">ImpDeclSpec
</span><a href="#local-6989586621681362532"><span class="hs-identifier hs-var">decl_spec</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681362531"><span class="hs-identifier hs-var">ie</span></a></span><span>
</span><span id="line-1997"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1998"></span><span>    </span><span id="local-6989586621681362529"><span class="annot"><span class="annottext">checkIfDataCon :: AvailInfo -&gt; Bool
</span><a href="#local-6989586621681362529"><span class="hs-identifier hs-var hs-var">checkIfDataCon</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Avail.html#AvailTC"><span class="hs-identifier hs-type">AvailTC</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681362526"><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362526"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1999"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><a href="../../base-4.16.4.0/src/Data-Foldable.html#find"><span class="hs-identifier hs-var">find</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681362525"><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681362525"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621681362524"><span class="hs-identifier hs-var">importedFS</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OccName -&gt; FastString
</span><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. HasOccName name =&gt; name -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#occName"><span class="hs-identifier hs-var">occName</span></a></span><span> </span><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681362525"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GreName]
</span><a href="#local-6989586621681362526"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2000"></span><span>        </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681362523"><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681362523"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="GHC.Types.Name.html#isDataConName"><span class="hs-identifier hs-var">isDataConName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GreName -&gt; Name
</span><a href="GHC.Types.Avail.html#greNameMangledName"><span class="hs-identifier hs-var">greNameMangledName</span></a></span><span> </span><span class="annot"><span class="annottext">GreName
</span><a href="#local-6989586621681362523"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2001"></span><span>        </span><span class="annot"><span class="annottext">Maybe GreName
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2002"></span><span>    </span><span class="annot"><a href="#local-6989586621681362529"><span class="hs-identifier hs-var">checkIfDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2003"></span><span>    </span><span id="local-6989586621681362527"><span class="annot"><span class="annottext">availOccName :: AvailInfo -&gt; OccName
</span><a href="#local-6989586621681362527"><span class="hs-identifier hs-var hs-var">availOccName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall name. HasOccName name =&gt; name -&gt; OccName
</span><a href="GHC.Types.Name.Occurrence.html#occName"><span class="hs-identifier hs-var">occName</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">AvailInfo -&gt; GreName
</span><a href="GHC.Types.Avail.html#availGreName"><span class="hs-identifier hs-var">availGreName</span></a></span><span>
</span><span id="line-2004"></span><span>    </span><span id="local-6989586621681362524"><span class="annot"><span class="annottext">importedFS :: FastString
</span><a href="#local-6989586621681362524"><span class="hs-identifier hs-var hs-var">importedFS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; FastString
</span><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#rdrNameOcc"><span class="hs-identifier hs-var">rdrNameOcc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (p :: Pass). IE (GhcPass p) -&gt; IdP (GhcPass p)
</span><a href="GHC.Hs.ImpExp.html#ieName"><span class="hs-identifier hs-var">ieName</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681362531"><span class="hs-identifier hs-var">ie</span></a></span><span>
</span><span id="line-2005"></span><span>
</span><span id="line-2006"></span><span class="annot"><a href="GHC.Rename.Names.html#illegalImportItemErr"><span class="hs-identifier hs-type">illegalImportItemErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-2007"></span><span id="illegalImportItemErr"><span class="annot"><span class="annottext">illegalImportItemErr :: SDoc
</span><a href="GHC.Rename.Names.html#illegalImportItemErr"><span class="hs-identifier hs-var hs-var">illegalImportItemErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Illegal import item&quot;</span></span><span>
</span><span id="line-2008"></span><span>
</span><span id="line-2009"></span><span class="annot"><a href="GHC.Rename.Names.html#dodgyImportWarn"><span class="hs-identifier hs-type">dodgyImportWarn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-2010"></span><span id="dodgyImportWarn"><span class="annot"><span class="annottext">dodgyImportWarn :: RdrName -&gt; SDoc
</span><a href="GHC.Rename.Names.html#dodgyImportWarn"><span class="hs-identifier hs-var hs-var">dodgyImportWarn</span></a></span></span><span> </span><span id="local-6989586621681362519"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681362519"><span class="hs-identifier hs-var">item</span></a></span></span><span>
</span><span id="line-2011"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Outputable a, Outputable b) =&gt; SDoc -&gt; a -&gt; b -&gt; SDoc
</span><a href="GHC.Rename.Names.html#dodgyMsg"><span class="hs-identifier hs-var">dodgyMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;import&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681362519"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (p :: Pass). IdP (GhcPass p) -&gt; IE (GhcPass p)
</span><a href="GHC.Rename.Names.html#dodgyMsgInsert"><span class="hs-identifier hs-var">dodgyMsgInsert</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681362519"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2012"></span><span>
</span><span id="line-2013"></span><span id="local-6989586621681364116"><span id="local-6989586621681364117"><span class="annot"><a href="GHC.Rename.Names.html#dodgyMsg"><span class="hs-identifier hs-type">dodgyMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681364117"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681364116"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681364117"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681364116"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span></span></span><span>
</span><span id="line-2014"></span><span id="dodgyMsg"><span class="annot"><span class="annottext">dodgyMsg :: forall a b. (Outputable a, Outputable b) =&gt; SDoc -&gt; a -&gt; b -&gt; SDoc
</span><a href="GHC.Rename.Names.html#dodgyMsg"><span class="hs-identifier hs-var hs-var">dodgyMsg</span></a></span></span><span> </span><span id="local-6989586621681362514"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362514"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span id="local-6989586621681362513"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681362513"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621681362512"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681362512"><span class="hs-identifier hs-var">ie</span></a></span></span><span>
</span><span id="line-2015"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621681362514"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PtrString -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; PtrString
</span><a href="GHC.Data.FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;item&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2016"></span><span>                    </span><span class="hs-comment">-- &lt;+&gt; quotes (ppr (IEThingAll (noLoc (IEName $ noLoc tc))))</span><span>
</span><span id="line-2017"></span><span>                     </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681362512"><span class="hs-identifier hs-var">ie</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2018"></span><span>                </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;suggests that&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-2019"></span><span>          </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681362513"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;has (in-scope) constructors or class methods,&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-2020"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;but it has none&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2021"></span><span>
</span><span id="line-2022"></span><span class="annot"><a href="GHC.Rename.Names.html#dodgyMsgInsert"><span class="hs-identifier hs-type">dodgyMsgInsert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681364115"><span class="annot"><a href="#local-6989586621681364115"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681364115"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681364115"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2023"></span><span id="dodgyMsgInsert"><span class="annot"><span class="annottext">dodgyMsgInsert :: forall (p :: Pass). IdP (GhcPass p) -&gt; IE (GhcPass p)
</span><a href="GHC.Rename.Names.html#dodgyMsgInsert"><span class="hs-identifier hs-var hs-var">dodgyMsgInsert</span></a></span></span><span> </span><span id="local-6989586621681362511"><span class="annot"><span class="annottext">IdP (GhcPass p)
</span><a href="#local-6989586621681362511"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall pass.
XIEThingAll pass -&gt; LIEWrappedName (IdP pass) -&gt; IE pass
</span><a href="GHC.Hs.ImpExp.html#IEThingAll"><span class="hs-identifier hs-var">IEThingAll</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. EpAnn a
</span><a href="GHC.Parser.Annotation.html#noAnn"><span class="hs-identifier hs-var">noAnn</span></a></span><span> </span><span class="annot"><span class="annottext">LIEWrappedName (IdP (GhcPass p))
</span><a href="#local-6989586621681362510"><span class="hs-identifier hs-var">ii</span></a></span><span>
</span><span id="line-2024"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2025"></span><span>    </span><span class="annot"><a href="#local-6989586621681362510"><span class="hs-identifier hs-type">ii</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#LIEWrappedName"><span class="hs-identifier hs-type">LIEWrappedName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Extension.html#IdP"><span class="hs-identifier hs-type">IdP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPass"><span class="hs-identifier hs-type">GhcPass</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681364115"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2026"></span><span>    </span><span id="local-6989586621681362510"><span class="annot"><span class="annottext">ii :: LIEWrappedName (IdP (GhcPass p))
</span><a href="#local-6989586621681362510"><span class="hs-identifier hs-var hs-var">ii</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall name. LocatedN name -&gt; IEWrappedName name
</span><a href="GHC.Hs.ImpExp.html#IEName"><span class="hs-identifier hs-var">IEName</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a an. a -&gt; LocatedAn an a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">IdP (GhcPass p)
</span><a href="#local-6989586621681362511"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2027"></span><span>
</span><span id="line-2028"></span><span>
</span><span id="line-2029"></span><span class="annot"><a href="GHC.Rename.Names.html#addDupDeclErr"><span class="hs-identifier hs-type">addDupDeclErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.Reader.html#GlobalRdrElt"><span class="hs-identifier hs-type">GlobalRdrElt</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRn"><span class="hs-identifier hs-type">TcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2030"></span><span id="addDupDeclErr"><span class="annot"><span class="annottext">addDupDeclErr :: [GlobalRdrElt] -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Names.html#addDupDeclErr"><span class="hs-identifier hs-var hs-var">addDupDeclErr</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;addDupDeclErr: empty list&quot;</span></span><span>
</span><span id="line-2031"></span><span class="annot"><a href="GHC.Rename.Names.html#addDupDeclErr"><span class="hs-identifier hs-var">addDupDeclErr</span></a></span><span> </span><span id="local-6989586621681362508"><span class="annot"><span class="annottext">gres :: [GlobalRdrElt]
</span><a href="#local-6989586621681362508"><span class="hs-identifier hs-var">gres</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621681362507"><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681362507"><span class="hs-identifier hs-var">gre</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-2032"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#addErrAt"><span class="hs-identifier hs-var">addErrAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. NamedThing a =&gt; a -&gt; SrcSpan
</span><a href="GHC.Types.Name.html#getSrcSpan"><span class="hs-identifier hs-var">getSrcSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-List.html#last"><span class="hs-identifier hs-var">last</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681362504"><span class="hs-identifier hs-var">sorted_names</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-2033"></span><span>    </span><span class="hs-comment">-- Report the error at the later location</span><span>
</span><span id="line-2034"></span><span>    </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Multiple declarations of&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-2035"></span><span>             </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; OccName
</span><a href="GHC.Types.Name.Reader.html#greOccName"><span class="hs-identifier hs-var">greOccName</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt
</span><a href="#local-6989586621681362507"><span class="hs-identifier hs-var">gre</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2036"></span><span>             </span><span class="hs-comment">-- NB. print the OccName, not the Name, because the</span><span>
</span><span id="line-2037"></span><span>             </span><span class="hs-comment">-- latter might not be in scope in the RdrEnv and so will</span><span>
</span><span id="line-2038"></span><span>             </span><span class="hs-comment">-- be printed qualified.</span><span>
</span><span id="line-2039"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Declared at:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-2040"></span><span>                   </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SrcLoc
</span><a href="GHC.Types.Name.html#nameSrcLoc"><span class="hs-identifier hs-var">nameSrcLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681362504"><span class="hs-identifier hs-var">sorted_names</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2041"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2042"></span><span>    </span><span id="local-6989586621681362504"><span class="annot"><span class="annottext">sorted_names :: [Name]
</span><a href="#local-6989586621681362504"><span class="hs-identifier hs-var hs-var">sorted_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2043"></span><span>      </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/Data-OldList.html#sortBy"><span class="hs-identifier hs-var">sortBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; SrcSpan -&gt; Ordering
</span><a href="GHC.Types.SrcLoc.html#leftmost_smallest"><span class="hs-identifier hs-var">SrcLoc.leftmost_smallest</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/Data-Function.html#on"><span class="hs-operator hs-var">`on`</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SrcSpan
</span><a href="GHC.Types.Name.html#nameSrcSpan"><span class="hs-identifier hs-var">nameSrcSpan</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2044"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">GlobalRdrElt -&gt; Name
</span><a href="GHC.Types.Name.Reader.html#greMangledName"><span class="hs-identifier hs-var">greMangledName</span></a></span><span> </span><span class="annot"><span class="annottext">[GlobalRdrElt]
</span><a href="#local-6989586621681362508"><span class="hs-identifier hs-var">gres</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2045"></span><span>
</span><span id="line-2046"></span><span>
</span><span id="line-2047"></span><span>
</span><span id="line-2048"></span><span class="annot"><a href="GHC.Rename.Names.html#missingImportListWarn"><span class="hs-identifier hs-type">missingImportListWarn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-2049"></span><span id="missingImportListWarn"><span class="annot"><span class="annottext">missingImportListWarn :: ModuleName -&gt; SDoc
</span><a href="GHC.Rename.Names.html#missingImportListWarn"><span class="hs-identifier hs-var hs-var">missingImportListWarn</span></a></span></span><span> </span><span id="local-6989586621681362500"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681362500"><span class="hs-identifier hs-var">mod</span></a></span></span><span>
</span><span id="line-2050"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The module&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681362500"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PtrString -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; PtrString
</span><a href="GHC.Data.FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;does not have an explicit import list&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2051"></span><span>
</span><span id="line-2052"></span><span class="annot"><a href="GHC.Rename.Names.html#missingImportListItem"><span class="hs-identifier hs-type">missingImportListItem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Hs.ImpExp.html#IE"><span class="hs-identifier hs-type">IE</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcPs"><span class="hs-identifier hs-type">GhcPs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-2053"></span><span id="missingImportListItem"><span class="annot"><span class="annottext">missingImportListItem :: IE GhcPs -&gt; SDoc
</span><a href="GHC.Rename.Names.html#missingImportListItem"><span class="hs-identifier hs-var hs-var">missingImportListItem</span></a></span></span><span> </span><span id="local-6989586621681362499"><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681362499"><span class="hs-identifier hs-var">ie</span></a></span></span><span>
</span><span id="line-2054"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The import item&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><a href="#local-6989586621681362499"><span class="hs-identifier hs-var">ie</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PtrString -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; PtrString
</span><a href="GHC.Data.FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;does not have an explicit import list&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-2055"></span><span>
</span><span id="line-2056"></span><span class="annot"><a href="GHC.Rename.Names.html#moduleWarn"><span class="hs-identifier hs-type">moduleWarn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#WarningTxt"><span class="hs-identifier hs-type">WarningTxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-2057"></span><span id="moduleWarn"><span class="annot"><span class="annottext">moduleWarn :: ModuleName -&gt; WarningTxt -&gt; SDoc
</span><a href="GHC.Rename.Names.html#moduleWarn"><span class="hs-identifier hs-var hs-var">moduleWarn</span></a></span></span><span> </span><span id="local-6989586621681362498"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681362498"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#WarningTxt"><span class="hs-identifier hs-type">WarningTxt</span></a></span><span> </span><span class="annot"><span class="annottext">Located SourceText
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681362496"><span class="annot"><span class="annottext">[Located StringLiteral]
</span><a href="#local-6989586621681362496"><span class="hs-identifier hs-var">txt</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2058"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Module&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681362498"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PtrString -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ptext"><span class="hs-identifier hs-var">ptext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; PtrString
</span><a href="GHC.Data.FastString.html#sLit"><span class="hs-identifier hs-var">sLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-2059"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">StringLiteral -&gt; FastString
</span><a href="GHC.Types.SourceText.html#sl_fs"><span class="hs-identifier hs-var">sl_fs</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Located StringLiteral]
</span><a href="#local-6989586621681362496"><span class="hs-identifier hs-var">txt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2060"></span><span class="annot"><a href="GHC.Rename.Names.html#moduleWarn"><span class="hs-identifier hs-var">moduleWarn</span></a></span><span> </span><span id="local-6989586621681362495"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681362495"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Unit.Module.Warnings.html#DeprecatedTxt"><span class="hs-identifier hs-type">DeprecatedTxt</span></a></span><span> </span><span class="annot"><span class="annottext">Located SourceText
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681362493"><span class="annot"><span class="annottext">[Located StringLiteral]
</span><a href="#local-6989586621681362493"><span class="hs-identifier hs-var">txt</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2061"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Module&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681362495"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2062"></span><span>                                </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is deprecated:&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-2063"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">StringLiteral -&gt; FastString
</span><a href="GHC.Types.SourceText.html#sl_fs"><span class="hs-identifier hs-var">sl_fs</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Located StringLiteral]
</span><a href="#local-6989586621681362493"><span class="hs-identifier hs-var">txt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-2064"></span><span>
</span><span id="line-2065"></span><span class="annot"><a href="GHC.Rename.Names.html#packageImportErr"><span class="hs-identifier hs-type">packageImportErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-2066"></span><span id="packageImportErr"><span class="annot"><span class="annottext">packageImportErr :: SDoc
</span><a href="GHC.Rename.Names.html#packageImportErr"><span class="hs-identifier hs-var hs-var">packageImportErr</span></a></span></span><span>
</span><span id="line-2067"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Package-qualified imports are not enabled; use PackageImports&quot;</span></span><span>
</span><span id="line-2068"></span><span>
</span><span id="line-2069"></span><span class="hs-comment">-- This data decl will parse OK</span><span>
</span><span id="line-2070"></span><span class="hs-comment">--      data T = a Int</span><span>
</span><span id="line-2071"></span><span class="hs-comment">-- treating &quot;a&quot; as the constructor.</span><span>
</span><span id="line-2072"></span><span class="hs-comment">-- It is really hard to make the parser spot this malformation.</span><span>
</span><span id="line-2073"></span><span class="hs-comment">-- So the renamer has to check that the constructor is legal</span><span>
</span><span id="line-2074"></span><span class="hs-comment">--</span><span>
</span><span id="line-2075"></span><span class="hs-comment">-- We can get an operator as the constructor, even in the prefix form:</span><span>
</span><span id="line-2076"></span><span class="hs-comment">--      data T = :% Int Int</span><span>
</span><span id="line-2077"></span><span class="hs-comment">-- from interface files, which always print in prefix form</span><span>
</span><span id="line-2078"></span><span>
</span><span id="line-2079"></span><span class="annot"><a href="GHC.Rename.Names.html#checkConName"><span class="hs-identifier hs-type">checkConName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Tc.Types.html#TcRn"><span class="hs-identifier hs-type">TcRn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2080"></span><span id="checkConName"><span class="annot"><span class="annottext">checkConName :: RdrName -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Rename.Names.html#checkConName"><span class="hs-identifier hs-var hs-var">checkConName</span></a></span></span><span> </span><span id="local-6989586621681362492"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681362492"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc -&gt; IOEnv (Env TcGblEnv TcLclEnv) ()
</span><a href="GHC.Tc.Utils.Monad.html#checkErr"><span class="hs-identifier hs-var">checkErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName -&gt; Bool
</span><a href="GHC.Types.Name.Reader.html#isRdrDataCon"><span class="hs-identifier hs-var">isRdrDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681362492"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName -&gt; SDoc
</span><a href="GHC.Rename.Names.html#badDataCon"><span class="hs-identifier hs-var">badDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681362492"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2081"></span><span>
</span><span id="line-2082"></span><span class="annot"><a href="GHC.Rename.Names.html#badDataCon"><span class="hs-identifier hs-type">badDataCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.Reader.html#RdrName"><span class="hs-identifier hs-type">RdrName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-2083"></span><span id="badDataCon"><span class="annot"><span class="annottext">badDataCon :: RdrName -&gt; SDoc
</span><a href="GHC.Rename.Names.html#badDataCon"><span class="hs-identifier hs-var hs-var">badDataCon</span></a></span></span><span> </span><span id="local-6989586621681362488"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681362488"><span class="hs-identifier hs-var">name</span></a></span></span><span>
</span><span id="line-2084"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Illegal data constructor name&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621681362488"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2085"></span></pre></body></html>