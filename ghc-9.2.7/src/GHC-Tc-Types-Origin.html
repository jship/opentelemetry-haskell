<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>GHC/Tc/Types/Origin.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE CPP #-}</span>
<a name="line-2"></a><span class='hs-comment'>{-# LANGUAGE LambdaCase #-}</span>
<a name="line-3"></a>
<a name="line-4"></a><span class='hs-comment'>{-# OPTIONS_GHC -Wno-incomplete-record-updates #-}</span>
<a name="line-5"></a><span class='hs-comment'>{-# OPTIONS_GHC -Wno-incomplete-uni-patterns   #-}</span>
<a name="line-6"></a>
<a name="line-7"></a><span class='hs-comment'>-- | Describes the provenance of types as they flow through the type-checker.</span>
<a name="line-8"></a><span class='hs-comment'>-- The datatypes here are mainly used for error message generation.</span>
<a name="line-9"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>GHC.Tc.Types.Origin</span> <span class='hs-layout'>(</span>
<a name="line-10"></a>  <span class='hs-comment'>-- UserTypeCtxt</span>
<a name="line-11"></a>  <span class='hs-conid'>UserTypeCtxt</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprUserTypeCtxt</span><span class='hs-layout'>,</span> <span class='hs-varid'>isSigMaybe</span><span class='hs-layout'>,</span>
<a name="line-12"></a>
<a name="line-13"></a>  <span class='hs-comment'>-- SkolemInfo</span>
<a name="line-14"></a>  <span class='hs-conid'>SkolemInfo</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprSigSkolInfo</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprSkolInfo</span><span class='hs-layout'>,</span>
<a name="line-15"></a>
<a name="line-16"></a>  <span class='hs-comment'>-- CtOrigin</span>
<a name="line-17"></a>  <span class='hs-conid'>CtOrigin</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>exprCtOrigin</span><span class='hs-layout'>,</span> <span class='hs-varid'>lexprCtOrigin</span><span class='hs-layout'>,</span> <span class='hs-varid'>matchesCtOrigin</span><span class='hs-layout'>,</span> <span class='hs-varid'>grhssCtOrigin</span><span class='hs-layout'>,</span>
<a name="line-18"></a>  <span class='hs-varid'>isVisibleOrigin</span><span class='hs-layout'>,</span> <span class='hs-varid'>toInvisibleOrigin</span><span class='hs-layout'>,</span>
<a name="line-19"></a>  <span class='hs-varid'>pprCtOrigin</span><span class='hs-layout'>,</span> <span class='hs-varid'>isGivenOrigin</span>
<a name="line-20"></a>
<a name="line-21"></a>  <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-22"></a>
<a name="line-23"></a><span class='hs-cpp'>#include "HsVersions.h"</span>
<a name="line-24"></a>
<a name="line-25"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Prelude</span>
<a name="line-26"></a>
<a name="line-27"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Tc.Utils.TcType</span>
<a name="line-28"></a>
<a name="line-29"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Hs</span>
<a name="line-30"></a>
<a name="line-31"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Core.DataCon</span>
<a name="line-32"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Core.ConLike</span>
<a name="line-33"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Core.TyCon</span>
<a name="line-34"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Core.InstEnv</span>
<a name="line-35"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Core.PatSyn</span>
<a name="line-36"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Core.Multiplicity</span> <span class='hs-layout'>(</span> <span class='hs-varid'>scaledThing</span> <span class='hs-layout'>)</span>
<a name="line-37"></a>
<a name="line-38"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Unit.Module</span>
<a name="line-39"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Id</span>
<a name="line-40"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Name</span>
<a name="line-41"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Name.Reader</span>
<a name="line-42"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Basic</span>
<a name="line-43"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.SrcLoc</span>
<a name="line-44"></a>
<a name="line-45"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Data.FastString</span>
<a name="line-46"></a>
<a name="line-47"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Utils.Outputable</span>
<a name="line-48"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Utils.Panic</span>
<a name="line-49"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Driver.Ppr</span>
<a name="line-50"></a>
<a name="line-51"></a><span class='hs-comment'>{- *********************************************************************
<a name="line-52"></a>*                                                                      *
<a name="line-53"></a>          UserTypeCtxt
<a name="line-54"></a>*                                                                      *
<a name="line-55"></a>********************************************************************* -}</span>
<a name="line-56"></a>
<a name="line-57"></a><a name="UserTypeCtxt"></a><span class='hs-comment'>-------------------------------------</span>
<a name="line-58"></a><a name="UserTypeCtxt"></a><span class='hs-comment'>-- | UserTypeCtxt describes the origin of the polymorphic type</span>
<a name="line-59"></a><a name="UserTypeCtxt"></a><span class='hs-comment'>-- in the places where we need an expression to have that type</span>
<a name="line-60"></a><a name="UserTypeCtxt"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>UserTypeCtxt</span>
<a name="line-61"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>FunSigCtxt</span>      <span class='hs-comment'>-- Function type signature, when checking the type</span>
<a name="line-62"></a>                    <span class='hs-comment'>-- Also used for types in SPECIALISE pragmas</span>
<a name="line-63"></a>       <span class='hs-conid'>Name</span>              <span class='hs-comment'>-- Name of the function</span>
<a name="line-64"></a>       <span class='hs-conid'>Bool</span>              <span class='hs-comment'>-- True &lt;=&gt; report redundant constraints</span>
<a name="line-65"></a>                            <span class='hs-comment'>-- This is usually True, but False for</span>
<a name="line-66"></a>                            <span class='hs-comment'>--   * Record selectors (not important here)</span>
<a name="line-67"></a>                            <span class='hs-comment'>--   * Class and instance methods.  Here</span>
<a name="line-68"></a>                            <span class='hs-comment'>--     the code may legitimately be more</span>
<a name="line-69"></a>                            <span class='hs-comment'>--     polymorphic than the signature</span>
<a name="line-70"></a>                            <span class='hs-comment'>--     generated from the class</span>
<a name="line-71"></a>                            <span class='hs-comment'>--     declaration</span>
<a name="line-72"></a>
<a name="line-73"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>InfSigCtxt</span> <span class='hs-conid'>Name</span>     <span class='hs-comment'>-- Inferred type for function</span>
<a name="line-74"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ExprSigCtxt</span>         <span class='hs-comment'>-- Expression type signature</span>
<a name="line-75"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>KindSigCtxt</span>         <span class='hs-comment'>-- Kind signature</span>
<a name="line-76"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>StandaloneKindSigCtxt</span>  <span class='hs-comment'>-- Standalone kind signature</span>
<a name="line-77"></a>       <span class='hs-conid'>Name</span>                <span class='hs-comment'>-- Name of the type/class</span>
<a name="line-78"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>TypeAppCtxt</span>         <span class='hs-comment'>-- Visible type application</span>
<a name="line-79"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConArgCtxt</span> <span class='hs-conid'>Name</span>     <span class='hs-comment'>-- Data constructor argument</span>
<a name="line-80"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>TySynCtxt</span> <span class='hs-conid'>Name</span>      <span class='hs-comment'>-- RHS of a type synonym decl</span>
<a name="line-81"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>PatSynCtxt</span> <span class='hs-conid'>Name</span>     <span class='hs-comment'>-- Type sig for a pattern synonym</span>
<a name="line-82"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>PatSigCtxt</span>          <span class='hs-comment'>-- Type sig in pattern</span>
<a name="line-83"></a>                        <span class='hs-comment'>--   eg  f (x::t) = ...</span>
<a name="line-84"></a>                        <span class='hs-comment'>--   or  (x::t, y) = e</span>
<a name="line-85"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>RuleSigCtxt</span> <span class='hs-conid'>Name</span>    <span class='hs-comment'>-- LHS of a RULE forall</span>
<a name="line-86"></a>                        <span class='hs-comment'>--    RULE "foo" forall (x :: a -&gt; a). f (Just x) = ...</span>
<a name="line-87"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ForSigCtxt</span> <span class='hs-conid'>Name</span>     <span class='hs-comment'>-- Foreign import or export signature</span>
<a name="line-88"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>DefaultDeclCtxt</span>     <span class='hs-comment'>-- Types in a default declaration</span>
<a name="line-89"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>InstDeclCtxt</span> <span class='hs-conid'>Bool</span>   <span class='hs-comment'>-- An instance declaration</span>
<a name="line-90"></a>                        <span class='hs-comment'>--    True:  stand-alone deriving</span>
<a name="line-91"></a>                        <span class='hs-comment'>--    False: vanilla instance declaration</span>
<a name="line-92"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>SpecInstCtxt</span>        <span class='hs-comment'>-- SPECIALISE instance pragma</span>
<a name="line-93"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>GenSigCtxt</span>          <span class='hs-comment'>-- Higher-rank or impredicative situations</span>
<a name="line-94"></a>                        <span class='hs-comment'>-- e.g. (f e) where f has a higher-rank type</span>
<a name="line-95"></a>                        <span class='hs-comment'>-- We might want to elaborate this</span>
<a name="line-96"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>GhciCtxt</span> <span class='hs-conid'>Bool</span>       <span class='hs-comment'>-- GHCi command :kind &lt;type&gt;</span>
<a name="line-97"></a>                        <span class='hs-comment'>-- The Bool indicates if we are checking the outermost</span>
<a name="line-98"></a>                        <span class='hs-comment'>-- type application.</span>
<a name="line-99"></a>                        <span class='hs-comment'>-- See Note [Unsaturated type synonyms in GHCi] in</span>
<a name="line-100"></a>                        <span class='hs-comment'>-- GHC.Tc.Validity.</span>
<a name="line-101"></a>
<a name="line-102"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ClassSCCtxt</span> <span class='hs-conid'>Name</span>    <span class='hs-comment'>-- Superclasses of a class</span>
<a name="line-103"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>SigmaCtxt</span>           <span class='hs-comment'>-- Theta part of a normal for-all type</span>
<a name="line-104"></a>                        <span class='hs-comment'>--      f :: &lt;S&gt; =&gt; a -&gt; a</span>
<a name="line-105"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>DataTyCtxt</span> <span class='hs-conid'>Name</span>     <span class='hs-comment'>-- The "stupid theta" part of a data decl</span>
<a name="line-106"></a>                        <span class='hs-comment'>--      data &lt;S&gt; =&gt; T a = MkT a</span>
<a name="line-107"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>DerivClauseCtxt</span>     <span class='hs-comment'>-- A 'deriving' clause</span>
<a name="line-108"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>TyVarBndrKindCtxt</span> <span class='hs-conid'>Name</span>  <span class='hs-comment'>-- The kind of a type variable being bound</span>
<a name="line-109"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>DataKindCtxt</span> <span class='hs-conid'>Name</span>   <span class='hs-comment'>-- The kind of a data/newtype (instance)</span>
<a name="line-110"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>TySynKindCtxt</span> <span class='hs-conid'>Name</span>  <span class='hs-comment'>-- The kind of the RHS of a type synonym</span>
<a name="line-111"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>TyFamResKindCtxt</span> <span class='hs-conid'>Name</span>   <span class='hs-comment'>-- The result kind of a type family</span>
<a name="line-112"></a>
<a name="line-113"></a><span class='hs-comment'>{-
<a name="line-114"></a>-- Notes re TySynCtxt
<a name="line-115"></a>-- We allow type synonyms that aren't types; e.g.  type List = []
<a name="line-116"></a>--
<a name="line-117"></a>-- If the RHS mentions tyvars that aren't in scope, we'll
<a name="line-118"></a>-- quantify over them:
<a name="line-119"></a>--      e.g.    type T = a-&gt;a
<a name="line-120"></a>-- will become  type T = forall a. a-&gt;a
<a name="line-121"></a>--
<a name="line-122"></a>-- With gla-exts that's right, but for H98 we should complain.
<a name="line-123"></a>-}</span>
<a name="line-124"></a>
<a name="line-125"></a>
<a name="line-126"></a><a name="pprUserTypeCtxt"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>UserTypeCtxt</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-127"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>FunSigCtxt</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the type signature for"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-128"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>InfSigCtxt</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the inferred type for"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-129"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>RuleSigCtxt</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the type signature for"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-130"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-conid'>ExprSigCtxt</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"an expression type signature"</span>
<a name="line-131"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-conid'>KindSigCtxt</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a kind signature"</span>
<a name="line-132"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>StandaloneKindSigCtxt</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a standalone kind signature for"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-133"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-conid'>TypeAppCtxt</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a type argument"</span>
<a name="line-134"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>ConArgCtxt</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the type of the constructor"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-135"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>TySynCtxt</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the RHS of the type synonym"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-136"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-conid'>PatSigCtxt</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a pattern type signature"</span>
<a name="line-137"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>ForSigCtxt</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the foreign declaration for"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-138"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-conid'>DefaultDeclCtxt</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a type in a `default' declaration"</span>
<a name="line-139"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>InstDeclCtxt</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"an instance declaration"</span>
<a name="line-140"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>InstDeclCtxt</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a stand-alone deriving instance declaration"</span>
<a name="line-141"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-conid'>SpecInstCtxt</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a SPECIALISE instance pragma"</span>
<a name="line-142"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-conid'>GenSigCtxt</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a type expected by the context"</span>
<a name="line-143"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhciCtxt</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a type in a GHCi command"</span>
<a name="line-144"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>ClassSCCtxt</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the super-classes of class"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-145"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-conid'>SigmaCtxt</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the context of a polymorphic type"</span>
<a name="line-146"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>DataTyCtxt</span> <span class='hs-varid'>tc</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the context of the data type declaration for"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>tc</span><span class='hs-layout'>)</span>
<a name="line-147"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>PatSynCtxt</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the signature for pattern synonym"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-148"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>DerivClauseCtxt</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a `deriving' clause"</span>
<a name="line-149"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>TyVarBndrKindCtxt</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the kind annotation on the type variable"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-150"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>DataKindCtxt</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the kind annotation on the declaration for"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-151"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>TySynKindCtxt</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the kind annotation on the declaration for"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-152"></a><span class='hs-definition'>pprUserTypeCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>TyFamResKindCtxt</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the result kind for"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-153"></a>
<a name="line-154"></a><a name="isSigMaybe"></a><span class='hs-definition'>isSigMaybe</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>UserTypeCtxt</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Name</span>
<a name="line-155"></a><span class='hs-definition'>isSigMaybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>FunSigCtxt</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>n</span>
<a name="line-156"></a><span class='hs-definition'>isSigMaybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>ConArgCtxt</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>n</span>
<a name="line-157"></a><span class='hs-definition'>isSigMaybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>ForSigCtxt</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>n</span>
<a name="line-158"></a><span class='hs-definition'>isSigMaybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>PatSynCtxt</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>n</span>
<a name="line-159"></a><span class='hs-definition'>isSigMaybe</span> <span class='hs-keyword'>_</span>                <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span>
<a name="line-160"></a>
<a name="line-161"></a><span class='hs-comment'>{-
<a name="line-162"></a>************************************************************************
<a name="line-163"></a>*                                                                      *
<a name="line-164"></a>                SkolemInfo
<a name="line-165"></a>*                                                                      *
<a name="line-166"></a>************************************************************************
<a name="line-167"></a>-}</span>
<a name="line-168"></a>
<a name="line-169"></a><a name="SkolemInfo"></a><span class='hs-comment'>-- SkolemInfo gives the origin of *given* constraints</span>
<a name="line-170"></a><a name="SkolemInfo"></a><span class='hs-comment'>--   a) type variables are skolemised</span>
<a name="line-171"></a><a name="SkolemInfo"></a><span class='hs-comment'>--   b) an implication constraint is generated</span>
<a name="line-172"></a><a name="SkolemInfo"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>SkolemInfo</span>
<a name="line-173"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SigSkol</span> <span class='hs-comment'>-- A skolem that is created by instantiating</span>
<a name="line-174"></a>            <span class='hs-comment'>-- a programmer-supplied type signature</span>
<a name="line-175"></a>            <span class='hs-comment'>-- Location of the binding site is on the TyVar</span>
<a name="line-176"></a>            <span class='hs-comment'>-- See Note [SigSkol SkolemInfo]</span>
<a name="line-177"></a>       <span class='hs-conid'>UserTypeCtxt</span>        <span class='hs-comment'>-- What sort of signature</span>
<a name="line-178"></a>       <span class='hs-conid'>TcType</span>              <span class='hs-comment'>-- Original type signature (before skolemisation)</span>
<a name="line-179"></a>       <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Name</span><span class='hs-layout'>,</span><span class='hs-conid'>TcTyVar</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>    <span class='hs-comment'>-- Maps the original name of the skolemised tyvar</span>
<a name="line-180"></a>                           <span class='hs-comment'>-- to its instantiated version</span>
<a name="line-181"></a>
<a name="line-182"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>SigTypeSkol</span> <span class='hs-conid'>UserTypeCtxt</span>
<a name="line-183"></a>                 <span class='hs-comment'>-- like SigSkol, but when we're kind-checking the *type*</span>
<a name="line-184"></a>                 <span class='hs-comment'>-- hence, we have less info</span>
<a name="line-185"></a>
<a name="line-186"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ForAllSkol</span>  <span class='hs-comment'>-- Bound by a user-written "forall".</span>
<a name="line-187"></a>       <span class='hs-conid'>SDoc</span>        <span class='hs-comment'>-- Shows just the binders, used when reporting a bad telescope</span>
<a name="line-188"></a>                   <span class='hs-comment'>-- See Note [Checking telescopes] in GHC.Tc.Types.Constraint</span>
<a name="line-189"></a>
<a name="line-190"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>DerivSkol</span> <span class='hs-conid'>Type</span>      <span class='hs-comment'>-- Bound by a 'deriving' clause;</span>
<a name="line-191"></a>                        <span class='hs-comment'>-- the type is the instance we are trying to derive</span>
<a name="line-192"></a>
<a name="line-193"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>InstSkol</span>            <span class='hs-comment'>-- Bound at an instance decl</span>
<a name="line-194"></a>
<a name="line-195"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>FamInstSkol</span>         <span class='hs-comment'>-- Bound at a family instance decl</span>
<a name="line-196"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>PatSkol</span>             <span class='hs-comment'>-- An existential type variable bound by a pattern for</span>
<a name="line-197"></a>      <span class='hs-conid'>ConLike</span>           <span class='hs-comment'>-- a data constructor with an existential type.</span>
<a name="line-198"></a>      <span class='hs-layout'>(</span><span class='hs-conid'>HsMatchContext</span> <span class='hs-conid'>GhcRn</span><span class='hs-layout'>)</span>
<a name="line-199"></a>             <span class='hs-comment'>-- e.g.   data T = forall a. Eq a =&gt; MkT a</span>
<a name="line-200"></a>             <span class='hs-comment'>--        f (MkT x) = ...</span>
<a name="line-201"></a>             <span class='hs-comment'>-- The pattern MkT x will allocate an existential type</span>
<a name="line-202"></a>             <span class='hs-comment'>-- variable for 'a'.</span>
<a name="line-203"></a>
<a name="line-204"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ArrowSkol</span>           <span class='hs-comment'>-- An arrow form (see GHC.Tc.Gen.Arrow)</span>
<a name="line-205"></a>
<a name="line-206"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IPSkol</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>HsIPName</span><span class='hs-keyglyph'>]</span>   <span class='hs-comment'>-- Binding site of an implicit parameter</span>
<a name="line-207"></a>
<a name="line-208"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>RuleSkol</span> <span class='hs-conid'>RuleName</span>   <span class='hs-comment'>-- The LHS of a RULE</span>
<a name="line-209"></a>
<a name="line-210"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>InferSkol</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Name</span><span class='hs-layout'>,</span><span class='hs-conid'>TcType</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-211"></a>                        <span class='hs-comment'>-- We have inferred a type for these (mutually-recursivive)</span>
<a name="line-212"></a>                        <span class='hs-comment'>-- polymorphic Ids, and are now checking that their RHS</span>
<a name="line-213"></a>                        <span class='hs-comment'>-- constraints are satisfied.</span>
<a name="line-214"></a>
<a name="line-215"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>BracketSkol</span>         <span class='hs-comment'>-- Template Haskell bracket</span>
<a name="line-216"></a>
<a name="line-217"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UnifyForAllSkol</span>     <span class='hs-comment'>-- We are unifying two for-all types</span>
<a name="line-218"></a>       <span class='hs-conid'>TcType</span>           <span class='hs-comment'>-- The instantiated type *inside* the forall</span>
<a name="line-219"></a>
<a name="line-220"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>TyConSkol</span> <span class='hs-conid'>TyConFlavour</span> <span class='hs-conid'>Name</span>  <span class='hs-comment'>-- bound in a type declaration of the given flavour</span>
<a name="line-221"></a>
<a name="line-222"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>DataConSkol</span> <span class='hs-conid'>Name</span>    <span class='hs-comment'>-- bound as an existential in a Haskell98 datacon decl or</span>
<a name="line-223"></a>                        <span class='hs-comment'>-- as any variable in a GADT datacon decl</span>
<a name="line-224"></a>
<a name="line-225"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ReifySkol</span>           <span class='hs-comment'>-- Bound during Template Haskell reification</span>
<a name="line-226"></a>
<a name="line-227"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>QuantCtxtSkol</span>       <span class='hs-comment'>-- Quantified context, e.g.</span>
<a name="line-228"></a>                        <span class='hs-comment'>--   f :: forall c. (forall a. c a =&gt; c [a]) =&gt; blah</span>
<a name="line-229"></a>
<a name="line-230"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>RuntimeUnkSkol</span>      <span class='hs-comment'>-- Runtime skolem from the GHCi debugger      #14628</span>
<a name="line-231"></a>
<a name="line-232"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UnkSkol</span>             <span class='hs-comment'>-- Unhelpful info (until I improve it)</span>
<a name="line-233"></a>
<a name="line-234"></a><a name="instance%20Outputable%20SkolemInfo"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>SkolemInfo</span> <span class='hs-keyword'>where</span>
<a name="line-235"></a>  <span class='hs-varid'>ppr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprSkolInfo</span>
<a name="line-236"></a>
<a name="line-237"></a><a name="pprSkolInfo"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SkolemInfo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-238"></a><span class='hs-comment'>-- Complete the sentence "is a rigid type variable bound by..."</span>
<a name="line-239"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-layout'>(</span><span class='hs-conid'>SigSkol</span> <span class='hs-varid'>cx</span> <span class='hs-varid'>ty</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprSigSkolInfo</span> <span class='hs-varid'>cx</span> <span class='hs-varid'>ty</span>
<a name="line-240"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-layout'>(</span><span class='hs-conid'>SigTypeSkol</span> <span class='hs-varid'>cx</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprUserTypeCtxt</span> <span class='hs-varid'>cx</span>
<a name="line-241"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-layout'>(</span><span class='hs-conid'>ForAllSkol</span> <span class='hs-varid'>tvs</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"an explicit forall"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>tvs</span>
<a name="line-242"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-layout'>(</span><span class='hs-conid'>IPSkol</span> <span class='hs-varid'>ips</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the implicit-parameter binding"</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>plural</span> <span class='hs-varid'>ips</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"for"</span>
<a name="line-243"></a>                                 <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprWithCommas</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ips</span>
<a name="line-244"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-layout'>(</span><span class='hs-conid'>DerivSkol</span> <span class='hs-varid'>pred</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the deriving clause for"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>pred</span><span class='hs-layout'>)</span>
<a name="line-245"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-conid'>InstSkol</span>          <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the instance declaration"</span>
<a name="line-246"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-conid'>FamInstSkol</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a family instance declaration"</span>
<a name="line-247"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-conid'>BracketSkol</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a Template Haskell bracket"</span>
<a name="line-248"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-layout'>(</span><span class='hs-conid'>RuleSkol</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the RULE"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprRuleName</span> <span class='hs-varid'>name</span>
<a name="line-249"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-conid'>ArrowSkol</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"an arrow form"</span>
<a name="line-250"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-layout'>(</span><span class='hs-conid'>PatSkol</span> <span class='hs-varid'>cl</span> <span class='hs-varid'>mc</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>pprPatSkolInfo</span> <span class='hs-varid'>cl</span>
<a name="line-251"></a>                                    <span class='hs-layout'>,</span> <span class='hs-varid'>text</span> <span class='hs-str'>"in"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprMatchContext</span> <span class='hs-varid'>mc</span> <span class='hs-keyglyph'>]</span>
<a name="line-252"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-layout'>(</span><span class='hs-conid'>InferSkol</span> <span class='hs-varid'>ids</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"the inferred type"</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>plural</span> <span class='hs-varid'>ids</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"of"</span><span class='hs-layout'>)</span>
<a name="line-253"></a>                                   <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>vcat</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>name</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>dcolon</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span>
<a name="line-254"></a>                                           <span class='hs-keyglyph'>|</span> <span class='hs-layout'>(</span><span class='hs-varid'>name</span><span class='hs-layout'>,</span><span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>ids</span> <span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-255"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-layout'>(</span><span class='hs-conid'>UnifyForAllSkol</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the type"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span>
<a name="line-256"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-layout'>(</span><span class='hs-conid'>TyConSkol</span> <span class='hs-varid'>flav</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>flav</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"declaration for"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span>
<a name="line-257"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-layout'>(</span><span class='hs-conid'>DataConSkol</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the data constructor"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span>
<a name="line-258"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-conid'>ReifySkol</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the type being reified"</span>
<a name="line-259"></a>
<a name="line-260"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-layout'>(</span><span class='hs-conid'>QuantCtxtSkol</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a quantified context"</span>
<a name="line-261"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-conid'>RuntimeUnkSkol</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"Unknown type from GHCi runtime"</span>
<a name="line-262"></a>
<a name="line-263"></a><span class='hs-comment'>-- UnkSkol</span>
<a name="line-264"></a><span class='hs-comment'>-- For type variables the others are dealt with by pprSkolTvBinding.</span>
<a name="line-265"></a><span class='hs-comment'>-- For Insts, these cases should not happen</span>
<a name="line-266"></a><span class='hs-definition'>pprSkolInfo</span> <span class='hs-conid'>UnkSkol</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>WARN</span><span class='hs-layout'>(</span> <span class='hs-conid'>True</span><span class='hs-layout'>,</span> <span class='hs-varid'>text</span> <span class='hs-str'>"pprSkolInfo: UnkSkol"</span> <span class='hs-layout'>)</span> <span class='hs-varid'>text</span> <span class='hs-str'>"UnkSkol"</span>
<a name="line-267"></a>
<a name="line-268"></a><a name="pprSigSkolInfo"></a><span class='hs-definition'>pprSigSkolInfo</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>UserTypeCtxt</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TcType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-269"></a><span class='hs-comment'>-- The type is already tidied</span>
<a name="line-270"></a><span class='hs-definition'>pprSigSkolInfo</span> <span class='hs-varid'>ctxt</span> <span class='hs-varid'>ty</span>
<a name="line-271"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ctxt</span> <span class='hs-keyword'>of</span>
<a name="line-272"></a>       <span class='hs-conid'>FunSigCtxt</span> <span class='hs-varid'>f</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>vcat</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the type signature for:"</span>
<a name="line-273"></a>                              <span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprPrefixOcc</span> <span class='hs-varid'>f</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>dcolon</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>]</span>
<a name="line-274"></a>       <span class='hs-conid'>PatSynCtxt</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>pprUserTypeCtxt</span> <span class='hs-varid'>ctxt</span>  <span class='hs-comment'>-- See Note [Skolem info for pattern synonyms]</span>
<a name="line-275"></a>       <span class='hs-keyword'>_</span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>vcat</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>pprUserTypeCtxt</span> <span class='hs-varid'>ctxt</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>colon</span>
<a name="line-276"></a>                              <span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>]</span>
<a name="line-277"></a>
<a name="line-278"></a><a name="pprPatSkolInfo"></a><span class='hs-definition'>pprPatSkolInfo</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ConLike</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-279"></a><span class='hs-definition'>pprPatSkolInfo</span> <span class='hs-layout'>(</span><span class='hs-conid'>RealDataCon</span> <span class='hs-varid'>dc</span><span class='hs-layout'>)</span>
<a name="line-280"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sdocOption</span> <span class='hs-varid'>sdocLinearTypes</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>show_linear_types</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-281"></a>      <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a pattern with constructor:"</span>
<a name="line-282"></a>          <span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-varop'>$</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>dc</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>dcolon</span>
<a name="line-283"></a>            <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprType</span> <span class='hs-layout'>(</span><span class='hs-varid'>dataConDisplayType</span> <span class='hs-varid'>show_linear_types</span> <span class='hs-varid'>dc</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>comma</span> <span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-284"></a>            <span class='hs-comment'>-- pprType prints forall's regardless of -fprint-explicit-foralls</span>
<a name="line-285"></a>            <span class='hs-comment'>-- which is what we want here, since we might be saying</span>
<a name="line-286"></a>            <span class='hs-comment'>-- type variable 't' is bound by ...</span>
<a name="line-287"></a>
<a name="line-288"></a><span class='hs-definition'>pprPatSkolInfo</span> <span class='hs-layout'>(</span><span class='hs-conid'>PatSynCon</span> <span class='hs-varid'>ps</span><span class='hs-layout'>)</span>
<a name="line-289"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a pattern with pattern synonym:"</span>
<a name="line-290"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-varop'>$</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ps</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>dcolon</span>
<a name="line-291"></a>                   <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprPatSynType</span> <span class='hs-varid'>ps</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>comma</span> <span class='hs-keyglyph'>]</span>
<a name="line-292"></a>
<a name="line-293"></a><span class='hs-comment'>{- Note [Skolem info for pattern synonyms]
<a name="line-294"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-295"></a>For pattern synonym SkolemInfo we have
<a name="line-296"></a>   SigSkol (PatSynCtxt p) ty _
<a name="line-297"></a>but the type 'ty' is not very helpful.  The full pattern-synonym type
<a name="line-298"></a>has the provided and required pieces, which it is inconvenient to
<a name="line-299"></a>record and display here. So we simply don't display the type at all,
<a name="line-300"></a>contenting ourselves with just the name of the pattern synonym, which
<a name="line-301"></a>is fine.  We could do more, but it doesn't seem worth it.
<a name="line-302"></a>
<a name="line-303"></a>Note [SigSkol SkolemInfo]
<a name="line-304"></a>~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-305"></a>Suppose we skolemise a type
<a name="line-306"></a>   f :: forall a. Eq a =&gt; forall b. b -&gt; a
<a name="line-307"></a>Then we'll instantiate [a :-&gt; a', b :-&gt; b'], and with the instantiated
<a name="line-308"></a>      a' -&gt; b' -&gt; a.
<a name="line-309"></a>But when, in an error message, we report that "b is a rigid type
<a name="line-310"></a>variable bound by the type signature for f", we want to show the foralls
<a name="line-311"></a>in the right place.  So we proceed as follows:
<a name="line-312"></a>
<a name="line-313"></a>* In SigSkol we record
<a name="line-314"></a>    - the original signature forall a. a -&gt; forall b. b -&gt; a
<a name="line-315"></a>    - the instantiation mapping [a :-&gt; a', b :-&gt; b']
<a name="line-316"></a>
<a name="line-317"></a>* Then when tidying in GHC.Tc.Utils.TcMType.tidySkolemInfo, we first tidy a' to
<a name="line-318"></a>  whatever it tidies to, say a''; and then we walk over the type
<a name="line-319"></a>  replacing the binder a by the tidied version a'', to give
<a name="line-320"></a>       forall a''. Eq a'' =&gt; forall b''. b'' -&gt; a''
<a name="line-321"></a>  We need to do this under (=&gt;) arrows, to match what topSkolemise
<a name="line-322"></a>  does.
<a name="line-323"></a>
<a name="line-324"></a>* Typically a'' will have a nice pretty name like "a", but the point is
<a name="line-325"></a>  that the foral-bound variables of the signature we report line up with
<a name="line-326"></a>  the instantiated skolems lying  around in other types.
<a name="line-327"></a>
<a name="line-328"></a>
<a name="line-329"></a>************************************************************************
<a name="line-330"></a>*                                                                      *
<a name="line-331"></a>            CtOrigin
<a name="line-332"></a>*                                                                      *
<a name="line-333"></a>************************************************************************
<a name="line-334"></a>-}</span>
<a name="line-335"></a>
<a name="line-336"></a><a name="CtOrigin"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>CtOrigin</span>
<a name="line-337"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-comment'>-- | A given constraint from a user-written type signature. The</span>
<a name="line-338"></a>    <span class='hs-comment'>-- 'SkolemInfo' inside gives more information.</span>
<a name="line-339"></a>    <span class='hs-conid'>GivenOrigin</span> <span class='hs-conid'>SkolemInfo</span>
<a name="line-340"></a>
<a name="line-341"></a>  <span class='hs-comment'>-- The following are other origins for given constraints that cannot produce</span>
<a name="line-342"></a>  <span class='hs-comment'>-- new skolems -- hence no SkolemInfo.</span>
<a name="line-343"></a>
<a name="line-344"></a>  <span class='hs-comment'>-- | 'InstSCOrigin' is used for a Given constraint obtained by superclass selection</span>
<a name="line-345"></a>  <span class='hs-comment'>-- from the context of an instance declaration.  E.g.</span>
<a name="line-346"></a>  <span class='hs-comment'>--       instance @(Foo a, Bar a) =&gt; C [a]@ where ...</span>
<a name="line-347"></a>  <span class='hs-comment'>-- When typechecking the instance decl itself, including producing evidence</span>
<a name="line-348"></a>  <span class='hs-comment'>-- for the superclasses of @C@, the superclasses of @(Foo a)@ and @(Bar a)@ will</span>
<a name="line-349"></a>  <span class='hs-comment'>-- have 'InstSCOrigin' origin.</span>
<a name="line-350"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>InstSCOrigin</span> <span class='hs-conid'>ScDepth</span>      <span class='hs-comment'>-- ^ The number of superclass selections necessary to</span>
<a name="line-351"></a>                              <span class='hs-comment'>-- get this constraint; see Note [Replacement vs keeping]</span>
<a name="line-352"></a>                              <span class='hs-comment'>-- and Note [Use only the best local instance], both in</span>
<a name="line-353"></a>                              <span class='hs-comment'>-- GHC.Tc.Solver.Interact</span>
<a name="line-354"></a>                 <span class='hs-conid'>TypeSize</span>     <span class='hs-comment'>-- ^ If @(C ty1 .. tyn)@ is the largest class from</span>
<a name="line-355"></a>                              <span class='hs-comment'>--    which we made a superclass selection in the chain,</span>
<a name="line-356"></a>                              <span class='hs-comment'>--    then @TypeSize = sizeTypes [ty1, .., tyn]@</span>
<a name="line-357"></a>                              <span class='hs-comment'>-- See Note [Solving superclass constraints] in GHC.Tc.TyCl.Instance</span>
<a name="line-358"></a>
<a name="line-359"></a>  <span class='hs-comment'>-- | 'OtherSCOrigin' is used for a Given constraint obtained by superclass</span>
<a name="line-360"></a>  <span class='hs-comment'>-- selection from a constraint /other than/ the context of an instance</span>
<a name="line-361"></a>  <span class='hs-comment'>-- declaration. (For the latter we use 'InstSCOrigin'.)  E.g.</span>
<a name="line-362"></a>  <span class='hs-comment'>--      f :: Foo a =&gt; blah</span>
<a name="line-363"></a>  <span class='hs-comment'>--      f = e</span>
<a name="line-364"></a>  <span class='hs-comment'>-- When typechecking body of 'f', the superclasses of the Given (Foo a)</span>
<a name="line-365"></a>  <span class='hs-comment'>-- will have 'OtherSCOrigin'.</span>
<a name="line-366"></a>  <span class='hs-comment'>-- Needed for Note [Replacement vs keeping] and</span>
<a name="line-367"></a>  <span class='hs-comment'>-- Note [Use only the best local instance], both in GHC.Tc.Solver.Interact.</span>
<a name="line-368"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>OtherSCOrigin</span> <span class='hs-conid'>ScDepth</span> <span class='hs-comment'>-- ^ The number of superclass selections necessary to</span>
<a name="line-369"></a>                          <span class='hs-comment'>-- get this constraint</span>
<a name="line-370"></a>                  <span class='hs-conid'>SkolemInfo</span>   <span class='hs-comment'>-- ^ Where the sub-class constraint arose from</span>
<a name="line-371"></a>                               <span class='hs-comment'>-- (used only for printing)</span>
<a name="line-372"></a>
<a name="line-373"></a>  <span class='hs-comment'>-- All the others are for *wanted* constraints</span>
<a name="line-374"></a>
<a name="line-375"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>OccurrenceOf</span> <span class='hs-conid'>Name</span>              <span class='hs-comment'>-- Occurrence of an overloaded identifier</span>
<a name="line-376"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>OccurrenceOfRecSel</span> <span class='hs-conid'>RdrName</span>     <span class='hs-comment'>-- Occurrence of a record selector</span>
<a name="line-377"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>AppOrigin</span>                      <span class='hs-comment'>-- An application of some kind</span>
<a name="line-378"></a>
<a name="line-379"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>SpecPragOrigin</span> <span class='hs-conid'>UserTypeCtxt</span>    <span class='hs-comment'>-- Specialisation pragma for</span>
<a name="line-380"></a>                                   <span class='hs-comment'>-- function or instance</span>
<a name="line-381"></a>
<a name="line-382"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>TypeEqOrigin</span> <span class='hs-layout'>{</span> <span class='hs-varid'>uo_actual</span>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>TcType</span>
<a name="line-383"></a>                 <span class='hs-layout'>,</span> <span class='hs-varid'>uo_expected</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>TcType</span>
<a name="line-384"></a>                 <span class='hs-layout'>,</span> <span class='hs-varid'>uo_thing</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>SDoc</span>
<a name="line-385"></a>                       <span class='hs-comment'>-- ^ The thing that has type "actual"</span>
<a name="line-386"></a>                 <span class='hs-layout'>,</span> <span class='hs-varid'>uo_visible</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span>
<a name="line-387"></a>                       <span class='hs-comment'>-- ^ Is at least one of the three elements above visible?</span>
<a name="line-388"></a>                       <span class='hs-comment'>-- (Errors from the polymorphic subsumption check are considered</span>
<a name="line-389"></a>                       <span class='hs-comment'>-- visible.) Only used for prioritizing error messages.</span>
<a name="line-390"></a>                 <span class='hs-layout'>}</span>
<a name="line-391"></a>
<a name="line-392"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>KindEqOrigin</span>
<a name="line-393"></a>      <span class='hs-conid'>TcType</span> <span class='hs-conid'>TcType</span>             <span class='hs-comment'>-- A kind equality arising from unifying these two types</span>
<a name="line-394"></a>      <span class='hs-conid'>CtOrigin</span>                  <span class='hs-comment'>-- originally arising from this</span>
<a name="line-395"></a>      <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-conid'>TypeOrKind</span><span class='hs-layout'>)</span>        <span class='hs-comment'>-- the level of the eq this arises from</span>
<a name="line-396"></a>
<a name="line-397"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IPOccOrigin</span>  <span class='hs-conid'>HsIPName</span>       <span class='hs-comment'>-- Occurrence of an implicit parameter</span>
<a name="line-398"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>OverLabelOrigin</span> <span class='hs-conid'>FastString</span>  <span class='hs-comment'>-- Occurrence of an overloaded label</span>
<a name="line-399"></a>
<a name="line-400"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>LiteralOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsOverLit</span> <span class='hs-conid'>GhcRn</span><span class='hs-layout'>)</span>     <span class='hs-comment'>-- Occurrence of a literal</span>
<a name="line-401"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>NegateOrigin</span>                        <span class='hs-comment'>-- Occurrence of syntactic negation</span>
<a name="line-402"></a>
<a name="line-403"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ArithSeqOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>ArithSeqInfo</span> <span class='hs-conid'>GhcRn</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- [x..], [x..y] etc</span>
<a name="line-404"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>AssocFamPatOrigin</span>   <span class='hs-comment'>-- When matching the patterns of an associated</span>
<a name="line-405"></a>                        <span class='hs-comment'>-- family instance with that of its parent class</span>
<a name="line-406"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>SectionOrigin</span>
<a name="line-407"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>HasFieldOrigin</span> <span class='hs-conid'>FastString</span>
<a name="line-408"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>TupleOrigin</span>         <span class='hs-comment'>-- (..,..)</span>
<a name="line-409"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ExprSigOrigin</span>       <span class='hs-comment'>-- e :: ty</span>
<a name="line-410"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>PatSigOrigin</span>        <span class='hs-comment'>-- p :: ty</span>
<a name="line-411"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>PatOrigin</span>           <span class='hs-comment'>-- Instantiating a polytyped pattern at a constructor</span>
<a name="line-412"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ProvCtxtOrigin</span>      <span class='hs-comment'>-- The "provided" context of a pattern synonym signature</span>
<a name="line-413"></a>        <span class='hs-layout'>(</span><span class='hs-conid'>PatSynBind</span> <span class='hs-conid'>GhcRn</span> <span class='hs-conid'>GhcRn</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- Information about the pattern synonym, in</span>
<a name="line-414"></a>                                 <span class='hs-comment'>-- particular the name and the right-hand side</span>
<a name="line-415"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>RecordUpdOrigin</span>
<a name="line-416"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ViewPatOrigin</span>
<a name="line-417"></a>
<a name="line-418"></a>  <span class='hs-comment'>-- | 'ScOrigin' is used only for the Wanted constraints for the</span>
<a name="line-419"></a>  <span class='hs-comment'>-- superclasses of an instance declaration.</span>
<a name="line-420"></a>  <span class='hs-comment'>-- If the instance head is @C ty1 .. tyn@</span>
<a name="line-421"></a>  <span class='hs-comment'>--    then @TypeSize = sizeTypes [ty1, .., tyn]@</span>
<a name="line-422"></a>  <span class='hs-comment'>-- See Note [Solving superclass constraints] in GHC.Tc.TyCl.Instance</span>
<a name="line-423"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ScOrigin</span> <span class='hs-conid'>TypeSize</span>
<a name="line-424"></a>
<a name="line-425"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>DerivClauseOrigin</span>   <span class='hs-comment'>-- Typechecking a deriving clause (as opposed to</span>
<a name="line-426"></a>                        <span class='hs-comment'>-- standalone deriving).</span>
<a name="line-427"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>DerivOriginDC</span> <span class='hs-conid'>DataCon</span> <span class='hs-conid'>Int</span> <span class='hs-conid'>Bool</span>
<a name="line-428"></a>      <span class='hs-comment'>-- Checking constraints arising from this data con and field index. The</span>
<a name="line-429"></a>      <span class='hs-comment'>-- Bool argument in DerivOriginDC and DerivOriginCoerce is True if</span>
<a name="line-430"></a>      <span class='hs-comment'>-- standalong deriving (with a wildcard constraint) is being used. This</span>
<a name="line-431"></a>      <span class='hs-comment'>-- is used to inform error messages on how to recommended fixes (e.g., if</span>
<a name="line-432"></a>      <span class='hs-comment'>-- the argument is True, then don't recommend "use standalone deriving",</span>
<a name="line-433"></a>      <span class='hs-comment'>-- but rather "fill in the wildcard constraint yourself").</span>
<a name="line-434"></a>      <span class='hs-comment'>-- See Note [Inferring the instance context] in GHC.Tc.Deriv.Infer</span>
<a name="line-435"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>DerivOriginCoerce</span> <span class='hs-conid'>Id</span> <span class='hs-conid'>Type</span> <span class='hs-conid'>Type</span> <span class='hs-conid'>Bool</span>
<a name="line-436"></a>                        <span class='hs-comment'>-- DerivOriginCoerce id ty1 ty2: Trying to coerce class method `id` from</span>
<a name="line-437"></a>                        <span class='hs-comment'>-- `ty1` to `ty2`.</span>
<a name="line-438"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>StandAloneDerivOrigin</span> <span class='hs-comment'>-- Typechecking stand-alone deriving. Useful for</span>
<a name="line-439"></a>                          <span class='hs-comment'>-- constraints coming from a wildcard constraint,</span>
<a name="line-440"></a>                          <span class='hs-comment'>-- e.g., deriving instance _ =&gt; Eq (Foo a)</span>
<a name="line-441"></a>                          <span class='hs-comment'>-- See Note [Inferring the instance context]</span>
<a name="line-442"></a>                          <span class='hs-comment'>-- in GHC.Tc.Deriv.Infer</span>
<a name="line-443"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>DefaultOrigin</span>       <span class='hs-comment'>-- Typechecking a default decl</span>
<a name="line-444"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>DoOrigin</span>            <span class='hs-comment'>-- Arising from a do expression</span>
<a name="line-445"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>DoPatOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>LPat</span> <span class='hs-conid'>GhcRn</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- Arising from a failable pattern in</span>
<a name="line-446"></a>                             <span class='hs-comment'>-- a do expression</span>
<a name="line-447"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>MCompOrigin</span>         <span class='hs-comment'>-- Arising from a monad comprehension</span>
<a name="line-448"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>MCompPatOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>LPat</span> <span class='hs-conid'>GhcRn</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- Arising from a failable pattern in a</span>
<a name="line-449"></a>                                <span class='hs-comment'>-- monad comprehension</span>
<a name="line-450"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IfOrigin</span>            <span class='hs-comment'>-- Arising from an if statement</span>
<a name="line-451"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ProcOrigin</span>          <span class='hs-comment'>-- Arising from a proc expression</span>
<a name="line-452"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>AnnOrigin</span>           <span class='hs-comment'>-- An annotation</span>
<a name="line-453"></a>
<a name="line-454"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>FunDepOrigin1</span>       <span class='hs-comment'>-- A functional dependency from combining</span>
<a name="line-455"></a>        <span class='hs-conid'>PredType</span> <span class='hs-conid'>CtOrigin</span> <span class='hs-conid'>RealSrcSpan</span>      <span class='hs-comment'>-- This constraint arising from ...</span>
<a name="line-456"></a>        <span class='hs-conid'>PredType</span> <span class='hs-conid'>CtOrigin</span> <span class='hs-conid'>RealSrcSpan</span>      <span class='hs-comment'>-- and this constraint arising from ...</span>
<a name="line-457"></a>
<a name="line-458"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>FunDepOrigin2</span>       <span class='hs-comment'>-- A functional dependency from combining</span>
<a name="line-459"></a>        <span class='hs-conid'>PredType</span> <span class='hs-conid'>CtOrigin</span>   <span class='hs-comment'>-- This constraint arising from ...</span>
<a name="line-460"></a>        <span class='hs-conid'>PredType</span> <span class='hs-conid'>SrcSpan</span>    <span class='hs-comment'>-- and this top-level instance</span>
<a name="line-461"></a>        <span class='hs-comment'>-- We only need a CtOrigin on the first, because the location</span>
<a name="line-462"></a>        <span class='hs-comment'>-- is pinned on the entire error message</span>
<a name="line-463"></a>
<a name="line-464"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ExprHoleOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-conid'>OccName</span><span class='hs-layout'>)</span>   <span class='hs-comment'>-- from an expression hole</span>
<a name="line-465"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>TypeHoleOrigin</span> <span class='hs-conid'>OccName</span>   <span class='hs-comment'>-- from a type hole (partial type signature)</span>
<a name="line-466"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>PatCheckOrigin</span>      <span class='hs-comment'>-- normalisation of a type during pattern-match checking</span>
<a name="line-467"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ListOrigin</span>          <span class='hs-comment'>-- An overloaded list</span>
<a name="line-468"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>BracketOrigin</span>       <span class='hs-comment'>-- An overloaded quotation bracket</span>
<a name="line-469"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>StaticOrigin</span>        <span class='hs-comment'>-- A static form</span>
<a name="line-470"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Shouldn'tHappenOrigin</span> <span class='hs-conid'>String</span>
<a name="line-471"></a>                            <span class='hs-comment'>-- the user should never see this one,</span>
<a name="line-472"></a>                            <span class='hs-comment'>-- unless ImpredicativeTypes is on, where all</span>
<a name="line-473"></a>                            <span class='hs-comment'>-- bets are off</span>
<a name="line-474"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>InstProvidedOrigin</span> <span class='hs-conid'>Module</span> <span class='hs-conid'>ClsInst</span>
<a name="line-475"></a>        <span class='hs-comment'>-- Skolem variable arose when we were testing if an instance</span>
<a name="line-476"></a>        <span class='hs-comment'>-- is solvable or not.</span>
<a name="line-477"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>NonLinearPatternOrigin</span>
<a name="line-478"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UsageEnvironmentOf</span> <span class='hs-conid'>Name</span>
<a name="line-479"></a>
<a name="line-480"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>CycleBreakerOrigin</span>
<a name="line-481"></a>      <span class='hs-conid'>CtOrigin</span>   <span class='hs-comment'>-- origin of the original constraint</span>
<a name="line-482"></a>      <span class='hs-comment'>-- See Detail (7) of Note [Type equality cycles] in GHC.Tc.Solver.Canonical</span>
<a name="line-483"></a>
<a name="line-484"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>InstanceSigOrigin</span>   <span class='hs-comment'>-- from the sub-type check of an InstanceSig</span>
<a name="line-485"></a>      <span class='hs-conid'>Name</span>   <span class='hs-comment'>-- the method name</span>
<a name="line-486"></a>      <span class='hs-conid'>Type</span>   <span class='hs-comment'>-- the instance-sig type</span>
<a name="line-487"></a>      <span class='hs-conid'>Type</span>   <span class='hs-comment'>-- the instantiated type of the method</span>
<a name="line-488"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>AmbiguityCheckOrigin</span> <span class='hs-conid'>UserTypeCtxt</span>
<a name="line-489"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>GhcBug20076</span>
<a name="line-490"></a>
<a name="line-491"></a><a name="ScDepth"></a><span class='hs-comment'>-- | The number of superclass selections needed to get this Given.</span>
<a name="line-492"></a><a name="ScDepth"></a><span class='hs-comment'>-- If @d :: C ty@   has @ScDepth=2@, then the evidence @d@ will look</span>
<a name="line-493"></a><a name="ScDepth"></a><span class='hs-comment'>-- like @sc_sel (sc_sel dg)@, where @dg@ is a Given.</span>
<a name="line-494"></a><a name="ScDepth"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>ScDepth</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Int</span>
<a name="line-495"></a>
<a name="line-496"></a><a name="isVisibleOrigin"></a><span class='hs-comment'>-- An origin is visible if the place where the constraint arises is manifest</span>
<a name="line-497"></a><span class='hs-comment'>-- in user code. Currently, all origins are visible except for invisible</span>
<a name="line-498"></a><span class='hs-comment'>-- TypeEqOrigins. This is used when choosing which error of</span>
<a name="line-499"></a><span class='hs-comment'>-- several to report</span>
<a name="line-500"></a><span class='hs-definition'>isVisibleOrigin</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>CtOrigin</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-501"></a><span class='hs-definition'>isVisibleOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>TypeEqOrigin</span> <span class='hs-layout'>{</span> <span class='hs-varid'>uo_visible</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>vis</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>vis</span>
<a name="line-502"></a><span class='hs-definition'>isVisibleOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>KindEqOrigin</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>sub_orig</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isVisibleOrigin</span> <span class='hs-varid'>sub_orig</span>
<a name="line-503"></a><span class='hs-definition'>isVisibleOrigin</span> <span class='hs-keyword'>_</span>                                   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-504"></a>
<a name="line-505"></a><a name="toInvisibleOrigin"></a><span class='hs-comment'>-- Converts a visible origin to an invisible one, if possible. Currently,</span>
<a name="line-506"></a><span class='hs-comment'>-- this works only for TypeEqOrigin</span>
<a name="line-507"></a><span class='hs-definition'>toInvisibleOrigin</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>CtOrigin</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CtOrigin</span>
<a name="line-508"></a><span class='hs-definition'>toInvisibleOrigin</span> <span class='hs-varid'>orig</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>TypeEqOrigin</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>orig</span> <span class='hs-layout'>{</span> <span class='hs-varid'>uo_visible</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span> <span class='hs-layout'>}</span>
<a name="line-509"></a><span class='hs-definition'>toInvisibleOrigin</span> <span class='hs-varid'>orig</span>                   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>orig</span>
<a name="line-510"></a>
<a name="line-511"></a><a name="isGivenOrigin"></a><span class='hs-definition'>isGivenOrigin</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>CtOrigin</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-512"></a><span class='hs-definition'>isGivenOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>GivenOrigin</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>              <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-513"></a><span class='hs-definition'>isGivenOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>InstSCOrigin</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>             <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-514"></a><span class='hs-definition'>isGivenOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>OtherSCOrigin</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>            <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-515"></a><span class='hs-definition'>isGivenOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>FunDepOrigin1</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>o1</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>o2</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isGivenOrigin</span> <span class='hs-varid'>o1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>isGivenOrigin</span> <span class='hs-varid'>o2</span>
<a name="line-516"></a><span class='hs-definition'>isGivenOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>FunDepOrigin2</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>o1</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isGivenOrigin</span> <span class='hs-varid'>o1</span>
<a name="line-517"></a><span class='hs-definition'>isGivenOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>CycleBreakerOrigin</span> <span class='hs-varid'>o</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isGivenOrigin</span> <span class='hs-varid'>o</span>
<a name="line-518"></a><span class='hs-definition'>isGivenOrigin</span> <span class='hs-keyword'>_</span>                             <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-519"></a>
<a name="line-520"></a><a name="instance%20Outputable%20CtOrigin"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>CtOrigin</span> <span class='hs-keyword'>where</span>
<a name="line-521"></a>  <span class='hs-varid'>ppr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprCtOrigin</span>
<a name="line-522"></a>
<a name="line-523"></a><a name="ctoHerald"></a><span class='hs-definition'>ctoHerald</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SDoc</span>
<a name="line-524"></a><span class='hs-definition'>ctoHerald</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"arising from"</span>
<a name="line-525"></a>
<a name="line-526"></a><a name="lexprCtOrigin"></a><span class='hs-comment'>-- | Extract a suitable CtOrigin from a HsExpr</span>
<a name="line-527"></a><span class='hs-definition'>lexprCtOrigin</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>LHsExpr</span> <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CtOrigin</span>
<a name="line-528"></a><span class='hs-definition'>lexprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>exprCtOrigin</span> <span class='hs-varid'>e</span>
<a name="line-529"></a>
<a name="line-530"></a><a name="exprCtOrigin"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsExpr</span> <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CtOrigin</span>
<a name="line-531"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsVar</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>OccurrenceOf</span> <span class='hs-varid'>name</span>
<a name="line-532"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsGetField</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HasFieldOrigin</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varop'>$</span> <span class='hs-varid'>hflLabel</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span>
<a name="line-533"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsUnboundVar</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Shouldn'tHappenOrigin</span> <span class='hs-str'>"unbound variable"</span>
<a name="line-534"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsConLikeOut</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>panic</span> <span class='hs-str'>"exprCtOrigin HsConLikeOut"</span>
<a name="line-535"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsRecFld</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>OccurrenceOfRecSel</span> <span class='hs-layout'>(</span><span class='hs-varid'>rdrNameAmbiguousFieldOcc</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span>
<a name="line-536"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsOverLabel</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>OverLabelOrigin</span> <span class='hs-varid'>l</span>
<a name="line-537"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>ExplicitList</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ListOrigin</span>
<a name="line-538"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsIPVar</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>ip</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IPOccOrigin</span> <span class='hs-varid'>ip</span>
<a name="line-539"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsOverLit</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>lit</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>LiteralOrigin</span> <span class='hs-varid'>lit</span>
<a name="line-540"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsLit</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>           <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Shouldn'tHappenOrigin</span> <span class='hs-str'>"concrete literal"</span>
<a name="line-541"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsLam</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>matches</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>matchesCtOrigin</span> <span class='hs-varid'>matches</span>
<a name="line-542"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsLamCase</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>ms</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>matchesCtOrigin</span> <span class='hs-varid'>ms</span>
<a name="line-543"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsApp</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e1</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lexprCtOrigin</span> <span class='hs-varid'>e1</span>
<a name="line-544"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsAppType</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e1</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lexprCtOrigin</span> <span class='hs-varid'>e1</span>
<a name="line-545"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>OpApp</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>op</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lexprCtOrigin</span> <span class='hs-varid'>op</span>
<a name="line-546"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>NegApp</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lexprCtOrigin</span> <span class='hs-varid'>e</span>
<a name="line-547"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsPar</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lexprCtOrigin</span> <span class='hs-varid'>e</span>
<a name="line-548"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsProjection</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SectionOrigin</span>
<a name="line-549"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>SectionL</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SectionOrigin</span>
<a name="line-550"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>SectionR</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SectionOrigin</span>
<a name="line-551"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>ExplicitTuple</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Shouldn'tHappenOrigin</span> <span class='hs-str'>"explicit tuple"</span>
<a name="line-552"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-conid'>ExplicitSum</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Shouldn'tHappenOrigin</span> <span class='hs-str'>"explicit sum"</span>
<a name="line-553"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCase</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>matches</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>matchesCtOrigin</span> <span class='hs-varid'>matches</span>
<a name="line-554"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsIf</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>           <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Shouldn'tHappenOrigin</span> <span class='hs-str'>"if expression"</span>
<a name="line-555"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsMultiIf</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>rhs</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lGRHSCtOrigin</span> <span class='hs-varid'>rhs</span>
<a name="line-556"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsLet</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lexprCtOrigin</span> <span class='hs-varid'>e</span>
<a name="line-557"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsDo</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>           <span class='hs-keyglyph'>=</span> <span class='hs-conid'>DoOrigin</span>
<a name="line-558"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>RecordCon</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Shouldn'tHappenOrigin</span> <span class='hs-str'>"record construction"</span>
<a name="line-559"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>RecordUpd</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RecordUpdOrigin</span>
<a name="line-560"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>ExprWithTySig</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ExprSigOrigin</span>
<a name="line-561"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>ArithSeq</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Shouldn'tHappenOrigin</span> <span class='hs-str'>"arithmetic sequence"</span>
<a name="line-562"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsPragE</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lexprCtOrigin</span> <span class='hs-varid'>e</span>
<a name="line-563"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsBracket</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Shouldn'tHappenOrigin</span> <span class='hs-str'>"TH bracket"</span>
<a name="line-564"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsRnBracketOut</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>=</span> <span class='hs-conid'>Shouldn'tHappenOrigin</span> <span class='hs-str'>"HsRnBracketOut"</span>
<a name="line-565"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsTcBracketOut</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>=</span> <span class='hs-varid'>panic</span> <span class='hs-str'>"exprCtOrigin HsTcBracketOut"</span>
<a name="line-566"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsSpliceE</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Shouldn'tHappenOrigin</span> <span class='hs-str'>"TH splice"</span>
<a name="line-567"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsProc</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Shouldn'tHappenOrigin</span> <span class='hs-str'>"proc"</span>
<a name="line-568"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsStatic</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Shouldn'tHappenOrigin</span> <span class='hs-str'>"static expression"</span>
<a name="line-569"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsTick</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>           <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lexprCtOrigin</span> <span class='hs-varid'>e</span>
<a name="line-570"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsBinTick</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lexprCtOrigin</span> <span class='hs-varid'>e</span>
<a name="line-571"></a><span class='hs-definition'>exprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>XExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpanded</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>exprCtOrigin</span> <span class='hs-varid'>a</span>
<a name="line-572"></a>
<a name="line-573"></a><a name="matchesCtOrigin"></a><span class='hs-comment'>-- | Extract a suitable CtOrigin from a MatchGroup</span>
<a name="line-574"></a><span class='hs-definition'>matchesCtOrigin</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MatchGroup</span> <span class='hs-conid'>GhcRn</span> <span class='hs-layout'>(</span><span class='hs-conid'>LHsExpr</span> <span class='hs-conid'>GhcRn</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CtOrigin</span>
<a name="line-575"></a><span class='hs-definition'>matchesCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>MG</span> <span class='hs-layout'>{</span> <span class='hs-varid'>mg_alts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>alts</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-576"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>match</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>alts</span>
<a name="line-577"></a>  <span class='hs-layout'>,</span> <span class='hs-conid'>Match</span> <span class='hs-layout'>{</span> <span class='hs-varid'>m_grhss</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>grhss</span> <span class='hs-layout'>}</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>match</span>
<a name="line-578"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>grhssCtOrigin</span> <span class='hs-varid'>grhss</span>
<a name="line-579"></a>
<a name="line-580"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-581"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Shouldn'tHappenOrigin</span> <span class='hs-str'>"multi-way match"</span>
<a name="line-582"></a>
<a name="line-583"></a><a name="grhssCtOrigin"></a><span class='hs-comment'>-- | Extract a suitable CtOrigin from guarded RHSs</span>
<a name="line-584"></a><span class='hs-definition'>grhssCtOrigin</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>GRHSs</span> <span class='hs-conid'>GhcRn</span> <span class='hs-layout'>(</span><span class='hs-conid'>LHsExpr</span> <span class='hs-conid'>GhcRn</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CtOrigin</span>
<a name="line-585"></a><span class='hs-definition'>grhssCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>GRHSs</span> <span class='hs-layout'>{</span> <span class='hs-varid'>grhssGRHSs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lgrhss</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lGRHSCtOrigin</span> <span class='hs-varid'>lgrhss</span>
<a name="line-586"></a>
<a name="line-587"></a><a name="lGRHSCtOrigin"></a><span class='hs-comment'>-- | Extract a suitable CtOrigin from a list of guarded RHSs</span>
<a name="line-588"></a><span class='hs-definition'>lGRHSCtOrigin</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LGRHS</span> <span class='hs-conid'>GhcRn</span> <span class='hs-layout'>(</span><span class='hs-conid'>LHsExpr</span> <span class='hs-conid'>GhcRn</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CtOrigin</span>
<a name="line-589"></a><span class='hs-definition'>lGRHSCtOrigin</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>GRHS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>exprCtOrigin</span> <span class='hs-varid'>e</span>
<a name="line-590"></a><span class='hs-definition'>lGRHSCtOrigin</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Shouldn'tHappenOrigin</span> <span class='hs-str'>"multi-way GRHS"</span>
<a name="line-591"></a>
<a name="line-592"></a><a name="pprCtOrigin"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>CtOrigin</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-593"></a><span class='hs-comment'>-- "arising from ..."</span>
<a name="line-594"></a><span class='hs-comment'>-- Not an instance of Outputable because of the "arising from" prefix</span>
<a name="line-595"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>GivenOrigin</span> <span class='hs-varid'>sk</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ctoHerald</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>sk</span>
<a name="line-596"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>InstSCOrigin</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ctoHerald</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprSkolInfo</span> <span class='hs-conid'>InstSkol</span>   <span class='hs-comment'>-- keep output in sync</span>
<a name="line-597"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>OtherSCOrigin</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>si</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ctoHerald</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprSkolInfo</span> <span class='hs-varid'>si</span>
<a name="line-598"></a>
<a name="line-599"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>SpecPragOrigin</span> <span class='hs-varid'>ctxt</span><span class='hs-layout'>)</span>
<a name="line-600"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ctxt</span> <span class='hs-keyword'>of</span>
<a name="line-601"></a>       <span class='hs-conid'>FunSigCtxt</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"for"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-602"></a>       <span class='hs-conid'>SpecInstCtxt</span>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a SPECIALISE INSTANCE pragma"</span>
<a name="line-603"></a>       <span class='hs-keyword'>_</span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a SPECIALISE pragma"</span>  <span class='hs-comment'>-- Never happens I think</span>
<a name="line-604"></a>
<a name="line-605"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>FunDepOrigin1</span> <span class='hs-varid'>pred1</span> <span class='hs-varid'>orig1</span> <span class='hs-varid'>loc1</span> <span class='hs-varid'>pred2</span> <span class='hs-varid'>orig2</span> <span class='hs-varid'>loc2</span><span class='hs-layout'>)</span>
<a name="line-606"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ctoHerald</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a functional dependency between constraints:"</span><span class='hs-layout'>)</span>
<a name="line-607"></a>       <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>vcat</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>pred1</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprCtOrigin</span> <span class='hs-varid'>orig1</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"at"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>loc1</span><span class='hs-layout'>)</span>
<a name="line-608"></a>               <span class='hs-layout'>,</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>pred2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprCtOrigin</span> <span class='hs-varid'>orig2</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"at"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>loc2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-609"></a>
<a name="line-610"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>FunDepOrigin2</span> <span class='hs-varid'>pred1</span> <span class='hs-varid'>orig1</span> <span class='hs-varid'>pred2</span> <span class='hs-varid'>loc2</span><span class='hs-layout'>)</span>
<a name="line-611"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ctoHerald</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a functional dependency between:"</span><span class='hs-layout'>)</span>
<a name="line-612"></a>       <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>vcat</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"constraint"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>pred1</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-613"></a>                    <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprCtOrigin</span> <span class='hs-varid'>orig1</span> <span class='hs-layout'>)</span>
<a name="line-614"></a>               <span class='hs-layout'>,</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"instance"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>pred2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-615"></a>                    <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"at"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>loc2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-616"></a>
<a name="line-617"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-conid'>AssocFamPatOrigin</span>
<a name="line-618"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"when matching a family LHS with its class instance head"</span>
<a name="line-619"></a>
<a name="line-620"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>TypeEqOrigin</span> <span class='hs-layout'>{</span> <span class='hs-varid'>uo_actual</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>t1</span><span class='hs-layout'>,</span> <span class='hs-varid'>uo_expected</span> <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>t2</span><span class='hs-layout'>,</span> <span class='hs-varid'>uo_visible</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>vis</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-621"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a type equality"</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>brackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>vis</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>t1</span><span class='hs-layout'>,</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'~'</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>t2</span><span class='hs-keyglyph'>]</span>
<a name="line-622"></a>
<a name="line-623"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>KindEqOrigin</span> <span class='hs-varid'>t1</span> <span class='hs-varid'>t2</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>
<a name="line-624"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ctoHerald</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a kind equality arising from"</span><span class='hs-layout'>)</span>
<a name="line-625"></a>       <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>t1</span><span class='hs-layout'>,</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'~'</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>t2</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-626"></a>
<a name="line-627"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>DerivOriginDC</span> <span class='hs-varid'>dc</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>
<a name="line-628"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ctoHerald</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>speakNth</span> <span class='hs-varid'>n</span>
<a name="line-629"></a>          <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"field of"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>dc</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-630"></a>       <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"type"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-varid'>scaledThing</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-631"></a>  <span class='hs-keyword'>where</span>
<a name="line-632"></a>    <span class='hs-varid'>ty</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dataConOrigArgTys</span> <span class='hs-varid'>dc</span> <span class='hs-varop'>!!</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<a name="line-633"></a>
<a name="line-634"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>DerivOriginCoerce</span> <span class='hs-varid'>meth</span> <span class='hs-varid'>ty1</span> <span class='hs-varid'>ty2</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>
<a name="line-635"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ctoHerald</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the coercion of the method"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>meth</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-636"></a>       <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>text</span> <span class='hs-str'>"from type"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>ty1</span><span class='hs-layout'>)</span>
<a name="line-637"></a>              <span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-varop'>$</span> <span class='hs-varid'>text</span> <span class='hs-str'>"to type"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>ty2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-638"></a>
<a name="line-639"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>DoPatOrigin</span> <span class='hs-varid'>pat</span><span class='hs-layout'>)</span>
<a name="line-640"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ctoHerald</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a do statement"</span>
<a name="line-641"></a>      <span class='hs-varop'>$$</span>
<a name="line-642"></a>      <span class='hs-varid'>text</span> <span class='hs-str'>"with the failable pattern"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>pat</span><span class='hs-layout'>)</span>
<a name="line-643"></a>
<a name="line-644"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>MCompPatOrigin</span> <span class='hs-varid'>pat</span><span class='hs-layout'>)</span>
<a name="line-645"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ctoHerald</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the failable pattern"</span>
<a name="line-646"></a>           <span class='hs-layout'>,</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>pat</span><span class='hs-layout'>)</span>
<a name="line-647"></a>           <span class='hs-layout'>,</span> <span class='hs-varid'>text</span> <span class='hs-str'>"in a statement in a monad comprehension"</span> <span class='hs-keyglyph'>]</span>
<a name="line-648"></a>
<a name="line-649"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>Shouldn'tHappenOrigin</span> <span class='hs-varid'>note</span><span class='hs-layout'>)</span>
<a name="line-650"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sdocOption</span> <span class='hs-varid'>sdocImpredicativeTypes</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-keyword'>case</span>
<a name="line-651"></a>      <span class='hs-conid'>True</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a situation created by impredicative types"</span>
<a name="line-652"></a>      <span class='hs-conid'>False</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>vcat</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>text</span> <span class='hs-str'>"&lt;&lt; This should not appear in error messages. If you see this"</span>
<a name="line-653"></a>                    <span class='hs-layout'>,</span> <span class='hs-varid'>text</span> <span class='hs-str'>"in an error message, please report a bug mentioning"</span>
<a name="line-654"></a>                        <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-varid'>note</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"at"</span>
<a name="line-655"></a>                    <span class='hs-layout'>,</span> <span class='hs-varid'>text</span> <span class='hs-str'>"https://gitlab.haskell.org/ghc/ghc/wikis/report-a-bug &gt;&gt;"</span>
<a name="line-656"></a>                    <span class='hs-keyglyph'>]</span>
<a name="line-657"></a>
<a name="line-658"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>ProvCtxtOrigin</span> <span class='hs-conid'>PSB</span><span class='hs-layout'>{</span> <span class='hs-varid'>psb_id</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-659"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ctoHerald</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the \"provided\" constraints claimed by"</span><span class='hs-layout'>)</span>
<a name="line-660"></a>       <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"the signature of"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-661"></a>
<a name="line-662"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>InstProvidedOrigin</span> <span class='hs-varid'>mod</span> <span class='hs-varid'>cls_inst</span><span class='hs-layout'>)</span>
<a name="line-663"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>vcat</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>text</span> <span class='hs-str'>"arising when attempting to show that"</span>
<a name="line-664"></a>         <span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>cls_inst</span>
<a name="line-665"></a>         <span class='hs-layout'>,</span> <span class='hs-varid'>text</span> <span class='hs-str'>"is provided by"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>mod</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-666"></a>
<a name="line-667"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>CycleBreakerOrigin</span> <span class='hs-varid'>orig</span><span class='hs-layout'>)</span>
<a name="line-668"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprCtOrigin</span> <span class='hs-varid'>orig</span>
<a name="line-669"></a>
<a name="line-670"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>InstanceSigOrigin</span> <span class='hs-varid'>method_name</span> <span class='hs-varid'>sig_type</span> <span class='hs-varid'>orig_method_type</span><span class='hs-layout'>)</span>
<a name="line-671"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>vcat</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>ctoHerald</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the check that an instance signature is more general"</span>
<a name="line-672"></a>         <span class='hs-layout'>,</span> <span class='hs-varid'>text</span> <span class='hs-str'>"than the type of the method (instantiated for this instance)"</span>
<a name="line-673"></a>         <span class='hs-layout'>,</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"instance signature:"</span><span class='hs-layout'>)</span>
<a name="line-674"></a>              <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>method_name</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>dcolon</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>sig_type</span><span class='hs-layout'>)</span>
<a name="line-675"></a>         <span class='hs-layout'>,</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"instantiated method type:"</span><span class='hs-layout'>)</span>
<a name="line-676"></a>              <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>orig_method_type</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>]</span>
<a name="line-677"></a>
<a name="line-678"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>AmbiguityCheckOrigin</span> <span class='hs-varid'>ctxt</span><span class='hs-layout'>)</span>
<a name="line-679"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ctoHerald</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a type ambiguity check for"</span> <span class='hs-varop'>$$</span>
<a name="line-680"></a>    <span class='hs-varid'>pprUserTypeCtxt</span> <span class='hs-varid'>ctxt</span>
<a name="line-681"></a>
<a name="line-682"></a><span class='hs-definition'>pprCtOrigin</span> <span class='hs-varid'>simple_origin</span>
<a name="line-683"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ctoHerald</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprCtO</span> <span class='hs-varid'>simple_origin</span>
<a name="line-684"></a>
<a name="line-685"></a><a name="pprCtO"></a><span class='hs-comment'>-- | Short one-liners</span>
<a name="line-686"></a><span class='hs-definition'>pprCtO</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>CtOrigin</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-687"></a><span class='hs-definition'>pprCtO</span> <span class='hs-layout'>(</span><span class='hs-conid'>OccurrenceOf</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"a use of"</span><span class='hs-layout'>,</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-688"></a><span class='hs-definition'>pprCtO</span> <span class='hs-layout'>(</span><span class='hs-conid'>OccurrenceOfRecSel</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"a use of"</span><span class='hs-layout'>,</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-689"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>AppOrigin</span>             <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"an application"</span>
<a name="line-690"></a><span class='hs-definition'>pprCtO</span> <span class='hs-layout'>(</span><span class='hs-conid'>IPOccOrigin</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"a use of implicit parameter"</span><span class='hs-layout'>,</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-691"></a><span class='hs-definition'>pprCtO</span> <span class='hs-layout'>(</span><span class='hs-conid'>OverLabelOrigin</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"the overloaded label"</span>
<a name="line-692"></a>                                    <span class='hs-layout'>,</span><span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>char</span> <span class='hs-chr'>'#'</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-693"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>RecordUpdOrigin</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a record update"</span>
<a name="line-694"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>ExprSigOrigin</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"an expression type signature"</span>
<a name="line-695"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>PatSigOrigin</span>          <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a pattern type signature"</span>
<a name="line-696"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>PatOrigin</span>             <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a pattern"</span>
<a name="line-697"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>ViewPatOrigin</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a view pattern"</span>
<a name="line-698"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>IfOrigin</span>              <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"an if expression"</span>
<a name="line-699"></a><span class='hs-definition'>pprCtO</span> <span class='hs-layout'>(</span><span class='hs-conid'>LiteralOrigin</span> <span class='hs-varid'>lit</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"the literal"</span><span class='hs-layout'>,</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>lit</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-700"></a><span class='hs-definition'>pprCtO</span> <span class='hs-layout'>(</span><span class='hs-conid'>ArithSeqOrigin</span> <span class='hs-varid'>seq</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"the arithmetic sequence"</span><span class='hs-layout'>,</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>seq</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-701"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>SectionOrigin</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"an operator section"</span>
<a name="line-702"></a><span class='hs-definition'>pprCtO</span> <span class='hs-layout'>(</span><span class='hs-conid'>HasFieldOrigin</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"selecting the field"</span><span class='hs-layout'>,</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-703"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>AssocFamPatOrigin</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the LHS of a family instance"</span>
<a name="line-704"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>TupleOrigin</span>           <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a tuple"</span>
<a name="line-705"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>NegateOrigin</span>          <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a use of syntactic negation"</span>
<a name="line-706"></a><span class='hs-definition'>pprCtO</span> <span class='hs-layout'>(</span><span class='hs-conid'>ScOrigin</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the superclasses of an instance declaration"</span>
<a name="line-707"></a>                               <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>whenPprDebug</span> <span class='hs-layout'>(</span><span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-708"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>DerivClauseOrigin</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"the 'deriving' clause of a data type declaration"</span>
<a name="line-709"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>StandAloneDerivOrigin</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a 'deriving' declaration"</span>
<a name="line-710"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>DefaultOrigin</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a 'default' declaration"</span>
<a name="line-711"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>DoOrigin</span>              <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a do statement"</span>
<a name="line-712"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>MCompOrigin</span>           <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a statement in a monad comprehension"</span>
<a name="line-713"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>ProcOrigin</span>            <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a proc expression"</span>
<a name="line-714"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>AnnOrigin</span>             <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"an annotation"</span>
<a name="line-715"></a><span class='hs-definition'>pprCtO</span> <span class='hs-layout'>(</span><span class='hs-conid'>ExprHoleOrigin</span> <span class='hs-conid'>Nothing</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"an expression hole"</span>
<a name="line-716"></a><span class='hs-definition'>pprCtO</span> <span class='hs-layout'>(</span><span class='hs-conid'>ExprHoleOrigin</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>occ</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a use of"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>occ</span><span class='hs-layout'>)</span>
<a name="line-717"></a><span class='hs-definition'>pprCtO</span> <span class='hs-layout'>(</span><span class='hs-conid'>TypeHoleOrigin</span> <span class='hs-varid'>occ</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a use of wildcard"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>occ</span><span class='hs-layout'>)</span>
<a name="line-718"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>PatCheckOrigin</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a pattern-match completeness check"</span>
<a name="line-719"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>ListOrigin</span>            <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"an overloaded list"</span>
<a name="line-720"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>StaticOrigin</span>          <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a static form"</span>
<a name="line-721"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>NonLinearPatternOrigin</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a non-linear pattern"</span>
<a name="line-722"></a><span class='hs-definition'>pprCtO</span> <span class='hs-layout'>(</span><span class='hs-conid'>UsageEnvironmentOf</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"multiplicity of"</span><span class='hs-layout'>,</span> <span class='hs-varid'>quotes</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-723"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>BracketOrigin</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a quotation bracket"</span>
<a name="line-724"></a><span class='hs-definition'>pprCtO</span> <span class='hs-layout'>(</span><span class='hs-conid'>InstanceSigOrigin</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a type signature in an instance"</span>
<a name="line-725"></a><span class='hs-definition'>pprCtO</span> <span class='hs-layout'>(</span><span class='hs-conid'>AmbiguityCheckOrigin</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"a type ambiguity check"</span>
<a name="line-726"></a><span class='hs-definition'>pprCtO</span> <span class='hs-conid'>GhcBug20076</span>           <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"GHC Bug #20076"</span>
<a name="line-727"></a><span class='hs-definition'>pprCtO</span> <span class='hs-keyword'>_</span>                     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>panic</span> <span class='hs-str'>"pprCtOrigin"</span>
</pre></body>
</html>
