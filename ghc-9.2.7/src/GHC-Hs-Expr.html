<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>GHC/Hs/Expr.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE CPP                       #-}</span>
<a name="line-2"></a><span class='hs-comment'>{-# LANGUAGE ConstraintKinds           #-}</span>
<a name="line-3"></a><span class='hs-comment'>{-# LANGUAGE DataKinds                 #-}</span>
<a name="line-4"></a><span class='hs-comment'>{-# LANGUAGE DeriveDataTypeable        #-}</span>
<a name="line-5"></a><span class='hs-comment'>{-# LANGUAGE ExistentialQuantification #-}</span>
<a name="line-6"></a><span class='hs-comment'>{-# LANGUAGE FlexibleContexts          #-}</span>
<a name="line-7"></a><span class='hs-comment'>{-# LANGUAGE FlexibleInstances         #-}</span>
<a name="line-8"></a><span class='hs-comment'>{-# LANGUAGE LambdaCase                #-}</span>
<a name="line-9"></a><span class='hs-comment'>{-# LANGUAGE MultiParamTypeClasses     #-}</span>
<a name="line-10"></a><span class='hs-comment'>{-# LANGUAGE ScopedTypeVariables       #-}</span>
<a name="line-11"></a><span class='hs-comment'>{-# LANGUAGE StandaloneDeriving        #-}</span>
<a name="line-12"></a><span class='hs-comment'>{-# LANGUAGE TypeApplications          #-}</span>
<a name="line-13"></a><span class='hs-comment'>{-# LANGUAGE TypeFamilyDependencies    #-}</span>
<a name="line-14"></a><span class='hs-comment'>{-# LANGUAGE UndecidableInstances #-}</span> <span class='hs-comment'>-- Wrinkle in Note [Trees That Grow]</span>
<a name="line-15"></a>                                      <span class='hs-comment'>-- in module Language.Haskell.Syntax.Extension</span>
<a name="line-16"></a>
<a name="line-17"></a><span class='hs-comment'>{-# OPTIONS_GHC -Wno-incomplete-uni-patterns #-}</span>
<a name="line-18"></a><span class='hs-comment'>{-# OPTIONS_GHC -Wno-orphans #-}</span> <span class='hs-comment'>-- Outputable</span>
<a name="line-19"></a>
<a name="line-20"></a><span class='hs-comment'>{-
<a name="line-21"></a>(c) The University of Glasgow 2006
<a name="line-22"></a>(c) The GRASP/AQUA Project, Glasgow University, 1992-1998
<a name="line-23"></a>-}</span>
<a name="line-24"></a>
<a name="line-25"></a><span class='hs-comment'>-- | Abstract Haskell syntax for expressions.</span>
<a name="line-26"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>GHC.Hs.Expr</span>
<a name="line-27"></a>  <span class='hs-layout'>(</span> <span class='hs-keyword'>module</span> <span class='hs-conid'>Language.Haskell.Syntax.Expr</span>
<a name="line-28"></a>  <span class='hs-layout'>,</span> <span class='hs-keyword'>module</span> <span class='hs-conid'>GHC.Hs.Expr</span>
<a name="line-29"></a>  <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-30"></a>
<a name="line-31"></a><span class='hs-cpp'>#include "HsVersions.h"</span>
<a name="line-32"></a>
<a name="line-33"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Haskell.Syntax.Expr</span>
<a name="line-34"></a>
<a name="line-35"></a><span class='hs-comment'>-- friends:</span>
<a name="line-36"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Prelude</span>
<a name="line-37"></a>
<a name="line-38"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Hs.Decls</span>
<a name="line-39"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Hs.Pat</span>
<a name="line-40"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Hs.Lit</span>
<a name="line-41"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Haskell.Syntax.Extension</span>
<a name="line-42"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Hs.Extension</span>
<a name="line-43"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Hs.Type</span>
<a name="line-44"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Hs.Binds</span>
<a name="line-45"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Parser.Annotation</span>
<a name="line-46"></a>
<a name="line-47"></a><span class='hs-comment'>-- others:</span>
<a name="line-48"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Tc.Types.Evidence</span>
<a name="line-49"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Name</span>
<a name="line-50"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Name.Set</span>
<a name="line-51"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Basic</span>
<a name="line-52"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Fixity</span>
<a name="line-53"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.SourceText</span>
<a name="line-54"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.SrcLoc</span>
<a name="line-55"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Core.ConLike</span>
<a name="line-56"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Unit.Module</span> <span class='hs-layout'>(</span><span class='hs-conid'>ModuleName</span><span class='hs-layout'>)</span>
<a name="line-57"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Utils.Misc</span>
<a name="line-58"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Utils.Outputable</span>
<a name="line-59"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Utils.Panic</span>
<a name="line-60"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Data.FastString</span>
<a name="line-61"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Core.Type</span>
<a name="line-62"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Builtin.Types</span> <span class='hs-layout'>(</span><span class='hs-varid'>mkTupleStr</span><span class='hs-layout'>)</span>
<a name="line-63"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Tc.Utils.TcType</span> <span class='hs-layout'>(</span><span class='hs-conid'>TcType</span><span class='hs-layout'>)</span>
<a name="line-64"></a><span class='hs-keyword'>import</span> <span class='hs-comment'>{-# SOURCE #-}</span> <span class='hs-conid'>GHC.Tc.Types</span> <span class='hs-layout'>(</span><span class='hs-conid'>TcLclEnv</span><span class='hs-layout'>)</span>
<a name="line-65"></a>
<a name="line-66"></a><span class='hs-comment'>-- libraries:</span>
<a name="line-67"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Data</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-conid'>Fixity</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-68"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Data</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Fixity</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-69"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data.Kind</span>
<a name="line-70"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Maybe</span> <span class='hs-layout'>(</span><span class='hs-varid'>isJust</span><span class='hs-layout'>)</span>
<a name="line-71"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Void</span>  <span class='hs-layout'>(</span> <span class='hs-conid'>Void</span> <span class='hs-layout'>)</span>
<a name="line-72"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Foldable</span> <span class='hs-layout'>(</span> <span class='hs-varid'>toList</span> <span class='hs-layout'>)</span>
<a name="line-73"></a>
<a name="line-74"></a><span class='hs-comment'>{- *********************************************************************
<a name="line-75"></a>*                                                                      *
<a name="line-76"></a>                Expressions proper
<a name="line-77"></a>*                                                                      *
<a name="line-78"></a>********************************************************************* -}</span>
<a name="line-79"></a>
<a name="line-80"></a><a name="PostTcExpr"></a><span class='hs-comment'>-- | Post-Type checking Expression</span>
<a name="line-81"></a><a name="PostTcExpr"></a><span class='hs-comment'>--</span>
<a name="line-82"></a><a name="PostTcExpr"></a><span class='hs-comment'>-- PostTcExpr is an evidence expression attached to the syntax tree by the</span>
<a name="line-83"></a><a name="PostTcExpr"></a><span class='hs-comment'>-- type checker (c.f. postTcType).</span>
<a name="line-84"></a><a name="PostTcExpr"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>PostTcExpr</span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HsExpr</span> <span class='hs-conid'>GhcTc</span>
<a name="line-85"></a>
<a name="line-86"></a><a name="PostTcTable"></a><span class='hs-comment'>-- | Post-Type checking Table</span>
<a name="line-87"></a><a name="PostTcTable"></a><span class='hs-comment'>--</span>
<a name="line-88"></a><a name="PostTcTable"></a><span class='hs-comment'>-- We use a PostTcTable where there are a bunch of pieces of evidence, more</span>
<a name="line-89"></a><a name="PostTcTable"></a><span class='hs-comment'>-- than is convenient to keep individually.</span>
<a name="line-90"></a><a name="PostTcTable"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>PostTcTable</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Name</span><span class='hs-layout'>,</span> <span class='hs-conid'>PostTcExpr</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-91"></a>
<a name="line-92"></a><span class='hs-comment'>-------------------------</span>
<a name="line-93"></a>
<a name="line-94"></a><span class='hs-comment'>-- Defining SyntaxExpr in two stages allows for better type inference, because</span>
<a name="line-95"></a><span class='hs-comment'>-- we can declare SyntaxExprGhc to be injective (and closed). Without injectivity,</span>
<a name="line-96"></a><span class='hs-comment'>-- noSyntaxExpr would be ambiguous.</span>
<a name="line-97"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>SyntaxExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SyntaxExprGhc</span> <span class='hs-varid'>p</span>
<a name="line-98"></a>
<a name="line-99"></a><a name="SyntaxExprGhc"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>family</span> <span class='hs-conid'>SyntaxExprGhc</span> <span class='hs-layout'>(</span><span class='hs-varid'>p</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pass</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>r</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Data.Kind.Type</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>p</span> <span class='hs-keyword'>where</span>
<a name="line-100"></a>  <span class='hs-conid'>SyntaxExprGhc</span> <span class='hs-chr'>'</span><span class='hs-conid'>Parsed</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-101"></a>  <span class='hs-conid'>SyntaxExprGhc</span> <span class='hs-chr'>'</span><span class='hs-conid'>Renamed</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SyntaxExprRn</span>
<a name="line-102"></a>  <span class='hs-conid'>SyntaxExprGhc</span> <span class='hs-chr'>'</span><span class='hs-conid'>Typechecked</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SyntaxExprTc</span>
<a name="line-103"></a>
<a name="line-104"></a><a name="SyntaxExprRn"></a><span class='hs-comment'>-- | The function to use in rebindable syntax. See Note [NoSyntaxExpr].</span>
<a name="line-105"></a><a name="SyntaxExprRn"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>SyntaxExprRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SyntaxExprRn</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpr</span> <span class='hs-conid'>GhcRn</span><span class='hs-layout'>)</span>
<a name="line-106"></a>    <span class='hs-comment'>-- Why is the payload not just a Name?</span>
<a name="line-107"></a>    <span class='hs-comment'>-- See Note [Monad fail : Rebindable syntax, overloaded strings] in "GHC.Rename.Expr"</span>
<a name="line-108"></a>                  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>NoSyntaxExprRn</span>
<a name="line-109"></a>
<a name="line-110"></a><a name="SyntaxExprTc"></a><span class='hs-comment'>-- | An expression with wrappers, used for rebindable syntax</span>
<a name="line-111"></a><a name="SyntaxExprTc"></a><span class='hs-comment'>--</span>
<a name="line-112"></a><a name="SyntaxExprTc"></a><span class='hs-comment'>-- This should desugar to</span>
<a name="line-113"></a><a name="SyntaxExprTc"></a><span class='hs-comment'>--</span>
<a name="line-114"></a><a name="SyntaxExprTc"></a><span class='hs-comment'>-- &gt; syn_res_wrap $ syn_expr (syn_arg_wraps[0] arg0)</span>
<a name="line-115"></a><a name="SyntaxExprTc"></a><span class='hs-comment'>-- &gt;                         (syn_arg_wraps[1] arg1) ...</span>
<a name="line-116"></a><a name="SyntaxExprTc"></a><span class='hs-comment'>--</span>
<a name="line-117"></a><a name="SyntaxExprTc"></a><span class='hs-comment'>-- where the actual arguments come from elsewhere in the AST.</span>
<a name="line-118"></a><a name="SyntaxExprTc"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>SyntaxExprTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SyntaxExprTc</span> <span class='hs-layout'>{</span> <span class='hs-varid'>syn_expr</span>      <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsExpr</span> <span class='hs-conid'>GhcTc</span>
<a name="line-119"></a>                                 <span class='hs-layout'>,</span> <span class='hs-varid'>syn_arg_wraps</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>HsWrapper</span><span class='hs-keyglyph'>]</span>
<a name="line-120"></a>                                 <span class='hs-layout'>,</span> <span class='hs-varid'>syn_res_wrap</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsWrapper</span> <span class='hs-layout'>}</span>
<a name="line-121"></a>                  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>NoSyntaxExprTc</span>  <span class='hs-comment'>-- See Note [NoSyntaxExpr]</span>
<a name="line-122"></a>
<a name="line-123"></a><a name="noExpr"></a><span class='hs-comment'>-- | This is used for rebindable-syntax pieces that are too polymorphic</span>
<a name="line-124"></a><span class='hs-comment'>-- for tcSyntaxOp (trS_fmap and the mzip in ParStmt)</span>
<a name="line-125"></a><span class='hs-definition'>noExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-126"></a><span class='hs-definition'>noExpr</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HsLit</span> <span class='hs-varid'>noComments</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsString</span> <span class='hs-layout'>(</span><span class='hs-conid'>SourceText</span>  <span class='hs-str'>"noExpr"</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>fsLit</span> <span class='hs-str'>"noExpr"</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-127"></a>
<a name="line-128"></a><a name="noSyntaxExpr"></a><span class='hs-definition'>noSyntaxExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>p</span><span class='hs-varop'>.</span> <span class='hs-conid'>IsPass</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>SyntaxExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-129"></a>                              <span class='hs-comment'>-- Before renaming, and sometimes after</span>
<a name="line-130"></a>                              <span class='hs-comment'>-- See Note [NoSyntaxExpr]</span>
<a name="line-131"></a><span class='hs-definition'>noSyntaxExpr</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ghcPass</span> <span class='hs-keyglyph'>@</span><span class='hs-varid'>p</span> <span class='hs-keyword'>of</span>
<a name="line-132"></a>  <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>noExtField</span>
<a name="line-133"></a>  <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NoSyntaxExprRn</span>
<a name="line-134"></a>  <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NoSyntaxExprTc</span>
<a name="line-135"></a>
<a name="line-136"></a><a name="mkSyntaxExpr"></a><span class='hs-comment'>-- | Make a 'SyntaxExpr GhcRn' from an expression</span>
<a name="line-137"></a><span class='hs-comment'>-- Used only in getMonadFailOp.</span>
<a name="line-138"></a><span class='hs-comment'>-- See Note [Monad fail : Rebindable syntax, overloaded strings] in "GHC.Rename.Expr"</span>
<a name="line-139"></a><span class='hs-definition'>mkSyntaxExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsExpr</span> <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SyntaxExprRn</span>
<a name="line-140"></a><span class='hs-definition'>mkSyntaxExpr</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SyntaxExprRn</span>
<a name="line-141"></a>
<a name="line-142"></a><a name="mkRnSyntaxExpr"></a><span class='hs-comment'>-- | Make a 'SyntaxExpr' from a 'Name' (the "rn" is because this is used in the</span>
<a name="line-143"></a><span class='hs-comment'>-- renamer).</span>
<a name="line-144"></a><span class='hs-definition'>mkRnSyntaxExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Name</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SyntaxExprRn</span>
<a name="line-145"></a><span class='hs-definition'>mkRnSyntaxExpr</span> <span class='hs-varid'>name</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SyntaxExprRn</span> <span class='hs-varop'>$</span> <span class='hs-conid'>HsVar</span> <span class='hs-varid'>noExtField</span> <span class='hs-varop'>$</span> <span class='hs-varid'>noLocA</span> <span class='hs-varid'>name</span>
<a name="line-146"></a>
<a name="line-147"></a><a name="instance%20Outputable%20SyntaxExprRn"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>SyntaxExprRn</span> <span class='hs-keyword'>where</span>
<a name="line-148"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>SyntaxExprRn</span> <span class='hs-varid'>expr</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>expr</span>
<a name="line-149"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>NoSyntaxExprRn</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"&lt;no syntax expr&gt;"</span>
<a name="line-150"></a>
<a name="line-151"></a><a name="instance%20Outputable%20SyntaxExprTc"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>SyntaxExprTc</span> <span class='hs-keyword'>where</span>
<a name="line-152"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>SyntaxExprTc</span> <span class='hs-layout'>{</span> <span class='hs-varid'>syn_expr</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>expr</span>
<a name="line-153"></a>                    <span class='hs-layout'>,</span> <span class='hs-varid'>syn_arg_wraps</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>arg_wraps</span>
<a name="line-154"></a>                    <span class='hs-layout'>,</span> <span class='hs-varid'>syn_res_wrap</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>res_wrap</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-155"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sdocOption</span> <span class='hs-varid'>sdocPrintExplicitCoercions</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>print_co</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-156"></a>      <span class='hs-varid'>getPprDebug</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>debug</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-157"></a>      <span class='hs-keyword'>if</span> <span class='hs-varid'>debug</span> <span class='hs-varop'>||</span> <span class='hs-varid'>print_co</span>
<a name="line-158"></a>      <span class='hs-keyword'>then</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>expr</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>braces</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprWithCommas</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>arg_wraps</span><span class='hs-layout'>)</span>
<a name="line-159"></a>                    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>braces</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>res_wrap</span><span class='hs-layout'>)</span>
<a name="line-160"></a>      <span class='hs-keyword'>else</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>expr</span>
<a name="line-161"></a>
<a name="line-162"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>NoSyntaxExprTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"&lt;no syntax expr&gt;"</span>
<a name="line-163"></a>
<a name="line-164"></a><a name="RecordUpdTc"></a><span class='hs-comment'>-- | Extra data fields for a 'RecordUpd', added by the type checker</span>
<a name="line-165"></a><a name="RecordUpdTc"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>RecordUpdTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RecordUpdTc</span>
<a name="line-166"></a>      <span class='hs-layout'>{</span> <span class='hs-varid'>rupd_cons</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>ConLike</span><span class='hs-keyglyph'>]</span>
<a name="line-167"></a>                <span class='hs-comment'>-- Filled in by the type checker to the</span>
<a name="line-168"></a>                <span class='hs-comment'>-- _non-empty_ list of DataCons that have</span>
<a name="line-169"></a>                <span class='hs-comment'>-- all the upd'd fields</span>
<a name="line-170"></a>
<a name="line-171"></a>      <span class='hs-layout'>,</span> <span class='hs-varid'>rupd_in_tys</span>  <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Type</span><span class='hs-keyglyph'>]</span>  <span class='hs-comment'>-- Argument types of *input* record type</span>
<a name="line-172"></a>      <span class='hs-layout'>,</span> <span class='hs-varid'>rupd_out_tys</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Type</span><span class='hs-keyglyph'>]</span>  <span class='hs-comment'>--             and  *output* record type</span>
<a name="line-173"></a>                <span class='hs-comment'>-- For a data family, these are the type args of the</span>
<a name="line-174"></a>                <span class='hs-comment'>-- /representation/ type constructor</span>
<a name="line-175"></a>
<a name="line-176"></a>      <span class='hs-layout'>,</span> <span class='hs-varid'>rupd_wrap</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsWrapper</span>  <span class='hs-comment'>-- See note [Record Update HsWrapper]</span>
<a name="line-177"></a>      <span class='hs-layout'>}</span>
<a name="line-178"></a>
<a name="line-179"></a><a name="HsWrap"></a><span class='hs-comment'>-- | HsWrap appears only in typechecker output</span>
<a name="line-180"></a><a name="HsWrap"></a><span class='hs-comment'>-- Invariant: The contained Expr is *NOT* itself an HsWrap.</span>
<a name="line-181"></a><a name="HsWrap"></a><span class='hs-comment'>-- See Note [Detecting forced eta expansion] in "GHC.HsToCore.Expr".</span>
<a name="line-182"></a><a name="HsWrap"></a><span class='hs-comment'>-- This invariant is maintained by 'GHC.Hs.Utils.mkHsWrap'.</span>
<a name="line-183"></a><a name="HsWrap"></a><span class='hs-comment'>-- hs_syn is something like HsExpr or HsCmd</span>
<a name="line-184"></a><a name="HsWrap"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>HsWrap</span> <span class='hs-varid'>hs_syn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HsWrap</span> <span class='hs-conid'>HsWrapper</span>      <span class='hs-comment'>-- the wrapper</span>
<a name="line-185"></a>                            <span class='hs-layout'>(</span><span class='hs-varid'>hs_syn</span> <span class='hs-conid'>GhcTc</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- the thing that is wrapped</span>
<a name="line-186"></a>
<a name="line-187"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>hs_syn</span> <span class='hs-conid'>GhcTc</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>hs_syn</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsWrap</span> <span class='hs-varid'>hs_syn</span><span class='hs-layout'>)</span>
<a name="line-188"></a>
<a name="line-189"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>HsDoRn</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>GhcRn</span>
<a name="line-190"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>HsBracketRn</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>GhcRn</span>
<a name="line-191"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>PendingRnSplice'</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PendingRnSplice</span>
<a name="line-192"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>PendingTcSplice'</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PendingTcSplice</span>
<a name="line-193"></a>
<a name="line-194"></a><span class='hs-comment'>-- ---------------------------------------------------------------------</span>
<a name="line-195"></a>
<a name="line-196"></a><span class='hs-comment'>{- Note [Constructor cannot occur]
<a name="line-197"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-198"></a>Some data constructors can't occur in certain phases; e.g. the output
<a name="line-199"></a>of the type checker never has OverLabel. We signal this by setting
<a name="line-200"></a>the extension field to Void. For example:
<a name="line-201"></a>   type instance XOverLabel GhcTc = Void
<a name="line-202"></a>   dsExpr (HsOverLabel x _) = absurd x
<a name="line-203"></a>
<a name="line-204"></a>It would be better to omit the pattern match altogether, but we
<a name="line-205"></a>could only do that if the extension field was strict (#18764)
<a name="line-206"></a>-}</span>
<a name="line-207"></a>
<a name="line-208"></a><span class='hs-comment'>-- API Annotations types</span>
<a name="line-209"></a>
<a name="line-210"></a><a name="EpAnnHsCase"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>EpAnnHsCase</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnnHsCase</span>
<a name="line-211"></a>      <span class='hs-layout'>{</span> <span class='hs-varid'>hsCaseAnnCase</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>EpaLocation</span>
<a name="line-212"></a>      <span class='hs-layout'>,</span> <span class='hs-varid'>hsCaseAnnOf</span>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>EpaLocation</span>
<a name="line-213"></a>      <span class='hs-layout'>,</span> <span class='hs-varid'>hsCaseAnnsRest</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-214"></a>      <span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Data</span>
<a name="line-215"></a>
<a name="line-216"></a><a name="EpAnnUnboundVar"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>EpAnnUnboundVar</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnnUnboundVar</span>
<a name="line-217"></a>     <span class='hs-layout'>{</span> <span class='hs-varid'>hsUnboundBackquotes</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>EpaLocation</span><span class='hs-layout'>,</span> <span class='hs-conid'>EpaLocation</span><span class='hs-layout'>)</span>
<a name="line-218"></a>     <span class='hs-layout'>,</span> <span class='hs-varid'>hsUnboundHole</span>       <span class='hs-keyglyph'>::</span> <span class='hs-conid'>EpaLocation</span>
<a name="line-219"></a>     <span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Data</span>
<a name="line-220"></a>
<a name="line-221"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XVar</span>           <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-222"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XConLikeOut</span>    <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-223"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XRecFld</span>        <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-224"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XLam</span>           <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-225"></a>
<a name="line-226"></a><span class='hs-comment'>-- OverLabel not present in GhcTc pass; see GHC.Rename.Expr</span>
<a name="line-227"></a><span class='hs-comment'>-- Note [Handling overloaded and rebindable constructs]</span>
<a name="line-228"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XOverLabel</span>     <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnnCO</span>
<a name="line-229"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XOverLabel</span>     <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnnCO</span>
<a name="line-230"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XOverLabel</span>     <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Void</span>  <span class='hs-comment'>-- See Note [Constructor cannot occur]</span>
<a name="line-231"></a>
<a name="line-232"></a><span class='hs-comment'>-- ---------------------------------------------------------------------</span>
<a name="line-233"></a>
<a name="line-234"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XVar</span>           <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-235"></a>
<a name="line-236"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XUnboundVar</span>    <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>EpAnnUnboundVar</span>
<a name="line-237"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XUnboundVar</span>    <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-238"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XUnboundVar</span>    <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HoleExprRef</span>
<a name="line-239"></a>  <span class='hs-comment'>-- We really don't need the whole HoleExprRef; just the IORef EvTerm</span>
<a name="line-240"></a>  <span class='hs-comment'>-- would be enough. But then deriving a Data instance becomes impossible.</span>
<a name="line-241"></a>  <span class='hs-comment'>-- Much, much easier just to define HoleExprRef with a Data instance and</span>
<a name="line-242"></a>  <span class='hs-comment'>-- store the whole structure.</span>
<a name="line-243"></a>
<a name="line-244"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XConLikeOut</span>    <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-245"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XRecFld</span>        <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-246"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XIPVar</span>         <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnnCO</span>
<a name="line-247"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XOverLitE</span>      <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnnCO</span>
<a name="line-248"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XLitE</span>          <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnnCO</span>
<a name="line-249"></a>
<a name="line-250"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XLam</span>           <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-251"></a>
<a name="line-252"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XLamCase</span>       <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-253"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XApp</span>           <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnnCO</span>
<a name="line-254"></a>
<a name="line-255"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XAppTypeE</span>      <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpan</span> <span class='hs-comment'>-- Where the `@` lives</span>
<a name="line-256"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XAppTypeE</span>      <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-257"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XAppTypeE</span>      <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Type</span>
<a name="line-258"></a>
<a name="line-259"></a><span class='hs-comment'>-- OpApp not present in GhcTc pass; see GHC.Rename.Expr</span>
<a name="line-260"></a><span class='hs-comment'>-- Note [Handling overloaded and rebindable constructs]</span>
<a name="line-261"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XOpApp</span>         <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-262"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XOpApp</span>         <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Fixity</span>
<a name="line-263"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XOpApp</span>         <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Void</span>  <span class='hs-comment'>-- See Note [Constructor cannot occur]</span>
<a name="line-264"></a>
<a name="line-265"></a><span class='hs-comment'>-- SectionL, SectionR not present in GhcTc pass; see GHC.Rename.Expr</span>
<a name="line-266"></a><span class='hs-comment'>-- Note [Handling overloaded and rebindable constructs]</span>
<a name="line-267"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XSectionL</span>      <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnnCO</span>
<a name="line-268"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XSectionR</span>      <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnnCO</span>
<a name="line-269"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XSectionL</span>      <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnnCO</span>
<a name="line-270"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XSectionR</span>      <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnnCO</span>
<a name="line-271"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XSectionL</span>      <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Void</span>  <span class='hs-comment'>-- See Note [Constructor cannot occur]</span>
<a name="line-272"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XSectionR</span>      <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Void</span>  <span class='hs-comment'>-- See Note [Constructor cannot occur]</span>
<a name="line-273"></a>
<a name="line-274"></a>
<a name="line-275"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XNegApp</span>        <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-276"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XNegApp</span>        <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-277"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XNegApp</span>        <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-278"></a>
<a name="line-279"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XPar</span>           <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>AnnParen</span>
<a name="line-280"></a>
<a name="line-281"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XExplicitTuple</span> <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-282"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XExplicitTuple</span> <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-283"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XExplicitTuple</span> <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-284"></a>
<a name="line-285"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XExplicitSum</span>   <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>AnnExplicitSum</span>
<a name="line-286"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XExplicitSum</span>   <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-287"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XExplicitSum</span>   <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Type</span><span class='hs-keyglyph'>]</span>
<a name="line-288"></a>
<a name="line-289"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCase</span>          <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>EpAnnHsCase</span>
<a name="line-290"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCase</span>          <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-291"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCase</span>          <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-292"></a>
<a name="line-293"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XIf</span>            <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>AnnsIf</span>
<a name="line-294"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XIf</span>            <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-295"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XIf</span>            <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-296"></a>
<a name="line-297"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XMultiIf</span>       <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-298"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XMultiIf</span>       <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-299"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XMultiIf</span>       <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Type</span>
<a name="line-300"></a>
<a name="line-301"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XLet</span>           <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>AnnsLet</span>
<a name="line-302"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XLet</span>           <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-303"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XLet</span>           <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-304"></a>
<a name="line-305"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XDo</span>            <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>AnnList</span>
<a name="line-306"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XDo</span>            <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-307"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XDo</span>            <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Type</span>
<a name="line-308"></a>
<a name="line-309"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XExplicitList</span>  <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>AnnList</span>
<a name="line-310"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XExplicitList</span>  <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-311"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XExplicitList</span>  <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Type</span>
<a name="line-312"></a><span class='hs-comment'>-- GhcPs: ExplicitList includes all source-level</span>
<a name="line-313"></a><span class='hs-comment'>--   list literals, including overloaded ones</span>
<a name="line-314"></a><span class='hs-comment'>-- GhcRn and GhcTc: ExplicitList used only for list literals</span>
<a name="line-315"></a><span class='hs-comment'>--   that denote Haskell's built-in lists.  Overloaded lists</span>
<a name="line-316"></a><span class='hs-comment'>--   have been expanded away in the renamer</span>
<a name="line-317"></a><span class='hs-comment'>-- See Note [Handling overloaded and rebindable constructs]</span>
<a name="line-318"></a><span class='hs-comment'>-- in  GHC.Rename.Expr</span>
<a name="line-319"></a>
<a name="line-320"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XRecordCon</span>     <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-321"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XRecordCon</span>     <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-322"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XRecordCon</span>     <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PostTcExpr</span>   <span class='hs-comment'>-- Instantiated constructor function</span>
<a name="line-323"></a>
<a name="line-324"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XRecordUpd</span>     <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-325"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XRecordUpd</span>     <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-326"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XRecordUpd</span>     <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RecordUpdTc</span>
<a name="line-327"></a>
<a name="line-328"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XGetField</span>     <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnnCO</span>
<a name="line-329"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XGetField</span>     <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-330"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XGetField</span>     <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Void</span>
<a name="line-331"></a><span class='hs-comment'>-- HsGetField is eliminated by the renamer. See [Handling overloaded</span>
<a name="line-332"></a><span class='hs-comment'>-- and rebindable constructs].</span>
<a name="line-333"></a>
<a name="line-334"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XProjection</span>     <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>AnnProjection</span>
<a name="line-335"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XProjection</span>     <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-336"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XProjection</span>     <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Void</span>
<a name="line-337"></a><span class='hs-comment'>-- HsProjection is eliminated by the renamer. See [Handling overloaded</span>
<a name="line-338"></a><span class='hs-comment'>-- and rebindable constructs].</span>
<a name="line-339"></a>
<a name="line-340"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XExprWithTySig</span> <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-341"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XExprWithTySig</span> <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-342"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XExprWithTySig</span> <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-343"></a>
<a name="line-344"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XArithSeq</span>      <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-345"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XArithSeq</span>      <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-346"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XArithSeq</span>      <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PostTcExpr</span>
<a name="line-347"></a>
<a name="line-348"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XBracket</span>       <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-349"></a>
<a name="line-350"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XRnBracketOut</span>  <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-351"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XTcBracketOut</span>  <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-352"></a>
<a name="line-353"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XSpliceE</span>       <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnnCO</span>
<a name="line-354"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XProc</span>          <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-355"></a>
<a name="line-356"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XStatic</span>        <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-357"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XStatic</span>        <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NameSet</span>
<a name="line-358"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XStatic</span>        <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NameSet</span>
<a name="line-359"></a>
<a name="line-360"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XTick</span>          <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-361"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XBinTick</span>       <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-362"></a>
<a name="line-363"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XPragE</span>         <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-364"></a>
<a name="line-365"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXExpr</span>         <span class='hs-conid'>GhcPs</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-366"></a>
<a name="line-367"></a><span class='hs-comment'>-- See Note [Rebindable syntax and HsExpansion] below</span>
<a name="line-368"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXExpr</span>         <span class='hs-conid'>GhcRn</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HsExpansion</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpr</span> <span class='hs-conid'>GhcRn</span><span class='hs-layout'>)</span>
<a name="line-369"></a>                                                       <span class='hs-layout'>(</span><span class='hs-conid'>HsExpr</span> <span class='hs-conid'>GhcRn</span><span class='hs-layout'>)</span>
<a name="line-370"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXExpr</span>         <span class='hs-conid'>GhcTc</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>XXExprGhcTc</span>
<a name="line-371"></a>
<a name="line-372"></a>
<a name="line-373"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pl</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-varid'>body</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnL</span>
<a name="line-374"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-conid'>GhcRn</span> <span class='hs-conid'>GhcRn</span> <span class='hs-layout'>(</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-varid'>body</span> <span class='hs-conid'>GhcRn</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnA</span>
<a name="line-375"></a>
<a name="line-376"></a><a name="XXExprGhcTc"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>XXExprGhcTc</span>
<a name="line-377"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>WrapExpr</span> <span class='hs-comment'>{-# UNPACK #-}</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-conid'>HsWrap</span> <span class='hs-conid'>HsExpr</span><span class='hs-layout'>)</span>
<a name="line-378"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ExpansionExpr</span> <span class='hs-comment'>{-# UNPACK #-}</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-conid'>HsExpansion</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpr</span> <span class='hs-conid'>GhcRn</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpr</span> <span class='hs-conid'>GhcTc</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-379"></a>
<a name="line-380"></a><a name="AnnExplicitSum"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>AnnExplicitSum</span>
<a name="line-381"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>AnnExplicitSum</span> <span class='hs-layout'>{</span>
<a name="line-382"></a>      <span class='hs-varid'>aesOpen</span>       <span class='hs-keyglyph'>::</span> <span class='hs-conid'>EpaLocation</span><span class='hs-layout'>,</span>
<a name="line-383"></a>      <span class='hs-varid'>aesBarsBefore</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>EpaLocation</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>
<a name="line-384"></a>      <span class='hs-varid'>aesBarsAfter</span>  <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>EpaLocation</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>
<a name="line-385"></a>      <span class='hs-varid'>aesClose</span>      <span class='hs-keyglyph'>::</span> <span class='hs-conid'>EpaLocation</span>
<a name="line-386"></a>      <span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Data</span>
<a name="line-387"></a>
<a name="line-388"></a><a name="AnnsLet"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>AnnsLet</span>
<a name="line-389"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>AnnsLet</span> <span class='hs-layout'>{</span>
<a name="line-390"></a>      <span class='hs-varid'>alLet</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>EpaLocation</span><span class='hs-layout'>,</span>
<a name="line-391"></a>      <span class='hs-varid'>alIn</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>EpaLocation</span>
<a name="line-392"></a>      <span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Data</span>
<a name="line-393"></a>
<a name="line-394"></a><a name="AnnFieldLabel"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>AnnFieldLabel</span>
<a name="line-395"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>AnnFieldLabel</span> <span class='hs-layout'>{</span>
<a name="line-396"></a>      <span class='hs-varid'>afDot</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>EpaLocation</span>
<a name="line-397"></a>      <span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Data</span>
<a name="line-398"></a>
<a name="line-399"></a><a name="AnnProjection"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>AnnProjection</span>
<a name="line-400"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>AnnProjection</span> <span class='hs-layout'>{</span>
<a name="line-401"></a>      <span class='hs-varid'>apOpen</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>EpaLocation</span><span class='hs-layout'>,</span> <span class='hs-comment'>-- ^ '('</span>
<a name="line-402"></a>      <span class='hs-varid'>apClose</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>EpaLocation</span>  <span class='hs-comment'>-- ^ ')'</span>
<a name="line-403"></a>      <span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Data</span>
<a name="line-404"></a>
<a name="line-405"></a><a name="AnnsIf"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>AnnsIf</span>
<a name="line-406"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>AnnsIf</span> <span class='hs-layout'>{</span>
<a name="line-407"></a>      <span class='hs-varid'>aiIf</span>       <span class='hs-keyglyph'>::</span> <span class='hs-conid'>EpaLocation</span><span class='hs-layout'>,</span>
<a name="line-408"></a>      <span class='hs-varid'>aiThen</span>     <span class='hs-keyglyph'>::</span> <span class='hs-conid'>EpaLocation</span><span class='hs-layout'>,</span>
<a name="line-409"></a>      <span class='hs-varid'>aiElse</span>     <span class='hs-keyglyph'>::</span> <span class='hs-conid'>EpaLocation</span><span class='hs-layout'>,</span>
<a name="line-410"></a>      <span class='hs-varid'>aiThenSemi</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>EpaLocation</span><span class='hs-layout'>,</span>
<a name="line-411"></a>      <span class='hs-varid'>aiElseSemi</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>EpaLocation</span>
<a name="line-412"></a>      <span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Data</span>
<a name="line-413"></a>
<a name="line-414"></a><span class='hs-comment'>-- ---------------------------------------------------------------------</span>
<a name="line-415"></a>
<a name="line-416"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XSCC</span>           <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>AnnPragma</span>
<a name="line-417"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXPragE</span>        <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-418"></a>
<a name="line-419"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCHsFieldLabel</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>AnnFieldLabel</span>
<a name="line-420"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXHsFieldLabel</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-421"></a>
<a name="line-422"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XPresent</span>         <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-423"></a>
<a name="line-424"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XMissing</span>         <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>EpaLocation</span>
<a name="line-425"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XMissing</span>         <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-426"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XMissing</span>         <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Scaled</span> <span class='hs-conid'>Type</span>
<a name="line-427"></a>
<a name="line-428"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXTupArg</span>         <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-429"></a>
<a name="line-430"></a><a name="tupArgPresent"></a><span class='hs-definition'>tupArgPresent</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsTupArg</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-431"></a><span class='hs-definition'>tupArgPresent</span> <span class='hs-layout'>(</span><span class='hs-conid'>Present</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-432"></a><span class='hs-definition'>tupArgPresent</span> <span class='hs-layout'>(</span><span class='hs-conid'>Missing</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-433"></a>
<a name="line-434"></a><a name="instance%20Outputable%20(HsExpr%20(GhcPass%20p))"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-435"></a>    <span class='hs-varid'>ppr</span> <span class='hs-varid'>expr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprExpr</span> <span class='hs-varid'>expr</span>
<a name="line-436"></a>
<a name="line-437"></a><a name="pprLExpr"></a><span class='hs-comment'>-----------------------</span>
<a name="line-438"></a><span class='hs-comment'>-- pprExpr, pprLExpr, pprBinds call pprDeeper;</span>
<a name="line-439"></a><span class='hs-comment'>-- the underscore versions do not</span>
<a name="line-440"></a><span class='hs-definition'>pprLExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>LHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-441"></a><span class='hs-definition'>pprLExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprExpr</span> <span class='hs-varid'>e</span>
<a name="line-442"></a>
<a name="line-443"></a><a name="pprExpr"></a><span class='hs-definition'>pprExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-444"></a><span class='hs-definition'>pprExpr</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isAtomicHsExpr</span> <span class='hs-varid'>e</span> <span class='hs-varop'>||</span> <span class='hs-varid'>isQuietHsExpr</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span>            <span class='hs-varid'>ppr_expr</span> <span class='hs-varid'>e</span>
<a name="line-445"></a>          <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>                           <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprDeeper</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_expr</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-446"></a>
<a name="line-447"></a><a name="isQuietHsExpr"></a><span class='hs-definition'>isQuietHsExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsExpr</span> <span class='hs-varid'>id</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-448"></a><span class='hs-comment'>-- Parentheses do display something, but it gives little info and</span>
<a name="line-449"></a><span class='hs-comment'>-- if we go deeper when we go inside them then we get ugly things</span>
<a name="line-450"></a><span class='hs-comment'>-- like (...)</span>
<a name="line-451"></a><span class='hs-definition'>isQuietHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsPar</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-452"></a><span class='hs-comment'>-- applications don't display anything themselves</span>
<a name="line-453"></a><span class='hs-definition'>isQuietHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsApp</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-454"></a><span class='hs-definition'>isQuietHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsAppType</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-455"></a><span class='hs-definition'>isQuietHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>OpApp</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-456"></a><span class='hs-definition'>isQuietHsExpr</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-457"></a>
<a name="line-458"></a><a name="pprBinds"></a><span class='hs-definition'>pprBinds</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>idL</span><span class='hs-layout'>,</span> <span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span>
<a name="line-459"></a>         <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsLocalBindsLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-460"></a><span class='hs-definition'>pprBinds</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprDeeper</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-461"></a>
<a name="line-462"></a><a name="ppr_lexpr"></a><span class='hs-comment'>-----------------------</span>
<a name="line-463"></a><span class='hs-definition'>ppr_lexpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>LHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-464"></a><span class='hs-definition'>ppr_lexpr</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-465"></a>
<a name="line-466"></a><a name="ppr_expr"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>p</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-467"></a>         <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-468"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsVar</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPrefixOcc</span> <span class='hs-varid'>v</span>
<a name="line-469"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsUnboundVar</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>uv</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPrefixOcc</span> <span class='hs-varid'>uv</span>
<a name="line-470"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsConLikeOut</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPrefixOcc</span> <span class='hs-varid'>c</span>
<a name="line-471"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsRecFld</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPrefixOcc</span> <span class='hs-varid'>f</span>
<a name="line-472"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsIPVar</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>v</span>
<a name="line-473"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsOverLabel</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'#'</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>l</span>
<a name="line-474"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsLit</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>lit</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>lit</span>
<a name="line-475"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsOverLit</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>lit</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>lit</span>
<a name="line-476"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsPar</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_lexpr</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-477"></a>
<a name="line-478"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsPragE</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>prag</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>prag</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr_lexpr</span> <span class='hs-varid'>e</span><span class='hs-keyglyph'>]</span>
<a name="line-479"></a>
<a name="line-480"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-varid'>e</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>HsApp</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_apps</span> <span class='hs-varid'>e</span> <span class='hs-conid'>[]</span>
<a name="line-481"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-varid'>e</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>HsAppType</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_apps</span> <span class='hs-varid'>e</span> <span class='hs-conid'>[]</span>
<a name="line-482"></a>
<a name="line-483"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>OpApp</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>op</span> <span class='hs-varid'>e2</span><span class='hs-layout'>)</span>
<a name="line-484"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>pp_op</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>ppr_infix_expr</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>op</span><span class='hs-layout'>)</span>
<a name="line-485"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pp_infixly</span> <span class='hs-varid'>pp_op</span>
<a name="line-486"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-487"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pp_prefixly</span>
<a name="line-488"></a>
<a name="line-489"></a>  <span class='hs-keyword'>where</span>
<a name="line-490"></a>    <span class='hs-varid'>pp_e1</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprDebugParendExpr</span> <span class='hs-varid'>opPrec</span> <span class='hs-varid'>e1</span>   <span class='hs-comment'>-- In debug mode, add parens</span>
<a name="line-491"></a>    <span class='hs-varid'>pp_e2</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprDebugParendExpr</span> <span class='hs-varid'>opPrec</span> <span class='hs-varid'>e2</span>   <span class='hs-comment'>-- to make precedence clear</span>
<a name="line-492"></a>
<a name="line-493"></a>    <span class='hs-varid'>pp_prefixly</span>
<a name="line-494"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>op</span><span class='hs-layout'>)</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pp_e1</span><span class='hs-layout'>,</span> <span class='hs-varid'>pp_e2</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-495"></a>
<a name="line-496"></a>    <span class='hs-varid'>pp_infixly</span> <span class='hs-varid'>pp_op</span>
<a name="line-497"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-varid'>pp_e1</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pp_op</span><span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-varid'>pp_e2</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-498"></a>
<a name="line-499"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>NegApp</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'-'</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprDebugParendExpr</span> <span class='hs-varid'>appPrec</span> <span class='hs-varid'>e</span>
<a name="line-500"></a>
<a name="line-501"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>SectionL</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>expr</span> <span class='hs-varid'>op</span><span class='hs-layout'>)</span>
<a name="line-502"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>pp_op</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>ppr_infix_expr</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>op</span><span class='hs-layout'>)</span>
<a name="line-503"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pp_infixly</span> <span class='hs-varid'>pp_op</span>
<a name="line-504"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-505"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pp_prefixly</span>
<a name="line-506"></a>  <span class='hs-keyword'>where</span>
<a name="line-507"></a>    <span class='hs-varid'>pp_expr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprDebugParendExpr</span> <span class='hs-varid'>opPrec</span> <span class='hs-varid'>expr</span>
<a name="line-508"></a>
<a name="line-509"></a>    <span class='hs-varid'>pp_prefixly</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>" \\ x_ -&gt;"</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>op</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-510"></a>                       <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pp_expr</span><span class='hs-layout'>,</span> <span class='hs-varid'>text</span> <span class='hs-str'>"x_ )"</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-511"></a>
<a name="line-512"></a>    <span class='hs-varid'>pp_infixly</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pp_expr</span><span class='hs-layout'>,</span> <span class='hs-varid'>v</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-513"></a>
<a name="line-514"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>SectionR</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>op</span> <span class='hs-varid'>expr</span><span class='hs-layout'>)</span>
<a name="line-515"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>pp_op</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>ppr_infix_expr</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>op</span><span class='hs-layout'>)</span>
<a name="line-516"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pp_infixly</span> <span class='hs-varid'>pp_op</span>
<a name="line-517"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-518"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pp_prefixly</span>
<a name="line-519"></a>  <span class='hs-keyword'>where</span>
<a name="line-520"></a>    <span class='hs-varid'>pp_expr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprDebugParendExpr</span> <span class='hs-varid'>opPrec</span> <span class='hs-varid'>expr</span>
<a name="line-521"></a>
<a name="line-522"></a>    <span class='hs-varid'>pp_prefixly</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"( \\ x_ -&gt;"</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>op</span><span class='hs-layout'>,</span> <span class='hs-varid'>text</span> <span class='hs-str'>"x_"</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-523"></a>                       <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>pp_expr</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>rparen</span><span class='hs-layout'>)</span>
<a name="line-524"></a>
<a name="line-525"></a>    <span class='hs-varid'>pp_infixly</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>v</span><span class='hs-layout'>,</span> <span class='hs-varid'>pp_expr</span><span class='hs-keyglyph'>]</span>
<a name="line-526"></a>
<a name="line-527"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>ExplicitTuple</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>exprs</span> <span class='hs-varid'>boxity</span><span class='hs-layout'>)</span>
<a name="line-528"></a>    <span class='hs-comment'>-- Special-case unary boxed tuples so that they are pretty-printed as</span>
<a name="line-529"></a>    <span class='hs-comment'>-- `Solo x`, not `(x)`</span>
<a name="line-530"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Present</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>expr</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>exprs</span>
<a name="line-531"></a>  <span class='hs-layout'>,</span> <span class='hs-conid'>Boxed</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>boxity</span>
<a name="line-532"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-layout'>(</span><span class='hs-varid'>mkTupleStr</span> <span class='hs-conid'>Boxed</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>expr</span><span class='hs-keyglyph'>]</span>
<a name="line-533"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-534"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tupleParens</span> <span class='hs-layout'>(</span><span class='hs-varid'>boxityTupleSort</span> <span class='hs-varid'>boxity</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>fcat</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_tup_args</span> <span class='hs-varid'>exprs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-535"></a>  <span class='hs-keyword'>where</span>
<a name="line-536"></a>    <span class='hs-varid'>ppr_tup_args</span> <span class='hs-conid'>[]</span>               <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-537"></a>    <span class='hs-varid'>ppr_tup_args</span> <span class='hs-layout'>(</span><span class='hs-conid'>Present</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span> <span class='hs-conop'>:</span> <span class='hs-varid'>es</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_lexpr</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>punc</span> <span class='hs-varid'>es</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-varid'>ppr_tup_args</span> <span class='hs-varid'>es</span>
<a name="line-538"></a>    <span class='hs-varid'>ppr_tup_args</span> <span class='hs-layout'>(</span><span class='hs-conid'>Missing</span> <span class='hs-keyword'>_</span>   <span class='hs-conop'>:</span> <span class='hs-varid'>es</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>punc</span> <span class='hs-varid'>es</span> <span class='hs-conop'>:</span> <span class='hs-varid'>ppr_tup_args</span> <span class='hs-varid'>es</span>
<a name="line-539"></a>
<a name="line-540"></a>    <span class='hs-varid'>punc</span> <span class='hs-layout'>(</span><span class='hs-conid'>Present</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-conop'>:</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>comma</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>space</span>
<a name="line-541"></a>    <span class='hs-varid'>punc</span> <span class='hs-layout'>(</span><span class='hs-conid'>Missing</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-conop'>:</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>comma</span>
<a name="line-542"></a>    <span class='hs-varid'>punc</span> <span class='hs-layout'>(</span><span class='hs-conid'>XTupArg</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-conop'>:</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>comma</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>space</span>
<a name="line-543"></a>    <span class='hs-varid'>punc</span> <span class='hs-conid'>[]</span>               <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
<a name="line-544"></a>
<a name="line-545"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>ExplicitSum</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>alt</span> <span class='hs-varid'>arity</span> <span class='hs-varid'>expr</span><span class='hs-layout'>)</span>
<a name="line-546"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"(#"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr_bars</span> <span class='hs-layout'>(</span><span class='hs-varid'>alt</span> <span class='hs-comment'>-</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>expr</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr_bars</span> <span class='hs-layout'>(</span><span class='hs-varid'>arity</span> <span class='hs-comment'>-</span> <span class='hs-varid'>alt</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"#)"</span>
<a name="line-547"></a>  <span class='hs-keyword'>where</span>
<a name="line-548"></a>    <span class='hs-varid'>ppr_bars</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-layout'>(</span><span class='hs-varid'>replicate</span> <span class='hs-varid'>n</span> <span class='hs-layout'>(</span><span class='hs-varid'>char</span> <span class='hs-chr'>'|'</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-549"></a>
<a name="line-550"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsLam</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>matches</span><span class='hs-layout'>)</span>
<a name="line-551"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprMatches</span> <span class='hs-varid'>matches</span>
<a name="line-552"></a>
<a name="line-553"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsLamCase</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>matches</span><span class='hs-layout'>)</span>
<a name="line-554"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"\\case"</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>
<a name="line-555"></a>          <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprMatches</span> <span class='hs-varid'>matches</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>]</span>
<a name="line-556"></a>
<a name="line-557"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCase</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>expr</span> <span class='hs-varid'>matches</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>MG</span> <span class='hs-layout'>{</span> <span class='hs-varid'>mg_alts</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>alts</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-558"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"case"</span><span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>expr</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"of"</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>
<a name="line-559"></a>          <span class='hs-varid'>pp_alts</span> <span class='hs-keyglyph'>]</span>
<a name="line-560"></a>  <span class='hs-keyword'>where</span>
<a name="line-561"></a>    <span class='hs-varid'>pp_alts</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>null</span> <span class='hs-varid'>alts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"{}"</span>
<a name="line-562"></a>            <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprMatches</span> <span class='hs-varid'>matches</span><span class='hs-layout'>)</span>
<a name="line-563"></a>
<a name="line-564"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsIf</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>e2</span> <span class='hs-varid'>e3</span><span class='hs-layout'>)</span>
<a name="line-565"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"if"</span><span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>e1</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"then"</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>
<a name="line-566"></a>         <span class='hs-varid'>nest</span> <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>e2</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-567"></a>         <span class='hs-varid'>text</span> <span class='hs-str'>"else"</span><span class='hs-layout'>,</span>
<a name="line-568"></a>         <span class='hs-varid'>nest</span> <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>e3</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-569"></a>
<a name="line-570"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsMultiIf</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>alts</span><span class='hs-layout'>)</span>
<a name="line-571"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"if"</span><span class='hs-layout'>)</span> <span class='hs-num'>3</span>  <span class='hs-layout'>(</span><span class='hs-varid'>vcat</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr_alt</span> <span class='hs-varid'>alts</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-572"></a>  <span class='hs-keyword'>where</span> <span class='hs-varid'>ppr_alt</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>GRHS</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>guards</span> <span class='hs-varid'>expr</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-573"></a>          <span class='hs-varid'>hang</span> <span class='hs-varid'>vbar</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_one</span> <span class='hs-varid'>one_alt</span><span class='hs-layout'>)</span>
<a name="line-574"></a>          <span class='hs-keyword'>where</span>
<a name="line-575"></a>            <span class='hs-varid'>ppr_one</span> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>panic</span> <span class='hs-str'>"ppr_exp HsMultiIf"</span>
<a name="line-576"></a>            <span class='hs-varid'>ppr_one</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span><span class='hs-conop'>:</span><span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-varid'>h</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>
<a name="line-577"></a>            <span class='hs-varid'>one_alt</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>interpp'SP</span> <span class='hs-varid'>guards</span>
<a name="line-578"></a>                      <span class='hs-layout'>,</span> <span class='hs-varid'>text</span> <span class='hs-str'>"-&gt;"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprDeeper</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>expr</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>]</span>
<a name="line-579"></a>        <span class='hs-varid'>ppr_alt</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>XGRHS</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>x</span>
<a name="line-580"></a>
<a name="line-581"></a><span class='hs-comment'>-- special case: let ... in let ...</span>
<a name="line-582"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsLet</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>binds</span> <span class='hs-varid'>expr</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsLet</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-583"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"let"</span><span class='hs-layout'>)</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pprBinds</span> <span class='hs-varid'>binds</span><span class='hs-layout'>,</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"in"</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-584"></a>         <span class='hs-varid'>ppr_lexpr</span> <span class='hs-varid'>expr</span><span class='hs-keyglyph'>]</span>
<a name="line-585"></a>
<a name="line-586"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsLet</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>binds</span> <span class='hs-varid'>expr</span><span class='hs-layout'>)</span>
<a name="line-587"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"let"</span><span class='hs-layout'>)</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprBinds</span> <span class='hs-varid'>binds</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-588"></a>         <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"in"</span><span class='hs-layout'>)</span>  <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>expr</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-589"></a>
<a name="line-590"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsDo</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>do_or_list_comp</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>stmts</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprDo</span> <span class='hs-varid'>do_or_list_comp</span> <span class='hs-varid'>stmts</span>
<a name="line-591"></a>
<a name="line-592"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>ExplicitList</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>exprs</span><span class='hs-layout'>)</span>
<a name="line-593"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>brackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprDeeperList</span> <span class='hs-varid'>fsep</span> <span class='hs-layout'>(</span><span class='hs-varid'>punctuate</span> <span class='hs-varid'>comma</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr_lexpr</span> <span class='hs-varid'>exprs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-594"></a>
<a name="line-595"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>RecordCon</span> <span class='hs-layout'>{</span> <span class='hs-varid'>rcon_con</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>con</span><span class='hs-layout'>,</span> <span class='hs-varid'>rcon_flds</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rbinds</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-596"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-varid'>pp_con</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>rbinds</span><span class='hs-layout'>)</span>
<a name="line-597"></a>  <span class='hs-keyword'>where</span>
<a name="line-598"></a>    <span class='hs-comment'>-- con :: ConLikeP (GhcPass p)</span>
<a name="line-599"></a>    <span class='hs-comment'>-- so we need case analysis to know to print it</span>
<a name="line-600"></a>    <span class='hs-varid'>pp_con</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ghcPass</span> <span class='hs-keyglyph'>@</span><span class='hs-varid'>p</span> <span class='hs-keyword'>of</span>
<a name="line-601"></a>               <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>con</span>
<a name="line-602"></a>               <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>con</span>
<a name="line-603"></a>               <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>con</span>
<a name="line-604"></a>
<a name="line-605"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>RecordUpd</span> <span class='hs-layout'>{</span> <span class='hs-varid'>rupd_expr</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>aexp</span><span class='hs-layout'>,</span> <span class='hs-varid'>rupd_flds</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>flds</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-606"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>flds</span> <span class='hs-keyword'>of</span>
<a name="line-607"></a>      <span class='hs-conid'>Left</span> <span class='hs-varid'>rbinds</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>aexp</span><span class='hs-layout'>)</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>braces</span> <span class='hs-layout'>(</span><span class='hs-varid'>fsep</span> <span class='hs-layout'>(</span><span class='hs-varid'>punctuate</span> <span class='hs-varid'>comma</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>rbinds</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-608"></a>      <span class='hs-conid'>Right</span> <span class='hs-varid'>pbinds</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>aexp</span><span class='hs-layout'>)</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>braces</span> <span class='hs-layout'>(</span><span class='hs-varid'>fsep</span> <span class='hs-layout'>(</span><span class='hs-varid'>punctuate</span> <span class='hs-varid'>comma</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>pbinds</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-609"></a>
<a name="line-610"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsGetField</span> <span class='hs-layout'>{</span> <span class='hs-varid'>gf_expr</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>fexp</span><span class='hs-layout'>,</span> <span class='hs-varid'>gf_field</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>field</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-611"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>fexp</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>dot</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>field</span>
<a name="line-612"></a>
<a name="line-613"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsProjection</span> <span class='hs-layout'>{</span> <span class='hs-varid'>proj_flds</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>flds</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>hcat</span> <span class='hs-layout'>(</span><span class='hs-varid'>dot</span> <span class='hs-conop'>:</span> <span class='hs-layout'>(</span><span class='hs-varid'>punctuate</span> <span class='hs-varid'>dot</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varop'>$</span> <span class='hs-varid'>toList</span> <span class='hs-varid'>flds</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-614"></a>
<a name="line-615"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>ExprWithTySig</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>expr</span> <span class='hs-varid'>sig</span><span class='hs-layout'>)</span>
<a name="line-616"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_lexpr</span> <span class='hs-varid'>expr</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>dcolon</span><span class='hs-layout'>)</span>
<a name="line-617"></a>         <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>sig</span><span class='hs-layout'>)</span>
<a name="line-618"></a>
<a name="line-619"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>ArithSeq</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>brackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>info</span><span class='hs-layout'>)</span>
<a name="line-620"></a>
<a name="line-621"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsSpliceE</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprSplice</span> <span class='hs-varid'>s</span>
<a name="line-622"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsBracket</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprHsBracket</span> <span class='hs-varid'>b</span>
<a name="line-623"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsRnBracketOut</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span> <span class='hs-conid'>[]</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>e</span>
<a name="line-624"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsRnBracketOut</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span> <span class='hs-varid'>ps</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>e</span> <span class='hs-varop'>$$</span> <span class='hs-varid'>text</span> <span class='hs-str'>"pending(rn)"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ps</span>
<a name="line-625"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsTcBracketOut</span> <span class='hs-keyword'>_</span> <span class='hs-sel'>_wrap</span> <span class='hs-varid'>e</span> <span class='hs-conid'>[]</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>e</span>
<a name="line-626"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsTcBracketOut</span> <span class='hs-keyword'>_</span> <span class='hs-sel'>_wrap</span> <span class='hs-varid'>e</span> <span class='hs-varid'>ps</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>e</span> <span class='hs-varop'>$$</span> <span class='hs-varid'>text</span> <span class='hs-str'>"pending(tc)"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprIfTc</span> <span class='hs-keyglyph'>@</span><span class='hs-varid'>p</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>ps</span><span class='hs-layout'>)</span>
<a name="line-627"></a>
<a name="line-628"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsProc</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pat</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdTop</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>cmd</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-629"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"proc"</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>pat</span><span class='hs-layout'>,</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"-&gt;"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>cmd</span><span class='hs-keyglyph'>]</span>
<a name="line-630"></a>
<a name="line-631"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsStatic</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-632"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"static"</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>e</span><span class='hs-keyglyph'>]</span>
<a name="line-633"></a>
<a name="line-634"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsTick</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>tickish</span> <span class='hs-varid'>exp</span><span class='hs-layout'>)</span>
<a name="line-635"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprTicks</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>exp</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span>
<a name="line-636"></a>    <span class='hs-varid'>ppr</span> <span class='hs-varid'>tickish</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr_lexpr</span> <span class='hs-varid'>exp</span>
<a name="line-637"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsBinTick</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>tickIdTrue</span> <span class='hs-varid'>tickIdFalse</span> <span class='hs-varid'>exp</span><span class='hs-layout'>)</span>
<a name="line-638"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprTicks</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>exp</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span>
<a name="line-639"></a>    <span class='hs-varid'>hcat</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"bintick&lt;"</span><span class='hs-layout'>,</span>
<a name="line-640"></a>          <span class='hs-varid'>ppr</span> <span class='hs-varid'>tickIdTrue</span><span class='hs-layout'>,</span>
<a name="line-641"></a>          <span class='hs-varid'>text</span> <span class='hs-str'>","</span><span class='hs-layout'>,</span>
<a name="line-642"></a>          <span class='hs-varid'>ppr</span> <span class='hs-varid'>tickIdFalse</span><span class='hs-layout'>,</span>
<a name="line-643"></a>          <span class='hs-varid'>text</span> <span class='hs-str'>"&gt;("</span><span class='hs-layout'>,</span>
<a name="line-644"></a>          <span class='hs-varid'>ppr</span> <span class='hs-varid'>exp</span><span class='hs-layout'>,</span> <span class='hs-varid'>text</span> <span class='hs-str'>")"</span><span class='hs-keyglyph'>]</span>
<a name="line-645"></a>
<a name="line-646"></a><span class='hs-definition'>ppr_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>XExpr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ghcPass</span> <span class='hs-keyglyph'>@</span><span class='hs-varid'>p</span> <span class='hs-keyword'>of</span>
<a name="line-647"></a><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &lt; 811</span>
<a name="line-648"></a>  <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>x</span>
<a name="line-649"></a><span class='hs-cpp'>#endif</span>
<a name="line-650"></a>  <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>x</span>
<a name="line-651"></a>  <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>of</span>
<a name="line-652"></a>    <span class='hs-conid'>WrapExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsWrap</span> <span class='hs-varid'>co_fn</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>pprHsWrapper</span> <span class='hs-varid'>co_fn</span>
<a name="line-653"></a>      <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>parens</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>parens</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>pprExpr</span> <span class='hs-varid'>e</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>pprExpr</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-654"></a>    <span class='hs-conid'>ExpansionExpr</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>e</span> <span class='hs-comment'>-- e is an HsExpansion, we print the original</span>
<a name="line-655"></a>                             <span class='hs-comment'>-- expression (LHsExpr GhcPs), not the</span>
<a name="line-656"></a>                             <span class='hs-comment'>-- desugared one (LHsExpr GhcT).</span>
<a name="line-657"></a>
<a name="line-658"></a><a name="ppr_infix_expr"></a><span class='hs-definition'>ppr_infix_expr</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>p</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>SDoc</span>
<a name="line-659"></a><span class='hs-definition'>ppr_infix_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsVar</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprInfixOcc</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span>
<a name="line-660"></a><span class='hs-definition'>ppr_infix_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsConLikeOut</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprInfixOcc</span> <span class='hs-layout'>(</span><span class='hs-varid'>conLikeName</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-661"></a><span class='hs-definition'>ppr_infix_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsRecFld</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprInfixOcc</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span>
<a name="line-662"></a><span class='hs-definition'>ppr_infix_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsUnboundVar</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>occ</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprInfixOcc</span> <span class='hs-varid'>occ</span><span class='hs-layout'>)</span>
<a name="line-663"></a><span class='hs-definition'>ppr_infix_expr</span> <span class='hs-layout'>(</span><span class='hs-conid'>XExpr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>            <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-layout'>(</span><span class='hs-varid'>ghcPass</span> <span class='hs-keyglyph'>@</span><span class='hs-varid'>p</span><span class='hs-layout'>,</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-664"></a><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &lt; 901</span>
<a name="line-665"></a>  <span class='hs-layout'>(</span><span class='hs-conid'>GhcPs</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>                              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Nothing</span>
<a name="line-666"></a><span class='hs-cpp'>#endif</span>
<a name="line-667"></a>  <span class='hs-layout'>(</span><span class='hs-conid'>GhcRn</span><span class='hs-layout'>,</span> <span class='hs-conid'>HsExpanded</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr_infix_expr</span> <span class='hs-varid'>a</span>
<a name="line-668"></a>  <span class='hs-layout'>(</span><span class='hs-conid'>GhcTc</span><span class='hs-layout'>,</span> <span class='hs-conid'>WrapExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsWrap</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr_infix_expr</span> <span class='hs-varid'>e</span>
<a name="line-669"></a>  <span class='hs-layout'>(</span><span class='hs-conid'>GhcTc</span><span class='hs-layout'>,</span> <span class='hs-conid'>ExpansionExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpanded</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr_infix_expr</span> <span class='hs-varid'>a</span>
<a name="line-670"></a><span class='hs-definition'>ppr_infix_expr</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span>
<a name="line-671"></a>
<a name="line-672"></a><a name="ppr_apps"></a><span class='hs-definition'>ppr_apps</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-673"></a>         <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-674"></a>         <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Either</span> <span class='hs-layout'>(</span><span class='hs-conid'>LHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LHsWcType</span> <span class='hs-layout'>(</span><span class='hs-conid'>NoGhcTc</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-675"></a>         <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-676"></a><span class='hs-definition'>ppr_apps</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsApp</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>fun</span><span class='hs-layout'>)</span> <span class='hs-varid'>arg</span><span class='hs-layout'>)</span>        <span class='hs-varid'>args</span>
<a name="line-677"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_apps</span> <span class='hs-varid'>fun</span> <span class='hs-layout'>(</span><span class='hs-conid'>Left</span> <span class='hs-varid'>arg</span> <span class='hs-conop'>:</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span>
<a name="line-678"></a><span class='hs-definition'>ppr_apps</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsAppType</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>fun</span><span class='hs-layout'>)</span> <span class='hs-varid'>arg</span><span class='hs-layout'>)</span>    <span class='hs-varid'>args</span>
<a name="line-679"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_apps</span> <span class='hs-varid'>fun</span> <span class='hs-layout'>(</span><span class='hs-conid'>Right</span> <span class='hs-varid'>arg</span> <span class='hs-conop'>:</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span>
<a name="line-680"></a><span class='hs-definition'>ppr_apps</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>args</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_expr</span> <span class='hs-varid'>fun</span><span class='hs-layout'>)</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>fsep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>pp</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-681"></a>  <span class='hs-keyword'>where</span>
<a name="line-682"></a>    <span class='hs-varid'>pp</span> <span class='hs-layout'>(</span><span class='hs-conid'>Left</span> <span class='hs-varid'>arg</span><span class='hs-layout'>)</span>                             <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>arg</span>
<a name="line-683"></a>    <span class='hs-comment'>-- pp (Right (LHsWcTypeX (HsWC { hswc_body = L _ arg })))</span>
<a name="line-684"></a>    <span class='hs-comment'>--   = char '@' &lt;&gt; pprHsType arg</span>
<a name="line-685"></a>    <span class='hs-varid'>pp</span> <span class='hs-layout'>(</span><span class='hs-conid'>Right</span> <span class='hs-varid'>arg</span><span class='hs-layout'>)</span>
<a name="line-686"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"@"</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>arg</span>
<a name="line-687"></a>
<a name="line-688"></a>
<a name="line-689"></a><a name="pprDebugParendExpr"></a><span class='hs-definition'>pprDebugParendExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-690"></a>                   <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-691"></a><span class='hs-definition'>pprDebugParendExpr</span> <span class='hs-varid'>p</span> <span class='hs-varid'>expr</span>
<a name="line-692"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>getPprDebug</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-keyword'>case</span>
<a name="line-693"></a>      <span class='hs-conid'>True</span>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>pprParendLExpr</span> <span class='hs-varid'>p</span> <span class='hs-varid'>expr</span>
<a name="line-694"></a>      <span class='hs-conid'>False</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>pprLExpr</span>         <span class='hs-varid'>expr</span>
<a name="line-695"></a>
<a name="line-696"></a><a name="pprParendLExpr"></a><span class='hs-definition'>pprParendLExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-697"></a>               <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-698"></a><span class='hs-definition'>pprParendLExpr</span> <span class='hs-varid'>p</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprParendExpr</span> <span class='hs-varid'>p</span> <span class='hs-varid'>e</span>
<a name="line-699"></a>
<a name="line-700"></a><a name="pprParendExpr"></a><span class='hs-definition'>pprParendExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-701"></a>              <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-702"></a><span class='hs-definition'>pprParendExpr</span> <span class='hs-varid'>p</span> <span class='hs-varid'>expr</span>
<a name="line-703"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>hsExprNeedsParens</span> <span class='hs-varid'>p</span> <span class='hs-varid'>expr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprExpr</span> <span class='hs-varid'>expr</span><span class='hs-layout'>)</span>
<a name="line-704"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>                <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprExpr</span> <span class='hs-varid'>expr</span>
<a name="line-705"></a>        <span class='hs-comment'>-- Using pprLExpr makes sure that we go 'deeper'</span>
<a name="line-706"></a>        <span class='hs-comment'>-- I think that is usually (always?) right</span>
<a name="line-707"></a>
<a name="line-708"></a><a name="hsExprNeedsParens"></a><span class='hs-comment'>-- | @'hsExprNeedsParens' p e@ returns 'True' if the expression @e@ needs</span>
<a name="line-709"></a><span class='hs-comment'>-- parentheses under precedence @p@.</span>
<a name="line-710"></a><span class='hs-definition'>hsExprNeedsParens</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>p</span><span class='hs-varop'>.</span> <span class='hs-conid'>IsPass</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-711"></a><span class='hs-definition'>hsExprNeedsParens</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span>
<a name="line-712"></a>  <span class='hs-keyword'>where</span>
<a name="line-713"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsVar</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-714"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsUnboundVar</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>               <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-715"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsConLikeOut</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>               <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-716"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsIPVar</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-717"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsOverLabel</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-718"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsLit</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span>                    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsLitNeedsParens</span> <span class='hs-varid'>p</span> <span class='hs-varid'>l</span>
<a name="line-719"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsOverLit</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>ol</span><span class='hs-layout'>)</span>               <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsOverLitNeedsParens</span> <span class='hs-varid'>p</span> <span class='hs-varid'>ol</span>
<a name="line-720"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsPar</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-721"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsApp</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;=</span> <span class='hs-varid'>appPrec</span>
<a name="line-722"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsAppType</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                 <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;=</span> <span class='hs-varid'>appPrec</span>
<a name="line-723"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>OpApp</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;=</span> <span class='hs-varid'>opPrec</span>
<a name="line-724"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>NegApp</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>topPrec</span>
<a name="line-725"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>SectionL</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-726"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>SectionR</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-727"></a>    <span class='hs-comment'>-- Special-case unary boxed tuple applications so that they are</span>
<a name="line-728"></a>    <span class='hs-comment'>-- parenthesized as `Identity (Solo x)`, not `Identity Solo x` (#18612)</span>
<a name="line-729"></a>    <span class='hs-comment'>-- See Note [One-tuples] in GHC.Builtin.Types</span>
<a name="line-730"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>ExplicitTuple</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Present</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-keyglyph'>]</span> <span class='hs-conid'>Boxed</span><span class='hs-layout'>)</span>
<a name="line-731"></a>                                      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;=</span> <span class='hs-varid'>appPrec</span>
<a name="line-732"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>ExplicitTuple</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>              <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-733"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>ExplicitSum</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-734"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsLam</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>topPrec</span>
<a name="line-735"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsLamCase</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>topPrec</span>
<a name="line-736"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCase</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>topPrec</span>
<a name="line-737"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsIf</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>topPrec</span>
<a name="line-738"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsMultiIf</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>topPrec</span>
<a name="line-739"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsLet</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>topPrec</span>
<a name="line-740"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsDo</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>sc</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>
<a name="line-741"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isComprehensionContext</span> <span class='hs-varid'>sc</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-742"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>                     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>topPrec</span>
<a name="line-743"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>ExplicitList</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>               <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-744"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>RecordUpd</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-745"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>ExprWithTySig</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>              <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;=</span> <span class='hs-varid'>sigPrec</span>
<a name="line-746"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>ArithSeq</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-747"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsPragE</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;=</span> <span class='hs-varid'>appPrec</span>
<a name="line-748"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsSpliceE</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-749"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsBracket</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-750"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsRnBracketOut</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>             <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-751"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsTcBracketOut</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>             <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-752"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsProc</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>topPrec</span>
<a name="line-753"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsStatic</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-varop'>&gt;=</span> <span class='hs-varid'>appPrec</span>
<a name="line-754"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsTick</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>           <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>e</span>
<a name="line-755"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsBinTick</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>e</span>
<a name="line-756"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>RecordCon</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-757"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsRecFld</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-758"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsProjection</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>               <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-759"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsGetField</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>                 <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-760"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>XExpr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-761"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>ghcPass</span> <span class='hs-keyglyph'>@</span><span class='hs-varid'>p</span>
<a name="line-762"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>of</span>
<a name="line-763"></a>          <span class='hs-conid'>WrapExpr</span>      <span class='hs-layout'>(</span><span class='hs-conid'>HsWrap</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>go</span> <span class='hs-varid'>e</span>
<a name="line-764"></a>          <span class='hs-conid'>ExpansionExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpanded</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>hsExprNeedsParens</span> <span class='hs-varid'>p</span> <span class='hs-varid'>a</span>
<a name="line-765"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>ghcPass</span> <span class='hs-keyglyph'>@</span><span class='hs-varid'>p</span>
<a name="line-766"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>of</span> <span class='hs-conid'>HsExpanded</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>hsExprNeedsParens</span> <span class='hs-varid'>p</span> <span class='hs-varid'>a</span>
<a name="line-767"></a><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &lt;= 900</span>
<a name="line-768"></a>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-769"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-770"></a><span class='hs-cpp'>#endif</span>
<a name="line-771"></a>
<a name="line-772"></a>
<a name="line-773"></a><a name="parenthesizeHsExpr"></a><span class='hs-comment'>-- | @'parenthesizeHsExpr' p e@ checks if @'hsExprNeedsParens' p e@ is true,</span>
<a name="line-774"></a><span class='hs-comment'>-- and if so, surrounds @e@ with an 'HsPar'. Otherwise, it simply returns @e@.</span>
<a name="line-775"></a><span class='hs-definition'>parenthesizeHsExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IsPass</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>PprPrec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-776"></a><span class='hs-definition'>parenthesizeHsExpr</span> <span class='hs-varid'>p</span> <span class='hs-varid'>le</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-varid'>loc</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-777"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>hsExprNeedsParens</span> <span class='hs-varid'>p</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>L</span> <span class='hs-varid'>loc</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsPar</span> <span class='hs-varid'>noAnn</span> <span class='hs-varid'>le</span><span class='hs-layout'>)</span>
<a name="line-778"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>             <span class='hs-keyglyph'>=</span> <span class='hs-varid'>le</span>
<a name="line-779"></a>
<a name="line-780"></a><a name="stripParensLHsExpr"></a><span class='hs-definition'>stripParensLHsExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>LHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-781"></a><span class='hs-definition'>stripParensLHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsPar</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>stripParensLHsExpr</span> <span class='hs-varid'>e</span>
<a name="line-782"></a><span class='hs-definition'>stripParensLHsExpr</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>e</span>
<a name="line-783"></a>
<a name="line-784"></a><a name="stripParensHsExpr"></a><span class='hs-definition'>stripParensHsExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-785"></a><span class='hs-definition'>stripParensHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsPar</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>stripParensHsExpr</span> <span class='hs-varid'>e</span>
<a name="line-786"></a><span class='hs-definition'>stripParensHsExpr</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>e</span>
<a name="line-787"></a>
<a name="line-788"></a><a name="isAtomicHsExpr"></a><span class='hs-definition'>isAtomicHsExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>p</span><span class='hs-varop'>.</span> <span class='hs-conid'>IsPass</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-789"></a><span class='hs-comment'>-- True of a single token</span>
<a name="line-790"></a><span class='hs-definition'>isAtomicHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsVar</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-791"></a><span class='hs-definition'>isAtomicHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsConLikeOut</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-792"></a><span class='hs-definition'>isAtomicHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsLit</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-793"></a><span class='hs-definition'>isAtomicHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsOverLit</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-794"></a><span class='hs-definition'>isAtomicHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsIPVar</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-795"></a><span class='hs-definition'>isAtomicHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsOverLabel</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-796"></a><span class='hs-definition'>isAtomicHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsUnboundVar</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-797"></a><span class='hs-definition'>isAtomicHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsRecFld</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-798"></a><span class='hs-definition'>isAtomicHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>XExpr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-799"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>ghcPass</span> <span class='hs-keyglyph'>@</span><span class='hs-varid'>p</span>          <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>of</span>
<a name="line-800"></a>      <span class='hs-conid'>WrapExpr</span>      <span class='hs-layout'>(</span><span class='hs-conid'>HsWrap</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>isAtomicHsExpr</span> <span class='hs-varid'>e</span>
<a name="line-801"></a>      <span class='hs-conid'>ExpansionExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpanded</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>isAtomicHsExpr</span> <span class='hs-varid'>a</span>
<a name="line-802"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>ghcPass</span> <span class='hs-keyglyph'>@</span><span class='hs-varid'>p</span>          <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>of</span>
<a name="line-803"></a>      <span class='hs-conid'>HsExpanded</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>_</span>         <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>isAtomicHsExpr</span> <span class='hs-varid'>a</span>
<a name="line-804"></a><span class='hs-definition'>isAtomicHsExpr</span> <span class='hs-keyword'>_</span>                 <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-805"></a>
<a name="line-806"></a><a name="instance%20Outputable%20(HsPragE%20(GhcPass%20p))"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsPragE</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-807"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsPragSCC</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>st</span> <span class='hs-layout'>(</span><span class='hs-conid'>StringLiteral</span> <span class='hs-varid'>stl</span> <span class='hs-varid'>lbl</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-808"></a>    <span class='hs-varid'>pprWithSourceText</span> <span class='hs-varid'>st</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"{-# SCC"</span><span class='hs-layout'>)</span>
<a name="line-809"></a>     <span class='hs-comment'>-- no doublequotes if stl empty, for the case where the SCC was written</span>
<a name="line-810"></a>     <span class='hs-comment'>-- without quotes.</span>
<a name="line-811"></a>    <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprWithSourceText</span> <span class='hs-varid'>stl</span> <span class='hs-layout'>(</span><span class='hs-varid'>ftext</span> <span class='hs-varid'>lbl</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"#-}"</span>
<a name="line-812"></a>
<a name="line-813"></a>
<a name="line-814"></a><span class='hs-comment'>{- *********************************************************************
<a name="line-815"></a>*                                                                      *
<a name="line-816"></a>             HsExpansion and rebindable syntax
<a name="line-817"></a>*                                                                      *
<a name="line-818"></a>********************************************************************* -}</span>
<a name="line-819"></a>
<a name="line-820"></a><span class='hs-comment'>{- Note [Rebindable syntax and HsExpansion]
<a name="line-821"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-822"></a>We implement rebindable syntax (RS) support by performing a desugaring
<a name="line-823"></a>in the renamer. We transform GhcPs expressions affected by RS into the
<a name="line-824"></a>appropriate desugared form, but **annotated with the original expression**.
<a name="line-825"></a>
<a name="line-826"></a>Let us consider a piece of code like:
<a name="line-827"></a>
<a name="line-828"></a>    {-# LANGUAGE RebindableSyntax #-}
<a name="line-829"></a>    ifThenElse :: Char -&gt; () -&gt; () -&gt; ()
<a name="line-830"></a>    ifThenElse _ _ _ = ()
<a name="line-831"></a>    x = if 'a' then () else True
<a name="line-832"></a>
<a name="line-833"></a>The parsed AST for the RHS of x would look something like (slightly simplified):
<a name="line-834"></a>
<a name="line-835"></a>    L locif (HsIf (L loca 'a') (L loctrue ()) (L locfalse True))
<a name="line-836"></a>
<a name="line-837"></a>Upon seeing such an AST with RS on, we could transform it into a
<a name="line-838"></a>mere function call, as per the RS rules, equivalent to the
<a name="line-839"></a>following function application:
<a name="line-840"></a>
<a name="line-841"></a>    ifThenElse 'a' () True
<a name="line-842"></a>
<a name="line-843"></a>which doesn't typecheck. But GHC would report an error about
<a name="line-844"></a>not being able to match the third argument's type (Bool) with the
<a name="line-845"></a>expected type: (), in the expression _as desugared_, i.e in
<a name="line-846"></a>the aforementioned function application. But the user never
<a name="line-847"></a>wrote a function application! This would be pretty bad.
<a name="line-848"></a>
<a name="line-849"></a>To remedy this, instead of transforming the original HsIf
<a name="line-850"></a>node into mere applications of 'ifThenElse', we keep the
<a name="line-851"></a>original 'if' expression around too, using the TTG
<a name="line-852"></a>XExpr extension point to allow GHC to construct an
<a name="line-853"></a>'HsExpansion' value that will keep track of the original
<a name="line-854"></a>expression in its first field, and the desugared one in the
<a name="line-855"></a>second field. The resulting renamed AST would look like:
<a name="line-856"></a>
<a name="line-857"></a>    L locif (XExpr
<a name="line-858"></a>      (HsExpanded
<a name="line-859"></a>        (HsIf (L loca 'a')
<a name="line-860"></a>              (L loctrue ())
<a name="line-861"></a>              (L locfalse True)
<a name="line-862"></a>        )
<a name="line-863"></a>        (App (L generatedSrcSpan
<a name="line-864"></a>                (App (L generatedSrcSpan
<a name="line-865"></a>                        (App (L generatedSrcSpan (Var ifThenElse))
<a name="line-866"></a>                             (L loca 'a')
<a name="line-867"></a>                        )
<a name="line-868"></a>                     )
<a name="line-869"></a>                     (L loctrue ())
<a name="line-870"></a>                )
<a name="line-871"></a>             )
<a name="line-872"></a>             (L locfalse True)
<a name="line-873"></a>        )
<a name="line-874"></a>      )
<a name="line-875"></a>    )
<a name="line-876"></a>
<a name="line-877"></a>When comes the time to typecheck the program, we end up calling
<a name="line-878"></a>tcMonoExpr on the AST above. If this expression gives rise to
<a name="line-879"></a>a type error, then it will appear in a context line and GHC
<a name="line-880"></a>will pretty-print it using the 'Outputable (HsExpansion a b)'
<a name="line-881"></a>instance defined below, which *only prints the original
<a name="line-882"></a>expression*. This is the gist of the idea, but is not quite
<a name="line-883"></a>enough to recover the error messages that we had with the
<a name="line-884"></a>SyntaxExpr-based, typechecking/desugaring-to-core time
<a name="line-885"></a>implementation of rebindable syntax. The key idea is to decorate
<a name="line-886"></a>some elements of the desugared expression so as to be able to
<a name="line-887"></a>give them a special treatment when typechecking the desugared
<a name="line-888"></a>expression, to print a different context line or skip one
<a name="line-889"></a>altogether.
<a name="line-890"></a>
<a name="line-891"></a>Whenever we 'setSrcSpan' a 'generatedSrcSpan', we update a field in
<a name="line-892"></a>TcLclEnv called 'tcl_in_gen_code', setting it to True, which indicates that we
<a name="line-893"></a>entered generated code, i.e code fabricated by the compiler when rebinding some
<a name="line-894"></a>syntax. If someone tries to push some error context line while that field is set
<a name="line-895"></a>to True, the pushing won't actually happen and the context line is just dropped.
<a name="line-896"></a>Once we 'setSrcSpan' a real span (for an expression that was in the original
<a name="line-897"></a>source code), we set 'tcl_in_gen_code' back to False, indicating that we
<a name="line-898"></a>"emerged from the generated code tunnel", and that the expressions we will be
<a name="line-899"></a>processing are relevant to report in context lines again.
<a name="line-900"></a>
<a name="line-901"></a>You might wonder why TcLclEnv has both
<a name="line-902"></a>   tcl_loc         :: RealSrcSpan
<a name="line-903"></a>   tcl_in_gen_code :: Bool
<a name="line-904"></a>Could we not store a Maybe RealSrcSpan? The problem is that we still
<a name="line-905"></a>generate constraints when processing generated code, and a CtLoc must
<a name="line-906"></a>contain a RealSrcSpan -- otherwise, error messages might appear
<a name="line-907"></a>without source locations. So tcl_loc keeps the RealSrcSpan of the last
<a name="line-908"></a>location spotted that wasn't generated; it's as good as we're going to
<a name="line-909"></a>get in generated code. Once we get to sub-trees that are not
<a name="line-910"></a>generated, then we update the RealSrcSpan appropriately, and set the
<a name="line-911"></a>tcl_in_gen_code Bool to False.
<a name="line-912"></a>
<a name="line-913"></a>---
<a name="line-914"></a>
<a name="line-915"></a>A general recipe to follow this approach for new constructs could go as follows:
<a name="line-916"></a>
<a name="line-917"></a>- Remove any GhcRn-time SyntaxExpr extensions to the relevant constructor for your
<a name="line-918"></a>  construct, in HsExpr or related syntax data types.
<a name="line-919"></a>- At renaming-time:
<a name="line-920"></a>    - take your original node of interest (HsIf above)
<a name="line-921"></a>    - rename its subexpressions (condition, true branch, false branch above)
<a name="line-922"></a>    - construct the suitable "rebound"-and-renamed result (ifThenElse call
<a name="line-923"></a>      above), where the 'SrcSpan' attached to any _fabricated node_ (the
<a name="line-924"></a>      HsVar/HsApp nodes, above) is set to 'generatedSrcSpan'
<a name="line-925"></a>    - take both the original node and that rebound-and-renamed result and wrap
<a name="line-926"></a>      them in an XExpr: XExpr (HsExpanded &lt;original node&gt; &lt;desugared&gt;)
<a name="line-927"></a> - At typechecking-time:
<a name="line-928"></a>    - remove any logic that was previously dealing with your rebindable
<a name="line-929"></a>      construct, typically involving [tc]SyntaxOp, SyntaxExpr and friends.
<a name="line-930"></a>    - the XExpr (HsExpanded ... ...) case in tcExpr already makes sure that we
<a name="line-931"></a>      typecheck the desugared expression while reporting the original one in
<a name="line-932"></a>      errors
<a name="line-933"></a>-}</span>
<a name="line-934"></a>
<a name="line-935"></a><span class='hs-comment'>{- Note [Overview of record dot syntax]
<a name="line-936"></a>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-937"></a>This is the note that explains all the moving parts for record dot
<a name="line-938"></a>syntax.
<a name="line-939"></a>
<a name="line-940"></a>The language extensions @OverloadedRecordDot@ and
<a name="line-941"></a>@OverloadedRecordUpdate@ (providing "record dot syntax") are
<a name="line-942"></a>implemented using the techniques of Note [Rebindable syntax and
<a name="line-943"></a>HsExpansion].
<a name="line-944"></a>
<a name="line-945"></a>When OverloadedRecordDot is enabled:
<a name="line-946"></a>- Field selection expressions
<a name="line-947"></a>  - e.g. foo.bar.baz
<a name="line-948"></a>  - Have abstract syntax HsGetField
<a name="line-949"></a>  - After renaming are XExpr (HsExpanded (HsGetField ...) (getField @"..."...)) expressions
<a name="line-950"></a>- Field selector expressions e.g. (.x.y)
<a name="line-951"></a>  - Have abstract syntax HsProjection
<a name="line-952"></a>  - After renaming are XExpr (HsExpanded (HsProjection ...) ((getField @"...") . (getField @"...") . ...) expressions
<a name="line-953"></a>
<a name="line-954"></a>When OverloadedRecordUpdate is enabled:
<a name="line-955"></a>- Record update expressions
<a name="line-956"></a>  - e.g. a{foo.bar=1, quux="corge", baz}
<a name="line-957"></a>  - Have abstract syntax RecordUpd
<a name="line-958"></a>    - With rupd_flds containting a Right
<a name="line-959"></a>    - See Note [RecordDotSyntax field updates] (in Language.Haskell.Syntax.Expr)
<a name="line-960"></a>  - After renaming are XExpr (HsExpanded (RecordUpd ...) (setField@"..." ...) expressions
<a name="line-961"></a>    - Note that this is true for all record updates even for those that do not involve '.'
<a name="line-962"></a>
<a name="line-963"></a>When OverloadedRecordDot is enabled and RebindableSyntax is not
<a name="line-964"></a>enabled the name 'getField' is resolved to GHC.Records.getField. When
<a name="line-965"></a>OverloadedRecordDot is enabled and RebindableSyntax is enabled the
<a name="line-966"></a>name 'getField' is whatever in-scope name that is.
<a name="line-967"></a>
<a name="line-968"></a>When OverloadedRecordUpd is enabled and RebindableSyntax is not
<a name="line-969"></a>enabled it is an error for now (temporary while we wait on native
<a name="line-970"></a>setField support; see
<a name="line-971"></a>https://gitlab.haskell.org/ghc/ghc/-/issues/16232). When
<a name="line-972"></a>OverloadedRecordUpd is enabled and RebindableSyntax is enabled the
<a name="line-973"></a>names 'getField' and 'setField' are whatever in-scope names they are.
<a name="line-974"></a>-}</span>
<a name="line-975"></a>
<a name="line-976"></a><a name="HsExpansion"></a><span class='hs-comment'>-- See Note [Rebindable syntax and HsExpansion] just above.</span>
<a name="line-977"></a><a name="HsExpansion"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>HsExpansion</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<a name="line-978"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HsExpanded</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<a name="line-979"></a>  <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Data</span>
<a name="line-980"></a>
<a name="line-981"></a><a name="instance%20Outputable%20(HsExpansion%20a%20b)"></a><span class='hs-comment'>-- | Just print the original expression (the @a@).</span>
<a name="line-982"></a><a name="instance%20Outputable%20(HsExpansion%20a%20b)"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Outputable</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Outputable</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpansion</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-983"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpanded</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ifPprDebug</span> <span class='hs-layout'>(</span><span class='hs-varid'>vcat</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>b</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-984"></a>
<a name="line-985"></a>
<a name="line-986"></a><span class='hs-comment'>{-
<a name="line-987"></a>************************************************************************
<a name="line-988"></a>*                                                                      *
<a name="line-989"></a>\subsection{Commands (in arrow abstractions)}
<a name="line-990"></a>*                                                                      *
<a name="line-991"></a>************************************************************************
<a name="line-992"></a>-}</span>
<a name="line-993"></a>
<a name="line-994"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdArrApp</span>  <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>AddEpAnn</span>
<a name="line-995"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdArrApp</span>  <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-996"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdArrApp</span>  <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Type</span>
<a name="line-997"></a>
<a name="line-998"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdArrForm</span> <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>AnnList</span>
<a name="line-999"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdArrForm</span> <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1000"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdArrForm</span> <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1001"></a>
<a name="line-1002"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdApp</span>     <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnnCO</span>
<a name="line-1003"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdLam</span>     <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1004"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdPar</span>     <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>AnnParen</span>
<a name="line-1005"></a>
<a name="line-1006"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdCase</span>    <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>EpAnnHsCase</span>
<a name="line-1007"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdCase</span>    <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1008"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdCase</span>    <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1009"></a>
<a name="line-1010"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdLamCase</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-1011"></a>
<a name="line-1012"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdIf</span>      <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>AnnsIf</span>
<a name="line-1013"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdIf</span>      <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1014"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdIf</span>      <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1015"></a>
<a name="line-1016"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdLet</span>     <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>AnnsLet</span>
<a name="line-1017"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdLet</span>     <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1018"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdLet</span>     <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1019"></a>
<a name="line-1020"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdDo</span>      <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>AnnList</span>
<a name="line-1021"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdDo</span>      <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1022"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdDo</span>      <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Type</span>
<a name="line-1023"></a>
<a name="line-1024"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdWrap</span>    <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1025"></a>
<a name="line-1026"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXCmd</span>       <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-1027"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXCmd</span>       <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-1028"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXCmd</span>       <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HsWrap</span> <span class='hs-conid'>HsCmd</span>
<a name="line-1029"></a>
<a name="line-1030"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pl</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-1031"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnL</span>
<a name="line-1032"></a>
<a name="line-1033"></a>    <span class='hs-comment'>-- If   cmd :: arg1 --&gt; res</span>
<a name="line-1034"></a>    <span class='hs-comment'>--      wrap :: arg1 "-&gt;" arg2</span>
<a name="line-1035"></a>    <span class='hs-comment'>-- Then (XCmd (HsWrap wrap cmd)) :: arg2 --&gt; res</span>
<a name="line-1036"></a>
<a name="line-1037"></a><a name="CmdTopTc"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>CmdTopTc</span>
<a name="line-1038"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>CmdTopTc</span> <span class='hs-conid'>Type</span>    <span class='hs-comment'>-- Nested tuple of inputs on the command's stack</span>
<a name="line-1039"></a>             <span class='hs-conid'>Type</span>    <span class='hs-comment'>-- return type of the command</span>
<a name="line-1040"></a>             <span class='hs-layout'>(</span><span class='hs-conid'>CmdSyntaxTable</span> <span class='hs-conid'>GhcTc</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- See Note [CmdSyntaxTable]</span>
<a name="line-1041"></a>
<a name="line-1042"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdTop</span>  <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1043"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdTop</span>  <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>CmdSyntaxTable</span> <span class='hs-conid'>GhcRn</span> <span class='hs-comment'>-- See Note [CmdSyntaxTable]</span>
<a name="line-1044"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCmdTop</span>  <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>CmdTopTc</span>
<a name="line-1045"></a>
<a name="line-1046"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXCmdTop</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-1047"></a>
<a name="line-1048"></a><a name="instance%20Outputable%20(HsCmd%20(GhcPass%20p))"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-1049"></a>    <span class='hs-varid'>ppr</span> <span class='hs-varid'>cmd</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprCmd</span> <span class='hs-varid'>cmd</span>
<a name="line-1050"></a>
<a name="line-1051"></a><a name="pprLCmd"></a><span class='hs-comment'>-----------------------</span>
<a name="line-1052"></a><span class='hs-comment'>-- pprCmd and pprLCmd call pprDeeper;</span>
<a name="line-1053"></a><span class='hs-comment'>-- the underscore versions do not</span>
<a name="line-1054"></a><span class='hs-definition'>pprLCmd</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>LHsCmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1055"></a><span class='hs-definition'>pprLCmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprCmd</span> <span class='hs-varid'>c</span>
<a name="line-1056"></a>
<a name="line-1057"></a><a name="pprCmd"></a><span class='hs-definition'>pprCmd</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsCmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1058"></a><span class='hs-definition'>pprCmd</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isQuietHsCmd</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span>            <span class='hs-varid'>ppr_cmd</span> <span class='hs-varid'>c</span>
<a name="line-1059"></a>         <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprDeeper</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_cmd</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-1060"></a>
<a name="line-1061"></a><a name="isQuietHsCmd"></a><span class='hs-definition'>isQuietHsCmd</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsCmd</span> <span class='hs-varid'>id</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-1062"></a><span class='hs-comment'>-- Parentheses do display something, but it gives little info and</span>
<a name="line-1063"></a><span class='hs-comment'>-- if we go deeper when we go inside them then we get ugly things</span>
<a name="line-1064"></a><span class='hs-comment'>-- like (...)</span>
<a name="line-1065"></a><span class='hs-definition'>isQuietHsCmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdPar</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-1066"></a><span class='hs-comment'>-- applications don't display anything themselves</span>
<a name="line-1067"></a><span class='hs-definition'>isQuietHsCmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdApp</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-1068"></a><span class='hs-definition'>isQuietHsCmd</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-1069"></a>
<a name="line-1070"></a><a name="ppr_lcmd"></a><span class='hs-comment'>-----------------------</span>
<a name="line-1071"></a><span class='hs-definition'>ppr_lcmd</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>LHsCmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1072"></a><span class='hs-definition'>ppr_lcmd</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-1073"></a>
<a name="line-1074"></a><a name="ppr_cmd"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>p</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span>
<a name="line-1075"></a>                     <span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsCmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1076"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdPar</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_lcmd</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-1077"></a>
<a name="line-1078"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdApp</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>c</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-1079"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>fun</span><span class='hs-layout'>,</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>collect_args</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>e</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>in</span>
<a name="line-1080"></a>    <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_lcmd</span> <span class='hs-varid'>fun</span><span class='hs-layout'>)</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1081"></a>  <span class='hs-keyword'>where</span>
<a name="line-1082"></a>    <span class='hs-varid'>collect_args</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdApp</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>arg</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>args</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>collect_args</span> <span class='hs-varid'>fun</span> <span class='hs-layout'>(</span><span class='hs-varid'>arg</span><span class='hs-conop'>:</span><span class='hs-varid'>args</span><span class='hs-layout'>)</span>
<a name="line-1083"></a>    <span class='hs-varid'>collect_args</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>args</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>fun</span><span class='hs-layout'>,</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span>
<a name="line-1084"></a>
<a name="line-1085"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdLam</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>matches</span><span class='hs-layout'>)</span>
<a name="line-1086"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprMatches</span> <span class='hs-varid'>matches</span>
<a name="line-1087"></a>
<a name="line-1088"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdCase</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>expr</span> <span class='hs-varid'>matches</span><span class='hs-layout'>)</span>
<a name="line-1089"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"case"</span><span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>expr</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"of"</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>
<a name="line-1090"></a>          <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprMatches</span> <span class='hs-varid'>matches</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>]</span>
<a name="line-1091"></a>
<a name="line-1092"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdLamCase</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>matches</span><span class='hs-layout'>)</span>
<a name="line-1093"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>text</span> <span class='hs-str'>"\\case"</span><span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprMatches</span> <span class='hs-varid'>matches</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>]</span>
<a name="line-1094"></a>
<a name="line-1095"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdIf</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span> <span class='hs-varid'>ct</span> <span class='hs-varid'>ce</span><span class='hs-layout'>)</span>
<a name="line-1096"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"if"</span><span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"then"</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>
<a name="line-1097"></a>         <span class='hs-varid'>nest</span> <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>ct</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-1098"></a>         <span class='hs-varid'>text</span> <span class='hs-str'>"else"</span><span class='hs-layout'>,</span>
<a name="line-1099"></a>         <span class='hs-varid'>nest</span> <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>ce</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-1100"></a>
<a name="line-1101"></a><span class='hs-comment'>-- special case: let ... in let ...</span>
<a name="line-1102"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdLet</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>binds</span> <span class='hs-varid'>cmd</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdLet</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1103"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"let"</span><span class='hs-layout'>)</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pprBinds</span> <span class='hs-varid'>binds</span><span class='hs-layout'>,</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"in"</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-1104"></a>         <span class='hs-varid'>ppr_lcmd</span> <span class='hs-varid'>cmd</span><span class='hs-keyglyph'>]</span>
<a name="line-1105"></a>
<a name="line-1106"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdLet</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>binds</span> <span class='hs-varid'>cmd</span><span class='hs-layout'>)</span>
<a name="line-1107"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"let"</span><span class='hs-layout'>)</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprBinds</span> <span class='hs-varid'>binds</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-1108"></a>         <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"in"</span><span class='hs-layout'>)</span>  <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>cmd</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-1109"></a>
<a name="line-1110"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdDo</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>stmts</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprDo</span> <span class='hs-conid'>ArrowExpr</span> <span class='hs-varid'>stmts</span>
<a name="line-1111"></a>
<a name="line-1112"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdArrApp</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>arrow</span> <span class='hs-varid'>arg</span> <span class='hs-conid'>HsFirstOrderApp</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span>
<a name="line-1113"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr_lexpr</span> <span class='hs-varid'>arrow</span><span class='hs-layout'>,</span> <span class='hs-varid'>larrowt</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr_lexpr</span> <span class='hs-varid'>arg</span><span class='hs-keyglyph'>]</span>
<a name="line-1114"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdArrApp</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>arrow</span> <span class='hs-varid'>arg</span> <span class='hs-conid'>HsFirstOrderApp</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span>
<a name="line-1115"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr_lexpr</span> <span class='hs-varid'>arg</span><span class='hs-layout'>,</span> <span class='hs-varid'>arrowt</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr_lexpr</span> <span class='hs-varid'>arrow</span><span class='hs-keyglyph'>]</span>
<a name="line-1116"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdArrApp</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>arrow</span> <span class='hs-varid'>arg</span> <span class='hs-conid'>HsHigherOrderApp</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span>
<a name="line-1117"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr_lexpr</span> <span class='hs-varid'>arrow</span><span class='hs-layout'>,</span> <span class='hs-varid'>larrowtt</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr_lexpr</span> <span class='hs-varid'>arg</span><span class='hs-keyglyph'>]</span>
<a name="line-1118"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdArrApp</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>arrow</span> <span class='hs-varid'>arg</span> <span class='hs-conid'>HsHigherOrderApp</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span>
<a name="line-1119"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr_lexpr</span> <span class='hs-varid'>arg</span><span class='hs-layout'>,</span> <span class='hs-varid'>arrowtt</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr_lexpr</span> <span class='hs-varid'>arrow</span><span class='hs-keyglyph'>]</span>
<a name="line-1120"></a>
<a name="line-1121"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdArrForm</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsVar</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>arg1</span><span class='hs-layout'>,</span> <span class='hs-varid'>arg2</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1122"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprCmdArg</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>arg1</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>pprInfixOcc</span> <span class='hs-varid'>v</span>
<a name="line-1123"></a>                                         <span class='hs-layout'>,</span> <span class='hs-varid'>pprCmdArg</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>arg2</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1124"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdArrForm</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsVar</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-conid'>Infix</span> <span class='hs-keyword'>_</span>    <span class='hs-keyglyph'>[</span><span class='hs-varid'>arg1</span><span class='hs-layout'>,</span> <span class='hs-varid'>arg2</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1125"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprCmdArg</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>arg1</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>pprInfixOcc</span> <span class='hs-varid'>v</span>
<a name="line-1126"></a>                                         <span class='hs-layout'>,</span> <span class='hs-varid'>pprCmdArg</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>arg2</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1127"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdArrForm</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsConLikeOut</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>arg1</span><span class='hs-layout'>,</span> <span class='hs-varid'>arg2</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1128"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprCmdArg</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>arg1</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>pprInfixOcc</span> <span class='hs-layout'>(</span><span class='hs-varid'>conLikeName</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-1129"></a>                                         <span class='hs-layout'>,</span> <span class='hs-varid'>pprCmdArg</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>arg2</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1130"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdArrForm</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsConLikeOut</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-conid'>Infix</span> <span class='hs-keyword'>_</span>    <span class='hs-keyglyph'>[</span><span class='hs-varid'>arg1</span><span class='hs-layout'>,</span> <span class='hs-varid'>arg2</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1131"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprCmdArg</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>arg1</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>pprInfixOcc</span> <span class='hs-layout'>(</span><span class='hs-varid'>conLikeName</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-1132"></a>                                         <span class='hs-layout'>,</span> <span class='hs-varid'>pprCmdArg</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>arg2</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1133"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdArrForm</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>op</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span>
<a name="line-1134"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"(|"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr_lexpr</span> <span class='hs-varid'>op</span><span class='hs-layout'>)</span>
<a name="line-1135"></a>         <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprCmdArg</span><span class='hs-varop'>.</span><span class='hs-varid'>unLoc</span><span class='hs-layout'>)</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"|)"</span><span class='hs-layout'>)</span>
<a name="line-1136"></a><span class='hs-definition'>ppr_cmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>XCmd</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ghcPass</span> <span class='hs-keyglyph'>@</span><span class='hs-varid'>p</span> <span class='hs-keyword'>of</span>
<a name="line-1137"></a><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &lt; 811</span>
<a name="line-1138"></a>  <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>x</span>
<a name="line-1139"></a>  <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>x</span>
<a name="line-1140"></a><span class='hs-cpp'>#endif</span>
<a name="line-1141"></a>  <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>of</span>
<a name="line-1142"></a>    <span class='hs-conid'>HsWrap</span> <span class='hs-varid'>w</span> <span class='hs-varid'>cmd</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>pprHsWrapper</span> <span class='hs-varid'>w</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_cmd</span> <span class='hs-varid'>cmd</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1143"></a>
<a name="line-1144"></a><a name="pprCmdArg"></a><span class='hs-definition'>pprCmdArg</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsCmdTop</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1145"></a><span class='hs-definition'>pprCmdArg</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdTop</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>cmd</span><span class='hs-layout'>)</span>
<a name="line-1146"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_lcmd</span> <span class='hs-varid'>cmd</span>
<a name="line-1147"></a>
<a name="line-1148"></a><a name="instance%20Outputable%20(HsCmdTop%20(GhcPass%20p))"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdTop</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-1149"></a>    <span class='hs-varid'>ppr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprCmdArg</span>
<a name="line-1150"></a>
<a name="line-1151"></a><span class='hs-comment'>{-
<a name="line-1152"></a>************************************************************************
<a name="line-1153"></a>*                                                                      *
<a name="line-1154"></a>\subsection{@Match@, @GRHSs@, and @GRHS@ datatypes}
<a name="line-1155"></a>*                                                                      *
<a name="line-1156"></a>************************************************************************
<a name="line-1157"></a>-}</span>
<a name="line-1158"></a>
<a name="line-1159"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XMG</span>         <span class='hs-conid'>GhcPs</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1160"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XMG</span>         <span class='hs-conid'>GhcRn</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1161"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XMG</span>         <span class='hs-conid'>GhcTc</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>MatchGroupTc</span>
<a name="line-1162"></a>
<a name="line-1163"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXMatchGroup</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-1164"></a>
<a name="line-1165"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCMatch</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-1166"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXMatch</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-1167"></a>
<a name="line-1168"></a><a name="instance%20Outputable%20(Match%20(GhcPass%20pr)%20body)"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>pr</span><span class='hs-layout'>,</span> <span class='hs-conid'>Outputable</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-1169"></a>            <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>Match</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-1170"></a>  <span class='hs-varid'>ppr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprMatch</span>
<a name="line-1171"></a>
<a name="line-1172"></a><a name="isEmptyMatchGroup"></a><span class='hs-definition'>isEmptyMatchGroup</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MatchGroup</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-1173"></a><span class='hs-definition'>isEmptyMatchGroup</span> <span class='hs-layout'>(</span><span class='hs-conid'>MG</span> <span class='hs-layout'>{</span> <span class='hs-varid'>mg_alts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ms</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>null</span> <span class='hs-varop'>$</span> <span class='hs-varid'>unLoc</span> <span class='hs-varid'>ms</span>
<a name="line-1174"></a>
<a name="line-1175"></a><a name="isSingletonMatchGroup"></a><span class='hs-comment'>-- | Is there only one RHS in this list of matches?</span>
<a name="line-1176"></a><span class='hs-definition'>isSingletonMatchGroup</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LMatch</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-1177"></a><span class='hs-definition'>isSingletonMatchGroup</span> <span class='hs-varid'>matches</span>
<a name="line-1178"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>match</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>matches</span>
<a name="line-1179"></a>  <span class='hs-layout'>,</span> <span class='hs-conid'>Match</span> <span class='hs-layout'>{</span> <span class='hs-varid'>m_grhss</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>GRHSs</span> <span class='hs-layout'>{</span> <span class='hs-varid'>grhssGRHSs</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-keyword'>_</span><span class='hs-keyglyph'>]</span> <span class='hs-layout'>}</span> <span class='hs-layout'>}</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>match</span>
<a name="line-1180"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-1181"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-1182"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-1183"></a>
<a name="line-1184"></a><a name="matchGroupArity"></a><span class='hs-definition'>matchGroupArity</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MatchGroup</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Arity</span>
<a name="line-1185"></a><span class='hs-comment'>-- Precondition: MatchGroup is non-empty</span>
<a name="line-1186"></a><span class='hs-comment'>-- This is called before type checking, when mg_arg_tys is not set</span>
<a name="line-1187"></a><span class='hs-definition'>matchGroupArity</span> <span class='hs-layout'>(</span><span class='hs-conid'>MG</span> <span class='hs-layout'>{</span> <span class='hs-varid'>mg_alts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>alts</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-1188"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-varid'>alt1</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>alts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>length</span> <span class='hs-layout'>(</span><span class='hs-varid'>hsLMatchPats</span> <span class='hs-varid'>alt1</span><span class='hs-layout'>)</span>
<a name="line-1189"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>panic</span> <span class='hs-str'>"matchGroupArity"</span>
<a name="line-1190"></a>
<a name="line-1191"></a><a name="hsLMatchPats"></a><span class='hs-definition'>hsLMatchPats</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>LMatch</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-1192"></a><span class='hs-definition'>hsLMatchPats</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>Match</span> <span class='hs-layout'>{</span> <span class='hs-varid'>m_pats</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pats</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pats</span>
<a name="line-1193"></a>
<a name="line-1194"></a><span class='hs-comment'>-- We keep the type checker happy by providing EpAnnComments.  They</span>
<a name="line-1195"></a><span class='hs-comment'>-- can only be used if they follow a `where` keyword with no binds,</span>
<a name="line-1196"></a><span class='hs-comment'>-- but in that case the comment is attached to the following parsed</span>
<a name="line-1197"></a><span class='hs-comment'>-- item. So this can never be used in practice.</span>
<a name="line-1198"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCGRHSs</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnnComments</span>
<a name="line-1199"></a>
<a name="line-1200"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXGRHSs</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-1201"></a>
<a name="line-1202"></a><a name="GrhsAnn"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>GrhsAnn</span>
<a name="line-1203"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>GrhsAnn</span> <span class='hs-layout'>{</span>
<a name="line-1204"></a>      <span class='hs-varid'>ga_vbar</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>EpaLocation</span><span class='hs-layout'>,</span> <span class='hs-comment'>-- TODO:AZ do we need this?</span>
<a name="line-1205"></a>      <span class='hs-varid'>ga_sep</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>AddEpAnn</span> <span class='hs-comment'>-- ^ Match separator location</span>
<a name="line-1206"></a>      <span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span><span class='hs-layout'>)</span>
<a name="line-1207"></a>
<a name="line-1208"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XCGRHS</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>GrhsAnn</span>
<a name="line-1209"></a>                                   <span class='hs-comment'>-- Location of matchSeparator</span>
<a name="line-1210"></a>                                   <span class='hs-comment'>-- TODO:AZ does this belong on the GRHS, or GRHSs?</span>
<a name="line-1211"></a>
<a name="line-1212"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXGRHS</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-1213"></a>
<a name="line-1214"></a><a name="pprMatches"></a><span class='hs-definition'>pprMatches</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>idR</span><span class='hs-layout'>,</span> <span class='hs-conid'>Outputable</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-1215"></a>           <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>MatchGroup</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1216"></a><span class='hs-definition'>pprMatches</span> <span class='hs-conid'>MG</span> <span class='hs-layout'>{</span> <span class='hs-varid'>mg_alts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>matches</span> <span class='hs-layout'>}</span>
<a name="line-1217"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>vcat</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>pprMatch</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>unLoc</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>matches</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1218"></a>      <span class='hs-comment'>-- Don't print the type; it's only a place-holder before typechecking</span>
<a name="line-1219"></a>
<a name="line-1220"></a><a name="pprFunBind"></a><span class='hs-comment'>-- Exported to GHC.Hs.Binds, which can't see the defn of HsMatchContext</span>
<a name="line-1221"></a><span class='hs-definition'>pprFunBind</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span>
<a name="line-1222"></a>           <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>MatchGroup</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1223"></a><span class='hs-definition'>pprFunBind</span> <span class='hs-varid'>matches</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprMatches</span> <span class='hs-varid'>matches</span>
<a name="line-1224"></a>
<a name="line-1225"></a><a name="pprPatBind"></a><span class='hs-comment'>-- Exported to GHC.Hs.Binds, which can't see the defn of HsMatchContext</span>
<a name="line-1226"></a><span class='hs-definition'>pprPatBind</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>bndr</span> <span class='hs-varid'>p</span> <span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>bndr</span><span class='hs-layout'>,</span>
<a name="line-1227"></a>                               <span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1228"></a>           <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>LPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>bndr</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GRHSs</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1229"></a><span class='hs-definition'>pprPatBind</span> <span class='hs-varid'>pat</span> <span class='hs-varid'>grhss</span>
<a name="line-1230"></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>pat</span><span class='hs-layout'>,</span>
<a name="line-1231"></a>       <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprGRHSs</span> <span class='hs-layout'>(</span><span class='hs-conid'>PatBindRhs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsMatchContext</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>grhss</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-1232"></a>
<a name="line-1233"></a><a name="pprMatch"></a><span class='hs-definition'>pprMatch</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>idR</span><span class='hs-layout'>,</span> <span class='hs-conid'>Outputable</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-1234"></a>         <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Match</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1235"></a><span class='hs-definition'>pprMatch</span> <span class='hs-layout'>(</span><span class='hs-conid'>Match</span> <span class='hs-layout'>{</span> <span class='hs-varid'>m_pats</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pats</span><span class='hs-layout'>,</span> <span class='hs-varid'>m_ctxt</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ctxt</span><span class='hs-layout'>,</span> <span class='hs-varid'>m_grhss</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>grhss</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-1236"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>herald</span> <span class='hs-conop'>:</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-varop'>.</span> <span class='hs-varid'>pprParendLPat</span> <span class='hs-varid'>appPrec</span><span class='hs-layout'>)</span> <span class='hs-varid'>other_pats</span><span class='hs-layout'>)</span>
<a name="line-1237"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprGRHSs</span> <span class='hs-varid'>ctxt</span> <span class='hs-varid'>grhss</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>]</span>
<a name="line-1238"></a>  <span class='hs-keyword'>where</span>
<a name="line-1239"></a>    <span class='hs-layout'>(</span><span class='hs-varid'>herald</span><span class='hs-layout'>,</span> <span class='hs-varid'>other_pats</span><span class='hs-layout'>)</span>
<a name="line-1240"></a>        <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ctxt</span> <span class='hs-keyword'>of</span>
<a name="line-1241"></a>            <span class='hs-conid'>FunRhs</span> <span class='hs-layout'>{</span><span class='hs-varid'>mc_fun</span><span class='hs-keyglyph'>=</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>fun</span><span class='hs-layout'>,</span> <span class='hs-varid'>mc_fixity</span><span class='hs-keyglyph'>=</span><span class='hs-varid'>fixity</span><span class='hs-layout'>,</span> <span class='hs-varid'>mc_strictness</span><span class='hs-keyglyph'>=</span><span class='hs-varid'>strictness</span><span class='hs-layout'>}</span>
<a name="line-1242"></a>                <span class='hs-keyglyph'>|</span> <span class='hs-conid'>SrcStrict</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>strictness</span>
<a name="line-1243"></a>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ASSERT</span><span class='hs-layout'>(</span><span class='hs-varid'>null</span> <span class='hs-varid'>pats</span><span class='hs-layout'>)</span>     <span class='hs-comment'>-- A strict variable binding</span>
<a name="line-1244"></a>                   <span class='hs-layout'>(</span><span class='hs-varid'>char</span> <span class='hs-chr'>'!'</span><span class='hs-varop'>&lt;&gt;</span><span class='hs-varid'>pprPrefixOcc</span> <span class='hs-varid'>fun</span><span class='hs-layout'>,</span> <span class='hs-varid'>pats</span><span class='hs-layout'>)</span>
<a name="line-1245"></a>
<a name="line-1246"></a>                <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Prefix</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>fixity</span>
<a name="line-1247"></a>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprPrefixOcc</span> <span class='hs-varid'>fun</span><span class='hs-layout'>,</span> <span class='hs-varid'>pats</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- f x y z = e</span>
<a name="line-1248"></a>                                            <span class='hs-comment'>-- Not pprBndr; the AbsBinds will</span>
<a name="line-1249"></a>                                            <span class='hs-comment'>-- have printed the signature</span>
<a name="line-1250"></a>                <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-1251"></a>                <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>pats</span> <span class='hs-keyword'>of</span>
<a name="line-1252"></a>                     <span class='hs-layout'>(</span><span class='hs-varid'>p1</span><span class='hs-conop'>:</span><span class='hs-varid'>p2</span><span class='hs-conop'>:</span><span class='hs-varid'>rest</span><span class='hs-layout'>)</span>
<a name="line-1253"></a>                        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>null</span> <span class='hs-varid'>rest</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>pp_infix</span><span class='hs-layout'>,</span> <span class='hs-conid'>[]</span><span class='hs-layout'>)</span>           <span class='hs-comment'>-- x &amp;&amp;&amp; y = e</span>
<a name="line-1254"></a>                        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>parens</span> <span class='hs-varid'>pp_infix</span><span class='hs-layout'>,</span> <span class='hs-varid'>rest</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- (x &amp;&amp;&amp; y) z = e</span>
<a name="line-1255"></a>                        <span class='hs-keyword'>where</span>
<a name="line-1256"></a>                          <span class='hs-varid'>pp_infix</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprParendLPat</span> <span class='hs-varid'>opPrec</span> <span class='hs-varid'>p1</span>
<a name="line-1257"></a>                                     <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprInfixOcc</span> <span class='hs-varid'>fun</span>
<a name="line-1258"></a>                                     <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprParendLPat</span> <span class='hs-varid'>opPrec</span> <span class='hs-varid'>p2</span>
<a name="line-1259"></a>                     <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>pprPanic</span> <span class='hs-str'>"pprMatch"</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>ctxt</span> <span class='hs-varop'>$$</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>pats</span><span class='hs-layout'>)</span>
<a name="line-1260"></a>
<a name="line-1261"></a>            <span class='hs-conid'>LambdaExpr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>char</span> <span class='hs-chr'>'\\'</span><span class='hs-layout'>,</span> <span class='hs-varid'>pats</span><span class='hs-layout'>)</span>
<a name="line-1262"></a>
<a name="line-1263"></a>            <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>pats</span> <span class='hs-keyword'>of</span>
<a name="line-1264"></a>                   <span class='hs-conid'>[]</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>empty</span><span class='hs-layout'>,</span> <span class='hs-conid'>[]</span><span class='hs-layout'>)</span>
<a name="line-1265"></a>                   <span class='hs-keyglyph'>[</span><span class='hs-varid'>pat</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>pat</span><span class='hs-layout'>,</span> <span class='hs-conid'>[]</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- No parens around the single pat in a case</span>
<a name="line-1266"></a>                   <span class='hs-keyword'>_</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>pprPanic</span> <span class='hs-str'>"pprMatch"</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>ctxt</span> <span class='hs-varop'>$$</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>pats</span><span class='hs-layout'>)</span>
<a name="line-1267"></a>
<a name="line-1268"></a><a name="pprGRHSs"></a><span class='hs-definition'>pprGRHSs</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>idR</span><span class='hs-layout'>,</span> <span class='hs-conid'>Outputable</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-1269"></a>         <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsMatchContext</span> <span class='hs-varid'>passL</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GRHSs</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1270"></a><span class='hs-definition'>pprGRHSs</span> <span class='hs-varid'>ctxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>GRHSs</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>grhss</span> <span class='hs-varid'>binds</span><span class='hs-layout'>)</span>
<a name="line-1271"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>vcat</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprGRHS</span> <span class='hs-varid'>ctxt</span> <span class='hs-varop'>.</span> <span class='hs-varid'>unLoc</span><span class='hs-layout'>)</span> <span class='hs-varid'>grhss</span><span class='hs-layout'>)</span>
<a name="line-1272"></a>  <span class='hs-comment'>-- Print the "where" even if the contents of the binds is empty. Only</span>
<a name="line-1273"></a>  <span class='hs-comment'>-- EmptyLocalBinds means no "where" keyword</span>
<a name="line-1274"></a> <span class='hs-varop'>$$</span> <span class='hs-varid'>ppUnless</span> <span class='hs-layout'>(</span><span class='hs-varid'>eqEmptyLocalBinds</span> <span class='hs-varid'>binds</span><span class='hs-layout'>)</span>
<a name="line-1275"></a>      <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"where"</span> <span class='hs-varop'>$$</span> <span class='hs-varid'>nest</span> <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprBinds</span> <span class='hs-varid'>binds</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1276"></a>
<a name="line-1277"></a><a name="pprGRHS"></a><span class='hs-definition'>pprGRHS</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>idR</span><span class='hs-layout'>,</span> <span class='hs-conid'>Outputable</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-1278"></a>        <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsMatchContext</span> <span class='hs-varid'>passL</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GRHS</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1279"></a><span class='hs-definition'>pprGRHS</span> <span class='hs-varid'>ctxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>GRHS</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>[]</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-1280"></a> <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>pp_rhs</span> <span class='hs-varid'>ctxt</span> <span class='hs-varid'>body</span>
<a name="line-1281"></a>
<a name="line-1282"></a><span class='hs-definition'>pprGRHS</span> <span class='hs-varid'>ctxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>GRHS</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>guards</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-1283"></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>vbar</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>interpp'SP</span> <span class='hs-varid'>guards</span><span class='hs-layout'>,</span> <span class='hs-varid'>pp_rhs</span> <span class='hs-varid'>ctxt</span> <span class='hs-varid'>body</span><span class='hs-keyglyph'>]</span>
<a name="line-1284"></a>
<a name="line-1285"></a><a name="pp_rhs"></a><span class='hs-definition'>pp_rhs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Outputable</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsMatchContext</span> <span class='hs-varid'>passL</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1286"></a><span class='hs-definition'>pp_rhs</span> <span class='hs-varid'>ctxt</span> <span class='hs-varid'>rhs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>matchSeparator</span> <span class='hs-varid'>ctxt</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprDeeper</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>rhs</span><span class='hs-layout'>)</span>
<a name="line-1287"></a>
<a name="line-1288"></a><a name="instance%20Outputable%20GrhsAnn"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>GrhsAnn</span> <span class='hs-keyword'>where</span>
<a name="line-1289"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GrhsAnn</span> <span class='hs-varid'>v</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"GrhsAnn"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>v</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>s</span>
<a name="line-1290"></a>
<a name="line-1291"></a><span class='hs-comment'>{-
<a name="line-1292"></a>************************************************************************
<a name="line-1293"></a>*                                                                      *
<a name="line-1294"></a>\subsection{Do stmts and list comprehensions}
<a name="line-1295"></a>*                                                                      *
<a name="line-1296"></a>************************************************************************
<a name="line-1297"></a>-}</span>
<a name="line-1298"></a>
<a name="line-1299"></a><a name="RecStmtTc"></a><span class='hs-comment'>-- Extra fields available post typechecking for RecStmt.</span>
<a name="line-1300"></a><a name="RecStmtTc"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>RecStmtTc</span> <span class='hs-keyglyph'>=</span>
<a name="line-1301"></a>  <span class='hs-conid'>RecStmtTc</span>
<a name="line-1302"></a>     <span class='hs-layout'>{</span> <span class='hs-varid'>recS_bind_ty</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Type</span>       <span class='hs-comment'>-- S in (&gt;&gt;=) :: Q -&gt; (R -&gt; S) -&gt; T</span>
<a name="line-1303"></a>     <span class='hs-layout'>,</span> <span class='hs-varid'>recS_later_rets</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>PostTcExpr</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- (only used in the arrow version)</span>
<a name="line-1304"></a>     <span class='hs-layout'>,</span> <span class='hs-varid'>recS_rec_rets</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>PostTcExpr</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- These expressions correspond 1-to-1</span>
<a name="line-1305"></a>                                  <span class='hs-comment'>-- with recS_later_ids and recS_rec_ids,</span>
<a name="line-1306"></a>                                  <span class='hs-comment'>-- and are the expressions that should be</span>
<a name="line-1307"></a>                                  <span class='hs-comment'>-- returned by the recursion.</span>
<a name="line-1308"></a>                                  <span class='hs-comment'>-- They may not quite be the Ids themselves,</span>
<a name="line-1309"></a>                                  <span class='hs-comment'>-- because the Id may be *polymorphic*, but</span>
<a name="line-1310"></a>                                  <span class='hs-comment'>-- the returned thing has to be *monomorphic*,</span>
<a name="line-1311"></a>                                  <span class='hs-comment'>-- so they may be type applications</span>
<a name="line-1312"></a>
<a name="line-1313"></a>      <span class='hs-layout'>,</span> <span class='hs-varid'>recS_ret_ty</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Type</span>        <span class='hs-comment'>-- The type of</span>
<a name="line-1314"></a>                                   <span class='hs-comment'>-- do { stmts; return (a,b,c) }</span>
<a name="line-1315"></a>                                   <span class='hs-comment'>-- With rebindable syntax the type might not</span>
<a name="line-1316"></a>                                   <span class='hs-comment'>-- be quite as simple as (m (tya, tyb, tyc)).</span>
<a name="line-1317"></a>      <span class='hs-layout'>}</span>
<a name="line-1318"></a>
<a name="line-1319"></a>
<a name="line-1320"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XLastStmt</span>        <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1321"></a>
<a name="line-1322"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XBindStmt</span>        <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcPs</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-1323"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XBindStmt</span>        <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcRn</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>XBindStmtRn</span>
<a name="line-1324"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XBindStmt</span>        <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcTc</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>XBindStmtTc</span>
<a name="line-1325"></a>
<a name="line-1326"></a><a name="XBindStmtRn"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>XBindStmtRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>XBindStmtRn</span>
<a name="line-1327"></a>  <span class='hs-layout'>{</span> <span class='hs-varid'>xbsrn_bindOp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SyntaxExpr</span> <span class='hs-conid'>GhcRn</span>
<a name="line-1328"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>xbsrn_failOp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FailOperator</span> <span class='hs-conid'>GhcRn</span>
<a name="line-1329"></a>  <span class='hs-layout'>}</span>
<a name="line-1330"></a>
<a name="line-1331"></a><a name="XBindStmtTc"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>XBindStmtTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>XBindStmtTc</span>
<a name="line-1332"></a>  <span class='hs-layout'>{</span> <span class='hs-varid'>xbstc_bindOp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SyntaxExpr</span> <span class='hs-conid'>GhcTc</span>
<a name="line-1333"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>xbstc_boundResultType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Type</span> <span class='hs-comment'>-- If (&gt;&gt;=) :: Q -&gt; (R -&gt; S) -&gt; T, this is S</span>
<a name="line-1334"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>xbstc_boundResultMult</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Mult</span> <span class='hs-comment'>-- If (&gt;&gt;=) :: Q -&gt; (R -&gt; S) -&gt; T, this is S</span>
<a name="line-1335"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>xbstc_failOp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>FailOperator</span> <span class='hs-conid'>GhcTc</span>
<a name="line-1336"></a>  <span class='hs-layout'>}</span>
<a name="line-1337"></a>
<a name="line-1338"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XApplicativeStmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcPs</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1339"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XApplicativeStmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcRn</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1340"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XApplicativeStmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcTc</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Type</span>
<a name="line-1341"></a>
<a name="line-1342"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XBodyStmt</span>        <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcPs</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1343"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XBodyStmt</span>        <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcRn</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1344"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XBodyStmt</span>        <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcTc</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Type</span>
<a name="line-1345"></a>
<a name="line-1346"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XLetStmt</span>         <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-1347"></a>
<a name="line-1348"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XParStmt</span>         <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcPs</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1349"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XParStmt</span>         <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcRn</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1350"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XParStmt</span>         <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcTc</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Type</span>
<a name="line-1351"></a>
<a name="line-1352"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XTransStmt</span>       <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcPs</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-1353"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XTransStmt</span>       <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcRn</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1354"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XTransStmt</span>       <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcTc</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Type</span>
<a name="line-1355"></a>
<a name="line-1356"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XRecStmt</span>         <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcPs</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-conid'>AnnList</span>
<a name="line-1357"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XRecStmt</span>         <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcRn</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1358"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XRecStmt</span>         <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-conid'>GhcTc</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>RecStmtTc</span>
<a name="line-1359"></a>
<a name="line-1360"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXStmtLR</span>         <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-1361"></a>
<a name="line-1362"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XParStmtBlock</span>  <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pL</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pR</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1363"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXParStmtBlock</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pL</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pR</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-1364"></a>
<a name="line-1365"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XApplicativeArgOne</span> <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1366"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XApplicativeArgOne</span> <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>FailOperator</span> <span class='hs-conid'>GhcRn</span>
<a name="line-1367"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XApplicativeArgOne</span> <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>FailOperator</span> <span class='hs-conid'>GhcTc</span>
<a name="line-1368"></a>
<a name="line-1369"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XApplicativeArgMany</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1370"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXApplicativeArg</span>    <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-1371"></a>
<a name="line-1372"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>ApplicativeArgStmCtxPass</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>GhcRn</span>
<a name="line-1373"></a>
<a name="line-1374"></a><a name="instance%20Outputable%20(ParStmtBlock%20(GhcPass%20idL)%20(GhcPass%20idR))"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-1375"></a>          <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>XXParStmtBlock</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1376"></a>        <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>ParStmtBlock</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-1377"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>ParStmtBlock</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>stmts</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>interpp'SP</span> <span class='hs-varid'>stmts</span>
<a name="line-1378"></a>
<a name="line-1379"></a><a name="instance%20Outputable%20(StmtLR%20(GhcPass%20pl)%20(GhcPass%20pr)%20body)"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>pl</span><span class='hs-layout'>,</span> <span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>pr</span><span class='hs-layout'>,</span>
<a name="line-1380"></a>                 <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pl</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>~</span> <span class='hs-conid'>SrcSpanAnnA</span><span class='hs-layout'>,</span>
<a name="line-1381"></a>          <span class='hs-conid'>Outputable</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-1382"></a>         <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pl</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-1383"></a>    <span class='hs-varid'>ppr</span> <span class='hs-varid'>stmt</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprStmt</span> <span class='hs-varid'>stmt</span>
<a name="line-1384"></a>
<a name="line-1385"></a><a name="pprStmt"></a><span class='hs-definition'>pprStmt</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>idL</span> <span class='hs-varid'>idR</span> <span class='hs-varid'>body</span> <span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>idL</span><span class='hs-layout'>,</span>
<a name="line-1386"></a>                                  <span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>idR</span><span class='hs-layout'>,</span>
<a name="line-1387"></a>                 <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>~</span> <span class='hs-conid'>SrcSpanAnnA</span><span class='hs-layout'>,</span>
<a name="line-1388"></a>                                  <span class='hs-conid'>Outputable</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-1389"></a>        <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1390"></a><span class='hs-definition'>pprStmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>LastStmt</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>expr</span> <span class='hs-varid'>m_dollar_stripped</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>
<a name="line-1391"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>whenPprDebug</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"[last]"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span>
<a name="line-1392"></a>      <span class='hs-layout'>(</span><span class='hs-keyword'>case</span> <span class='hs-varid'>m_dollar_stripped</span> <span class='hs-keyword'>of</span>
<a name="line-1393"></a>        <span class='hs-conid'>Just</span> <span class='hs-conid'>True</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"return $"</span>
<a name="line-1394"></a>        <span class='hs-conid'>Just</span> <span class='hs-conid'>False</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"return"</span>
<a name="line-1395"></a>        <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>empty</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span>
<a name="line-1396"></a>      <span class='hs-varid'>ppr</span> <span class='hs-varid'>expr</span>
<a name="line-1397"></a><span class='hs-definition'>pprStmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>BindStmt</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pat</span> <span class='hs-varid'>expr</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprBindStmt</span> <span class='hs-varid'>pat</span> <span class='hs-varid'>expr</span>
<a name="line-1398"></a><span class='hs-definition'>pprStmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>LetStmt</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>binds</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>text</span> <span class='hs-str'>"let"</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprBinds</span> <span class='hs-varid'>binds</span><span class='hs-keyglyph'>]</span>
<a name="line-1399"></a><span class='hs-definition'>pprStmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>BodyStmt</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>expr</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>expr</span>
<a name="line-1400"></a><span class='hs-definition'>pprStmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>ParStmt</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>stmtss</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>punctuate</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>" | "</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>stmtss</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1401"></a>
<a name="line-1402"></a><span class='hs-definition'>pprStmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>TransStmt</span> <span class='hs-layout'>{</span> <span class='hs-varid'>trS_stmts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>stmts</span><span class='hs-layout'>,</span> <span class='hs-varid'>trS_by</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>by</span>
<a name="line-1403"></a>                   <span class='hs-layout'>,</span> <span class='hs-varid'>trS_using</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>using</span><span class='hs-layout'>,</span> <span class='hs-varid'>trS_form</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>form</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-1404"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-varop'>$</span> <span class='hs-varid'>punctuate</span> <span class='hs-varid'>comma</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>stmts</span> <span class='hs-varop'>++</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pprTransStmt</span> <span class='hs-varid'>by</span> <span class='hs-varid'>using</span> <span class='hs-varid'>form</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1405"></a>
<a name="line-1406"></a><span class='hs-definition'>pprStmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>RecStmt</span> <span class='hs-layout'>{</span> <span class='hs-varid'>recS_stmts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>segment</span><span class='hs-layout'>,</span> <span class='hs-varid'>recS_rec_ids</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rec_ids</span>
<a name="line-1407"></a>                 <span class='hs-layout'>,</span> <span class='hs-varid'>recS_later_ids</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>later_ids</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-1408"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"rec"</span> <span class='hs-varop'>&lt;+&gt;</span>
<a name="line-1409"></a>    <span class='hs-varid'>vcat</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>ppr_do_stmts</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>segment</span><span class='hs-layout'>)</span>
<a name="line-1410"></a>         <span class='hs-layout'>,</span> <span class='hs-varid'>whenPprDebug</span> <span class='hs-layout'>(</span><span class='hs-varid'>vcat</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>text</span> <span class='hs-str'>"rec_ids="</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>rec_ids</span>
<a name="line-1411"></a>                            <span class='hs-layout'>,</span> <span class='hs-varid'>text</span> <span class='hs-str'>"later_ids="</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>later_ids</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-1412"></a>
<a name="line-1413"></a><span class='hs-definition'>pprStmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>ApplicativeStmt</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>args</span> <span class='hs-varid'>mb_join</span><span class='hs-layout'>)</span>
<a name="line-1414"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>getPprStyle</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>style</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-1415"></a>      <span class='hs-keyword'>if</span> <span class='hs-varid'>userStyle</span> <span class='hs-varid'>style</span>
<a name="line-1416"></a>         <span class='hs-keyword'>then</span> <span class='hs-varid'>pp_for_user</span>
<a name="line-1417"></a>         <span class='hs-keyword'>else</span> <span class='hs-varid'>pp_debug</span>
<a name="line-1418"></a>  <span class='hs-keyword'>where</span>
<a name="line-1419"></a>  <span class='hs-comment'>-- make all the Applicative stuff invisible in error messages by</span>
<a name="line-1420"></a>  <span class='hs-comment'>-- flattening the whole ApplicativeStmt nest back to a sequence</span>
<a name="line-1421"></a>  <span class='hs-comment'>-- of statements.</span>
<a name="line-1422"></a>   <span class='hs-varid'>pp_for_user</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>vcat</span> <span class='hs-varop'>$</span> <span class='hs-varid'>concatMap</span> <span class='hs-varid'>flattenArg</span> <span class='hs-varid'>args</span>
<a name="line-1423"></a>
<a name="line-1424"></a>   <span class='hs-comment'>-- ppr directly rather than transforming here, because we need to</span>
<a name="line-1425"></a>   <span class='hs-comment'>-- inject a "return" which is hard when we're polymorphic in the id</span>
<a name="line-1426"></a>   <span class='hs-comment'>-- type.</span>
<a name="line-1427"></a>   <span class='hs-varid'>flattenStmt</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ExprLStmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>SDoc</span><span class='hs-keyglyph'>]</span>
<a name="line-1428"></a>   <span class='hs-varid'>flattenStmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>ApplicativeStmt</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>args</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>concatMap</span> <span class='hs-varid'>flattenArg</span> <span class='hs-varid'>args</span>
<a name="line-1429"></a>   <span class='hs-varid'>flattenStmt</span> <span class='hs-varid'>stmt</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>stmt</span><span class='hs-keyglyph'>]</span>
<a name="line-1430"></a>
<a name="line-1431"></a>   <span class='hs-varid'>flattenArg</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>a</span> <span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>ApplicativeArg</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>SDoc</span><span class='hs-keyglyph'>]</span>
<a name="line-1432"></a>   <span class='hs-varid'>flattenArg</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-conid'>ApplicativeArgOne</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pat</span> <span class='hs-varid'>expr</span> <span class='hs-varid'>isBody</span><span class='hs-layout'>)</span>
<a name="line-1433"></a>     <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isBody</span> <span class='hs-keyglyph'>=</span>  <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>expr</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- See Note [Applicative BodyStmt]</span>
<a name="line-1434"></a>     <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pprBindStmt</span> <span class='hs-varid'>pat</span> <span class='hs-varid'>expr</span><span class='hs-keyglyph'>]</span>
<a name="line-1435"></a>   <span class='hs-varid'>flattenArg</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-conid'>ApplicativeArgMany</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>stmts</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-1436"></a>     <span class='hs-varid'>concatMap</span> <span class='hs-varid'>flattenStmt</span> <span class='hs-varid'>stmts</span>
<a name="line-1437"></a>
<a name="line-1438"></a>   <span class='hs-varid'>pp_debug</span> <span class='hs-keyglyph'>=</span>
<a name="line-1439"></a>     <span class='hs-keyword'>let</span>
<a name="line-1440"></a>         <span class='hs-varid'>ap_expr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>punctuate</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>" |"</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>pp_arg</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1441"></a>     <span class='hs-keyword'>in</span>
<a name="line-1442"></a>       <span class='hs-varid'>whenPprDebug</span> <span class='hs-layout'>(</span><span class='hs-keyword'>if</span> <span class='hs-varid'>isJust</span> <span class='hs-varid'>mb_join</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>text</span> <span class='hs-str'>"[join]"</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>empty</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span>
<a name="line-1443"></a>       <span class='hs-layout'>(</span><span class='hs-keyword'>if</span> <span class='hs-varid'>lengthAtLeast</span> <span class='hs-varid'>args</span> <span class='hs-num'>2</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>parens</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span> <span class='hs-varid'>ap_expr</span>
<a name="line-1444"></a>
<a name="line-1445"></a>   <span class='hs-varid'>pp_arg</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>ApplicativeArg</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1446"></a>   <span class='hs-varid'>pp_arg</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>applicativeArg</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>applicativeArg</span>
<a name="line-1447"></a>
<a name="line-1448"></a><a name="pprBindStmt"></a><span class='hs-definition'>pprBindStmt</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Outputable</span> <span class='hs-varid'>pat</span><span class='hs-layout'>,</span> <span class='hs-conid'>Outputable</span> <span class='hs-varid'>expr</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>pat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>expr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1449"></a><span class='hs-definition'>pprBindStmt</span> <span class='hs-varid'>pat</span> <span class='hs-varid'>expr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>pat</span><span class='hs-layout'>,</span> <span class='hs-varid'>larrow</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>expr</span><span class='hs-keyglyph'>]</span>
<a name="line-1450"></a>
<a name="line-1451"></a><a name="instance%20Outputable%20(ApplicativeArg%20(GhcPass%20idL))"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span>
<a name="line-1452"></a>      <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>ApplicativeArg</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-1453"></a>  <span class='hs-varid'>ppr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprArg</span>
<a name="line-1454"></a>
<a name="line-1455"></a><a name="pprArg"></a><span class='hs-definition'>pprArg</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>idL</span> <span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>ApplicativeArg</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1456"></a><span class='hs-definition'>pprArg</span> <span class='hs-layout'>(</span><span class='hs-conid'>ApplicativeArgOne</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pat</span> <span class='hs-varid'>expr</span> <span class='hs-varid'>isBody</span><span class='hs-layout'>)</span>
<a name="line-1457"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isBody</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>expr</span> <span class='hs-comment'>-- See Note [Applicative BodyStmt]</span>
<a name="line-1458"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprBindStmt</span> <span class='hs-varid'>pat</span> <span class='hs-varid'>expr</span>
<a name="line-1459"></a><span class='hs-definition'>pprArg</span> <span class='hs-layout'>(</span><span class='hs-conid'>ApplicativeArgMany</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>stmts</span> <span class='hs-varid'>return</span> <span class='hs-varid'>pat</span> <span class='hs-varid'>ctxt</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-1460"></a>     <span class='hs-varid'>ppr</span> <span class='hs-varid'>pat</span> <span class='hs-varop'>&lt;+&gt;</span>
<a name="line-1461"></a>     <span class='hs-varid'>text</span> <span class='hs-str'>"&lt;-"</span> <span class='hs-varop'>&lt;+&gt;</span>
<a name="line-1462"></a>     <span class='hs-varid'>pprDo</span> <span class='hs-varid'>ctxt</span> <span class='hs-layout'>(</span><span class='hs-varid'>stmts</span> <span class='hs-varop'>++</span>
<a name="line-1463"></a>                   <span class='hs-keyglyph'>[</span><span class='hs-varid'>noLocA</span> <span class='hs-layout'>(</span><span class='hs-conid'>LastStmt</span> <span class='hs-varid'>noExtField</span> <span class='hs-layout'>(</span><span class='hs-varid'>noLocA</span> <span class='hs-varid'>return</span><span class='hs-layout'>)</span> <span class='hs-conid'>Nothing</span> <span class='hs-varid'>noSyntaxExpr</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-1464"></a>
<a name="line-1465"></a><a name="pprTransformStmt"></a><span class='hs-definition'>pprTransformStmt</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1466"></a>                 <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IdP</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1467"></a>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>LHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1468"></a><span class='hs-definition'>pprTransformStmt</span> <span class='hs-varid'>bndrs</span> <span class='hs-varid'>using</span> <span class='hs-varid'>by</span>
<a name="line-1469"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>text</span> <span class='hs-str'>"then"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>whenPprDebug</span> <span class='hs-layout'>(</span><span class='hs-varid'>braces</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>bndrs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1470"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>using</span><span class='hs-layout'>)</span>
<a name="line-1471"></a>        <span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprBy</span> <span class='hs-varid'>by</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-1472"></a>
<a name="line-1473"></a><a name="pprTransStmt"></a><span class='hs-definition'>pprTransStmt</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Outputable</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TransForm</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1474"></a><span class='hs-definition'>pprTransStmt</span> <span class='hs-varid'>by</span> <span class='hs-varid'>using</span> <span class='hs-conid'>ThenForm</span>
<a name="line-1475"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>text</span> <span class='hs-str'>"then"</span><span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>using</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprBy</span> <span class='hs-varid'>by</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-1476"></a><span class='hs-definition'>pprTransStmt</span> <span class='hs-varid'>by</span> <span class='hs-varid'>using</span> <span class='hs-conid'>GroupForm</span>
<a name="line-1477"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>text</span> <span class='hs-str'>"then group"</span><span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprBy</span> <span class='hs-varid'>by</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>nest</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"using"</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>using</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-1478"></a>
<a name="line-1479"></a><a name="pprBy"></a><span class='hs-definition'>pprBy</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Outputable</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1480"></a><span class='hs-definition'>pprBy</span> <span class='hs-conid'>Nothing</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
<a name="line-1481"></a><span class='hs-definition'>pprBy</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"by"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>e</span>
<a name="line-1482"></a>
<a name="line-1483"></a><a name="pprDo"></a><span class='hs-definition'>pprDo</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>,</span> <span class='hs-conid'>Outputable</span> <span class='hs-varid'>body</span><span class='hs-layout'>,</span>
<a name="line-1484"></a>                 <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>~</span> <span class='hs-conid'>SrcSpanAnnA</span>
<a name="line-1485"></a>         <span class='hs-layout'>)</span>
<a name="line-1486"></a>      <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsStmtContext</span> <span class='hs-varid'>any</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LStmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1487"></a><span class='hs-definition'>pprDo</span> <span class='hs-layout'>(</span><span class='hs-conid'>DoExpr</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span>    <span class='hs-varid'>stmts</span> <span class='hs-keyglyph'>=</span>
<a name="line-1488"></a>  <span class='hs-varid'>ppr_module_name_prefix</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"do"</span>  <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr_do_stmts</span> <span class='hs-varid'>stmts</span>
<a name="line-1489"></a><span class='hs-definition'>pprDo</span> <span class='hs-conid'>GhciStmtCtxt</span>  <span class='hs-varid'>stmts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"do"</span>  <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr_do_stmts</span> <span class='hs-varid'>stmts</span>
<a name="line-1490"></a><span class='hs-definition'>pprDo</span> <span class='hs-conid'>ArrowExpr</span>     <span class='hs-varid'>stmts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"do"</span>  <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr_do_stmts</span> <span class='hs-varid'>stmts</span>
<a name="line-1491"></a><span class='hs-definition'>pprDo</span> <span class='hs-layout'>(</span><span class='hs-conid'>MDoExpr</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span>   <span class='hs-varid'>stmts</span> <span class='hs-keyglyph'>=</span>
<a name="line-1492"></a>  <span class='hs-varid'>ppr_module_name_prefix</span> <span class='hs-varid'>m</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"mdo"</span>  <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr_do_stmts</span> <span class='hs-varid'>stmts</span>
<a name="line-1493"></a><span class='hs-definition'>pprDo</span> <span class='hs-conid'>ListComp</span>      <span class='hs-varid'>stmts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>brackets</span>    <span class='hs-varop'>$</span> <span class='hs-varid'>pprComp</span> <span class='hs-varid'>stmts</span>
<a name="line-1494"></a><span class='hs-definition'>pprDo</span> <span class='hs-conid'>MonadComp</span>     <span class='hs-varid'>stmts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>brackets</span>    <span class='hs-varop'>$</span> <span class='hs-varid'>pprComp</span> <span class='hs-varid'>stmts</span>
<a name="line-1495"></a><span class='hs-definition'>pprDo</span> <span class='hs-keyword'>_</span>             <span class='hs-keyword'>_</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>panic</span> <span class='hs-str'>"pprDo"</span> <span class='hs-comment'>-- PatGuard, ParStmtCxt</span>
<a name="line-1496"></a>
<a name="line-1497"></a><a name="ppr_module_name_prefix"></a><span class='hs-definition'>ppr_module_name_prefix</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>ModuleName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1498"></a><span class='hs-definition'>ppr_module_name_prefix</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>\</span><span class='hs-keyword'>case</span>
<a name="line-1499"></a>  <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>empty</span>
<a name="line-1500"></a>  <span class='hs-conid'>Just</span> <span class='hs-varid'>module_name</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>module_name</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'.'</span>
<a name="line-1501"></a>
<a name="line-1502"></a><a name="ppr_do_stmts"></a><span class='hs-definition'>ppr_do_stmts</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>idL</span><span class='hs-layout'>,</span> <span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>idR</span><span class='hs-layout'>,</span>
<a name="line-1503"></a>                 <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>~</span> <span class='hs-conid'>SrcSpanAnnA</span><span class='hs-layout'>,</span>
<a name="line-1504"></a>                 <span class='hs-conid'>Outputable</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-1505"></a>             <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LStmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1506"></a><span class='hs-comment'>-- Print a bunch of do stmts</span>
<a name="line-1507"></a><span class='hs-definition'>ppr_do_stmts</span> <span class='hs-varid'>stmts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprDeeperList</span> <span class='hs-varid'>vcat</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>stmts</span><span class='hs-layout'>)</span>
<a name="line-1508"></a>
<a name="line-1509"></a><a name="pprComp"></a><span class='hs-definition'>pprComp</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>,</span> <span class='hs-conid'>Outputable</span> <span class='hs-varid'>body</span><span class='hs-layout'>,</span>
<a name="line-1510"></a>                 <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>~</span> <span class='hs-conid'>SrcSpanAnnA</span><span class='hs-layout'>)</span>
<a name="line-1511"></a>        <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LStmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1512"></a><span class='hs-definition'>pprComp</span> <span class='hs-varid'>quals</span>     <span class='hs-comment'>-- Prints:  body | qual1, ..., qualn</span>
<a name="line-1513"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>initStmts</span><span class='hs-layout'>,</span> <span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>LastStmt</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>body</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>snocView</span> <span class='hs-varid'>quals</span>
<a name="line-1514"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>null</span> <span class='hs-varid'>initStmts</span>
<a name="line-1515"></a>       <span class='hs-comment'>-- If there are no statements in a list comprehension besides the last</span>
<a name="line-1516"></a>       <span class='hs-comment'>-- one, we simply treat it like a normal list. This does arise</span>
<a name="line-1517"></a>       <span class='hs-comment'>-- occasionally in code that GHC generates, e.g., in implementations of</span>
<a name="line-1518"></a>       <span class='hs-comment'>-- 'range' for derived 'Ix' instances for product datatypes with exactly</span>
<a name="line-1519"></a>       <span class='hs-comment'>-- one constructor (e.g., see #12583).</span>
<a name="line-1520"></a>       <span class='hs-keyword'>then</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>body</span>
<a name="line-1521"></a>       <span class='hs-keyword'>else</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>body</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>vbar</span><span class='hs-layout'>)</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprQuals</span> <span class='hs-varid'>initStmts</span><span class='hs-layout'>)</span>
<a name="line-1522"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<a name="line-1523"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPanic</span> <span class='hs-str'>"pprComp"</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprQuals</span> <span class='hs-varid'>quals</span><span class='hs-layout'>)</span>
<a name="line-1524"></a>
<a name="line-1525"></a><a name="pprQuals"></a><span class='hs-definition'>pprQuals</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>,</span> <span class='hs-conid'>Outputable</span> <span class='hs-varid'>body</span><span class='hs-layout'>,</span>
<a name="line-1526"></a>                 <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>~</span> <span class='hs-conid'>SrcSpanAnnA</span><span class='hs-layout'>)</span>
<a name="line-1527"></a>         <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LStmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1528"></a><span class='hs-comment'>-- Show list comprehension qualifiers separated by commas</span>
<a name="line-1529"></a><span class='hs-definition'>pprQuals</span> <span class='hs-varid'>quals</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>interpp'SP</span> <span class='hs-varid'>quals</span>
<a name="line-1530"></a>
<a name="line-1531"></a><span class='hs-comment'>{-
<a name="line-1532"></a>************************************************************************
<a name="line-1533"></a>*                                                                      *
<a name="line-1534"></a>                Template Haskell quotation brackets
<a name="line-1535"></a>*                                                                      *
<a name="line-1536"></a>************************************************************************
<a name="line-1537"></a>-}</span>
<a name="line-1538"></a>
<a name="line-1539"></a><a name="HsSplicedT"></a><span class='hs-keyword'>newtype</span> <span class='hs-conid'>HsSplicedT</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HsSplicedT</span> <span class='hs-conid'>DelayedSplice</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span><span class='hs-layout'>)</span>
<a name="line-1540"></a>
<a name="line-1541"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XTypedSplice</span>   <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-1542"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XUntypedSplice</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EpAnn</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>AddEpAnn</span><span class='hs-keyglyph'>]</span>
<a name="line-1543"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XQuasiQuote</span>    <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1544"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XSpliced</span>       <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1545"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXSplice</span>       <span class='hs-conid'>GhcPs</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-1546"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXSplice</span>       <span class='hs-conid'>GhcRn</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-1547"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXSplice</span>       <span class='hs-conid'>GhcTc</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HsSplicedT</span>
<a name="line-1548"></a>
<a name="line-1549"></a><a name="DelayedSplice"></a><span class='hs-comment'>-- See Note [Running typed splices in the zonker]</span>
<a name="line-1550"></a><a name="DelayedSplice"></a><span class='hs-comment'>-- These are the arguments that are passed to `GHC.Tc.Gen.Splice.runTopSplice`</span>
<a name="line-1551"></a><a name="DelayedSplice"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>DelayedSplice</span> <span class='hs-keyglyph'>=</span>
<a name="line-1552"></a>  <span class='hs-conid'>DelayedSplice</span>
<a name="line-1553"></a>    <span class='hs-conid'>TcLclEnv</span>          <span class='hs-comment'>-- The local environment to run the splice in</span>
<a name="line-1554"></a>    <span class='hs-layout'>(</span><span class='hs-conid'>LHsExpr</span> <span class='hs-conid'>GhcRn</span><span class='hs-layout'>)</span>   <span class='hs-comment'>-- The original renamed expression</span>
<a name="line-1555"></a>    <span class='hs-conid'>TcType</span>            <span class='hs-comment'>-- The result type of running the splice, unzonked</span>
<a name="line-1556"></a>    <span class='hs-layout'>(</span><span class='hs-conid'>LHsExpr</span> <span class='hs-conid'>GhcTc</span><span class='hs-layout'>)</span>   <span class='hs-comment'>-- The typechecked expression to run and splice in the result</span>
<a name="line-1557"></a>
<a name="line-1558"></a><a name="instance%20Data%20DelayedSplice"></a><span class='hs-comment'>-- A Data instance which ignores the argument of 'DelayedSplice'.</span>
<a name="line-1559"></a><a name="instance%20Data%20DelayedSplice"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>DelayedSplice</span> <span class='hs-keyword'>where</span>
<a name="line-1560"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>panic</span> <span class='hs-str'>"DelayedSplice"</span>
<a name="line-1561"></a>  <span class='hs-varid'>toConstr</span>  <span class='hs-varid'>a</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkConstr</span> <span class='hs-layout'>(</span><span class='hs-varid'>dataTypeOf</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-str'>"DelayedSplice"</span> <span class='hs-conid'>[]</span> <span class='hs-conid'>Data.Prefix</span>
<a name="line-1562"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-varid'>a</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkDataType</span> <span class='hs-str'>"HsExpr.DelayedSplice"</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>toConstr</span> <span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<a name="line-1563"></a>
<a name="line-1564"></a><a name="PendingRnSplice"></a><span class='hs-comment'>-- | Pending Renamer Splice</span>
<a name="line-1565"></a><a name="PendingRnSplice"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>PendingRnSplice</span>
<a name="line-1566"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PendingRnSplice</span> <span class='hs-conid'>UntypedSpliceFlavour</span> <span class='hs-conid'>SplicePointName</span> <span class='hs-layout'>(</span><span class='hs-conid'>LHsExpr</span> <span class='hs-conid'>GhcRn</span><span class='hs-layout'>)</span>
<a name="line-1567"></a>
<a name="line-1568"></a><a name="PendingTcSplice"></a><span class='hs-comment'>-- | Pending Type-checker Splice</span>
<a name="line-1569"></a><a name="PendingTcSplice"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>PendingTcSplice</span>
<a name="line-1570"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PendingTcSplice</span> <span class='hs-conid'>SplicePointName</span> <span class='hs-layout'>(</span><span class='hs-conid'>LHsExpr</span> <span class='hs-conid'>GhcTc</span><span class='hs-layout'>)</span>
<a name="line-1571"></a>
<a name="line-1572"></a><span class='hs-comment'>{-
<a name="line-1573"></a>Note [Pending Splices]
<a name="line-1574"></a>~~~~~~~~~~~~~~~~~~~~~~
<a name="line-1575"></a>When we rename an untyped bracket, we name and lift out all the nested
<a name="line-1576"></a>splices, so that when the typechecker hits the bracket, it can
<a name="line-1577"></a>typecheck those nested splices without having to walk over the untyped
<a name="line-1578"></a>bracket code.  So for example
<a name="line-1579"></a>    [| f $(g x) |]
<a name="line-1580"></a>looks like
<a name="line-1581"></a>
<a name="line-1582"></a>    HsBracket (HsApp (HsVar "f") (HsSpliceE _ (g x)))
<a name="line-1583"></a>
<a name="line-1584"></a>which the renamer rewrites to
<a name="line-1585"></a>
<a name="line-1586"></a>    HsRnBracketOut (HsApp (HsVar f) (HsSpliceE sn (g x)))
<a name="line-1587"></a>                   [PendingRnSplice UntypedExpSplice sn (g x)]
<a name="line-1588"></a>
<a name="line-1589"></a>* The 'sn' is the Name of the splice point, the SplicePointName
<a name="line-1590"></a>
<a name="line-1591"></a>* The PendingRnExpSplice gives the splice that splice-point name maps to;
<a name="line-1592"></a>  and the typechecker can now conveniently find these sub-expressions
<a name="line-1593"></a>
<a name="line-1594"></a>* The other copy of the splice, in the second argument of HsSpliceE
<a name="line-1595"></a>                                in the renamed first arg of HsRnBracketOut
<a name="line-1596"></a>  is used only for pretty printing
<a name="line-1597"></a>
<a name="line-1598"></a>There are four varieties of pending splices generated by the renamer,
<a name="line-1599"></a>distinguished by their UntypedSpliceFlavour
<a name="line-1600"></a>
<a name="line-1601"></a> * Pending expression splices (UntypedExpSplice), e.g.,
<a name="line-1602"></a>       [|$(f x) + 2|]
<a name="line-1603"></a>
<a name="line-1604"></a>   UntypedExpSplice is also used for
<a name="line-1605"></a>     * quasi-quotes, where the pending expression expands to
<a name="line-1606"></a>          $(quoter "...blah...")
<a name="line-1607"></a>       (see GHC.Rename.Splice.makePending, HsQuasiQuote case)
<a name="line-1608"></a>
<a name="line-1609"></a>     * cross-stage lifting, where the pending expression expands to
<a name="line-1610"></a>          $(lift x)
<a name="line-1611"></a>       (see GHC.Rename.Splice.checkCrossStageLifting)
<a name="line-1612"></a>
<a name="line-1613"></a> * Pending pattern splices (UntypedPatSplice), e.g.,
<a name="line-1614"></a>       [| \$(f x) -&gt; x |]
<a name="line-1615"></a>
<a name="line-1616"></a> * Pending type splices (UntypedTypeSplice), e.g.,
<a name="line-1617"></a>       [| f :: $(g x) |]
<a name="line-1618"></a>
<a name="line-1619"></a> * Pending declaration (UntypedDeclSplice), e.g.,
<a name="line-1620"></a>       [| let $(f x) in ... |]
<a name="line-1621"></a>
<a name="line-1622"></a>There is a fifth variety of pending splice, which is generated by the type
<a name="line-1623"></a>checker:
<a name="line-1624"></a>
<a name="line-1625"></a>  * Pending *typed* expression splices, (PendingTcSplice), e.g.,
<a name="line-1626"></a>        [||1 + $$(f 2)||]
<a name="line-1627"></a>
<a name="line-1628"></a>It would be possible to eliminate HsRnBracketOut and use HsBracketOut for the
<a name="line-1629"></a>output of the renamer. However, when pretty printing the output of the renamer,
<a name="line-1630"></a>e.g., in a type error message, we *do not* want to print out the pending
<a name="line-1631"></a>splices. In contrast, when pretty printing the output of the type checker, we
<a name="line-1632"></a>*do* want to print the pending splices. So splitting them up seems to make
<a name="line-1633"></a>sense, although I hate to add another constructor to HsExpr.
<a name="line-1634"></a>-}</span>
<a name="line-1635"></a>
<a name="line-1636"></a><a name="instance%20Outputable%20(HsSplicedThing%20(GhcPass%20p))"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span>
<a name="line-1637"></a>       <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsSplicedThing</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-1638"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsSplicedExpr</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_expr</span> <span class='hs-varid'>e</span>
<a name="line-1639"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsSplicedTy</span>   <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>t</span>
<a name="line-1640"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsSplicedPat</span>  <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>p</span>
<a name="line-1641"></a>
<a name="line-1642"></a><a name="instance%20Outputable%20(HsSplice%20(GhcPass%20p))"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsSplice</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-1643"></a>  <span class='hs-varid'>ppr</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprSplice</span> <span class='hs-varid'>s</span>
<a name="line-1644"></a>
<a name="line-1645"></a><a name="pprPendingSplice"></a><span class='hs-definition'>pprPendingSplice</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1646"></a>                 <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>SplicePointName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1647"></a><span class='hs-definition'>pprPendingSplice</span> <span class='hs-varid'>n</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>angleBrackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>comma</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-varid'>stripParensLHsExpr</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1648"></a>
<a name="line-1649"></a><a name="pprSpliceDecl"></a><span class='hs-definition'>pprSpliceDecl</span> <span class='hs-keyglyph'>::</span>  <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1650"></a>          <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsSplice</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SpliceExplicitFlag</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1651"></a><span class='hs-definition'>pprSpliceDecl</span> <span class='hs-varid'>e</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>HsQuasiQuote</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprSplice</span> <span class='hs-varid'>e</span>
<a name="line-1652"></a><span class='hs-definition'>pprSpliceDecl</span> <span class='hs-varid'>e</span> <span class='hs-conid'>ExplicitSplice</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"$"</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr_splice_decl</span> <span class='hs-varid'>e</span>
<a name="line-1653"></a><span class='hs-definition'>pprSpliceDecl</span> <span class='hs-varid'>e</span> <span class='hs-conid'>ImplicitSplice</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_splice_decl</span> <span class='hs-varid'>e</span>
<a name="line-1654"></a>
<a name="line-1655"></a><a name="ppr_splice_decl"></a><span class='hs-definition'>ppr_splice_decl</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1656"></a>                <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsSplice</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1657"></a><span class='hs-definition'>ppr_splice_decl</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsUntypedSplice</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>n</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_splice</span> <span class='hs-varid'>empty</span> <span class='hs-varid'>n</span> <span class='hs-varid'>e</span> <span class='hs-varid'>empty</span>
<a name="line-1658"></a><span class='hs-definition'>ppr_splice_decl</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprSplice</span> <span class='hs-varid'>e</span>
<a name="line-1659"></a>
<a name="line-1660"></a><a name="pprSplice"></a><span class='hs-definition'>pprSplice</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>p</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsSplice</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1661"></a><span class='hs-definition'>pprSplice</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsTypedSplice</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>DollarSplice</span> <span class='hs-varid'>n</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-1662"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_splice</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"$$"</span><span class='hs-layout'>)</span> <span class='hs-varid'>n</span> <span class='hs-varid'>e</span> <span class='hs-varid'>empty</span>
<a name="line-1663"></a><span class='hs-definition'>pprSplice</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsTypedSplice</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>BareSplice</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>)</span>
<a name="line-1664"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>panic</span> <span class='hs-str'>"Bare typed splice"</span>  <span class='hs-comment'>-- impossible</span>
<a name="line-1665"></a><span class='hs-definition'>pprSplice</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsUntypedSplice</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>DollarSplice</span> <span class='hs-varid'>n</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-1666"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_splice</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"$"</span><span class='hs-layout'>)</span>  <span class='hs-varid'>n</span> <span class='hs-varid'>e</span> <span class='hs-varid'>empty</span>
<a name="line-1667"></a><span class='hs-definition'>pprSplice</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsUntypedSplice</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>BareSplice</span> <span class='hs-varid'>n</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-1668"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_splice</span> <span class='hs-varid'>empty</span>  <span class='hs-varid'>n</span> <span class='hs-varid'>e</span> <span class='hs-varid'>empty</span>
<a name="line-1669"></a><span class='hs-definition'>pprSplice</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsQuasiQuote</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>n</span> <span class='hs-varid'>q</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr_quasi</span> <span class='hs-varid'>n</span> <span class='hs-varid'>q</span> <span class='hs-varid'>s</span>
<a name="line-1670"></a><span class='hs-definition'>pprSplice</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsSpliced</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>thing</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>thing</span>
<a name="line-1671"></a><span class='hs-definition'>pprSplice</span> <span class='hs-layout'>(</span><span class='hs-conid'>XSplice</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>                   <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>ghcPass</span> <span class='hs-keyglyph'>@</span><span class='hs-varid'>p</span> <span class='hs-keyword'>of</span>
<a name="line-1672"></a><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &lt; 811</span>
<a name="line-1673"></a>                                            <span class='hs-conid'>GhcPs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>noExtCon</span> <span class='hs-varid'>x</span>
<a name="line-1674"></a>                                            <span class='hs-conid'>GhcRn</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>noExtCon</span> <span class='hs-varid'>x</span>
<a name="line-1675"></a><span class='hs-cpp'>#endif</span>
<a name="line-1676"></a>                                            <span class='hs-conid'>GhcTc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>of</span>
<a name="line-1677"></a>                                                       <span class='hs-conid'>HsSplicedT</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"Unevaluated typed splice"</span>
<a name="line-1678"></a>
<a name="line-1679"></a><a name="ppr_quasi"></a><span class='hs-definition'>ppr_quasi</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>OutputableBndr</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>FastString</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1680"></a><span class='hs-definition'>ppr_quasi</span> <span class='hs-varid'>n</span> <span class='hs-varid'>quoter</span> <span class='hs-varid'>quote</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>whenPprDebug</span> <span class='hs-layout'>(</span><span class='hs-varid'>brackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;&gt;</span>
<a name="line-1681"></a>                           <span class='hs-varid'>char</span> <span class='hs-chr'>'['</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>quoter</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>vbar</span> <span class='hs-varop'>&lt;&gt;</span>
<a name="line-1682"></a>                           <span class='hs-varid'>ppr</span> <span class='hs-varid'>quote</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"|]"</span>
<a name="line-1683"></a>
<a name="line-1684"></a><a name="ppr_splice"></a><span class='hs-definition'>ppr_splice</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1685"></a>           <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>IdP</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LHsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1686"></a><span class='hs-definition'>ppr_splice</span> <span class='hs-varid'>herald</span> <span class='hs-varid'>n</span> <span class='hs-varid'>e</span> <span class='hs-varid'>trail</span>
<a name="line-1687"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>herald</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>whenPprDebug</span> <span class='hs-layout'>(</span><span class='hs-varid'>brackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>trail</span>
<a name="line-1688"></a>
<a name="line-1689"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XExpBr</span>      <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1690"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XPatBr</span>      <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1691"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XDecBrL</span>     <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1692"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XDecBrG</span>     <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1693"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XTypBr</span>      <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1694"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XVarBr</span>      <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1695"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XTExpBr</span>     <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtField</span>
<a name="line-1696"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>XXBracket</span>   <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoExtCon</span>
<a name="line-1697"></a>
<a name="line-1698"></a><a name="instance%20Outputable%20(HsBracket%20(GhcPass%20p))"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span>
<a name="line-1699"></a>          <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsBracket</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-1700"></a>  <span class='hs-varid'>ppr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprHsBracket</span>
<a name="line-1701"></a>
<a name="line-1702"></a>
<a name="line-1703"></a><a name="pprHsBracket"></a><span class='hs-definition'>pprHsBracket</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsBracket</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1704"></a><span class='hs-definition'>pprHsBracket</span> <span class='hs-layout'>(</span><span class='hs-conid'>ExpBr</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>thBrackets</span> <span class='hs-varid'>empty</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-1705"></a><span class='hs-definition'>pprHsBracket</span> <span class='hs-layout'>(</span><span class='hs-conid'>PatBr</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>thBrackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>char</span> <span class='hs-chr'>'p'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1706"></a><span class='hs-definition'>pprHsBracket</span> <span class='hs-layout'>(</span><span class='hs-conid'>DecBrG</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>gp</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>thBrackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>char</span> <span class='hs-chr'>'d'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>gp</span><span class='hs-layout'>)</span>
<a name="line-1707"></a><span class='hs-definition'>pprHsBracket</span> <span class='hs-layout'>(</span><span class='hs-conid'>DecBrL</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>ds</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>thBrackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>char</span> <span class='hs-chr'>'d'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>vcat</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ds</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1708"></a><span class='hs-definition'>pprHsBracket</span> <span class='hs-layout'>(</span><span class='hs-conid'>TypBr</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>thBrackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>char</span> <span class='hs-chr'>'t'</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>
<a name="line-1709"></a><span class='hs-definition'>pprHsBracket</span> <span class='hs-layout'>(</span><span class='hs-conid'>VarBr</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>True</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-1710"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'\''</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>pprPrefixOcc</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-1711"></a><span class='hs-definition'>pprHsBracket</span> <span class='hs-layout'>(</span><span class='hs-conid'>VarBr</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>False</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-1712"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"''"</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>pprPrefixOcc</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
<a name="line-1713"></a><span class='hs-definition'>pprHsBracket</span> <span class='hs-layout'>(</span><span class='hs-conid'>TExpBr</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>thTyBrackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-1714"></a>
<a name="line-1715"></a><a name="thBrackets"></a><span class='hs-definition'>thBrackets</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1716"></a><span class='hs-definition'>thBrackets</span> <span class='hs-varid'>pp_kind</span> <span class='hs-varid'>pp_body</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'['</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>pp_kind</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>vbar</span> <span class='hs-varop'>&lt;+&gt;</span>
<a name="line-1717"></a>                             <span class='hs-varid'>pp_body</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>text</span> <span class='hs-str'>"|]"</span>
<a name="line-1718"></a>
<a name="line-1719"></a><a name="thTyBrackets"></a><span class='hs-definition'>thTyBrackets</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SDoc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1720"></a><span class='hs-definition'>thTyBrackets</span> <span class='hs-varid'>pp_body</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"[||"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pp_body</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>"||]"</span><span class='hs-layout'>)</span>
<a name="line-1721"></a>
<a name="line-1722"></a><a name="instance%20Outputable%20PendingRnSplice"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>PendingRnSplice</span> <span class='hs-keyword'>where</span>
<a name="line-1723"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>PendingRnSplice</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>n</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPendingSplice</span> <span class='hs-varid'>n</span> <span class='hs-varid'>e</span>
<a name="line-1724"></a>
<a name="line-1725"></a><a name="instance%20Outputable%20PendingTcSplice"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>PendingTcSplice</span> <span class='hs-keyword'>where</span>
<a name="line-1726"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>PendingTcSplice</span> <span class='hs-varid'>n</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPendingSplice</span> <span class='hs-varid'>n</span> <span class='hs-varid'>e</span>
<a name="line-1727"></a>
<a name="line-1728"></a><span class='hs-comment'>{-
<a name="line-1729"></a>************************************************************************
<a name="line-1730"></a>*                                                                      *
<a name="line-1731"></a>\subsection{Enumerations and list comprehensions}
<a name="line-1732"></a>*                                                                      *
<a name="line-1733"></a>************************************************************************
<a name="line-1734"></a>-}</span>
<a name="line-1735"></a>
<a name="line-1736"></a><a name="instance%20Outputable%20(ArithSeqInfo%20(GhcPass%20p))"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span>
<a name="line-1737"></a>         <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>ArithSeqInfo</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-1738"></a>    <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>From</span> <span class='hs-varid'>e1</span><span class='hs-layout'>)</span>             <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hcat</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>e1</span><span class='hs-layout'>,</span> <span class='hs-varid'>pp_dotdot</span><span class='hs-keyglyph'>]</span>
<a name="line-1739"></a>    <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>FromThen</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>e2</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hcat</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>e1</span><span class='hs-layout'>,</span> <span class='hs-varid'>comma</span><span class='hs-layout'>,</span> <span class='hs-varid'>space</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>e2</span><span class='hs-layout'>,</span> <span class='hs-varid'>pp_dotdot</span><span class='hs-keyglyph'>]</span>
<a name="line-1740"></a>    <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>FromTo</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>e3</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hcat</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>e1</span><span class='hs-layout'>,</span> <span class='hs-varid'>pp_dotdot</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>e3</span><span class='hs-keyglyph'>]</span>
<a name="line-1741"></a>    <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>FromThenTo</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>e2</span> <span class='hs-varid'>e3</span><span class='hs-layout'>)</span>
<a name="line-1742"></a>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hcat</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>e1</span><span class='hs-layout'>,</span> <span class='hs-varid'>comma</span><span class='hs-layout'>,</span> <span class='hs-varid'>space</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>e2</span><span class='hs-layout'>,</span> <span class='hs-varid'>pp_dotdot</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>e3</span><span class='hs-keyglyph'>]</span>
<a name="line-1743"></a>
<a name="line-1744"></a><a name="pp_dotdot"></a><span class='hs-definition'>pp_dotdot</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SDoc</span>
<a name="line-1745"></a><span class='hs-definition'>pp_dotdot</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>" .. "</span>
<a name="line-1746"></a>
<a name="line-1747"></a><span class='hs-comment'>{-
<a name="line-1748"></a>************************************************************************
<a name="line-1749"></a>*                                                                      *
<a name="line-1750"></a>\subsection{HsMatchCtxt}
<a name="line-1751"></a>*                                                                      *
<a name="line-1752"></a>************************************************************************
<a name="line-1753"></a>-}</span>
<a name="line-1754"></a>
<a name="line-1755"></a><a name="instance%20Outputable%20(HsMatchContext%20(GhcPass%20p))"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsMatchContext</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-1756"></a>  <span class='hs-varid'>ppr</span> <span class='hs-varid'>m</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>FunRhs</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"FunRhs"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-varid'>mc_fun</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-varid'>mc_fixity</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span>
<a name="line-1757"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>LambdaExpr</span>            <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"LambdaExpr"</span>
<a name="line-1758"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>CaseAlt</span>               <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"CaseAlt"</span>
<a name="line-1759"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>IfAlt</span>                 <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"IfAlt"</span>
<a name="line-1760"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>ArrowMatchCtxt</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"ArrowMatchCtxt"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>c</span>
<a name="line-1761"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>PatBindRhs</span>            <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"PatBindRhs"</span>
<a name="line-1762"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>PatBindGuards</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"PatBindGuards"</span>
<a name="line-1763"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>RecUpd</span>                <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"RecUpd"</span>
<a name="line-1764"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtCtxt</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"StmtCtxt _"</span>
<a name="line-1765"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>ThPatSplice</span>           <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"ThPatSplice"</span>
<a name="line-1766"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>ThPatQuote</span>            <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"ThPatQuote"</span>
<a name="line-1767"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>PatSyn</span>                <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"PatSyn"</span>
<a name="line-1768"></a>
<a name="line-1769"></a><a name="instance%20Outputable%20HsArrowMatchContext"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Outputable</span> <span class='hs-conid'>HsArrowMatchContext</span> <span class='hs-keyword'>where</span>
<a name="line-1770"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>ProcExpr</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"ProcExpr"</span>
<a name="line-1771"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>ArrowCaseAlt</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"ArrowCaseAlt"</span>
<a name="line-1772"></a>  <span class='hs-varid'>ppr</span> <span class='hs-conid'>KappaExpr</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"KappaExpr"</span>
<a name="line-1773"></a>
<a name="line-1774"></a><span class='hs-comment'>-----------------</span>
<a name="line-1775"></a>
<a name="line-1776"></a><a name="instance%20Outputable%20(HsStmtContext%20(GhcPass%20p))"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span>
<a name="line-1777"></a>      <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsStmtContext</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-1778"></a>    <span class='hs-varid'>ppr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprStmtContext</span>
<a name="line-1779"></a>
<a name="line-1780"></a><a name="matchContextErrString"></a><span class='hs-comment'>-- Used to generate the string for a *runtime* error message</span>
<a name="line-1781"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>p</span>
<a name="line-1782"></a>                      <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsMatchContext</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1783"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-layout'>(</span><span class='hs-conid'>FunRhs</span><span class='hs-layout'>{</span><span class='hs-varid'>mc_fun</span><span class='hs-keyglyph'>=</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>fun</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"function"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>fun</span>
<a name="line-1784"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-conid'>CaseAlt</span>                    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"case"</span>
<a name="line-1785"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-conid'>IfAlt</span>                      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"multi-way if"</span>
<a name="line-1786"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-conid'>PatBindRhs</span>                 <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"pattern binding"</span>
<a name="line-1787"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-conid'>PatBindGuards</span>              <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"pattern binding guards"</span>
<a name="line-1788"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-conid'>RecUpd</span>                     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"record update"</span>
<a name="line-1789"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-conid'>LambdaExpr</span>                 <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"lambda"</span>
<a name="line-1790"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-layout'>(</span><span class='hs-conid'>ArrowMatchCtxt</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>matchArrowContextErrString</span> <span class='hs-varid'>c</span>
<a name="line-1791"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-conid'>ThPatSplice</span>                <span class='hs-keyglyph'>=</span> <span class='hs-varid'>panic</span> <span class='hs-str'>"matchContextErrString"</span>  <span class='hs-comment'>-- Not used at runtime</span>
<a name="line-1792"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-conid'>ThPatQuote</span>                 <span class='hs-keyglyph'>=</span> <span class='hs-varid'>panic</span> <span class='hs-str'>"matchContextErrString"</span>  <span class='hs-comment'>-- Not used at runtime</span>
<a name="line-1793"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-conid'>PatSyn</span>                     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>panic</span> <span class='hs-str'>"matchContextErrString"</span>  <span class='hs-comment'>-- Not used at runtime</span>
<a name="line-1794"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>ParStmtCtxt</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>matchContextErrString</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtCtxt</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-1795"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>TransStmtCtxt</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>matchContextErrString</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtCtxt</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-1796"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>PatGuard</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"pattern guard"</span>
<a name="line-1797"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtCtxt</span> <span class='hs-conid'>GhciStmtCtxt</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"interactive GHCi command"</span>
<a name="line-1798"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>DoExpr</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>prependQualified</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"'do' block"</span><span class='hs-layout'>)</span>
<a name="line-1799"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtCtxt</span> <span class='hs-conid'>ArrowExpr</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"'do' block"</span>
<a name="line-1800"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtCtxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>MDoExpr</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>prependQualified</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"'mdo' block"</span><span class='hs-layout'>)</span>
<a name="line-1801"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtCtxt</span> <span class='hs-conid'>ListComp</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"list comprehension"</span>
<a name="line-1802"></a><span class='hs-definition'>matchContextErrString</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtCtxt</span> <span class='hs-conid'>MonadComp</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"monad comprehension"</span>
<a name="line-1803"></a>
<a name="line-1804"></a><a name="matchArrowContextErrString"></a><span class='hs-definition'>matchArrowContextErrString</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsArrowMatchContext</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1805"></a><span class='hs-definition'>matchArrowContextErrString</span> <span class='hs-conid'>ProcExpr</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"proc"</span>
<a name="line-1806"></a><span class='hs-definition'>matchArrowContextErrString</span> <span class='hs-conid'>ArrowCaseAlt</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"case"</span>
<a name="line-1807"></a><span class='hs-definition'>matchArrowContextErrString</span> <span class='hs-conid'>KappaExpr</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>text</span> <span class='hs-str'>"kappa"</span>
<a name="line-1808"></a>
<a name="line-1809"></a><a name="pprMatchInCtxt"></a><span class='hs-definition'>pprMatchInCtxt</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>idR</span><span class='hs-layout'>,</span> <span class='hs-conid'>Outputable</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-1810"></a>               <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Match</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1811"></a><span class='hs-definition'>pprMatchInCtxt</span> <span class='hs-varid'>match</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"In"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprMatchContext</span> <span class='hs-layout'>(</span><span class='hs-varid'>m_ctxt</span> <span class='hs-varid'>match</span><span class='hs-layout'>)</span>
<a name="line-1812"></a>                                        <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>colon</span><span class='hs-layout'>)</span>
<a name="line-1813"></a>                             <span class='hs-num'>4</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprMatch</span> <span class='hs-varid'>match</span><span class='hs-layout'>)</span>
<a name="line-1814"></a>
<a name="line-1815"></a><a name="pprStmtInCtxt"></a><span class='hs-definition'>pprStmtInCtxt</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>idL</span><span class='hs-layout'>,</span>
<a name="line-1816"></a>                  <span class='hs-conid'>OutputableBndrId</span> <span class='hs-varid'>idR</span><span class='hs-layout'>,</span>
<a name="line-1817"></a>                  <span class='hs-conid'>Outputable</span> <span class='hs-varid'>body</span><span class='hs-layout'>,</span>
<a name="line-1818"></a>                 <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>~</span> <span class='hs-conid'>SrcSpanAnnA</span><span class='hs-layout'>)</span>
<a name="line-1819"></a>              <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsStmtContext</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span>
<a name="line-1820"></a>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idL</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>idR</span><span class='hs-layout'>)</span> <span class='hs-varid'>body</span>
<a name="line-1821"></a>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-1822"></a><span class='hs-definition'>pprStmtInCtxt</span> <span class='hs-varid'>ctxt</span> <span class='hs-layout'>(</span><span class='hs-conid'>LastStmt</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>
<a name="line-1823"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isComprehensionContext</span> <span class='hs-varid'>ctxt</span>      <span class='hs-comment'>-- For [ e | .. ], do not mutter about "stmts"</span>
<a name="line-1824"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"In the expression:"</span><span class='hs-layout'>)</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-1825"></a>
<a name="line-1826"></a><span class='hs-definition'>pprStmtInCtxt</span> <span class='hs-varid'>ctxt</span> <span class='hs-varid'>stmt</span>
<a name="line-1827"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hang</span> <span class='hs-layout'>(</span><span class='hs-varid'>text</span> <span class='hs-str'>"In a stmt of"</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprAStmtContext</span> <span class='hs-varid'>ctxt</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>colon</span><span class='hs-layout'>)</span>
<a name="line-1828"></a>       <span class='hs-num'>2</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr_stmt</span> <span class='hs-varid'>stmt</span><span class='hs-layout'>)</span>
<a name="line-1829"></a>  <span class='hs-keyword'>where</span>
<a name="line-1830"></a>    <span class='hs-comment'>-- For Group and Transform Stmts, don't print the nested stmts!</span>
<a name="line-1831"></a>    <span class='hs-varid'>ppr_stmt</span> <span class='hs-layout'>(</span><span class='hs-conid'>TransStmt</span> <span class='hs-layout'>{</span> <span class='hs-varid'>trS_by</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>by</span><span class='hs-layout'>,</span> <span class='hs-varid'>trS_using</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>using</span>
<a name="line-1832"></a>                        <span class='hs-layout'>,</span> <span class='hs-varid'>trS_form</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>form</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprTransStmt</span> <span class='hs-varid'>by</span> <span class='hs-varid'>using</span> <span class='hs-varid'>form</span>
<a name="line-1833"></a>    <span class='hs-varid'>ppr_stmt</span> <span class='hs-varid'>stmt</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprStmt</span> <span class='hs-varid'>stmt</span>
<a name="line-1834"></a>
<a name="line-1835"></a><span class='hs-comment'>{-
<a name="line-1836"></a>************************************************************************
<a name="line-1837"></a>*                                                                      *
<a name="line-1838"></a>\subsection{Anno instances}
<a name="line-1839"></a>*                                                                      *
<a name="line-1840"></a>************************************************************************
<a name="line-1841"></a>-}</span>
<a name="line-1842"></a>
<a name="line-1843"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnA</span>
<a name="line-1844"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pl</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnL</span>
<a name="line-1845"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pl</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnL</span>
<a name="line-1846"></a>
<a name="line-1847"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnA</span>
<a name="line-1848"></a>
<a name="line-1849"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pl</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmd</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-1850"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnL</span>
<a name="line-1851"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmdTop</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpan</span>
<a name="line-1852"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>Match</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnL</span>
<a name="line-1853"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>Match</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmd</span>  <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnL</span>
<a name="line-1854"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>Match</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnA</span>
<a name="line-1855"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>Match</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmd</span>  <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnA</span>
<a name="line-1856"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>GRHS</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpan</span>
<a name="line-1857"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>GRHS</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmd</span>  <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpan</span>
<a name="line-1858"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pl</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnA</span>
<a name="line-1859"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pl</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmd</span>  <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnA</span>
<a name="line-1860"></a>
<a name="line-1861"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsSplice</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnA</span>
<a name="line-1862"></a>
<a name="line-1863"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pl</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnL</span>
<a name="line-1864"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Anno</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>StmtLR</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pl</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LocatedA</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCmd</span>  <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>pr</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SrcSpanAnnL</span>
<a name="line-1865"></a>
<a name="line-1866"></a><a name="instance%20WrapXRec%20(GhcPass%20p)%20a"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Anno</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>~</span> <span class='hs-conid'>SrcSpanAnn'</span> <span class='hs-layout'>(</span><span class='hs-conid'>EpAnn</span> <span class='hs-varid'>an</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1867"></a>   <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>WrapXRec</span> <span class='hs-layout'>(</span><span class='hs-conid'>GhcPass</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>where</span>
<a name="line-1868"></a>  <span class='hs-varid'>wrapXRec</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>noLocA</span>
</pre></body>
</html>
