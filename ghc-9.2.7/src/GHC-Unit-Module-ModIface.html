<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>GHC/Unit/Module/ModIface.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE DataKinds #-}</span>
<a name="line-2"></a><span class='hs-comment'>{-# LANGUAGE TypeFamilies #-}</span>
<a name="line-3"></a><span class='hs-comment'>{-# LANGUAGE FlexibleContexts #-}</span>
<a name="line-4"></a><span class='hs-comment'>{-# LANGUAGE FlexibleInstances #-}</span>
<a name="line-5"></a><span class='hs-comment'>{-# LANGUAGE UndecidableInstances #-}</span>
<a name="line-6"></a>
<a name="line-7"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>GHC.Unit.Module.ModIface</span>
<a name="line-8"></a>   <span class='hs-layout'>(</span> <span class='hs-conid'>ModIface</span>
<a name="line-9"></a>   <span class='hs-layout'>,</span> <span class='hs-conid'>ModIface_</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span>
<a name="line-10"></a>   <span class='hs-layout'>,</span> <span class='hs-conid'>PartialModIface</span>
<a name="line-11"></a>   <span class='hs-layout'>,</span> <span class='hs-conid'>ModIfaceBackend</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span>
<a name="line-12"></a>   <span class='hs-layout'>,</span> <span class='hs-conid'>IfaceDeclExts</span>
<a name="line-13"></a>   <span class='hs-layout'>,</span> <span class='hs-conid'>IfaceBackendExts</span>
<a name="line-14"></a>   <span class='hs-layout'>,</span> <span class='hs-conid'>IfaceExport</span>
<a name="line-15"></a>   <span class='hs-layout'>,</span> <span class='hs-conid'>WhetherHasOrphans</span>
<a name="line-16"></a>   <span class='hs-layout'>,</span> <span class='hs-conid'>WhetherHasFamInst</span>
<a name="line-17"></a>   <span class='hs-layout'>,</span> <span class='hs-varid'>mi_boot</span>
<a name="line-18"></a>   <span class='hs-layout'>,</span> <span class='hs-varid'>mi_fix</span>
<a name="line-19"></a>   <span class='hs-layout'>,</span> <span class='hs-varid'>mi_semantic_module</span>
<a name="line-20"></a>   <span class='hs-layout'>,</span> <span class='hs-varid'>mi_free_holes</span>
<a name="line-21"></a>   <span class='hs-layout'>,</span> <span class='hs-varid'>renameFreeHoles</span>
<a name="line-22"></a>   <span class='hs-layout'>,</span> <span class='hs-varid'>emptyPartialModIface</span>
<a name="line-23"></a>   <span class='hs-layout'>,</span> <span class='hs-varid'>emptyFullModIface</span>
<a name="line-24"></a>   <span class='hs-layout'>,</span> <span class='hs-varid'>mkIfaceHashCache</span>
<a name="line-25"></a>   <span class='hs-layout'>,</span> <span class='hs-varid'>emptyIfaceHashCache</span>
<a name="line-26"></a>   <span class='hs-layout'>)</span>
<a name="line-27"></a><span class='hs-keyword'>where</span>
<a name="line-28"></a>
<a name="line-29"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Prelude</span>
<a name="line-30"></a>
<a name="line-31"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Hs</span>
<a name="line-32"></a>
<a name="line-33"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Iface.Syntax</span>
<a name="line-34"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Iface.Ext.Fields</span>
<a name="line-35"></a>
<a name="line-36"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Unit</span>
<a name="line-37"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Unit.Module.Deps</span>
<a name="line-38"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Unit.Module.Warnings</span>
<a name="line-39"></a>
<a name="line-40"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Avail</span>
<a name="line-41"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Fixity</span>
<a name="line-42"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Fixity.Env</span>
<a name="line-43"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.HpcInfo</span>
<a name="line-44"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Name</span>
<a name="line-45"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Name.Reader</span>
<a name="line-46"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.SafeHaskell</span>
<a name="line-47"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.SourceFile</span>
<a name="line-48"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Unique.DSet</span>
<a name="line-49"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types.Unique.FM</span>
<a name="line-50"></a>
<a name="line-51"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Data.Maybe</span>
<a name="line-52"></a>
<a name="line-53"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Utils.Fingerprint</span>
<a name="line-54"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Utils.Binary</span>
<a name="line-55"></a>
<a name="line-56"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.DeepSeq</span>
<a name="line-57"></a>
<a name="line-58"></a><span class='hs-comment'>{- Note [Interface file stages]
<a name="line-59"></a>   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a name="line-60"></a>
<a name="line-61"></a>Interface files have two possible stages.
<a name="line-62"></a>
<a name="line-63"></a>* A partial stage built from the result of the core pipeline.
<a name="line-64"></a>* A fully instantiated form. Which also includes fingerprints and
<a name="line-65"></a>  potentially information provided by backends.
<a name="line-66"></a>
<a name="line-67"></a>We can build a full interface file two ways:
<a name="line-68"></a>* Directly from a partial one:
<a name="line-69"></a>  Then we omit backend information and mostly compute fingerprints.
<a name="line-70"></a>* From a partial one + information produced by a backend.
<a name="line-71"></a>  Then we store the provided information and fingerprint both.
<a name="line-72"></a>-}</span>
<a name="line-73"></a>
<a name="line-74"></a><a name="PartialModIface"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>PartialModIface</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ModIface_</span> <span class='hs-chr'>'</span><span class='hs-conid'>ModIfaceCore</span>
<a name="line-75"></a><a name="ModIface"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>ModIface</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ModIface_</span> <span class='hs-chr'>'</span><span class='hs-conid'>ModIfaceFinal</span>
<a name="line-76"></a>
<a name="line-77"></a><a name="ModIfaceBackend"></a><span class='hs-comment'>-- | Extends a PartialModIface with information which is either:</span>
<a name="line-78"></a><a name="ModIfaceBackend"></a><span class='hs-comment'>-- * Computed after codegen</span>
<a name="line-79"></a><a name="ModIfaceBackend"></a><span class='hs-comment'>-- * Or computed just before writing the iface to disk. (Hashes)</span>
<a name="line-80"></a><a name="ModIfaceBackend"></a><span class='hs-comment'>-- In order to fully instantiate it.</span>
<a name="line-81"></a><a name="ModIfaceBackend"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>ModIfaceBackend</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ModIfaceBackend</span>
<a name="line-82"></a>  <span class='hs-layout'>{</span> <span class='hs-varid'>mi_iface_hash</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Fingerprint</span>
<a name="line-83"></a>    <span class='hs-comment'>-- ^ Hash of the whole interface</span>
<a name="line-84"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>mi_mod_hash</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Fingerprint</span>
<a name="line-85"></a>    <span class='hs-comment'>-- ^ Hash of the ABI only</span>
<a name="line-86"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>mi_flag_hash</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Fingerprint</span>
<a name="line-87"></a>    <span class='hs-comment'>-- ^ Hash of the important flags used when compiling the module, excluding</span>
<a name="line-88"></a>    <span class='hs-comment'>-- optimisation flags</span>
<a name="line-89"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>mi_opt_hash</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Fingerprint</span>
<a name="line-90"></a>    <span class='hs-comment'>-- ^ Hash of optimisation flags</span>
<a name="line-91"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>mi_hpc_hash</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Fingerprint</span>
<a name="line-92"></a>    <span class='hs-comment'>-- ^ Hash of hpc flags</span>
<a name="line-93"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>mi_plugin_hash</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Fingerprint</span>
<a name="line-94"></a>    <span class='hs-comment'>-- ^ Hash of plugins</span>
<a name="line-95"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>mi_orphan</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>WhetherHasOrphans</span>
<a name="line-96"></a>    <span class='hs-comment'>-- ^ Whether this module has orphans</span>
<a name="line-97"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>mi_finsts</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>WhetherHasFamInst</span>
<a name="line-98"></a>    <span class='hs-comment'>-- ^ Whether this module has family instances. See Note [The type family</span>
<a name="line-99"></a>    <span class='hs-comment'>-- instance consistency story].</span>
<a name="line-100"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>mi_exp_hash</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Fingerprint</span>
<a name="line-101"></a>    <span class='hs-comment'>-- ^ Hash of export list</span>
<a name="line-102"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>mi_orphan_hash</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Fingerprint</span>
<a name="line-103"></a>    <span class='hs-comment'>-- ^ Hash for orphan rules, class and family instances combined</span>
<a name="line-104"></a>
<a name="line-105"></a>    <span class='hs-comment'>-- Cached environments for easy lookup. These are computed (lazily) from</span>
<a name="line-106"></a>    <span class='hs-comment'>-- other fields and are not put into the interface file.</span>
<a name="line-107"></a>    <span class='hs-comment'>-- Not really produced by the backend but there is no need to create them</span>
<a name="line-108"></a>    <span class='hs-comment'>-- any earlier.</span>
<a name="line-109"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>mi_warn_fn</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-conid'>OccName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>WarningTxt</span><span class='hs-layout'>)</span>
<a name="line-110"></a>    <span class='hs-comment'>-- ^ Cached lookup for 'mi_warns'</span>
<a name="line-111"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>mi_fix_fn</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-conid'>OccName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Fixity</span><span class='hs-layout'>)</span>
<a name="line-112"></a>    <span class='hs-comment'>-- ^ Cached lookup for 'mi_fixities'</span>
<a name="line-113"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>mi_hash_fn</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-conid'>OccName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>OccName</span><span class='hs-layout'>,</span> <span class='hs-conid'>Fingerprint</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-114"></a>    <span class='hs-comment'>-- ^ Cached lookup for 'mi_decls'. The @Nothing@ in 'mi_hash_fn' means that</span>
<a name="line-115"></a>    <span class='hs-comment'>-- the thing isn't in decls. It's useful to know that when seeing if we are</span>
<a name="line-116"></a>    <span class='hs-comment'>-- up to date wrt. the old interface. The 'OccName' is the parent of the</span>
<a name="line-117"></a>    <span class='hs-comment'>-- name, if it has one.</span>
<a name="line-118"></a>  <span class='hs-layout'>}</span>
<a name="line-119"></a>
<a name="line-120"></a><a name="ModIfacePhase"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>ModIfacePhase</span>
<a name="line-121"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ModIfaceCore</span>
<a name="line-122"></a>  <span class='hs-comment'>-- ^ Partial interface built based on output of core pipeline.</span>
<a name="line-123"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ModIfaceFinal</span>
<a name="line-124"></a>
<a name="line-125"></a><a name="IfaceDeclExts"></a><span class='hs-comment'>-- | Selects a IfaceDecl representation.</span>
<a name="line-126"></a><a name="IfaceDeclExts"></a><span class='hs-comment'>-- For fully instantiated interfaces we also maintain</span>
<a name="line-127"></a><a name="IfaceDeclExts"></a><span class='hs-comment'>-- a fingerprint, which is used for recompilation checks.</span>
<a name="line-128"></a><a name="IfaceDeclExts"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>family</span> <span class='hs-conid'>IfaceDeclExts</span> <span class='hs-layout'>(</span><span class='hs-varid'>phase</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ModIfacePhase</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-129"></a>  <span class='hs-conid'>IfaceDeclExts</span> <span class='hs-chr'>'</span><span class='hs-conid'>ModIfaceCore</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>IfaceDecl</span>
<a name="line-130"></a>  <span class='hs-conid'>IfaceDeclExts</span> <span class='hs-chr'>'</span><span class='hs-conid'>ModIfaceFinal</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Fingerprint</span><span class='hs-layout'>,</span> <span class='hs-conid'>IfaceDecl</span><span class='hs-layout'>)</span>
<a name="line-131"></a>
<a name="line-132"></a><a name="IfaceBackendExts"></a><span class='hs-keyword'>type</span> <span class='hs-keyword'>family</span> <span class='hs-conid'>IfaceBackendExts</span> <span class='hs-layout'>(</span><span class='hs-varid'>phase</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ModIfacePhase</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-133"></a>  <span class='hs-conid'>IfaceBackendExts</span> <span class='hs-chr'>'</span><span class='hs-conid'>ModIfaceCore</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>()</span>
<a name="line-134"></a>  <span class='hs-conid'>IfaceBackendExts</span> <span class='hs-chr'>'</span><span class='hs-conid'>ModIfaceFinal</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ModIfaceBackend</span>
<a name="line-135"></a>
<a name="line-136"></a>
<a name="line-137"></a>
<a name="line-138"></a><a name="ModIface_"></a><span class='hs-comment'>-- | A 'ModIface' plus a 'ModDetails' summarises everything we know</span>
<a name="line-139"></a><a name="ModIface_"></a><span class='hs-comment'>-- about a compiled module.  The 'ModIface' is the stuff *before* linking,</span>
<a name="line-140"></a><a name="ModIface_"></a><span class='hs-comment'>-- and can be written out to an interface file. The 'ModDetails is after</span>
<a name="line-141"></a><a name="ModIface_"></a><span class='hs-comment'>-- linking and can be completely recovered from just the 'ModIface'.</span>
<a name="line-142"></a><a name="ModIface_"></a><span class='hs-comment'>--</span>
<a name="line-143"></a><a name="ModIface_"></a><span class='hs-comment'>-- When we read an interface file, we also construct a 'ModIface' from it,</span>
<a name="line-144"></a><a name="ModIface_"></a><span class='hs-comment'>-- except that we explicitly make the 'mi_decls' and a few other fields empty;</span>
<a name="line-145"></a><a name="ModIface_"></a><span class='hs-comment'>-- as when reading we consolidate the declarations etc. into a number of indexed</span>
<a name="line-146"></a><a name="ModIface_"></a><span class='hs-comment'>-- maps and environments in the 'ExternalPackageState'.</span>
<a name="line-147"></a><a name="ModIface_"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>ModIface_</span> <span class='hs-layout'>(</span><span class='hs-varid'>phase</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ModIfacePhase</span><span class='hs-layout'>)</span>
<a name="line-148"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ModIface</span> <span class='hs-layout'>{</span>
<a name="line-149"></a>        <span class='hs-varid'>mi_module</span>     <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Module</span><span class='hs-layout'>,</span>             <span class='hs-comment'>-- ^ Name of the module we are for</span>
<a name="line-150"></a>        <span class='hs-varid'>mi_sig_of</span>     <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-conid'>Module</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>     <span class='hs-comment'>-- ^ Are we a sig of another mod?</span>
<a name="line-151"></a>
<a name="line-152"></a>        <span class='hs-varid'>mi_hsc_src</span>    <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>HscSource</span><span class='hs-layout'>,</span>          <span class='hs-comment'>-- ^ Boot? Signature?</span>
<a name="line-153"></a>
<a name="line-154"></a>        <span class='hs-varid'>mi_deps</span>     <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Dependencies</span><span class='hs-layout'>,</span>
<a name="line-155"></a>                <span class='hs-comment'>-- ^ The dependencies of the module.  This is</span>
<a name="line-156"></a>                <span class='hs-comment'>-- consulted for directly-imported modules, but not</span>
<a name="line-157"></a>                <span class='hs-comment'>-- for anything else (hence lazy)</span>
<a name="line-158"></a>
<a name="line-159"></a>        <span class='hs-varid'>mi_usages</span>   <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Usage</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>
<a name="line-160"></a>                <span class='hs-comment'>-- ^ Usages; kept sorted so that it's easy to decide</span>
<a name="line-161"></a>                <span class='hs-comment'>-- whether to write a new iface file (changing usages</span>
<a name="line-162"></a>                <span class='hs-comment'>-- doesn't affect the hash of this module)</span>
<a name="line-163"></a>                <span class='hs-comment'>-- NOT STRICT!  we read this field lazily from the interface file</span>
<a name="line-164"></a>                <span class='hs-comment'>-- It is *only* consulted by the recompilation checker</span>
<a name="line-165"></a>
<a name="line-166"></a>        <span class='hs-varid'>mi_exports</span>  <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceExport</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>
<a name="line-167"></a>                <span class='hs-comment'>-- ^ Exports</span>
<a name="line-168"></a>                <span class='hs-comment'>-- Kept sorted by (mod,occ), to make version comparisons easier</span>
<a name="line-169"></a>                <span class='hs-comment'>-- Records the modules that are the declaration points for things</span>
<a name="line-170"></a>                <span class='hs-comment'>-- exported by this module, and the 'OccName's of those things</span>
<a name="line-171"></a>
<a name="line-172"></a>
<a name="line-173"></a>        <span class='hs-varid'>mi_used_th</span>  <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Bool</span><span class='hs-layout'>,</span>
<a name="line-174"></a>                <span class='hs-comment'>-- ^ Module required TH splices when it was compiled.</span>
<a name="line-175"></a>                <span class='hs-comment'>-- This disables recompilation avoidance (see #481).</span>
<a name="line-176"></a>
<a name="line-177"></a>        <span class='hs-varid'>mi_fixities</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>OccName</span><span class='hs-layout'>,</span><span class='hs-conid'>Fixity</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>
<a name="line-178"></a>                <span class='hs-comment'>-- ^ Fixities</span>
<a name="line-179"></a>                <span class='hs-comment'>-- NOT STRICT!  we read this field lazily from the interface file</span>
<a name="line-180"></a>
<a name="line-181"></a>        <span class='hs-varid'>mi_warns</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Warnings</span><span class='hs-layout'>,</span>
<a name="line-182"></a>                <span class='hs-comment'>-- ^ Warnings</span>
<a name="line-183"></a>                <span class='hs-comment'>-- NOT STRICT!  we read this field lazily from the interface file</span>
<a name="line-184"></a>
<a name="line-185"></a>        <span class='hs-varid'>mi_anns</span>     <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceAnnotation</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>
<a name="line-186"></a>                <span class='hs-comment'>-- ^ Annotations</span>
<a name="line-187"></a>                <span class='hs-comment'>-- NOT STRICT!  we read this field lazily from the interface file</span>
<a name="line-188"></a>
<a name="line-189"></a>
<a name="line-190"></a>        <span class='hs-varid'>mi_decls</span>    <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceDeclExts</span> <span class='hs-varid'>phase</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>
<a name="line-191"></a>                <span class='hs-comment'>-- ^ Type, class and variable declarations</span>
<a name="line-192"></a>                <span class='hs-comment'>-- The hash of an Id changes if its fixity or deprecations change</span>
<a name="line-193"></a>                <span class='hs-comment'>--      (as well as its type of course)</span>
<a name="line-194"></a>                <span class='hs-comment'>-- Ditto data constructors, class operations, except that</span>
<a name="line-195"></a>                <span class='hs-comment'>-- the hash of the parent class/tycon changes</span>
<a name="line-196"></a>
<a name="line-197"></a>        <span class='hs-varid'>mi_globals</span>  <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-conid'>GlobalRdrEnv</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-198"></a>                <span class='hs-comment'>-- ^ Binds all the things defined at the top level in</span>
<a name="line-199"></a>                <span class='hs-comment'>-- the /original source/ code for this module. which</span>
<a name="line-200"></a>                <span class='hs-comment'>-- is NOT the same as mi_exports, nor mi_decls (which</span>
<a name="line-201"></a>                <span class='hs-comment'>-- may contains declarations for things not actually</span>
<a name="line-202"></a>                <span class='hs-comment'>-- defined by the user).  Used for GHCi and for inspecting</span>
<a name="line-203"></a>                <span class='hs-comment'>-- the contents of modules via the GHC API only.</span>
<a name="line-204"></a>                <span class='hs-comment'>--</span>
<a name="line-205"></a>                <span class='hs-comment'>-- (We need the source file to figure out the</span>
<a name="line-206"></a>                <span class='hs-comment'>-- top-level environment, if we didn't compile this module</span>
<a name="line-207"></a>                <span class='hs-comment'>-- from source then this field contains @Nothing@).</span>
<a name="line-208"></a>                <span class='hs-comment'>--</span>
<a name="line-209"></a>                <span class='hs-comment'>-- Strictly speaking this field should live in the</span>
<a name="line-210"></a>                <span class='hs-comment'>-- 'HomeModInfo', but that leads to more plumbing.</span>
<a name="line-211"></a>
<a name="line-212"></a>                <span class='hs-comment'>-- Instance declarations and rules</span>
<a name="line-213"></a>        <span class='hs-varid'>mi_insts</span>       <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceClsInst</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>     <span class='hs-comment'>-- ^ Sorted class instance</span>
<a name="line-214"></a>        <span class='hs-varid'>mi_fam_insts</span>   <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceFamInst</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>  <span class='hs-comment'>-- ^ Sorted family instances</span>
<a name="line-215"></a>        <span class='hs-varid'>mi_rules</span>       <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceRule</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>     <span class='hs-comment'>-- ^ Sorted rules</span>
<a name="line-216"></a>
<a name="line-217"></a>        <span class='hs-varid'>mi_hpc</span>       <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>AnyHpcUsage</span><span class='hs-layout'>,</span>
<a name="line-218"></a>                <span class='hs-comment'>-- ^ True if this program uses Hpc at any point in the program.</span>
<a name="line-219"></a>
<a name="line-220"></a>        <span class='hs-varid'>mi_trust</span>     <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>IfaceTrustInfo</span><span class='hs-layout'>,</span>
<a name="line-221"></a>                <span class='hs-comment'>-- ^ Safe Haskell Trust information for this module.</span>
<a name="line-222"></a>
<a name="line-223"></a>        <span class='hs-varid'>mi_trust_pkg</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Bool</span><span class='hs-layout'>,</span>
<a name="line-224"></a>                <span class='hs-comment'>-- ^ Do we require the package this module resides in be trusted</span>
<a name="line-225"></a>                <span class='hs-comment'>-- to trust this module? This is used for the situation where a</span>
<a name="line-226"></a>                <span class='hs-comment'>-- module is Safe (so doesn't require the package be trusted</span>
<a name="line-227"></a>                <span class='hs-comment'>-- itself) but imports some trustworthy modules from its own</span>
<a name="line-228"></a>                <span class='hs-comment'>-- package (which does require its own package be trusted).</span>
<a name="line-229"></a>                <span class='hs-comment'>-- See Note [Trust Own Package] in GHC.Rename.Names</span>
<a name="line-230"></a>        <span class='hs-varid'>mi_complete_matches</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>IfaceCompleteMatch</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>
<a name="line-231"></a>
<a name="line-232"></a>        <span class='hs-varid'>mi_doc_hdr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>HsDocString</span><span class='hs-layout'>,</span>
<a name="line-233"></a>                <span class='hs-comment'>-- ^ Module header.</span>
<a name="line-234"></a>
<a name="line-235"></a>        <span class='hs-varid'>mi_decl_docs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DeclDocMap</span><span class='hs-layout'>,</span>
<a name="line-236"></a>                <span class='hs-comment'>-- ^ Docs on declarations.</span>
<a name="line-237"></a>
<a name="line-238"></a>        <span class='hs-varid'>mi_arg_docs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ArgDocMap</span><span class='hs-layout'>,</span>
<a name="line-239"></a>                <span class='hs-comment'>-- ^ Docs on arguments.</span>
<a name="line-240"></a>
<a name="line-241"></a>        <span class='hs-varid'>mi_final_exts</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-conid'>IfaceBackendExts</span> <span class='hs-varid'>phase</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-242"></a>                <span class='hs-comment'>-- ^ Either `()` or `ModIfaceBackend` for</span>
<a name="line-243"></a>                <span class='hs-comment'>-- a fully instantiated interface.</span>
<a name="line-244"></a>
<a name="line-245"></a>        <span class='hs-varid'>mi_ext_fields</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ExtensibleFields</span>
<a name="line-246"></a>                <span class='hs-comment'>-- ^ Additional optional fields, where the Map key represents</span>
<a name="line-247"></a>                <span class='hs-comment'>-- the field name, resulting in a (size, serialized data) pair.</span>
<a name="line-248"></a>                <span class='hs-comment'>-- Because the data is intended to be serialized through the</span>
<a name="line-249"></a>                <span class='hs-comment'>-- internal `Binary` class (increasing compatibility with types</span>
<a name="line-250"></a>                <span class='hs-comment'>-- using `Name` and `FastString`, such as HIE), this format is</span>
<a name="line-251"></a>                <span class='hs-comment'>-- chosen over `ByteString`s.</span>
<a name="line-252"></a>     <span class='hs-layout'>}</span>
<a name="line-253"></a>
<a name="line-254"></a><a name="mi_boot"></a><span class='hs-comment'>-- | Old-style accessor for whether or not the ModIface came from an hs-boot</span>
<a name="line-255"></a><span class='hs-comment'>-- file.</span>
<a name="line-256"></a><span class='hs-definition'>mi_boot</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ModIface</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IsBootInterface</span>
<a name="line-257"></a><span class='hs-definition'>mi_boot</span> <span class='hs-varid'>iface</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>mi_hsc_src</span> <span class='hs-varid'>iface</span> <span class='hs-varop'>==</span> <span class='hs-conid'>HsBootFile</span>
<a name="line-258"></a>    <span class='hs-keyword'>then</span> <span class='hs-conid'>IsBoot</span>
<a name="line-259"></a>    <span class='hs-keyword'>else</span> <span class='hs-conid'>NotBoot</span>
<a name="line-260"></a>
<a name="line-261"></a><a name="mi_fix"></a><span class='hs-comment'>-- | Lookups up a (possibly cached) fixity from a 'ModIface'. If one cannot be</span>
<a name="line-262"></a><span class='hs-comment'>-- found, 'defaultFixity' is returned instead.</span>
<a name="line-263"></a><span class='hs-definition'>mi_fix</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ModIface</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>OccName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Fixity</span>
<a name="line-264"></a><span class='hs-definition'>mi_fix</span> <span class='hs-varid'>iface</span> <span class='hs-varid'>name</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mi_fix_fn</span> <span class='hs-layout'>(</span><span class='hs-varid'>mi_final_exts</span> <span class='hs-varid'>iface</span><span class='hs-layout'>)</span> <span class='hs-varid'>name</span> <span class='hs-varop'>`orElse`</span> <span class='hs-varid'>defaultFixity</span>
<a name="line-265"></a>
<a name="line-266"></a><a name="mi_semantic_module"></a><span class='hs-comment'>-- | The semantic module for this interface; e.g., if it's a interface</span>
<a name="line-267"></a><span class='hs-comment'>-- for a signature, if 'mi_module' is @p[A=&lt;A&gt;]:A@, 'mi_semantic_module'</span>
<a name="line-268"></a><span class='hs-comment'>-- will be @&lt;A&gt;@.</span>
<a name="line-269"></a><span class='hs-definition'>mi_semantic_module</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ModIface_</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Module</span>
<a name="line-270"></a><span class='hs-definition'>mi_semantic_module</span> <span class='hs-varid'>iface</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>mi_sig_of</span> <span class='hs-varid'>iface</span> <span class='hs-keyword'>of</span>
<a name="line-271"></a>                            <span class='hs-conid'>Nothing</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mi_module</span> <span class='hs-varid'>iface</span>
<a name="line-272"></a>                            <span class='hs-conid'>Just</span> <span class='hs-varid'>mod</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mod</span>
<a name="line-273"></a>
<a name="line-274"></a><a name="mi_free_holes"></a><span class='hs-comment'>-- | The "precise" free holes, e.g., the signatures that this</span>
<a name="line-275"></a><span class='hs-comment'>-- 'ModIface' depends on.</span>
<a name="line-276"></a><span class='hs-definition'>mi_free_holes</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ModIface</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>UniqDSet</span> <span class='hs-conid'>ModuleName</span>
<a name="line-277"></a><span class='hs-definition'>mi_free_holes</span> <span class='hs-varid'>iface</span> <span class='hs-keyglyph'>=</span>
<a name="line-278"></a>  <span class='hs-keyword'>case</span> <span class='hs-varid'>getModuleInstantiation</span> <span class='hs-layout'>(</span><span class='hs-varid'>mi_module</span> <span class='hs-varid'>iface</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-279"></a>    <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>indef</span><span class='hs-layout'>)</span>
<a name="line-280"></a>        <span class='hs-comment'>-- A mini-hack: we rely on the fact that 'renameFreeHoles'</span>
<a name="line-281"></a>        <span class='hs-comment'>-- drops things that aren't holes.</span>
<a name="line-282"></a>        <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>renameFreeHoles</span> <span class='hs-layout'>(</span><span class='hs-varid'>mkUniqDSet</span> <span class='hs-varid'>cands</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>instUnitInsts</span> <span class='hs-layout'>(</span><span class='hs-varid'>moduleUnit</span> <span class='hs-varid'>indef</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-283"></a>    <span class='hs-keyword'>_</span>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>emptyUniqDSet</span>
<a name="line-284"></a>  <span class='hs-keyword'>where</span>
<a name="line-285"></a>    <span class='hs-varid'>cands</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-varid'>gwib_mod</span> <span class='hs-varop'>$</span> <span class='hs-varid'>dep_mods</span> <span class='hs-varop'>$</span> <span class='hs-varid'>mi_deps</span> <span class='hs-varid'>iface</span>
<a name="line-286"></a>
<a name="line-287"></a><a name="renameFreeHoles"></a><span class='hs-comment'>-- | Given a set of free holes, and a unit identifier, rename</span>
<a name="line-288"></a><span class='hs-comment'>-- the free holes according to the instantiation of the unit</span>
<a name="line-289"></a><span class='hs-comment'>-- identifier.  For example, if we have A and B free, and</span>
<a name="line-290"></a><span class='hs-comment'>-- our unit identity is @p[A=&lt;C&gt;,B=impl:B]@, the renamed free</span>
<a name="line-291"></a><span class='hs-comment'>-- holes are just C.</span>
<a name="line-292"></a><span class='hs-definition'>renameFreeHoles</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>UniqDSet</span> <span class='hs-conid'>ModuleName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>ModuleName</span><span class='hs-layout'>,</span> <span class='hs-conid'>Module</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>UniqDSet</span> <span class='hs-conid'>ModuleName</span>
<a name="line-293"></a><span class='hs-definition'>renameFreeHoles</span> <span class='hs-varid'>fhs</span> <span class='hs-varid'>insts</span> <span class='hs-keyglyph'>=</span>
<a name="line-294"></a>    <span class='hs-varid'>unionManyUniqDSets</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>lookup_impl</span> <span class='hs-layout'>(</span><span class='hs-varid'>uniqDSetToList</span> <span class='hs-varid'>fhs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-295"></a>  <span class='hs-keyword'>where</span>
<a name="line-296"></a>    <span class='hs-varid'>hmap</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>listToUFM</span> <span class='hs-varid'>insts</span>
<a name="line-297"></a>    <span class='hs-varid'>lookup_impl</span> <span class='hs-varid'>mod_name</span>
<a name="line-298"></a>        <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>mod</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>lookupUFM</span> <span class='hs-varid'>hmap</span> <span class='hs-varid'>mod_name</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>moduleFreeHoles</span> <span class='hs-varid'>mod</span>
<a name="line-299"></a>        <span class='hs-comment'>-- It wasn't actually a hole</span>
<a name="line-300"></a>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>                           <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyUniqDSet</span>
<a name="line-301"></a>
<a name="line-302"></a>
<a name="line-303"></a><a name="instance%20Binary%20ModIface"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Binary</span> <span class='hs-conid'>ModIface</span> <span class='hs-keyword'>where</span>
<a name="line-304"></a>   <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-layout'>(</span><span class='hs-conid'>ModIface</span> <span class='hs-layout'>{</span>
<a name="line-305"></a>                 <span class='hs-varid'>mi_module</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mod</span><span class='hs-layout'>,</span>
<a name="line-306"></a>                 <span class='hs-varid'>mi_sig_of</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sig_of</span><span class='hs-layout'>,</span>
<a name="line-307"></a>                 <span class='hs-varid'>mi_hsc_src</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsc_src</span><span class='hs-layout'>,</span>
<a name="line-308"></a>                 <span class='hs-varid'>mi_deps</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>deps</span><span class='hs-layout'>,</span>
<a name="line-309"></a>                 <span class='hs-varid'>mi_usages</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>usages</span><span class='hs-layout'>,</span>
<a name="line-310"></a>                 <span class='hs-varid'>mi_exports</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>exports</span><span class='hs-layout'>,</span>
<a name="line-311"></a>                 <span class='hs-varid'>mi_used_th</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>used_th</span><span class='hs-layout'>,</span>
<a name="line-312"></a>                 <span class='hs-varid'>mi_fixities</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fixities</span><span class='hs-layout'>,</span>
<a name="line-313"></a>                 <span class='hs-varid'>mi_warns</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>warns</span><span class='hs-layout'>,</span>
<a name="line-314"></a>                 <span class='hs-varid'>mi_anns</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>anns</span><span class='hs-layout'>,</span>
<a name="line-315"></a>                 <span class='hs-varid'>mi_decls</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>decls</span><span class='hs-layout'>,</span>
<a name="line-316"></a>                 <span class='hs-varid'>mi_insts</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>insts</span><span class='hs-layout'>,</span>
<a name="line-317"></a>                 <span class='hs-varid'>mi_fam_insts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fam_insts</span><span class='hs-layout'>,</span>
<a name="line-318"></a>                 <span class='hs-varid'>mi_rules</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rules</span><span class='hs-layout'>,</span>
<a name="line-319"></a>                 <span class='hs-varid'>mi_hpc</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hpc_info</span><span class='hs-layout'>,</span>
<a name="line-320"></a>                 <span class='hs-varid'>mi_trust</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>trust</span><span class='hs-layout'>,</span>
<a name="line-321"></a>                 <span class='hs-varid'>mi_trust_pkg</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>trust_pkg</span><span class='hs-layout'>,</span>
<a name="line-322"></a>                 <span class='hs-varid'>mi_complete_matches</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>complete_matches</span><span class='hs-layout'>,</span>
<a name="line-323"></a>                 <span class='hs-varid'>mi_doc_hdr</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>doc_hdr</span><span class='hs-layout'>,</span>
<a name="line-324"></a>                 <span class='hs-varid'>mi_decl_docs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>decl_docs</span><span class='hs-layout'>,</span>
<a name="line-325"></a>                 <span class='hs-varid'>mi_arg_docs</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>arg_docs</span><span class='hs-layout'>,</span>
<a name="line-326"></a>                 <span class='hs-varid'>mi_ext_fields</span> <span class='hs-keyglyph'>=</span> <span class='hs-sel'>_ext_fields</span><span class='hs-layout'>,</span> <span class='hs-comment'>-- Don't `put_` this in the instance so we</span>
<a name="line-327"></a>                                              <span class='hs-comment'>-- can deal with it's pointer in the header</span>
<a name="line-328"></a>                                              <span class='hs-comment'>-- when we write the actual file</span>
<a name="line-329"></a>                 <span class='hs-varid'>mi_final_exts</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ModIfaceBackend</span> <span class='hs-layout'>{</span>
<a name="line-330"></a>                   <span class='hs-varid'>mi_iface_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>iface_hash</span><span class='hs-layout'>,</span>
<a name="line-331"></a>                   <span class='hs-varid'>mi_mod_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mod_hash</span><span class='hs-layout'>,</span>
<a name="line-332"></a>                   <span class='hs-varid'>mi_flag_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>flag_hash</span><span class='hs-layout'>,</span>
<a name="line-333"></a>                   <span class='hs-varid'>mi_opt_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>opt_hash</span><span class='hs-layout'>,</span>
<a name="line-334"></a>                   <span class='hs-varid'>mi_hpc_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hpc_hash</span><span class='hs-layout'>,</span>
<a name="line-335"></a>                   <span class='hs-varid'>mi_plugin_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>plugin_hash</span><span class='hs-layout'>,</span>
<a name="line-336"></a>                   <span class='hs-varid'>mi_orphan</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>orphan</span><span class='hs-layout'>,</span>
<a name="line-337"></a>                   <span class='hs-varid'>mi_finsts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hasFamInsts</span><span class='hs-layout'>,</span>
<a name="line-338"></a>                   <span class='hs-varid'>mi_exp_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>exp_hash</span><span class='hs-layout'>,</span>
<a name="line-339"></a>                   <span class='hs-varid'>mi_orphan_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>orphan_hash</span>
<a name="line-340"></a>                 <span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-341"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>mod</span>
<a name="line-342"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>sig_of</span>
<a name="line-343"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>hsc_src</span>
<a name="line-344"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>iface_hash</span>
<a name="line-345"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>mod_hash</span>
<a name="line-346"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>flag_hash</span>
<a name="line-347"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>opt_hash</span>
<a name="line-348"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>hpc_hash</span>
<a name="line-349"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>plugin_hash</span>
<a name="line-350"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>orphan</span>
<a name="line-351"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>hasFamInsts</span>
<a name="line-352"></a>        <span class='hs-varid'>lazyPut</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>deps</span>
<a name="line-353"></a>        <span class='hs-varid'>lazyPut</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>usages</span>
<a name="line-354"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>exports</span>
<a name="line-355"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>exp_hash</span>
<a name="line-356"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>used_th</span>
<a name="line-357"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>fixities</span>
<a name="line-358"></a>        <span class='hs-varid'>lazyPut</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>warns</span>
<a name="line-359"></a>        <span class='hs-varid'>lazyPut</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>anns</span>
<a name="line-360"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>decls</span>
<a name="line-361"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>insts</span>
<a name="line-362"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>fam_insts</span>
<a name="line-363"></a>        <span class='hs-varid'>lazyPut</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>rules</span>
<a name="line-364"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>orphan_hash</span>
<a name="line-365"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>hpc_info</span>
<a name="line-366"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>trust</span>
<a name="line-367"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>trust_pkg</span>
<a name="line-368"></a>        <span class='hs-varid'>put_</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>complete_matches</span>
<a name="line-369"></a>        <span class='hs-varid'>lazyPut</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>doc_hdr</span>
<a name="line-370"></a>        <span class='hs-varid'>lazyPut</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>decl_docs</span>
<a name="line-371"></a>        <span class='hs-varid'>lazyPut</span> <span class='hs-varid'>bh</span> <span class='hs-varid'>arg_docs</span>
<a name="line-372"></a>
<a name="line-373"></a>   <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-374"></a>        <span class='hs-varid'>mod</span>         <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-375"></a>        <span class='hs-varid'>sig_of</span>      <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-376"></a>        <span class='hs-varid'>hsc_src</span>     <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-377"></a>        <span class='hs-varid'>iface_hash</span>  <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-378"></a>        <span class='hs-varid'>mod_hash</span>    <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-379"></a>        <span class='hs-varid'>flag_hash</span>   <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-380"></a>        <span class='hs-varid'>opt_hash</span>    <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-381"></a>        <span class='hs-varid'>hpc_hash</span>    <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-382"></a>        <span class='hs-varid'>plugin_hash</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-383"></a>        <span class='hs-varid'>orphan</span>      <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-384"></a>        <span class='hs-varid'>hasFamInsts</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-385"></a>        <span class='hs-varid'>deps</span>        <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>lazyGet</span> <span class='hs-varid'>bh</span>
<a name="line-386"></a>        <span class='hs-varid'>usages</span>      <span class='hs-keyglyph'>&lt;-</span> <span class='hs-comment'>{-# SCC "bin_usages" #-}</span> <span class='hs-varid'>lazyGet</span> <span class='hs-varid'>bh</span>
<a name="line-387"></a>        <span class='hs-varid'>exports</span>     <span class='hs-keyglyph'>&lt;-</span> <span class='hs-comment'>{-# SCC "bin_exports" #-}</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-388"></a>        <span class='hs-varid'>exp_hash</span>    <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-389"></a>        <span class='hs-varid'>used_th</span>     <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-390"></a>        <span class='hs-varid'>fixities</span>    <span class='hs-keyglyph'>&lt;-</span> <span class='hs-comment'>{-# SCC "bin_fixities" #-}</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-391"></a>        <span class='hs-varid'>warns</span>       <span class='hs-keyglyph'>&lt;-</span> <span class='hs-comment'>{-# SCC "bin_warns" #-}</span> <span class='hs-varid'>lazyGet</span> <span class='hs-varid'>bh</span>
<a name="line-392"></a>        <span class='hs-varid'>anns</span>        <span class='hs-keyglyph'>&lt;-</span> <span class='hs-comment'>{-# SCC "bin_anns" #-}</span> <span class='hs-varid'>lazyGet</span> <span class='hs-varid'>bh</span>
<a name="line-393"></a>        <span class='hs-varid'>decls</span>       <span class='hs-keyglyph'>&lt;-</span> <span class='hs-comment'>{-# SCC "bin_tycldecls" #-}</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-394"></a>        <span class='hs-varid'>insts</span>       <span class='hs-keyglyph'>&lt;-</span> <span class='hs-comment'>{-# SCC "bin_insts" #-}</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-395"></a>        <span class='hs-varid'>fam_insts</span>   <span class='hs-keyglyph'>&lt;-</span> <span class='hs-comment'>{-# SCC "bin_fam_insts" #-}</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-396"></a>        <span class='hs-varid'>rules</span>       <span class='hs-keyglyph'>&lt;-</span> <span class='hs-comment'>{-# SCC "bin_rules" #-}</span> <span class='hs-varid'>lazyGet</span> <span class='hs-varid'>bh</span>
<a name="line-397"></a>        <span class='hs-varid'>orphan_hash</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-398"></a>        <span class='hs-varid'>hpc_info</span>    <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-399"></a>        <span class='hs-varid'>trust</span>       <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-400"></a>        <span class='hs-varid'>trust_pkg</span>   <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-401"></a>        <span class='hs-varid'>complete_matches</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>get</span> <span class='hs-varid'>bh</span>
<a name="line-402"></a>        <span class='hs-varid'>doc_hdr</span>     <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>lazyGet</span> <span class='hs-varid'>bh</span>
<a name="line-403"></a>        <span class='hs-varid'>decl_docs</span>   <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>lazyGet</span> <span class='hs-varid'>bh</span>
<a name="line-404"></a>        <span class='hs-varid'>arg_docs</span>    <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>lazyGet</span> <span class='hs-varid'>bh</span>
<a name="line-405"></a>        <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-conid'>ModIface</span> <span class='hs-layout'>{</span>
<a name="line-406"></a>                 <span class='hs-varid'>mi_module</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mod</span><span class='hs-layout'>,</span>
<a name="line-407"></a>                 <span class='hs-varid'>mi_sig_of</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sig_of</span><span class='hs-layout'>,</span>
<a name="line-408"></a>                 <span class='hs-varid'>mi_hsc_src</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hsc_src</span><span class='hs-layout'>,</span>
<a name="line-409"></a>                 <span class='hs-varid'>mi_deps</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>deps</span><span class='hs-layout'>,</span>
<a name="line-410"></a>                 <span class='hs-varid'>mi_usages</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>usages</span><span class='hs-layout'>,</span>
<a name="line-411"></a>                 <span class='hs-varid'>mi_exports</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>exports</span><span class='hs-layout'>,</span>
<a name="line-412"></a>                 <span class='hs-varid'>mi_used_th</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>used_th</span><span class='hs-layout'>,</span>
<a name="line-413"></a>                 <span class='hs-varid'>mi_anns</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>anns</span><span class='hs-layout'>,</span>
<a name="line-414"></a>                 <span class='hs-varid'>mi_fixities</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fixities</span><span class='hs-layout'>,</span>
<a name="line-415"></a>                 <span class='hs-varid'>mi_warns</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>warns</span><span class='hs-layout'>,</span>
<a name="line-416"></a>                 <span class='hs-varid'>mi_decls</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>decls</span><span class='hs-layout'>,</span>
<a name="line-417"></a>                 <span class='hs-varid'>mi_globals</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span><span class='hs-layout'>,</span>
<a name="line-418"></a>                 <span class='hs-varid'>mi_insts</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>insts</span><span class='hs-layout'>,</span>
<a name="line-419"></a>                 <span class='hs-varid'>mi_fam_insts</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fam_insts</span><span class='hs-layout'>,</span>
<a name="line-420"></a>                 <span class='hs-varid'>mi_rules</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rules</span><span class='hs-layout'>,</span>
<a name="line-421"></a>                 <span class='hs-varid'>mi_hpc</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hpc_info</span><span class='hs-layout'>,</span>
<a name="line-422"></a>                 <span class='hs-varid'>mi_trust</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>trust</span><span class='hs-layout'>,</span>
<a name="line-423"></a>                 <span class='hs-varid'>mi_trust_pkg</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>trust_pkg</span><span class='hs-layout'>,</span>
<a name="line-424"></a>                        <span class='hs-comment'>-- And build the cached values</span>
<a name="line-425"></a>                 <span class='hs-varid'>mi_complete_matches</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>complete_matches</span><span class='hs-layout'>,</span>
<a name="line-426"></a>                 <span class='hs-varid'>mi_doc_hdr</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>doc_hdr</span><span class='hs-layout'>,</span>
<a name="line-427"></a>                 <span class='hs-varid'>mi_decl_docs</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>decl_docs</span><span class='hs-layout'>,</span>
<a name="line-428"></a>                 <span class='hs-varid'>mi_arg_docs</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>arg_docs</span><span class='hs-layout'>,</span>
<a name="line-429"></a>                 <span class='hs-varid'>mi_ext_fields</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyExtensibleFields</span><span class='hs-layout'>,</span> <span class='hs-comment'>-- placeholder because this is dealt</span>
<a name="line-430"></a>                                                         <span class='hs-comment'>-- with specially when the file is read</span>
<a name="line-431"></a>                 <span class='hs-varid'>mi_final_exts</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ModIfaceBackend</span> <span class='hs-layout'>{</span>
<a name="line-432"></a>                   <span class='hs-varid'>mi_iface_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>iface_hash</span><span class='hs-layout'>,</span>
<a name="line-433"></a>                   <span class='hs-varid'>mi_mod_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mod_hash</span><span class='hs-layout'>,</span>
<a name="line-434"></a>                   <span class='hs-varid'>mi_flag_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>flag_hash</span><span class='hs-layout'>,</span>
<a name="line-435"></a>                   <span class='hs-varid'>mi_opt_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>opt_hash</span><span class='hs-layout'>,</span>
<a name="line-436"></a>                   <span class='hs-varid'>mi_hpc_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hpc_hash</span><span class='hs-layout'>,</span>
<a name="line-437"></a>                   <span class='hs-varid'>mi_plugin_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>plugin_hash</span><span class='hs-layout'>,</span>
<a name="line-438"></a>                   <span class='hs-varid'>mi_orphan</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>orphan</span><span class='hs-layout'>,</span>
<a name="line-439"></a>                   <span class='hs-varid'>mi_finsts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hasFamInsts</span><span class='hs-layout'>,</span>
<a name="line-440"></a>                   <span class='hs-varid'>mi_exp_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>exp_hash</span><span class='hs-layout'>,</span>
<a name="line-441"></a>                   <span class='hs-varid'>mi_orphan_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>orphan_hash</span><span class='hs-layout'>,</span>
<a name="line-442"></a>                   <span class='hs-varid'>mi_warn_fn</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIfaceWarnCache</span> <span class='hs-varid'>warns</span><span class='hs-layout'>,</span>
<a name="line-443"></a>                   <span class='hs-varid'>mi_fix_fn</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIfaceFixCache</span> <span class='hs-varid'>fixities</span><span class='hs-layout'>,</span>
<a name="line-444"></a>                   <span class='hs-varid'>mi_hash_fn</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIfaceHashCache</span> <span class='hs-varid'>decls</span>
<a name="line-445"></a>                 <span class='hs-layout'>}</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-446"></a>
<a name="line-447"></a><a name="IfaceExport"></a><span class='hs-comment'>-- | The original names declared of a certain module that are exported</span>
<a name="line-448"></a><a name="IfaceExport"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>IfaceExport</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>AvailInfo</span>
<a name="line-449"></a>
<a name="line-450"></a><a name="emptyPartialModIface"></a><span class='hs-definition'>emptyPartialModIface</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Module</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PartialModIface</span>
<a name="line-451"></a><span class='hs-definition'>emptyPartialModIface</span> <span class='hs-varid'>mod</span>
<a name="line-452"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ModIface</span> <span class='hs-layout'>{</span> <span class='hs-varid'>mi_module</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mod</span><span class='hs-layout'>,</span>
<a name="line-453"></a>               <span class='hs-varid'>mi_sig_of</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span><span class='hs-layout'>,</span>
<a name="line-454"></a>               <span class='hs-varid'>mi_hsc_src</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HsSrcFile</span><span class='hs-layout'>,</span>
<a name="line-455"></a>               <span class='hs-varid'>mi_deps</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>noDependencies</span><span class='hs-layout'>,</span>
<a name="line-456"></a>               <span class='hs-varid'>mi_usages</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span><span class='hs-layout'>,</span>
<a name="line-457"></a>               <span class='hs-varid'>mi_exports</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span><span class='hs-layout'>,</span>
<a name="line-458"></a>               <span class='hs-varid'>mi_used_th</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span><span class='hs-layout'>,</span>
<a name="line-459"></a>               <span class='hs-varid'>mi_fixities</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span><span class='hs-layout'>,</span>
<a name="line-460"></a>               <span class='hs-varid'>mi_warns</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoWarnings</span><span class='hs-layout'>,</span>
<a name="line-461"></a>               <span class='hs-varid'>mi_anns</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span><span class='hs-layout'>,</span>
<a name="line-462"></a>               <span class='hs-varid'>mi_insts</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span><span class='hs-layout'>,</span>
<a name="line-463"></a>               <span class='hs-varid'>mi_fam_insts</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span><span class='hs-layout'>,</span>
<a name="line-464"></a>               <span class='hs-varid'>mi_rules</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span><span class='hs-layout'>,</span>
<a name="line-465"></a>               <span class='hs-varid'>mi_decls</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span><span class='hs-layout'>,</span>
<a name="line-466"></a>               <span class='hs-varid'>mi_globals</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span><span class='hs-layout'>,</span>
<a name="line-467"></a>               <span class='hs-varid'>mi_hpc</span>         <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span><span class='hs-layout'>,</span>
<a name="line-468"></a>               <span class='hs-varid'>mi_trust</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>noIfaceTrustInfo</span><span class='hs-layout'>,</span>
<a name="line-469"></a>               <span class='hs-varid'>mi_trust_pkg</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span><span class='hs-layout'>,</span>
<a name="line-470"></a>               <span class='hs-varid'>mi_complete_matches</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span><span class='hs-layout'>,</span>
<a name="line-471"></a>               <span class='hs-varid'>mi_doc_hdr</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span><span class='hs-layout'>,</span>
<a name="line-472"></a>               <span class='hs-varid'>mi_decl_docs</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyDeclDocMap</span><span class='hs-layout'>,</span>
<a name="line-473"></a>               <span class='hs-varid'>mi_arg_docs</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyArgDocMap</span><span class='hs-layout'>,</span>
<a name="line-474"></a>               <span class='hs-varid'>mi_final_exts</span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>()</span><span class='hs-layout'>,</span>
<a name="line-475"></a>               <span class='hs-varid'>mi_ext_fields</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyExtensibleFields</span>
<a name="line-476"></a>             <span class='hs-layout'>}</span>
<a name="line-477"></a>
<a name="line-478"></a><a name="emptyFullModIface"></a><span class='hs-definition'>emptyFullModIface</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Module</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ModIface</span>
<a name="line-479"></a><span class='hs-definition'>emptyFullModIface</span> <span class='hs-varid'>mod</span> <span class='hs-keyglyph'>=</span>
<a name="line-480"></a>    <span class='hs-layout'>(</span><span class='hs-varid'>emptyPartialModIface</span> <span class='hs-varid'>mod</span><span class='hs-layout'>)</span>
<a name="line-481"></a>      <span class='hs-layout'>{</span> <span class='hs-varid'>mi_decls</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-482"></a>      <span class='hs-layout'>,</span> <span class='hs-varid'>mi_final_exts</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ModIfaceBackend</span>
<a name="line-483"></a>        <span class='hs-layout'>{</span> <span class='hs-varid'>mi_iface_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fingerprint0</span><span class='hs-layout'>,</span>
<a name="line-484"></a>          <span class='hs-varid'>mi_mod_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fingerprint0</span><span class='hs-layout'>,</span>
<a name="line-485"></a>          <span class='hs-varid'>mi_flag_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fingerprint0</span><span class='hs-layout'>,</span>
<a name="line-486"></a>          <span class='hs-varid'>mi_opt_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fingerprint0</span><span class='hs-layout'>,</span>
<a name="line-487"></a>          <span class='hs-varid'>mi_hpc_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fingerprint0</span><span class='hs-layout'>,</span>
<a name="line-488"></a>          <span class='hs-varid'>mi_plugin_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fingerprint0</span><span class='hs-layout'>,</span>
<a name="line-489"></a>          <span class='hs-varid'>mi_orphan</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span><span class='hs-layout'>,</span>
<a name="line-490"></a>          <span class='hs-varid'>mi_finsts</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span><span class='hs-layout'>,</span>
<a name="line-491"></a>          <span class='hs-varid'>mi_exp_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fingerprint0</span><span class='hs-layout'>,</span>
<a name="line-492"></a>          <span class='hs-varid'>mi_orphan_hash</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fingerprint0</span><span class='hs-layout'>,</span>
<a name="line-493"></a>          <span class='hs-varid'>mi_warn_fn</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyIfaceWarnCache</span><span class='hs-layout'>,</span>
<a name="line-494"></a>          <span class='hs-varid'>mi_fix_fn</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyIfaceFixCache</span><span class='hs-layout'>,</span>
<a name="line-495"></a>          <span class='hs-varid'>mi_hash_fn</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyIfaceHashCache</span> <span class='hs-layout'>}</span> <span class='hs-layout'>}</span>
<a name="line-496"></a>
<a name="line-497"></a><a name="mkIfaceHashCache"></a><span class='hs-comment'>-- | Constructs cache for the 'mi_hash_fn' field of a 'ModIface'</span>
<a name="line-498"></a><span class='hs-definition'>mkIfaceHashCache</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Fingerprint</span><span class='hs-layout'>,</span><span class='hs-conid'>IfaceDecl</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-499"></a>                 <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>OccName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>OccName</span><span class='hs-layout'>,</span> <span class='hs-conid'>Fingerprint</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-500"></a><span class='hs-definition'>mkIfaceHashCache</span> <span class='hs-varid'>pairs</span>
<a name="line-501"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>occ</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>lookupOccEnv</span> <span class='hs-varid'>env</span> <span class='hs-varid'>occ</span>
<a name="line-502"></a>  <span class='hs-keyword'>where</span>
<a name="line-503"></a>    <span class='hs-varid'>env</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>foldl'</span> <span class='hs-varid'>add_decl</span> <span class='hs-varid'>emptyOccEnv</span> <span class='hs-varid'>pairs</span>
<a name="line-504"></a>    <span class='hs-varid'>add_decl</span> <span class='hs-varid'>env0</span> <span class='hs-layout'>(</span><span class='hs-varid'>v</span><span class='hs-layout'>,</span><span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>foldl'</span> <span class='hs-varid'>add</span> <span class='hs-varid'>env0</span> <span class='hs-layout'>(</span><span class='hs-varid'>ifaceDeclFingerprints</span> <span class='hs-varid'>v</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-505"></a>      <span class='hs-keyword'>where</span>
<a name="line-506"></a>        <span class='hs-varid'>add</span> <span class='hs-varid'>env0</span> <span class='hs-layout'>(</span><span class='hs-varid'>occ</span><span class='hs-layout'>,</span><span class='hs-varid'>hash</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>extendOccEnv</span> <span class='hs-varid'>env0</span> <span class='hs-varid'>occ</span> <span class='hs-layout'>(</span><span class='hs-varid'>occ</span><span class='hs-layout'>,</span><span class='hs-varid'>hash</span><span class='hs-layout'>)</span>
<a name="line-507"></a>
<a name="line-508"></a><a name="emptyIfaceHashCache"></a><span class='hs-definition'>emptyIfaceHashCache</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>OccName</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>OccName</span><span class='hs-layout'>,</span> <span class='hs-conid'>Fingerprint</span><span class='hs-layout'>)</span>
<a name="line-509"></a><span class='hs-definition'>emptyIfaceHashCache</span> <span class='hs-sel'>_occ</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span>
<a name="line-510"></a>
<a name="line-511"></a><a name="instance%20NFData%20(ModIface_%20phase)"></a><span class='hs-comment'>-- Take care, this instance only forces to the degree necessary to</span>
<a name="line-512"></a><a name="instance%20NFData%20(ModIface_%20phase)"></a><span class='hs-comment'>-- avoid major space leaks.</span>
<a name="line-513"></a><a name="instance%20NFData%20(ModIface_%20phase)"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>NFData</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceBackendExts</span> <span class='hs-layout'>(</span><span class='hs-varid'>phase</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ModIfacePhase</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>NFData</span> <span class='hs-layout'>(</span><span class='hs-conid'>IfaceDeclExts</span> <span class='hs-layout'>(</span><span class='hs-varid'>phase</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ModIfacePhase</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>NFData</span> <span class='hs-layout'>(</span><span class='hs-conid'>ModIface_</span> <span class='hs-varid'>phase</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-514"></a>  <span class='hs-varid'>rnf</span> <span class='hs-layout'>(</span><span class='hs-conid'>ModIface</span> <span class='hs-varid'>f1</span> <span class='hs-varid'>f2</span> <span class='hs-varid'>f3</span> <span class='hs-varid'>f4</span> <span class='hs-varid'>f5</span> <span class='hs-varid'>f6</span> <span class='hs-varid'>f7</span> <span class='hs-varid'>f8</span> <span class='hs-varid'>f9</span> <span class='hs-varid'>f10</span> <span class='hs-varid'>f11</span> <span class='hs-varid'>f12</span>
<a name="line-515"></a>                <span class='hs-varid'>f13</span> <span class='hs-varid'>f14</span> <span class='hs-varid'>f15</span> <span class='hs-varid'>f16</span> <span class='hs-varid'>f17</span> <span class='hs-varid'>f18</span> <span class='hs-varid'>f19</span> <span class='hs-varid'>f20</span> <span class='hs-varid'>f21</span> <span class='hs-varid'>f22</span> <span class='hs-varid'>f23</span> <span class='hs-varid'>f24</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-516"></a>    <span class='hs-varid'>rnf</span> <span class='hs-varid'>f1</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f2</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>f3</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>f4</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>f5</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>f6</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f7</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>f8</span> <span class='hs-varop'>`seq`</span>
<a name="line-517"></a>    <span class='hs-varid'>f9</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f10</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f11</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>f12</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f13</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f14</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f15</span> <span class='hs-varop'>`seq`</span>
<a name="line-518"></a>    <span class='hs-varid'>rnf</span> <span class='hs-varid'>f16</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>f17</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f18</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f19</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>f20</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>f21</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>f22</span> <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f23</span>
<a name="line-519"></a>    <span class='hs-varop'>`seq`</span> <span class='hs-varid'>rnf</span> <span class='hs-varid'>f24</span>
<a name="line-520"></a>
<a name="line-521"></a><a name="WhetherHasOrphans"></a><span class='hs-comment'>-- | Records whether a module has orphans. An \"orphan\" is one of:</span>
<a name="line-522"></a><a name="WhetherHasOrphans"></a><span class='hs-comment'>--</span>
<a name="line-523"></a><a name="WhetherHasOrphans"></a><span class='hs-comment'>-- * An instance declaration in a module other than the definition</span>
<a name="line-524"></a><a name="WhetherHasOrphans"></a><span class='hs-comment'>--   module for one of the type constructors or classes in the instance head</span>
<a name="line-525"></a><a name="WhetherHasOrphans"></a><span class='hs-comment'>--</span>
<a name="line-526"></a><a name="WhetherHasOrphans"></a><span class='hs-comment'>-- * A rewrite rule in a module other than the one defining</span>
<a name="line-527"></a><a name="WhetherHasOrphans"></a><span class='hs-comment'>--   the function in the head of the rule</span>
<a name="line-528"></a><a name="WhetherHasOrphans"></a><span class='hs-comment'>--</span>
<a name="line-529"></a><a name="WhetherHasOrphans"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>WhetherHasOrphans</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Bool</span>
<a name="line-530"></a>
<a name="line-531"></a><a name="WhetherHasFamInst"></a><span class='hs-comment'>-- | Does this module define family instances?</span>
<a name="line-532"></a><a name="WhetherHasFamInst"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>WhetherHasFamInst</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Bool</span>
<a name="line-533"></a>
<a name="line-534"></a>
<a name="line-535"></a>
</pre></body>
</html>
