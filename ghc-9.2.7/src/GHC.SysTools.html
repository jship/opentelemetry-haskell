<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP                 #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">{-
-----------------------------------------------------------------------------
--
-- (c) The University of Glasgow 2001-2003
--
-- Access to system tools: gcc, cp, rm etc
--
-----------------------------------------------------------------------------
-}</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.SysTools</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-15"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Initialisation</span></span><span>
</span><span id="line-16"></span><span>        </span><span class="annot"><a href="GHC.SysTools.html#initSysTools"><span class="hs-identifier">initSysTools</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>        </span><span class="annot"><a href="GHC.SysTools.html#lazyInitLlvmConfig"><span class="hs-identifier">lazyInitLlvmConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Interface to system tools</span></span><span>
</span><span id="line-20"></span><span>        </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.SysTools.Tasks.html"><span class="hs-identifier">GHC.SysTools.Tasks</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>        </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.SysTools.Info.html"><span class="hs-identifier">GHC.SysTools.Info</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>        </span><span class="annot"><a href="GHC.SysTools.html#copy"><span class="hs-identifier">copy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><a href="GHC.SysTools.html#copyWithHeader"><span class="hs-identifier">copyWithHeader</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>        </span><span class="annot"><span class="hs-comment">-- * General utilities</span></span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><a href="GHC.Utils.CliOption.html#Option"><span class="hs-identifier">Option</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><a href="../../ghc-boot-9.2.7/src/GHC-BaseDir.html#expandTopDir"><span class="hs-identifier">expandTopDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#include &quot;HsVersions.h&quot;
</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../ghc-boot-9.2.7/src/GHC-Settings-Utils.html#"><span class="hs-identifier">GHC.Settings.Utils</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Error.html"><span class="hs-identifier">GHC.Utils.Error</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html"><span class="hs-identifier">GHC.Utils.Logger</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html"><span class="hs-identifier">GHC.Driver.Session</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-Except.html#"><span class="hs-identifier">Control.Monad.Trans.Except</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-Except.html#runExceptT"><span class="hs-identifier">runExceptT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../filepath-1.4.2.2/src/System-FilePath.html#"><span class="hs-identifier">System.FilePath</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/System-IO.html#"><span class="hs-identifier">System.IO</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/System-IO-Unsafe.html#"><span class="hs-identifier">System.IO.Unsafe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-IO-Unsafe.html#unsafeInterleaveIO"><span class="hs-identifier">unsafeInterleaveIO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Linker.ExtraObj.html"><span class="hs-identifier">GHC.Linker.ExtraObj</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.SysTools.Info.html"><span class="hs-identifier">GHC.SysTools.Info</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.SysTools.Tasks.html"><span class="hs-identifier">GHC.SysTools.Tasks</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.SysTools.BaseDir.html"><span class="hs-identifier">GHC.SysTools.BaseDir</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Settings.IO.html"><span class="hs-identifier">GHC.Settings.IO</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">{-
Note [How GHC finds toolchain utilities]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

GHC.SysTools.initSysProgs figures out exactly where all the auxiliary programs
are, and initialises mutable variables to make it easy to call them.
To do this, it makes use of definitions in Config.hs, which is a Haskell
file containing variables whose value is figured out by the build system.

Config.hs contains two sorts of things

  cGCC,         The *names* of the programs
  cCPP            e.g.  cGCC = gcc
  cUNLIT                cCPP = gcc -E
  etc           They do *not* include paths


  cUNLIT_DIR   The *path* to the directory containing unlit, split etc
  cSPLIT_DIR   *relative* to the root of the build tree,
                   for use when running *in-place* in a build tree (only)


---------------------------------------------
NOTES for an ALTERNATIVE scheme (i.e *not* what is currently implemented):

Another hair-brained scheme for simplifying the current tool location
nightmare in GHC: Simon originally suggested using another
configuration file along the lines of GCC's specs file - which is fine
except that it means adding code to read yet another configuration
file.  What I didn't notice is that the current package.conf is
general enough to do this:

Package
    {name = &quot;tools&quot;,    import_dirs = [],  source_dirs = [],
     library_dirs = [], hs_libraries = [], extra_libraries = [],
     include_dirs = [], c_includes = [],   package_deps = [],
     extra_ghc_opts = [&quot;-pgmc/usr/bin/gcc&quot;,&quot;-pgml${topdir}/bin/unlit&quot;, ... etc.],
     extra_cc_opts = [], extra_ld_opts = []}

Which would have the advantage that we get to collect together in one
place the path-specific package stuff with the path-specific tool
stuff.
                End of NOTES
---------------------------------------------

************************************************************************
*                                                                      *
\subsection{Initialisation}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- Note [LLVM configuration]</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- The `llvm-targets` and `llvm-passes` files are shipped with GHC and contain</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- information needed by the LLVM backend to invoke `llc` and `opt`.</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- Specifically:</span><span>
</span><span id="line-109"></span><span class="hs-comment">--</span><span>
</span><span id="line-110"></span><span class="hs-comment">--  * llvm-targets maps autoconf host triples to the corresponding LLVM</span><span>
</span><span id="line-111"></span><span class="hs-comment">--    `data-layout` declarations. This information is extracted from clang using</span><span>
</span><span id="line-112"></span><span class="hs-comment">--    the script in utils/llvm-targets/gen-data-layout.sh and should be updated</span><span>
</span><span id="line-113"></span><span class="hs-comment">--    whenever we target a new version of LLVM.</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">--  * llvm-passes maps GHC optimization levels to sets of LLVM optimization</span><span>
</span><span id="line-116"></span><span class="hs-comment">--    flags that GHC should pass to `opt`.</span><span>
</span><span id="line-117"></span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- This information is contained in files rather the GHC source to allow users</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- to add new targets to GHC without having to recompile the compiler.</span><span>
</span><span id="line-120"></span><span class="hs-comment">--</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- Since this information is only needed by the LLVM backend we load it lazily</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- with unsafeInterleaveIO. Consequently it is important that we lazily pattern</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- match on LlvmConfig until we actually need its contents.</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="annot"><a href="GHC.SysTools.html#lazyInitLlvmConfig"><span class="hs-identifier hs-type">lazyInitLlvmConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-126"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#LlvmConfig"><span class="hs-identifier hs-type">LlvmConfig</span></a></span><span>
</span><span id="line-127"></span><span id="lazyInitLlvmConfig"><span class="annot"><span class="annottext">lazyInitLlvmConfig :: String -&gt; IO LlvmConfig
</span><a href="GHC.SysTools.html#lazyInitLlvmConfig"><span class="hs-identifier hs-var hs-var">lazyInitLlvmConfig</span></a></span></span><span> </span><span id="local-6989586621681224570"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224570"><span class="hs-identifier hs-var">top_dir</span></a></span></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. IO a -&gt; IO a
</span><a href="../../base-4.16.4.0/src/GHC-IO-Unsafe.html#unsafeInterleaveIO"><span class="hs-identifier hs-var">unsafeInterleaveIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>    </span><span class="hs-comment">-- see Note [LLVM configuration]</span><span>
</span><span id="line-129"></span><span>      </span><span id="local-6989586621681224569"><span class="annot"><span class="annottext">[(String, (String, String, String))]
</span><a href="#local-6989586621681224569"><span class="hs-identifier hs-var">targets</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Read a =&gt; String -&gt; IO a
</span><a href="#local-6989586621681224568"><span class="hs-identifier hs-var">readAndParse</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;llvm-targets&quot;</span></span><span>
</span><span id="line-130"></span><span>      </span><span id="local-6989586621681224567"><span class="annot"><span class="annottext">[(Int, String)]
</span><a href="#local-6989586621681224567"><span class="hs-identifier hs-var">passes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Read a =&gt; String -&gt; IO a
</span><a href="#local-6989586621681224568"><span class="hs-identifier hs-var">readAndParse</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;llvm-passes&quot;</span></span><span>
</span><span id="line-131"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#LlvmConfig"><span class="hs-identifier hs-type">LlvmConfig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">llvmTargets :: [(String, LlvmTarget)]
</span><a href="GHC.Driver.Session.html#llvmTargets"><span class="hs-identifier hs-var">llvmTargets</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(String, String, String) -&gt; LlvmTarget
</span><a href="#local-6989586621681224564"><span class="hs-identifier hs-var">mkLlvmTarget</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.16.4.0/src/Data-Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, (String, String, String))]
</span><a href="#local-6989586621681224569"><span class="hs-identifier hs-var">targets</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-132"></span><span>                            </span><span class="annot"><span class="annottext">llvmPasses :: [(Int, String)]
</span><a href="GHC.Driver.Session.html#llvmPasses"><span class="hs-identifier hs-var">llvmPasses</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int, String)]
</span><a href="#local-6989586621681224567"><span class="hs-identifier hs-var">passes</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621681224645"><span class="annot"><a href="#local-6989586621681224568"><span class="hs-identifier hs-type">readAndParse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Read.html#Read"><span class="hs-identifier hs-type">Read</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681224645"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621681224645"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621681224568"><span class="annot"><span class="annottext">readAndParse :: forall a. Read a =&gt; String -&gt; IO a
</span><a href="#local-6989586621681224568"><span class="hs-identifier hs-var hs-var">readAndParse</span></a></span></span><span> </span><span id="local-6989586621681224553"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224553"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-136"></span><span>      </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681224552"><span class="annot"><span class="annottext">llvmConfigFile :: String
</span><a href="#local-6989586621681224552"><span class="hs-identifier hs-var hs-var">llvmConfigFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224570"><span class="hs-identifier hs-var">top_dir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="../../filepath-1.4.2.2/src/System-FilePath-Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224553"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-137"></span><span>         </span><span id="local-6989586621681224550"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224550"><span class="hs-identifier hs-var">llvmConfigStr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><a href="../../base-4.16.4.0/src/System-IO.html#readFile"><span class="hs-identifier hs-var">readFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224552"><span class="hs-identifier hs-var">llvmConfigFile</span></a></span><span>
</span><span id="line-138"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. Read a =&gt; String -&gt; Maybe a
</span><a href="../../ghc-boot-9.2.7/src/GHC-Settings-Utils.html#maybeReadFuzzy"><span class="hs-identifier hs-var">maybeReadFuzzy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224550"><span class="hs-identifier hs-var">llvmConfigStr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-139"></span><span>           </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681224547"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681224547"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681224547"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-140"></span><span>           </span><span class="annot"><span class="annottext">Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#pgmError"><span class="hs-identifier hs-var">pgmError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't parse &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../base-4.16.4.0/src/GHC-Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224552"><span class="hs-identifier hs-var">llvmConfigFile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><a href="#local-6989586621681224564"><span class="hs-identifier hs-type">mkLlvmTarget</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#LlvmTarget"><span class="hs-identifier hs-type">LlvmTarget</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621681224564"><span class="annot"><span class="annottext">mkLlvmTarget :: (String, String, String) -&gt; LlvmTarget
</span><a href="#local-6989586621681224564"><span class="hs-identifier hs-var hs-var">mkLlvmTarget</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681224544"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224544"><span class="hs-identifier hs-var">dl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681224543"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224543"><span class="hs-identifier hs-var">cpu</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681224542"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224542"><span class="hs-identifier hs-var">attrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; [String] -&gt; LlvmTarget
</span><a href="GHC.Driver.Session.html#LlvmTarget"><span class="hs-identifier hs-var">LlvmTarget</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224544"><span class="hs-identifier hs-var">dl</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224543"><span class="hs-identifier hs-var">cpu</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String]
</span><a href="../../base-4.16.4.0/src/Data-OldList.html#words"><span class="hs-identifier hs-var">words</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224542"><span class="hs-identifier hs-var">attrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><a href="GHC.SysTools.html#initSysTools"><span class="hs-identifier hs-type">initSysTools</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>          </span><span class="hs-comment">-- TopDir path</span><span>
</span><span id="line-147"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="GHC.Settings.html#Settings"><span class="hs-identifier hs-type">Settings</span></a></span><span>     </span><span class="hs-comment">-- Set all the mutable variables above, holding</span><span>
</span><span id="line-148"></span><span>                                </span><span class="hs-comment">--      (a) the system programs</span><span>
</span><span id="line-149"></span><span>                                </span><span class="hs-comment">--      (b) the package-config file</span><span>
</span><span id="line-150"></span><span>                                </span><span class="hs-comment">--      (c) the GHC usage message</span><span>
</span><span id="line-151"></span><span id="initSysTools"><span class="annot"><span class="annottext">initSysTools :: String -&gt; IO Settings
</span><a href="GHC.SysTools.html#initSysTools"><span class="hs-identifier hs-var hs-var">initSysTools</span></a></span></span><span> </span><span id="local-6989586621681224539"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224539"><span class="hs-identifier hs-var">top_dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span>  </span><span id="local-6989586621681224538"><span class="annot"><span class="annottext">Either SettingsError Settings
</span><a href="#local-6989586621681224538"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../../transformers-0.5.6.2/src/Control-Monad-Trans-Except.html#runExceptT"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadIO m =&gt;
String -&gt; ExceptT SettingsError m Settings
</span><a href="GHC.Settings.IO.html#initSettings"><span class="hs-identifier hs-var">initSettings</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224539"><span class="hs-identifier hs-var">top_dir</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either SettingsError Settings
</span><a href="#local-6989586621681224538"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621681224536"><span class="annot"><span class="annottext">Settings
</span><a href="#local-6989586621681224536"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Settings
</span><a href="#local-6989586621681224536"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Settings.IO.html#SettingsError_MissingData"><span class="hs-identifier hs-type">SettingsError_MissingData</span></a></span><span> </span><span id="local-6989586621681224534"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224534"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#pgmError"><span class="hs-identifier hs-var">pgmError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224534"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Settings.IO.html#SettingsError_BadData"><span class="hs-identifier hs-type">SettingsError_BadData</span></a></span><span> </span><span id="local-6989586621681224532"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224532"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#pgmError"><span class="hs-identifier hs-var">pgmError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224532"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">{- Note [Windows stack usage]

See: #8870 (and #8834 for related info) and #12186

On Windows, occasionally we need to grow the stack. In order to do
this, we would normally just bump the stack pointer - but there's a
catch on Windows.

If the stack pointer is bumped by more than a single page, then the
pages between the initial pointer and the resulting location must be
properly committed by the Windows virtual memory subsystem. This is
only needed in the event we bump by more than one page (i.e 4097 bytes
or more).

Windows compilers solve this by emitting a call to a special function
called _chkstk, which does this committing of the pages for you.

The reason this was causing a segfault was because due to the fact the
new code generator tends to generate larger functions, we needed more
stack space in GHC itself. In the x86 codegen, we needed approximately
~12kb of stack space in one go, which caused the process to segfault,
as the intervening pages were not committed.

GCC can emit such a check for us automatically but only when the flag
-fstack-check is used.

See https://gcc.gnu.org/onlinedocs/gnat_ugn/Stack-Overflow-Checking.html
for more information.

-}</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><a href="GHC.SysTools.html#copy"><span class="hs-identifier hs-type">copy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span id="copy"><span class="annot"><span class="annottext">copy :: Logger -&gt; DynFlags -&gt; String -&gt; String -&gt; String -&gt; IO ()
</span><a href="GHC.SysTools.html#copy"><span class="hs-identifier hs-var hs-var">copy</span></a></span></span><span> </span><span id="local-6989586621681224530"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681224530"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621681224529"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681224529"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681224528"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224528"><span class="hs-identifier hs-var">purpose</span></a></span></span><span> </span><span id="local-6989586621681224527"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224527"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621681224526"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224526"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Logger
-&gt; DynFlags -&gt; String -&gt; Maybe String -&gt; String -&gt; String -&gt; IO ()
</span><a href="GHC.SysTools.html#copyWithHeader"><span class="hs-identifier hs-var">copyWithHeader</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681224530"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681224529"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224528"><span class="hs-identifier hs-var">purpose</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224527"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224526"><span class="hs-identifier hs-var">to</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="annot"><a href="GHC.SysTools.html#copyWithHeader"><span class="hs-identifier hs-type">copyWithHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-193"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span id="copyWithHeader"><span class="annot"><span class="annottext">copyWithHeader :: Logger
-&gt; DynFlags -&gt; String -&gt; Maybe String -&gt; String -&gt; String -&gt; IO ()
</span><a href="GHC.SysTools.html#copyWithHeader"><span class="hs-identifier hs-var hs-var">copyWithHeader</span></a></span></span><span> </span><span id="local-6989586621681224525"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681224525"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621681224524"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681224524"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681224523"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224523"><span class="hs-identifier hs-var">purpose</span></a></span></span><span> </span><span id="local-6989586621681224522"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681224522"><span class="hs-identifier hs-var">maybe_header</span></a></span></span><span> </span><span id="local-6989586621681224521"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224521"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621681224520"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224520"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><span class="annottext">Logger -&gt; DynFlags -&gt; String -&gt; IO ()
</span><a href="GHC.Utils.Error.html#showPass"><span class="hs-identifier hs-var">showPass</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681224525"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681224524"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224523"><span class="hs-identifier hs-var">purpose</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>  </span><span id="local-6989586621681224518"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621681224518"><span class="hs-identifier hs-var">hout</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; IO Handle
</span><a href="../../base-4.16.4.0/src/GHC-IO-StdHandles.html#openBinaryFile"><span class="hs-identifier hs-var">openBinaryFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224520"><span class="hs-identifier hs-var">to</span></a></span><span>   </span><span class="annot"><span class="annottext">IOMode
</span><a href="../../base-4.16.4.0/src/GHC-IO-IOMode.html#WriteMode"><span class="hs-identifier hs-var">WriteMode</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621681224515"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621681224515"><span class="hs-identifier hs-var">hin</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; IO Handle
</span><a href="../../base-4.16.4.0/src/GHC-IO-StdHandles.html#openBinaryFile"><span class="hs-identifier hs-var">openBinaryFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224521"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><a href="../../base-4.16.4.0/src/GHC-IO-IOMode.html#ReadMode"><span class="hs-identifier hs-var">ReadMode</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span id="local-6989586621681224513"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224513"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO String
</span><a href="../../base-4.16.4.0/src/GHC-IO-Handle-Text.html#hGetContents"><span class="hs-identifier hs-var">hGetContents</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621681224515"><span class="hs-identifier hs-var">hin</span></a></span><span> </span><span class="hs-comment">-- inefficient, but it'll do for now. ToDo: speed up</span><span>
</span><span id="line-200"></span><span>  </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../base-4.16.4.0/src/Data-Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><a href="#local-6989586621681224510"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621681224518"><span class="hs-identifier hs-var">hout</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621681224522"><span class="hs-identifier hs-var">maybe_header</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><a href="../../base-4.16.4.0/src/GHC-IO-Handle-Text.html#hPutStr"><span class="hs-identifier hs-var">hPutStr</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621681224518"><span class="hs-identifier hs-var">hout</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224513"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="../../base-4.16.4.0/src/GHC-IO-Handle.html#hClose"><span class="hs-identifier hs-var">hClose</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621681224518"><span class="hs-identifier hs-var">hout</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="../../base-4.16.4.0/src/GHC-IO-Handle.html#hClose"><span class="hs-identifier hs-var">hClose</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621681224515"><span class="hs-identifier hs-var">hin</span></a></span><span>
</span><span id="line-204"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-comment">-- write the header string in UTF-8.  The header is something like</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-comment">--   {-# LINE &quot;foo.hs&quot; #-}</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-comment">-- and we want to make sure a Unicode filename isn't mangled.</span><span>
</span><span id="line-208"></span><span>  </span><span id="local-6989586621681224510"><span class="annot"><span class="annottext">header :: Handle -&gt; String -&gt; IO ()
</span><a href="#local-6989586621681224510"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span id="local-6989586621681224505"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621681224505"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621681224504"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224504"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-209"></span><span>   </span><span class="annot"><span class="annottext">Handle -&gt; TextEncoding -&gt; IO ()
</span><a href="../../base-4.16.4.0/src/GHC-IO-Handle.html#hSetEncoding"><span class="hs-identifier hs-var">hSetEncoding</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621681224505"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">TextEncoding
</span><a href="../../base-4.16.4.0/src/GHC-IO-Encoding.html#utf8"><span class="hs-identifier hs-var">utf8</span></a></span><span>
</span><span id="line-210"></span><span>   </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><a href="../../base-4.16.4.0/src/GHC-IO-Handle-Text.html#hPutStr"><span class="hs-identifier hs-var">hPutStr</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621681224505"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681224504"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-211"></span><span>   </span><span class="annot"><span class="annottext">Handle -&gt; Bool -&gt; IO ()
</span><a href="../../base-4.16.4.0/src/GHC-IO-Handle.html#hSetBinaryMode"><span class="hs-identifier hs-var">hSetBinaryMode</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621681224505"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-212"></span></pre></body></html>