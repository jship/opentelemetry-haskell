<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998


@Uniques@ are used to distinguish entities in the compiler (@Ids@,
@Classes@, etc.) from each other.  Thus, @Uniques@ are the basic
comparison key in the compiler.

If there is any single operation that needs to be fast, it is @Unique@

comparison.  Unsurprisingly, there is quite a bit of huff-and-puff
directed to that end.

Some of the other hair in this code is to be able to use a
``splittable @UniqueSupply@'' if requested/possible (not standard
Haskell).
-}</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE CPP, BangPatterns, MagicHash #-}</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Types.Unique</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-23"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Main data types</span></span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier">Unique</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Uniquable"><span class="hs-identifier">Uniquable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>        </span><span class="annot"><a href="GHC.Types.Unique.html#uNIQUE_BITS"><span class="hs-identifier">uNIQUE_BITS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Constructors, destructors and operations on 'Unique's</span></span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><a href="GHC.Types.Unique.html#hasKey"><span class="hs-identifier">hasKey</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>        </span><span class="annot"><a href="GHC.Types.Unique.html#pprUniqueAlways"><span class="hs-identifier">pprUniqueAlways</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>        </span><span class="annot"><a href="GHC.Types.Unique.html#mkUniqueGrimily"><span class="hs-identifier">mkUniqueGrimily</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>        </span><span class="annot"><a href="GHC.Types.Unique.html#getKey"><span class="hs-identifier">getKey</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>        </span><span class="annot"><a href="GHC.Types.Unique.html#mkUnique"><span class="hs-identifier">mkUnique</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#unpkUnique"><span class="hs-identifier">unpkUnique</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><a href="GHC.Types.Unique.html#eqUnique"><span class="hs-identifier">eqUnique</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#ltUnique"><span class="hs-identifier">ltUnique</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><a href="GHC.Types.Unique.html#incrUnique"><span class="hs-identifier">incrUnique</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#stepUnique"><span class="hs-identifier">stepUnique</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>        </span><span class="annot"><a href="GHC.Types.Unique.html#newTagUnique"><span class="hs-identifier">newTagUnique</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>        </span><span class="annot"><a href="GHC.Types.Unique.html#nonDetCmpUnique"><span class="hs-identifier">nonDetCmpUnique</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>        </span><span class="annot"><a href="GHC.Types.Unique.html#isValidKnownKeyUnique"><span class="hs-identifier">isValidKnownKeyUnique</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Local uniques</span></span><span>
</span><span id="line-43"></span><span>        </span><span class="hs-comment">-- | These are exposed exclusively for use by 'GHC.Types.Var.Env.uniqAway', which</span><span>
</span><span id="line-44"></span><span>        </span><span class="hs-comment">-- has rather peculiar needs. See Note [Local uniques].</span><span>
</span><span id="line-45"></span><span>        </span><span class="annot"><a href="GHC.Types.Unique.html#mkLocalUnique"><span class="hs-identifier">mkLocalUnique</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#minLocalUnique"><span class="hs-identifier">minLocalUnique</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#maxLocalUnique"><span class="hs-identifier">maxLocalUnique</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#include &quot;HsVersions.h&quot;
</span><span class="hs-cpp">#include &quot;Unique.h&quot;
</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- just for implementing a fast [0,61) -&gt; Char function</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Exts.html#"><span class="hs-identifier">GHC.Exts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">indexCharOffAddr#</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Char</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Int</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/Data-Char.html#"><span class="hs-identifier">Data.Char</span></a></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Char.html#chr"><span class="hs-identifier">chr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#ord"><span class="hs-identifier">ord</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[Unique-type]{@Unique@ type and operations}
*                                                                      *
************************************************************************

Note [Uniques and masks]
~~~~~~~~~~~~~~~~~~~~~~~~
A `Unique` in GHC is a Word-sized value composed of two pieces:
* A &quot;mask&quot;, of width `UNIQUE_TAG_BITS`, in the high order bits
* A number, of width `uNIQUE_BITS`, which fills up the remainder of the Word

The mask is typically an ASCII character.  It is typically used to make it easier
to distinguish uniques constructed by different parts of the compiler.
There is a (potentially incomplete) list of unique masks used given in
GHC.Builtin.Uniques. See Note [Uniques-prelude - Uniques for wired-in Prelude things]

`mkUnique` constructs a `Unique` from its pieces
  mkUnique :: Char -&gt; Int -&gt; Unique

-}</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- | Unique identifier.</span><span>
</span><span id="line-87"></span><span class="hs-comment">--</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- The type of unique identifiers that are used in many places in GHC</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- for fast ordering and equality tests. You should generate these with</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- the functions from the 'UniqSupply' module</span><span>
</span><span id="line-91"></span><span class="hs-comment">--</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- These are sometimes also referred to as \&quot;keys\&quot; in comments in GHC.</span><span>
</span><span id="line-93"></span><span class="hs-keyword">newtype</span><span> </span><span id="Unique"><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-var">Unique</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MkUnique"><span class="annot"><a href="GHC.Types.Unique.html#MkUnique"><span class="hs-identifier hs-var">MkUnique</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#uNIQUE_BITS"><span class="hs-pragma hs-type">uNIQUE_BITS</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-96"></span><span class="annot"><a href="GHC.Types.Unique.html#uNIQUE_BITS"><span class="hs-identifier hs-type">uNIQUE_BITS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-97"></span><span id="uNIQUE_BITS"><span class="annot"><span class="annottext">uNIQUE_BITS :: Int
</span><a href="GHC.Types.Unique.html#uNIQUE_BITS"><span class="hs-identifier hs-var hs-var">uNIQUE_BITS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b. FiniteBits b =&gt; b -&gt; Int
</span><a href="../../base-4.16.4.0/src/GHC-Bits.html#finiteBitSize"><span class="hs-identifier hs-var">finiteBitSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="hs-identifier">UNIQUE_TAG_BITS</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">{-
Now come the functions which construct uniques from their pieces, and vice versa.
The stuff about unique *supplies* is handled further down this module.
-}</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="annot"><a href="GHC.Types.Unique.html#unpkUnique"><span class="hs-identifier hs-type">unpkUnique</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>        </span><span class="hs-comment">-- The reverse</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="GHC.Types.Unique.html#mkUniqueGrimily"><span class="hs-identifier hs-type">mkUniqueGrimily</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span>                </span><span class="hs-comment">-- A trap-door for UniqSupply</span><span>
</span><span id="line-107"></span><span class="annot"><a href="GHC.Types.Unique.html#getKey"><span class="hs-identifier hs-type">getKey</span></a></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                </span><span class="hs-comment">-- for Var</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="annot"><a href="GHC.Types.Unique.html#incrUnique"><span class="hs-identifier hs-type">incrUnique</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span>
</span><span id="line-110"></span><span class="annot"><a href="GHC.Types.Unique.html#stepUnique"><span class="hs-identifier hs-type">stepUnique</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span>
</span><span id="line-111"></span><span class="annot"><a href="GHC.Types.Unique.html#newTagUnique"><span class="hs-identifier hs-type">newTagUnique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span id="mkUniqueGrimily"><span class="annot"><span class="annottext">mkUniqueGrimily :: Int -&gt; Unique
</span><a href="GHC.Types.Unique.html#mkUniqueGrimily"><span class="hs-identifier hs-var hs-var">mkUniqueGrimily</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Unique
</span><a href="GHC.Types.Unique.html#MkUnique"><span class="hs-identifier hs-var">MkUnique</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#getKey"><span class="hs-pragma hs-type">getKey</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-116"></span><span id="getKey"><span class="annot"><span class="annottext">getKey :: Unique -&gt; Int
</span><a href="GHC.Types.Unique.html#getKey"><span class="hs-identifier hs-var hs-var">getKey</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.html#MkUnique"><span class="hs-identifier hs-type">MkUnique</span></a></span><span> </span><span id="local-6989586621680980003"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680980003"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680980003"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span id="incrUnique"><span class="annot"><span class="annottext">incrUnique :: Unique -&gt; Unique
</span><a href="GHC.Types.Unique.html#incrUnique"><span class="hs-identifier hs-var hs-var">incrUnique</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.html#MkUnique"><span class="hs-identifier hs-type">MkUnique</span></a></span><span> </span><span id="local-6989586621680980002"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680980002"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Unique
</span><a href="GHC.Types.Unique.html#MkUnique"><span class="hs-identifier hs-var">MkUnique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680980002"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span id="stepUnique"><span class="annot"><span class="annottext">stepUnique :: Unique -&gt; Int -&gt; Unique
</span><a href="GHC.Types.Unique.html#stepUnique"><span class="hs-identifier hs-var hs-var">stepUnique</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.html#MkUnique"><span class="hs-identifier hs-type">MkUnique</span></a></span><span> </span><span id="local-6989586621680980000"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680980000"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680979999"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979999"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Unique
</span><a href="GHC.Types.Unique.html#MkUnique"><span class="hs-identifier hs-var">MkUnique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680980000"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979999"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><a href="GHC.Types.Unique.html#mkLocalUnique"><span class="hs-identifier hs-type">mkLocalUnique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span>
</span><span id="line-122"></span><span id="mkLocalUnique"><span class="annot"><span class="annottext">mkLocalUnique :: Int -&gt; Unique
</span><a href="GHC.Types.Unique.html#mkLocalUnique"><span class="hs-identifier hs-var hs-var">mkLocalUnique</span></a></span></span><span> </span><span id="local-6989586621680979998"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979998"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int -&gt; Unique
</span><a href="GHC.Types.Unique.html#mkUnique"><span class="hs-identifier hs-var">mkUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'X'</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979998"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="annot"><a href="GHC.Types.Unique.html#minLocalUnique"><span class="hs-identifier hs-type">minLocalUnique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span>
</span><span id="line-125"></span><span id="minLocalUnique"><span class="annot"><span class="annottext">minLocalUnique :: Unique
</span><a href="GHC.Types.Unique.html#minLocalUnique"><span class="hs-identifier hs-var hs-var">minLocalUnique</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Unique
</span><a href="GHC.Types.Unique.html#mkLocalUnique"><span class="hs-identifier hs-var">mkLocalUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><a href="GHC.Types.Unique.html#maxLocalUnique"><span class="hs-identifier hs-type">maxLocalUnique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span>
</span><span id="line-128"></span><span id="maxLocalUnique"><span class="annot"><span class="annottext">maxLocalUnique :: Unique
</span><a href="GHC.Types.Unique.html#maxLocalUnique"><span class="hs-identifier hs-var hs-var">maxLocalUnique</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Unique
</span><a href="GHC.Types.Unique.html#mkLocalUnique"><span class="hs-identifier hs-var">mkLocalUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GHC.Types.Unique.html#uniqueMask"><span class="hs-identifier hs-var">uniqueMask</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- newTagUnique changes the &quot;domain&quot; of a unique to a different char</span><span>
</span><span id="line-131"></span><span id="newTagUnique"><span class="annot"><span class="annottext">newTagUnique :: Unique -&gt; Char -&gt; Unique
</span><a href="GHC.Types.Unique.html#newTagUnique"><span class="hs-identifier hs-var hs-var">newTagUnique</span></a></span></span><span> </span><span id="local-6989586621680979996"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979996"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621680979995"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680979995"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int -&gt; Unique
</span><a href="GHC.Types.Unique.html#mkUnique"><span class="hs-identifier hs-var">mkUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680979995"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979994"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680979994"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979994"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; (Char, Int)
</span><a href="GHC.Types.Unique.html#unpkUnique"><span class="hs-identifier hs-var">unpkUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979996"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- | How many bits are devoted to the unique index (as opposed to the class</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- character).</span><span>
</span><span id="line-135"></span><span class="annot"><a href="GHC.Types.Unique.html#uniqueMask"><span class="hs-identifier hs-type">uniqueMask</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-136"></span><span id="uniqueMask"><span class="annot"><span class="annottext">uniqueMask :: Int
</span><a href="GHC.Types.Unique.html#uniqueMask"><span class="hs-identifier hs-var hs-var">uniqueMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GHC.Types.Unique.html#uNIQUE_BITS"><span class="hs-identifier hs-var">uNIQUE_BITS</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- pop the Char in the top 8 bits of the Unique(Supply)</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- No 64-bit bugs here, as long as we have at least 32 bits. --JSM</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- and as long as the Char fits in 8 bits, which we assume anyway!</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="annot"><a href="GHC.Types.Unique.html#mkUnique"><span class="hs-identifier hs-type">mkUnique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span>       </span><span class="hs-comment">-- Builds a unique from pieces</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- EXPORTED and used only in GHC.Builtin.Uniques</span><span>
</span><span id="line-146"></span><span id="mkUnique"><span class="annot"><span class="annottext">mkUnique :: Char -&gt; Int -&gt; Unique
</span><a href="GHC.Types.Unique.html#mkUnique"><span class="hs-identifier hs-var hs-var">mkUnique</span></a></span></span><span> </span><span id="local-6989586621680979992"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680979992"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621680979991"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979991"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Unique
</span><a href="GHC.Types.Unique.html#MkUnique"><span class="hs-identifier hs-var">MkUnique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979990"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979988"><span class="hs-identifier hs-var">bits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621680979990"><span class="annot"><span class="annottext">tag :: Int
</span><a href="#local-6989586621680979990"><span class="hs-identifier hs-var hs-var">tag</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680979992"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GHC.Types.Unique.html#uNIQUE_BITS"><span class="hs-identifier hs-var">uNIQUE_BITS</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span id="local-6989586621680979988"><span class="annot"><span class="annottext">bits :: Int
</span><a href="#local-6989586621680979988"><span class="hs-identifier hs-var hs-var">bits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979991"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GHC.Types.Unique.html#uniqueMask"><span class="hs-identifier hs-var">uniqueMask</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span id="unpkUnique"><span class="annot"><span class="annottext">unpkUnique :: Unique -&gt; (Char, Int)
</span><a href="GHC.Types.Unique.html#unpkUnique"><span class="hs-identifier hs-var hs-var">unpkUnique</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.html#MkUnique"><span class="hs-identifier hs-type">MkUnique</span></a></span><span> </span><span id="local-6989586621680979986"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979986"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-comment">-- as long as the Char may have its eighth bit set, we</span><span>
</span><span id="line-155"></span><span>        </span><span class="hs-comment">-- really do need the logical right-shift here!</span><span>
</span><span id="line-156"></span><span>        </span><span id="local-6989586621680979985"><span class="annot"><span class="annottext">tag :: Char
</span><a href="#local-6989586621680979985"><span class="hs-identifier hs-var hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char
</span><a href="../../base-4.16.4.0/src/GHC-Char.html#chr"><span class="hs-identifier hs-var">chr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979986"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GHC.Types.Unique.html#uNIQUE_BITS"><span class="hs-identifier hs-var">uNIQUE_BITS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>        </span><span id="local-6989586621680979983"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621680979983"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979986"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="GHC.Types.Unique.html#uniqueMask"><span class="hs-identifier hs-var">uniqueMask</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-keyword">in</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680979985"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979983"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- | The interface file symbol-table encoding assumes that known-key uniques fit</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- in 30-bits; verify this.</span><span>
</span><span id="line-163"></span><span class="hs-comment">--</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- See Note [Symbol table representation of names] in &quot;GHC.Iface.Binary&quot; for details.</span><span>
</span><span id="line-165"></span><span class="annot"><a href="GHC.Types.Unique.html#isValidKnownKeyUnique"><span class="hs-identifier hs-type">isValidKnownKeyUnique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-166"></span><span id="isValidKnownKeyUnique"><span class="annot"><span class="annottext">isValidKnownKeyUnique :: Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#isValidKnownKeyUnique"><span class="hs-identifier hs-var hs-var">isValidKnownKeyUnique</span></a></span></span><span> </span><span id="local-6989586621680979982"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979982"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; (Char, Int)
</span><a href="GHC.Types.Unique.html#unpkUnique"><span class="hs-identifier hs-var">unpkUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979982"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-168"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680979981"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680979981"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680979980"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979980"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680979981"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0xff</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979980"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Prelude.html#shiftL"><span class="hs-operator hs-var">`shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">22</span></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[Uniquable-class]{The @Uniquable@ class}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | Class of things that we can obtain a 'Unique' from</span><span>
</span><span id="line-179"></span><span class="hs-keyword">class</span><span> </span><span id="Uniquable"><span class="annot"><a href="GHC.Types.Unique.html#Uniquable"><span class="hs-identifier hs-var">Uniquable</span></a></span></span><span> </span><span id="local-6989586621680980071"><span class="annot"><a href="#local-6989586621680980071"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>    </span><span id="getUnique"><span class="annot"><a href="GHC.Types.Unique.html#getUnique"><span class="hs-identifier hs-type">getUnique</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680980071"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span id="local-6989586621680980074"><span class="annot"><a href="GHC.Types.Unique.html#hasKey"><span class="hs-identifier hs-type">hasKey</span></a></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Uniquable"><span class="hs-identifier hs-type">Uniquable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680980074"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680980074"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-183"></span><span id="local-6989586621680979971"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680979971"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="hasKey"><span class="annot"><span class="annottext">hasKey :: forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var hs-var">`hasKey`</span></a></span></span><span> </span><span id="local-6989586621680979970"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979970"><span class="hs-identifier hs-var">k</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Uniquable a =&gt; a -&gt; Unique
</span><a href="GHC.Types.Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680979971"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979970"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Uniquable"><span class="hs-identifier hs-type">Uniquable</span></a></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span> </span><span id="local-6989586621680979966"><span class="annot"><span class="annottext">getUnique :: FastString -&gt; Unique
</span><a href="#local-6989586621680979966"><span class="hs-identifier hs-var hs-var hs-var hs-var">getUnique</span></a></span></span><span> </span><span id="local-6989586621680979965"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680979965"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Unique
</span><a href="GHC.Types.Unique.html#mkUniqueGrimily"><span class="hs-identifier hs-var">mkUniqueGrimily</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; Int
</span><a href="GHC.Data.FastString.html#uniqueOfFS"><span class="hs-identifier hs-var">uniqueOfFS</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621680979965"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Uniquable"><span class="hs-identifier hs-type">Uniquable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-189"></span><span> </span><span id="local-6989586621680979961"><span class="annot"><span class="annottext">getUnique :: Int -&gt; Unique
</span><a href="#local-6989586621680979961"><span class="hs-identifier hs-var hs-var hs-var hs-var">getUnique</span></a></span></span><span> </span><span id="local-6989586621680979960"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979960"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Unique
</span><a href="GHC.Types.Unique.html#mkUniqueGrimily"><span class="hs-identifier hs-var">mkUniqueGrimily</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979960"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[Unique-instances]{Instance declarations for @Unique@}
*                                                                      *
************************************************************************

And the whole point (besides uniqueness) is fast equality.  We don't
use `deriving' because we want {\em precise} control of ordering
(equality on @Uniques@ is v common).
-}</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-comment">-- Note [Unique Determinism]</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- The order of allocated @Uniques@ is not stable across rebuilds.</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- The main reason for that is that typechecking interface files pulls</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- @Uniques@ from @UniqSupply@ and the interface file for the module being</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- currently compiled can, but doesn't have to exist.</span><span>
</span><span id="line-209"></span><span class="hs-comment">--</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- It gets more complicated if you take into account that the interface</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- files are loaded lazily and that building multiple files at once has to</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- work for any subset of interface files present. When you add parallelism</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- this makes @Uniques@ hopelessly random.</span><span>
</span><span id="line-214"></span><span class="hs-comment">--</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- As such, to get deterministic builds, the order of the allocated</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- @Uniques@ should not affect the final result.</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- see also wiki/deterministic-builds</span><span>
</span><span id="line-218"></span><span class="hs-comment">--</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- Note [Unique Determinism and code generation]</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- The goal of the deterministic builds (wiki/deterministic-builds, #4012)</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- is to get ABI compatible binaries given the same inputs and environment.</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- The motivation behind that is that if the ABI doesn't change the</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- binaries can be safely reused.</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- Note that this is weaker than bit-for-bit identical binaries and getting</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- bit-for-bit identical binaries is not a goal for now.</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- This means that we don't care about nondeterminism that happens after</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- the interface files are created, in particular we don't care about</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- register allocation and code generation.</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- To track progress on bit-for-bit determinism see #12262.</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="annot"><a href="GHC.Types.Unique.html#eqUnique"><span class="hs-identifier hs-type">eqUnique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-233"></span><span id="eqUnique"><span class="annot"><span class="annottext">eqUnique :: Unique -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#eqUnique"><span class="hs-identifier hs-var hs-var">eqUnique</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.html#MkUnique"><span class="hs-identifier hs-type">MkUnique</span></a></span><span> </span><span id="local-6989586621680979959"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979959"><span class="hs-identifier hs-var">u1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.html#MkUnique"><span class="hs-identifier hs-type">MkUnique</span></a></span><span> </span><span id="local-6989586621680979958"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979958"><span class="hs-identifier hs-var">u2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979959"><span class="hs-identifier hs-var">u1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979958"><span class="hs-identifier hs-var">u2</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="annot"><a href="GHC.Types.Unique.html#ltUnique"><span class="hs-identifier hs-type">ltUnique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-236"></span><span id="ltUnique"><span class="annot"><span class="annottext">ltUnique :: Unique -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#ltUnique"><span class="hs-identifier hs-var hs-var">ltUnique</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.html#MkUnique"><span class="hs-identifier hs-type">MkUnique</span></a></span><span> </span><span id="local-6989586621680979957"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979957"><span class="hs-identifier hs-var">u1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.html#MkUnique"><span class="hs-identifier hs-type">MkUnique</span></a></span><span> </span><span id="local-6989586621680979956"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979956"><span class="hs-identifier hs-var">u2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979957"><span class="hs-identifier hs-var">u1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979956"><span class="hs-identifier hs-var">u2</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- Provided here to make it explicit at the call-site that it can</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- introduce non-determinism.</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- See Note [Unique Determinism]</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- See Note [No Ord for Unique]</span><span>
</span><span id="line-242"></span><span class="annot"><a href="GHC.Types.Unique.html#nonDetCmpUnique"><span class="hs-identifier hs-type">nonDetCmpUnique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span>
</span><span id="line-243"></span><span id="nonDetCmpUnique"><span class="annot"><span class="annottext">nonDetCmpUnique :: Unique -&gt; Unique -&gt; Ordering
</span><a href="GHC.Types.Unique.html#nonDetCmpUnique"><span class="hs-identifier hs-var hs-var">nonDetCmpUnique</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.html#MkUnique"><span class="hs-identifier hs-type">MkUnique</span></a></span><span> </span><span id="local-6989586621680979955"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979955"><span class="hs-identifier hs-var">u1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Unique.html#MkUnique"><span class="hs-identifier hs-type">MkUnique</span></a></span><span> </span><span id="local-6989586621680979954"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979954"><span class="hs-identifier hs-var">u2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979955"><span class="hs-identifier hs-var">u1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979954"><span class="hs-identifier hs-var">u2</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979955"><span class="hs-identifier hs-var">u1</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979954"><span class="hs-identifier hs-var">u2</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">{-
Note [No Ord for Unique]
~~~~~~~~~~~~~~~~~~~~~~~~~~
As explained in Note [Unique Determinism] the relative order of Uniques
is nondeterministic. To prevent from accidental use the Ord Unique
instance has been removed.
This makes it easier to maintain deterministic builds, but comes with some
drawbacks.
The biggest drawback is that Maps keyed by Uniques can't directly be used.
The alternatives are:

  1) Use UniqFM or UniqDFM, see Note [Deterministic UniqFM] to decide which
  2) Create a newtype wrapper based on Unique ordering where nondeterminism
     is controlled. See Module.ModuleEnv
  3) Change the algorithm to use nonDetCmpUnique and document why it's still
     deterministic
  4) Use TrieMap as done in GHC.Cmm.CommonBlockElim.groupByLabel
-}</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-266"></span><span>    </span><span id="local-6989586621680979950"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979950"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680979949"><span class="annot"><span class="annottext">== :: Unique -&gt; Unique -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621680979948"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979948"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#eqUnique"><span class="hs-identifier hs-var">eqUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979950"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979948"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span id="local-6989586621680979947"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979947"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680979946"><span class="annot"><span class="annottext">/= :: Unique -&gt; Unique -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">/=</span></span></span><span> </span><span id="local-6989586621680979944"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979944"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#eqUnique"><span class="hs-identifier hs-var">eqUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979947"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979944"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Uniquable"><span class="hs-identifier hs-type">Uniquable</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-270"></span><span>    </span><span id="local-6989586621680979940"><span class="annot"><span class="annottext">getUnique :: Unique -&gt; Unique
</span><a href="#local-6989586621680979940"><span class="hs-identifier hs-var hs-var hs-var hs-var">getUnique</span></a></span></span><span> </span><span id="local-6989586621680979939"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979939"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979939"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- We do sometimes make strings with @Uniques@ in them:</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="annot"><a href="GHC.Types.Unique.html#showUnique"><span class="hs-identifier hs-type">showUnique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-275"></span><span id="showUnique"><span class="annot"><span class="annottext">showUnique :: Unique -&gt; String
</span><a href="GHC.Types.Unique.html#showUnique"><span class="hs-identifier hs-var hs-var">showUnique</span></a></span></span><span> </span><span id="local-6989586621680979937"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979937"><span class="hs-identifier hs-var">uniq</span></a></span></span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; (Char, Int)
</span><a href="GHC.Types.Unique.html#unpkUnique"><span class="hs-identifier hs-var">unpkUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979937"><span class="hs-identifier hs-var">uniq</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-277"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680979936"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680979936"><span class="hs-identifier hs-var">tag</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680979935"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979935"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int -&gt; String -&gt; String
</span><a href="GHC.Types.Unique.html#finish_show"><span class="hs-identifier hs-var">finish_show</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680979936"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979935"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="GHC.Types.Unique.html#iToBase62"><span class="hs-identifier hs-var">iToBase62</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979935"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="annot"><a href="GHC.Types.Unique.html#finish_show"><span class="hs-identifier hs-type">finish_show</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-280"></span><span id="finish_show"><span class="annot"><span class="annottext">finish_show :: Char -&gt; Int -&gt; String -&gt; String
</span><a href="GHC.Types.Unique.html#finish_show"><span class="hs-identifier hs-var hs-var">finish_show</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'t'</span></span><span> </span><span id="local-6989586621680979932"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979932"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621680979931"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680979931"><span class="hs-identifier hs-var">_pp_u</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979932"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">26</span></span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- Special case to make v common tyvars, t1, t2, ...</span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-comment">-- come out as a, b, ... (shorter, easier to read)</span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Char
</span><a href="../../base-4.16.4.0/src/GHC-Char.html#chr"><span class="hs-identifier hs-var">chr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.16.4.0/src/GHC-Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979932"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-284"></span><span class="annot"><a href="GHC.Types.Unique.html#finish_show"><span class="hs-identifier hs-var">finish_show</span></a></span><span> </span><span id="local-6989586621680979930"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680979930"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680979929"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680979929"><span class="hs-identifier hs-var">pp_u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680979930"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680979929"><span class="hs-identifier hs-var">pp_u</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><a href="GHC.Types.Unique.html#pprUniqueAlways"><span class="hs-identifier hs-type">pprUniqueAlways</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#SDoc"><span class="hs-identifier hs-type">SDoc</span></a></span><span>
</span><span id="line-287"></span><span class="hs-comment">-- The &quot;always&quot; means regardless of -dsuppress-uniques</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- It replaces the old pprUnique to remind callers that</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- they should consider whether they want to consult</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- Opt_SuppressUniques</span><span>
</span><span id="line-291"></span><span id="pprUniqueAlways"><span class="annot"><span class="annottext">pprUniqueAlways :: Unique -&gt; SDoc
</span><a href="GHC.Types.Unique.html#pprUniqueAlways"><span class="hs-identifier hs-var hs-var">pprUniqueAlways</span></a></span></span><span> </span><span id="local-6989586621680979928"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979928"><span class="hs-identifier hs-var">u</span></a></span></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unique -&gt; String
</span><a href="GHC.Types.Unique.html#showUnique"><span class="hs-identifier hs-var">showUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979928"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html#Outputable"><span class="hs-identifier hs-type">Outputable</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-295"></span><span>    </span><span id="local-6989586621680979923"><span class="annot"><span class="annottext">ppr :: Unique -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; SDoc
</span><a href="GHC.Types.Unique.html#pprUniqueAlways"><span class="hs-identifier hs-var">pprUniqueAlways</span></a></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680979917"><span id="local-6989586621680979920"><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-298"></span><span>    </span><span id="local-6989586621680979915"><span class="annot"><span class="annottext">show :: Unique -&gt; String
</span><a href="../../base-4.16.4.0/src/GHC-Show.html#show"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span id="local-6989586621680979913"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979913"><span class="hs-identifier hs-var">uniq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; String
</span><a href="GHC.Types.Unique.html#showUnique"><span class="hs-identifier hs-var">showUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621680979913"><span class="hs-identifier hs-var">uniq</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection[Utils-base62]{Base-62 numbers}
*                                                                      *
************************************************************************

A character-stingy way to read/write numbers (notably Uniques).
The ``62-its'' are \tr{[0-9a-zA-Z]}.  We don't handle negative Ints.
Code stolen from Lennart.
-}</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="annot"><a href="GHC.Types.Unique.html#iToBase62"><span class="hs-identifier hs-type">iToBase62</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.16.4.0/src/GHC-Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-313"></span><span id="iToBase62"><span class="annot"><span class="annottext">iToBase62 :: Int -&gt; String
</span><a href="GHC.Types.Unique.html#iToBase62"><span class="hs-identifier hs-var hs-var">iToBase62</span></a></span></span><span> </span><span id="local-6989586621680979912"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979912"><span class="hs-identifier hs-var">n_</span></a></span></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ASSERT</span><span class="hs-special">(</span><span class="hs-identifier">n_</span><span> </span><span class="hs-operator">&gt;=</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">n_</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>    </span><span id="local-6989586621680979909"><span class="annot"><span class="annottext">go :: Int -&gt; String -&gt; String
</span><a href="#local-6989586621680979909"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680979903"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979903"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680979902"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680979902"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979903"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">62</span></span><span>
</span><span id="line-317"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621680979901"><span class="annot"><span class="annottext">c :: Char
</span><a href="#local-6989586621680979901"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char
</span><a href="#local-6989586621680979900"><span class="hs-identifier hs-var">chooseChar62</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979903"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680979901"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680979902"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-318"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.16.4.0/src/GHC-Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-319"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
</span><a href="#local-6989586621680979909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979899"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680979898"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680979902"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621680979899"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979899"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680979897"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979897"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><a href="../../base-4.16.4.0/src/GHC-Real.html#quotRem"><span class="hs-identifier hs-var">quotRem</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979903"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">62</span></span><span>
</span><span id="line-320"></span><span>                                  </span><span class="hs-glyph">!</span><span id="local-6989586621680979898"><span class="annot"><span class="annottext">c :: Char
</span><a href="#local-6989586621680979898"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char
</span><a href="#local-6989586621680979900"><span class="hs-identifier hs-var">chooseChar62</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680979897"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><a href="#local-6989586621680979900"><span class="hs-identifier hs-type">chooseChar62</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621680979900"><span class="hs-pragma hs-type">chooseChar62</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621680979900"><span class="annot"><span class="annottext">chooseChar62 :: Int -&gt; Char
</span><a href="#local-6989586621680979900"><span class="hs-identifier hs-var hs-var">chooseChar62</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621680979895"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621680979895"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char# -&gt; Char
</span><span class="hs-identifier hs-var">C#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Char#
</span><span class="hs-identifier hs-var">indexCharOffAddr#</span></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621680979894"><span class="hs-identifier hs-var">chars62</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621680979895"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>    </span><span id="local-6989586621680979894"><span class="annot"><span class="annottext">chars62 :: Addr#
</span><a href="#local-6989586621680979894"><span class="hs-identifier hs-var hs-var">chars62</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><span class="hs-string">&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;#</span></span><span>
</span><span id="line-326"></span></pre></body></html>