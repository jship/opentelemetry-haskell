<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621679210313"><span id="local-6989586621679210314"><span id="local-6989586621679210315"><span id="local-6989586621679210316"></span></span></span></span><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Crypto.KDF.Argon2</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Portability : unknown</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Argon2 hashing function (P-H-C winner)</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Recommended to use this module qualified</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- File started from Argon2.hs, from Oliver Charles</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- at https://github.com/ocharles/argon2</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Crypto.KDF.Argon2</span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-17"></span><span>      </span><span class="annot"><a href="Crypto.KDF.Argon2.html#Options"><span class="hs-identifier">Options</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#TimeCost"><span class="hs-identifier">TimeCost</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#MemoryCost"><span class="hs-identifier">MemoryCost</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#Parallelism"><span class="hs-identifier">Parallelism</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#Variant"><span class="hs-identifier">Variant</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#Version"><span class="hs-identifier">Version</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#defaultOptions"><span class="hs-identifier">defaultOptions</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Hashing function</span></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#hash"><span class="hs-identifier">hash</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Internal.ByteArray.html"><span class="hs-identifier">Crypto.Internal.ByteArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteArray</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ByteArrayAccess</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Crypto.Internal.ByteArray.html"><span class="hs-identifier">Crypto.Internal.ByteArray</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Error.html"><span class="hs-identifier">Crypto.Error</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Foreign.C</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Foreign.Ptr</span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">-- | Which variant of Argon2 to use. You should choose the variant that is most</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- applicable to your intention to hash inputs.</span><span>
</span><span id="line-38"></span><span class="hs-keyword">data</span><span> </span><span id="Variant"><span class="annot"><a href="Crypto.KDF.Argon2.html#Variant"><span class="hs-identifier hs-var">Variant</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-39"></span><span>      </span><span id="Argon2d"><span class="annot"><a href="Crypto.KDF.Argon2.html#Argon2d"><span class="hs-identifier hs-var">Argon2d</span></a></span></span><span>  </span><span class="hs-comment">-- ^ Argon2d is faster than Argon2i and uses data-depending memory access,</span><span>
</span><span id="line-40"></span><span>               </span><span class="hs-comment">-- which makes it suitable for cryptocurrencies and applications with no</span><span>
</span><span id="line-41"></span><span>               </span><span class="hs-comment">-- threats from side-channel timing attacks.</span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Argon2i"><span class="annot"><a href="Crypto.KDF.Argon2.html#Argon2i"><span class="hs-identifier hs-var">Argon2i</span></a></span></span><span>  </span><span class="hs-comment">-- ^ Argon2i uses data-independent memory access, which is preferred</span><span>
</span><span id="line-43"></span><span>               </span><span class="hs-comment">-- for password hashing and password-based key derivation. Argon2i</span><span>
</span><span id="line-44"></span><span>               </span><span class="hs-comment">-- is slower as it makes more passes over the memory to protect from</span><span>
</span><span id="line-45"></span><span>               </span><span class="hs-comment">-- tradeoff attacks.</span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Argon2id"><span class="annot"><a href="Crypto.KDF.Argon2.html#Argon2id"><span class="hs-identifier hs-var">Argon2id</span></a></span></span><span> </span><span class="hs-comment">-- ^ Argon2id is a hybrid of Argon2i and Argon2d, using a combination</span><span>
</span><span id="line-47"></span><span>               </span><span class="hs-comment">-- of data-depending and data-independent memory accesses, which gives</span><span>
</span><span id="line-48"></span><span>               </span><span class="hs-comment">-- some of Argon2i's resistance to side-channel cache timing attacks</span><span>
</span><span id="line-49"></span><span>               </span><span class="hs-comment">-- and much of Argon2d's resistance to GPU cracking attacks</span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679210285"><span id="local-6989586621679210287"><span class="annot"><span class="annottext">Variant -&gt; Variant -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Variant -&gt; Variant -&gt; Bool
$c/= :: Variant -&gt; Variant -&gt; Bool
== :: Variant -&gt; Variant -&gt; Bool
$c== :: Variant -&gt; Variant -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210265"><span id="local-6989586621679210267"><span id="local-6989586621679210270"><span id="local-6989586621679210273"><span id="local-6989586621679210276"><span id="local-6989586621679210278"><span id="local-6989586621679210280"><span class="annot"><span class="annottext">Eq Variant
Variant -&gt; Variant -&gt; Bool
Variant -&gt; Variant -&gt; Ordering
Variant -&gt; Variant -&gt; Variant
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Variant -&gt; Variant -&gt; Variant
$cmin :: Variant -&gt; Variant -&gt; Variant
max :: Variant -&gt; Variant -&gt; Variant
$cmax :: Variant -&gt; Variant -&gt; Variant
&gt;= :: Variant -&gt; Variant -&gt; Bool
$c&gt;= :: Variant -&gt; Variant -&gt; Bool
&gt; :: Variant -&gt; Variant -&gt; Bool
$c&gt; :: Variant -&gt; Variant -&gt; Bool
&lt;= :: Variant -&gt; Variant -&gt; Bool
$c&lt;= :: Variant -&gt; Variant -&gt; Bool
&lt; :: Variant -&gt; Variant -&gt; Bool
$c&lt; :: Variant -&gt; Variant -&gt; Bool
compare :: Variant -&gt; Variant -&gt; Ordering
$ccompare :: Variant -&gt; Variant -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210251"><span id="local-6989586621679210257"><span id="local-6989586621679210260"><span id="local-6989586621679210262"><span class="annot"><span class="annottext">ReadPrec [Variant]
ReadPrec Variant
Int -&gt; ReadS Variant
ReadS [Variant]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Variant]
$creadListPrec :: ReadPrec [Variant]
readPrec :: ReadPrec Variant
$creadPrec :: ReadPrec Variant
readList :: ReadS [Variant]
$creadList :: ReadS [Variant]
readsPrec :: Int -&gt; ReadS Variant
$creadsPrec :: Int -&gt; ReadS Variant
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210243"><span id="local-6989586621679210245"><span id="local-6989586621679210247"><span class="annot"><span class="annottext">Int -&gt; Variant -&gt; ShowS
[Variant] -&gt; ShowS
Variant -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Variant] -&gt; ShowS
$cshowList :: [Variant] -&gt; ShowS
show :: Variant -&gt; String
$cshow :: Variant -&gt; String
showsPrec :: Int -&gt; Variant -&gt; ShowS
$cshowsPrec :: Int -&gt; Variant -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210204"><span id="local-6989586621679210206"><span id="local-6989586621679210210"><span id="local-6989586621679210214"><span id="local-6989586621679210216"><span id="local-6989586621679210226"><span id="local-6989586621679210232"><span id="local-6989586621679210240"><span class="annot"><span class="annottext">Int -&gt; Variant
Variant -&gt; Int
Variant -&gt; [Variant]
Variant -&gt; Variant
Variant -&gt; Variant -&gt; [Variant]
Variant -&gt; Variant -&gt; Variant -&gt; [Variant]
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: Variant -&gt; Variant -&gt; Variant -&gt; [Variant]
$cenumFromThenTo :: Variant -&gt; Variant -&gt; Variant -&gt; [Variant]
enumFromTo :: Variant -&gt; Variant -&gt; [Variant]
$cenumFromTo :: Variant -&gt; Variant -&gt; [Variant]
enumFromThen :: Variant -&gt; Variant -&gt; [Variant]
$cenumFromThen :: Variant -&gt; Variant -&gt; [Variant]
enumFrom :: Variant -&gt; [Variant]
$cenumFrom :: Variant -&gt; [Variant]
fromEnum :: Variant -&gt; Int
$cfromEnum :: Variant -&gt; Int
toEnum :: Int -&gt; Variant
$ctoEnum :: Int -&gt; Variant
pred :: Variant -&gt; Variant
$cpred :: Variant -&gt; Variant
succ :: Variant -&gt; Variant
$csucc :: Variant -&gt; Variant
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210199"><span id="local-6989586621679210201"><span class="annot"><span class="annottext">Variant
forall a. a -&gt; a -&gt; Bounded a
maxBound :: Variant
$cmaxBound :: Variant
minBound :: Variant
$cminBound :: Variant
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">-- | Which version of Argon2 to use</span><span>
</span><span id="line-53"></span><span class="hs-keyword">data</span><span> </span><span id="Version"><span class="annot"><a href="Crypto.KDF.Argon2.html#Version"><span class="hs-identifier hs-var">Version</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Version10"><span class="annot"><a href="Crypto.KDF.Argon2.html#Version10"><span class="hs-identifier hs-var">Version10</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Version13"><span class="annot"><a href="Crypto.KDF.Argon2.html#Version13"><span class="hs-identifier hs-var">Version13</span></a></span></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679210191"><span id="local-6989586621679210193"><span class="annot"><span class="annottext">Version -&gt; Version -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Version -&gt; Version -&gt; Bool
$c/= :: Version -&gt; Version -&gt; Bool
== :: Version -&gt; Version -&gt; Bool
$c== :: Version -&gt; Version -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210172"><span id="local-6989586621679210174"><span id="local-6989586621679210177"><span id="local-6989586621679210180"><span id="local-6989586621679210183"><span id="local-6989586621679210185"><span id="local-6989586621679210187"><span class="annot"><span class="annottext">Eq Version
Version -&gt; Version -&gt; Bool
Version -&gt; Version -&gt; Ordering
Version -&gt; Version -&gt; Version
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Version -&gt; Version -&gt; Version
$cmin :: Version -&gt; Version -&gt; Version
max :: Version -&gt; Version -&gt; Version
$cmax :: Version -&gt; Version -&gt; Version
&gt;= :: Version -&gt; Version -&gt; Bool
$c&gt;= :: Version -&gt; Version -&gt; Bool
&gt; :: Version -&gt; Version -&gt; Bool
$c&gt; :: Version -&gt; Version -&gt; Bool
&lt;= :: Version -&gt; Version -&gt; Bool
$c&lt;= :: Version -&gt; Version -&gt; Bool
&lt; :: Version -&gt; Version -&gt; Bool
$c&lt; :: Version -&gt; Version -&gt; Bool
compare :: Version -&gt; Version -&gt; Ordering
$ccompare :: Version -&gt; Version -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210161"><span id="local-6989586621679210165"><span id="local-6989586621679210168"><span id="local-6989586621679210170"><span class="annot"><span class="annottext">ReadPrec [Version]
ReadPrec Version
Int -&gt; ReadS Version
ReadS [Version]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Version]
$creadListPrec :: ReadPrec [Version]
readPrec :: ReadPrec Version
$creadPrec :: ReadPrec Version
readList :: ReadS [Version]
$creadList :: ReadS [Version]
readsPrec :: Int -&gt; ReadS Version
$creadsPrec :: Int -&gt; ReadS Version
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210154"><span id="local-6989586621679210156"><span id="local-6989586621679210158"><span class="annot"><span class="annottext">Int -&gt; Version -&gt; ShowS
[Version] -&gt; ShowS
Version -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Version] -&gt; ShowS
$cshowList :: [Version] -&gt; ShowS
show :: Version -&gt; String
$cshow :: Version -&gt; String
showsPrec :: Int -&gt; Version -&gt; ShowS
$cshowsPrec :: Int -&gt; Version -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210121"><span id="local-6989586621679210123"><span id="local-6989586621679210127"><span id="local-6989586621679210130"><span id="local-6989586621679210132"><span id="local-6989586621679210140"><span id="local-6989586621679210146"><span id="local-6989586621679210152"><span class="annot"><span class="annottext">Int -&gt; Version
Version -&gt; Int
Version -&gt; [Version]
Version -&gt; Version
Version -&gt; Version -&gt; [Version]
Version -&gt; Version -&gt; Version -&gt; [Version]
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: Version -&gt; Version -&gt; Version -&gt; [Version]
$cenumFromThenTo :: Version -&gt; Version -&gt; Version -&gt; [Version]
enumFromTo :: Version -&gt; Version -&gt; [Version]
$cenumFromTo :: Version -&gt; Version -&gt; [Version]
enumFromThen :: Version -&gt; Version -&gt; [Version]
$cenumFromThen :: Version -&gt; Version -&gt; [Version]
enumFrom :: Version -&gt; [Version]
$cenumFrom :: Version -&gt; [Version]
fromEnum :: Version -&gt; Int
$cfromEnum :: Version -&gt; Int
toEnum :: Int -&gt; Version
$ctoEnum :: Int -&gt; Version
pred :: Version -&gt; Version
$cpred :: Version -&gt; Version
succ :: Version -&gt; Version
$csucc :: Version -&gt; Version
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210117"><span id="local-6989586621679210119"><span class="annot"><span class="annottext">Version
forall a. a -&gt; a -&gt; Bounded a
maxBound :: Version
$cmaxBound :: Version
minBound :: Version
$cminBound :: Version
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-comment">-- | The time cost, which defines the amount of computation realized and therefore the execution time, given in number of iterations.</span><span>
</span><span id="line-57"></span><span class="hs-comment">--</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- 'FFI.ARGON2_MIN_TIME' &lt;= 'hashIterations' &lt;= 'FFI.ARGON2_MAX_TIME'</span><span>
</span><span id="line-59"></span><span class="hs-keyword">type</span><span> </span><span id="TimeCost"><span class="annot"><a href="Crypto.KDF.Argon2.html#TimeCost"><span class="hs-identifier hs-var">TimeCost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | The memory cost, which defines the memory usage, given in kibibytes.</span><span>
</span><span id="line-62"></span><span class="hs-comment">--</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- max 'FFI.ARGON2_MIN_MEMORY' (8 * 'hashParallelism') &lt;= 'hashMemory' &lt;= 'FFI.ARGON2_MAX_MEMORY'</span><span>
</span><span id="line-64"></span><span class="hs-keyword">type</span><span> </span><span id="MemoryCost"><span class="annot"><a href="Crypto.KDF.Argon2.html#MemoryCost"><span class="hs-identifier hs-var">MemoryCost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- | A parallelism degree, which defines the number of parallel threads.</span><span>
</span><span id="line-67"></span><span class="hs-comment">--</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- 'FFI.ARGON2_MIN_LANES' &lt;= 'hashParallelism' &lt;= 'FFI.ARGON2_MAX_LANES' &amp;&amp; 'FFI.ARGON_MIN_THREADS' &lt;= 'hashParallelism' &lt;= 'FFI.ARGON2_MAX_THREADS'</span><span>
</span><span id="line-69"></span><span class="hs-keyword">type</span><span> </span><span id="Parallelism"><span class="annot"><a href="Crypto.KDF.Argon2.html#Parallelism"><span class="hs-identifier hs-var">Parallelism</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | Parameters that can be adjusted to change the runtime performance of the</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- hashing.</span><span>
</span><span id="line-73"></span><span class="hs-keyword">data</span><span> </span><span id="Options"><span class="annot"><a href="Crypto.KDF.Argon2.html#Options"><span class="hs-identifier hs-var">Options</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Options"><span class="annot"><a href="Crypto.KDF.Argon2.html#Options"><span class="hs-identifier hs-var">Options</span></a></span></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="iterations"><span class="annot"><span class="annottext">Options -&gt; TimeCost
</span><a href="Crypto.KDF.Argon2.html#iterations"><span class="hs-identifier hs-var hs-var">iterations</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Crypto.KDF.Argon2.html#TimeCost"><span class="hs-identifier hs-type">TimeCost</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="memory"><span class="annot"><span class="annottext">Options -&gt; TimeCost
</span><a href="Crypto.KDF.Argon2.html#memory"><span class="hs-identifier hs-var hs-var">memory</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Crypto.KDF.Argon2.html#MemoryCost"><span class="hs-identifier hs-type">MemoryCost</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="parallelism"><span class="annot"><span class="annottext">Options -&gt; TimeCost
</span><a href="Crypto.KDF.Argon2.html#parallelism"><span class="hs-identifier hs-var hs-var">parallelism</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Crypto.KDF.Argon2.html#Parallelism"><span class="hs-identifier hs-type">Parallelism</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="variant"><span class="annot"><span class="annottext">Options -&gt; Variant
</span><a href="Crypto.KDF.Argon2.html#variant"><span class="hs-identifier hs-var hs-var">variant</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Crypto.KDF.Argon2.html#Variant"><span class="hs-identifier hs-type">Variant</span></a></span><span>     </span><span class="hs-comment">-- ^ Which variant of Argon2 to use.</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="version"><span class="annot"><span class="annottext">Options -&gt; Version
</span><a href="Crypto.KDF.Argon2.html#version"><span class="hs-identifier hs-var hs-var">version</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Crypto.KDF.Argon2.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span>     </span><span class="hs-comment">-- ^ Which version of Argon2 to use.</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679210100"><span id="local-6989586621679210108"><span class="annot"><span class="annottext">Options -&gt; Options -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Options -&gt; Options -&gt; Bool
$c/= :: Options -&gt; Options -&gt; Bool
== :: Options -&gt; Options -&gt; Bool
$c== :: Options -&gt; Options -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210070"><span id="local-6989586621679210072"><span id="local-6989586621679210075"><span id="local-6989586621679210078"><span id="local-6989586621679210081"><span id="local-6989586621679210088"><span id="local-6989586621679210096"><span class="annot"><span class="annottext">Eq Options
Options -&gt; Options -&gt; Bool
Options -&gt; Options -&gt; Ordering
Options -&gt; Options -&gt; Options
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Options -&gt; Options -&gt; Options
$cmin :: Options -&gt; Options -&gt; Options
max :: Options -&gt; Options -&gt; Options
$cmax :: Options -&gt; Options -&gt; Options
&gt;= :: Options -&gt; Options -&gt; Bool
$c&gt;= :: Options -&gt; Options -&gt; Bool
&gt; :: Options -&gt; Options -&gt; Bool
$c&gt; :: Options -&gt; Options -&gt; Bool
&lt;= :: Options -&gt; Options -&gt; Bool
$c&lt;= :: Options -&gt; Options -&gt; Bool
&lt; :: Options -&gt; Options -&gt; Bool
$c&lt; :: Options -&gt; Options -&gt; Bool
compare :: Options -&gt; Options -&gt; Ordering
$ccompare :: Options -&gt; Options -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210042"><span id="local-6989586621679210063"><span id="local-6989586621679210066"><span id="local-6989586621679210068"><span class="annot"><span class="annottext">ReadPrec [Options]
ReadPrec Options
Int -&gt; ReadS Options
ReadS [Options]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Options]
$creadListPrec :: ReadPrec [Options]
readPrec :: ReadPrec Options
$creadPrec :: ReadPrec Options
readList :: ReadS [Options]
$creadList :: ReadS [Options]
readsPrec :: Int -&gt; ReadS Options
$creadsPrec :: Int -&gt; ReadS Options
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210028"><span id="local-6989586621679210030"><span id="local-6989586621679210039"><span class="annot"><span class="annottext">Int -&gt; Options -&gt; ShowS
[Options] -&gt; ShowS
Options -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Options] -&gt; ShowS
$cshowList :: [Options] -&gt; ShowS
show :: Options -&gt; String
$cshow :: Options -&gt; String
showsPrec :: Int -&gt; Options -&gt; ShowS
$cshowsPrec :: Int -&gt; Options -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="annot"><a href="Crypto.KDF.Argon2.html#saltMinLength"><span class="hs-identifier hs-type">saltMinLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-83"></span><span id="saltMinLength"><span class="annot"><span class="annottext">saltMinLength :: Int
</span><a href="Crypto.KDF.Argon2.html#saltMinLength"><span class="hs-identifier hs-var hs-var">saltMinLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="annot"><a href="Crypto.KDF.Argon2.html#outputMinLength"><span class="hs-identifier hs-type">outputMinLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-86"></span><span id="outputMinLength"><span class="annot"><span class="annottext">outputMinLength :: Int
</span><a href="Crypto.KDF.Argon2.html#outputMinLength"><span class="hs-identifier hs-var hs-var">outputMinLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">-- specification allows up to 2^32-1 but this is too big for a signed Int</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- on a 32-bit architecture, so we limit tag length to 2^31-1 bytes</span><span>
</span><span id="line-90"></span><span class="annot"><a href="Crypto.KDF.Argon2.html#outputMaxLength"><span class="hs-identifier hs-type">outputMaxLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-91"></span><span id="outputMaxLength"><span class="annot"><span class="annottext">outputMaxLength :: Int
</span><a href="Crypto.KDF.Argon2.html#outputMaxLength"><span class="hs-identifier hs-var hs-var">outputMaxLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x7fffffff</span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="annot"><a href="Crypto.KDF.Argon2.html#defaultOptions"><span class="hs-identifier hs-type">defaultOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span>
</span><span id="line-94"></span><span id="defaultOptions"><span class="annot"><span class="annottext">defaultOptions :: Options
</span><a href="Crypto.KDF.Argon2.html#defaultOptions"><span class="hs-identifier hs-var hs-var">defaultOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><a href="Crypto.KDF.Argon2.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">iterations :: TimeCost
</span><a href="Crypto.KDF.Argon2.html#iterations"><span class="hs-identifier hs-var">iterations</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TimeCost
</span><span class="hs-number">1</span></span><span>
</span><span id="line-96"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">memory :: TimeCost
</span><a href="Crypto.KDF.Argon2.html#memory"><span class="hs-identifier hs-var">memory</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TimeCost
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">17</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">parallelism :: TimeCost
</span><a href="Crypto.KDF.Argon2.html#parallelism"><span class="hs-identifier hs-var">parallelism</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TimeCost
</span><span class="hs-number">4</span></span><span>
</span><span id="line-98"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">variant :: Variant
</span><a href="Crypto.KDF.Argon2.html#variant"><span class="hs-identifier hs-var">variant</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Variant
</span><a href="Crypto.KDF.Argon2.html#Argon2i"><span class="hs-identifier hs-var">Argon2i</span></a></span><span>
</span><span id="line-99"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">version :: Version
</span><a href="Crypto.KDF.Argon2.html#version"><span class="hs-identifier hs-var">version</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Crypto.KDF.Argon2.html#Version13"><span class="hs-identifier hs-var">Version13</span></a></span><span>
</span><span id="line-100"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span id="local-6989586621679210376"><span id="local-6989586621679210377"><span id="local-6989586621679210379"><span class="annot"><a href="Crypto.KDF.Argon2.html#hash"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210379"><span class="hs-identifier hs-type">password</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210377"><span class="hs-identifier hs-type">salt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679210376"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span>
</span><span id="line-104"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210379"><span class="hs-identifier hs-type">password</span></a></span><span>
</span><span id="line-105"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210377"><span class="hs-identifier hs-type">salt</span></a></span><span>
</span><span id="line-106"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-107"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailable"><span class="hs-identifier hs-type">CryptoFailable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210376"><span class="hs-identifier hs-type">out</span></a></span></span></span></span><span>
</span><span id="line-108"></span><span id="hash"><span class="annot"><span class="annottext">hash :: forall password salt out.
(ByteArrayAccess password, ByteArrayAccess salt, ByteArray out) =&gt;
Options -&gt; password -&gt; salt -&gt; Int -&gt; CryptoFailable out
</span><a href="Crypto.KDF.Argon2.html#hash"><span class="hs-identifier hs-var hs-var">hash</span></a></span></span><span> </span><span id="local-6989586621679210005"><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679210005"><span class="hs-identifier hs-var">options</span></a></span></span><span> </span><span id="local-6989586621679210004"><span class="annot"><span class="annottext">password
</span><a href="#local-6989586621679210004"><span class="hs-identifier hs-var">password</span></a></span></span><span> </span><span id="local-6989586621679210003"><span class="annot"><span class="annottext">salt
</span><a href="#local-6989586621679210003"><span class="hs-identifier hs-var">salt</span></a></span></span><span> </span><span id="local-6989586621679210002"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679210002"><span class="hs-identifier hs-var">outLen</span></a></span></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679210001"><span class="hs-identifier hs-var">saltLen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Crypto.KDF.Argon2.html#saltMinLength"><span class="hs-identifier hs-var">saltMinLength</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. CryptoError -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoFailed"><span class="hs-identifier hs-var">CryptoFailed</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><a href="Crypto.Error.Types.html#CryptoError_SaltTooSmall"><span class="hs-identifier hs-var">CryptoError_SaltTooSmall</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679210002"><span class="hs-identifier hs-var">outLen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Crypto.KDF.Argon2.html#outputMinLength"><span class="hs-identifier hs-var">outputMinLength</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. CryptoError -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoFailed"><span class="hs-identifier hs-var">CryptoFailed</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><a href="Crypto.Error.Types.html#CryptoError_OutputLengthTooSmall"><span class="hs-identifier hs-var">CryptoError_OutputLengthTooSmall</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679210002"><span class="hs-identifier hs-var">outLen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Crypto.KDF.Argon2.html#outputMaxLength"><span class="hs-identifier hs-var">outputMaxLength</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. CryptoError -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoFailed"><span class="hs-identifier hs-var">CryptoFailed</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><a href="Crypto.Error.Types.html#CryptoError_OutputLengthTooBig"><span class="hs-identifier hs-var">CryptoError_OutputLengthTooBig</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoPassed"><span class="hs-identifier hs-var">CryptoPassed</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a p. ByteArray a =&gt; Int -&gt; (Ptr p -&gt; IO ()) -&gt; a
</span><span class="hs-identifier hs-var">B.allocAndFreeze</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679210002"><span class="hs-identifier hs-var">outLen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679209992"><span class="annot"><span class="annottext">Ptr HashOut
</span><a href="#local-6989586621679209992"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-113"></span><span>        </span><span id="local-6989586621679209991"><span class="annot"><span class="annottext">CVariant
</span><a href="#local-6989586621679209991"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">B.withByteArray</span></span><span> </span><span class="annot"><span class="annottext">password
</span><a href="#local-6989586621679210004"><span class="hs-identifier hs-var">password</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679209989"><span class="annot"><span class="annottext">Ptr Pass
</span><a href="#local-6989586621679209989"><span class="hs-identifier hs-var">pPass</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-114"></span><span>               </span><span class="annot"><span class="annottext">forall ba p a. ByteArrayAccess ba =&gt; ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">B.withByteArray</span></span><span> </span><span class="annot"><span class="annottext">salt
</span><a href="#local-6989586621679210003"><span class="hs-identifier hs-var">salt</span></a></span><span>     </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679209988"><span class="annot"><span class="annottext">Ptr Salt
</span><a href="#local-6989586621679209988"><span class="hs-identifier hs-var">pSalt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-115"></span><span>                    </span><span class="annot"><span class="annottext">TimeCost
-&gt; TimeCost
-&gt; TimeCost
-&gt; Ptr Pass
-&gt; CSize
-&gt; Ptr Salt
-&gt; CSize
-&gt; Ptr HashOut
-&gt; CSize
-&gt; CVariant
-&gt; CVariant
-&gt; IO CVariant
</span><a href="Crypto.KDF.Argon2.html#argon2_hash"><span class="hs-identifier hs-var">argon2_hash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Options -&gt; TimeCost
</span><a href="Crypto.KDF.Argon2.html#iterations"><span class="hs-identifier hs-var">iterations</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679210005"><span class="hs-identifier hs-var">options</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Options -&gt; TimeCost
</span><a href="Crypto.KDF.Argon2.html#memory"><span class="hs-identifier hs-var">memory</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679210005"><span class="hs-identifier hs-var">options</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Options -&gt; TimeCost
</span><a href="Crypto.KDF.Argon2.html#parallelism"><span class="hs-identifier hs-var">parallelism</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679210005"><span class="hs-identifier hs-var">options</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>                                </span><span class="annot"><span class="annottext">Ptr Pass
</span><a href="#local-6989586621679209989"><span class="hs-identifier hs-var">pPass</span></a></span><span>
</span><span id="line-119"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
</span><a href="Crypto.KDF.Argon2.html#csizeOfInt"><span class="hs-identifier hs-var">csizeOfInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679209985"><span class="hs-identifier hs-var">passwordLen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>                                </span><span class="annot"><span class="annottext">Ptr Salt
</span><a href="#local-6989586621679209988"><span class="hs-identifier hs-var">pSalt</span></a></span><span>
</span><span id="line-121"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
</span><a href="Crypto.KDF.Argon2.html#csizeOfInt"><span class="hs-identifier hs-var">csizeOfInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679210001"><span class="hs-identifier hs-var">saltLen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>                                </span><span class="annot"><span class="annottext">Ptr HashOut
</span><a href="#local-6989586621679209992"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-123"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
</span><a href="Crypto.KDF.Argon2.html#csizeOfInt"><span class="hs-identifier hs-var">csizeOfInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679210002"><span class="hs-identifier hs-var">outLen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Variant -&gt; CVariant
</span><a href="Crypto.KDF.Argon2.html#cOfVariant"><span class="hs-identifier hs-var">cOfVariant</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Options -&gt; Variant
</span><a href="Crypto.KDF.Argon2.html#variant"><span class="hs-identifier hs-var">variant</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679210005"><span class="hs-identifier hs-var">options</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Version -&gt; CVariant
</span><a href="Crypto.KDF.Argon2.html#cOfVersion"><span class="hs-identifier hs-var">cOfVersion</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Options -&gt; Version
</span><a href="Crypto.KDF.Argon2.html#version"><span class="hs-identifier hs-var">version</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679210005"><span class="hs-identifier hs-var">options</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CVariant
</span><a href="#local-6989586621679209991"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">CVariant
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;argon2: hash: internal error&quot;</span></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621679210001"><span class="annot"><span class="annottext">saltLen :: Int
</span><a href="#local-6989586621679210001"><span class="hs-identifier hs-var hs-var">saltLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">salt
</span><a href="#local-6989586621679210003"><span class="hs-identifier hs-var">salt</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span id="local-6989586621679209985"><span class="annot"><span class="annottext">passwordLen :: Int
</span><a href="#local-6989586621679209985"><span class="hs-identifier hs-var hs-var">passwordLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">password
</span><a href="#local-6989586621679210004"><span class="hs-identifier hs-var">password</span></a></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-keyword">data</span><span> </span><span id="Pass"><span class="annot"><a href="Crypto.KDF.Argon2.html#Pass"><span class="hs-identifier hs-var">Pass</span></a></span></span><span>
</span><span id="line-132"></span><span class="hs-keyword">data</span><span> </span><span id="Salt"><span class="annot"><a href="Crypto.KDF.Argon2.html#Salt"><span class="hs-identifier hs-var">Salt</span></a></span></span><span>
</span><span id="line-133"></span><span class="hs-keyword">data</span><span> </span><span id="HashOut"><span class="annot"><a href="Crypto.KDF.Argon2.html#HashOut"><span class="hs-identifier hs-var">HashOut</span></a></span></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-keyword">type</span><span> </span><span id="CVariant"><span class="annot"><a href="Crypto.KDF.Argon2.html#CVariant"><span class="hs-identifier hs-var">CVariant</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span> </span><span class="hs-comment">-- valid value is 0 (Argon2d), 1 (Argon2i) and 2 (Argon2id)</span><span>
</span><span id="line-136"></span><span class="hs-keyword">type</span><span> </span><span id="CVersion"><span class="annot"><a href="Crypto.KDF.Argon2.html#CVersion"><span class="hs-identifier hs-var">CVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span> </span><span class="hs-comment">-- valid value is 0x10, 0x13</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="annot"><a href="Crypto.KDF.Argon2.html#cOfVersion"><span class="hs-identifier hs-type">cOfVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#CVersion"><span class="hs-identifier hs-type">CVersion</span></a></span><span>
</span><span id="line-139"></span><span id="cOfVersion"><span class="annot"><span class="annottext">cOfVersion :: Version -&gt; CVariant
</span><a href="Crypto.KDF.Argon2.html#cOfVersion"><span class="hs-identifier hs-var hs-var">cOfVersion</span></a></span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Crypto.KDF.Argon2.html#Version10"><span class="hs-identifier hs-var">Version10</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CVariant
</span><span class="hs-number">0x10</span></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Crypto.KDF.Argon2.html#cOfVersion"><span class="hs-identifier hs-var">cOfVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Crypto.KDF.Argon2.html#Version13"><span class="hs-identifier hs-var">Version13</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CVariant
</span><span class="hs-number">0x13</span></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="annot"><a href="Crypto.KDF.Argon2.html#cOfVariant"><span class="hs-identifier hs-type">cOfVariant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#Variant"><span class="hs-identifier hs-type">Variant</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#CVariant"><span class="hs-identifier hs-type">CVariant</span></a></span><span>
</span><span id="line-143"></span><span id="cOfVariant"><span class="annot"><span class="annottext">cOfVariant :: Variant -&gt; CVariant
</span><a href="Crypto.KDF.Argon2.html#cOfVariant"><span class="hs-identifier hs-var hs-var">cOfVariant</span></a></span></span><span> </span><span class="annot"><span class="annottext">Variant
</span><a href="Crypto.KDF.Argon2.html#Argon2d"><span class="hs-identifier hs-var">Argon2d</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CVariant
</span><span class="hs-number">0</span></span><span>
</span><span id="line-144"></span><span class="annot"><a href="Crypto.KDF.Argon2.html#cOfVariant"><span class="hs-identifier hs-var">cOfVariant</span></a></span><span> </span><span class="annot"><span class="annottext">Variant
</span><a href="Crypto.KDF.Argon2.html#Argon2i"><span class="hs-identifier hs-var">Argon2i</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CVariant
</span><span class="hs-number">1</span></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Crypto.KDF.Argon2.html#cOfVariant"><span class="hs-identifier hs-var">cOfVariant</span></a></span><span> </span><span class="annot"><span class="annottext">Variant
</span><a href="Crypto.KDF.Argon2.html#Argon2id"><span class="hs-identifier hs-var">Argon2id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CVariant
</span><span class="hs-number">2</span></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="annot"><a href="Crypto.KDF.Argon2.html#csizeOfInt"><span class="hs-identifier hs-type">csizeOfInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span>
</span><span id="line-148"></span><span id="csizeOfInt"><span class="annot"><span class="annottext">csizeOfInt :: Int -&gt; CSize
</span><a href="Crypto.KDF.Argon2.html#csizeOfInt"><span class="hs-identifier hs-var hs-var">csizeOfInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;cryptonite_argon2_hash&quot;</span></span><span>
</span><span id="line-151"></span><span>    </span><span id="argon2_hash"><span class="annot"><a href="Crypto.KDF.Argon2.html#argon2_hash"><span class="hs-identifier hs-var">argon2_hash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-152"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#Pass"><span class="hs-identifier hs-type">Pass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span>
</span><span id="line-153"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#Salt"><span class="hs-identifier hs-type">Salt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span>
</span><span id="line-154"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#HashOut"><span class="hs-identifier hs-type">HashOut</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span>
</span><span id="line-155"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#CVariant"><span class="hs-identifier hs-type">CVariant</span></a></span><span>
</span><span id="line-156"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.KDF.Argon2.html#CVersion"><span class="hs-identifier hs-type">CVersion</span></a></span><span>
</span><span id="line-157"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span>
</span><span id="line-158"></span></pre></body></html>